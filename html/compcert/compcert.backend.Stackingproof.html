
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Stackingproof</title>
<meta name="description" content="Documentation of Coq module Stackingproof" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="compcert"><summary>compcert</summary>
          <ul>
          <li><details id="compcert.backend"><summary>backend</summary>
          <ul>
          <li><a href="compcert.backend.Allocation.html">Allocation</a></li>
<li><a href="compcert.backend.Allocproof.html">Allocproof</a></li>
<li><a href="compcert.backend.Asmgenproof0.html">Asmgenproof0</a></li>
<li><a href="compcert.backend.Bounds.html">Bounds</a></li>
<li><a href="compcert.backend.CleanupLabels.html">CleanupLabels</a></li>
<li><a href="compcert.backend.CleanupLabelsproof.html">CleanupLabelsproof</a></li>
<li><a href="compcert.backend.Cminor.html">Cminor</a></li>
<li><a href="compcert.backend.CminorSel.html">CminorSel</a></li>
<li><a href="compcert.backend.Cminortyping.html">Cminortyping</a></li>
<li><a href="compcert.backend.Constprop.html">Constprop</a></li>
<li><a href="compcert.backend.Constpropproof.html">Constpropproof</a></li>
<li><a href="compcert.backend.Conventions.html">Conventions</a></li>
<li><a href="compcert.backend.CSE.html">CSE</a></li>
<li><a href="compcert.backend.CSEdomain.html">CSEdomain</a></li>
<li><a href="compcert.backend.CSEproof.html">CSEproof</a></li>
<li><a href="compcert.backend.Deadcode.html">Deadcode</a></li>
<li><a href="compcert.backend.Deadcodeproof.html">Deadcodeproof</a></li>
<li><a href="compcert.backend.Debugvar.html">Debugvar</a></li>
<li><a href="compcert.backend.Debugvarproof.html">Debugvarproof</a></li>
<li><a href="compcert.backend.Inlining.html">Inlining</a></li>
<li><a href="compcert.backend.Inliningproof.html">Inliningproof</a></li>
<li><a href="compcert.backend.Inliningspec.html">Inliningspec</a></li>
<li><a href="compcert.backend.Kildall.html">Kildall</a></li>
<li><a href="compcert.backend.Linear.html">Linear</a></li>
<li><a href="compcert.backend.Linearize.html">Linearize</a></li>
<li><a href="compcert.backend.Linearizeproof.html">Linearizeproof</a></li>
<li><a href="compcert.backend.Lineartyping.html">Lineartyping</a></li>
<li><a href="compcert.backend.Liveness.html">Liveness</a></li>
<li><a href="compcert.backend.Locations.html">Locations</a></li>
<li><a href="compcert.backend.LTL.html">LTL</a></li>
<li><a href="compcert.backend.Mach.html">Mach</a></li>
<li><a href="compcert.backend.NeedDomain.html">NeedDomain</a></li>
<li><a href="compcert.backend.Registers.html">Registers</a></li>
<li><a href="compcert.backend.Renumber.html">Renumber</a></li>
<li><a href="compcert.backend.Renumberproof.html">Renumberproof</a></li>
<li><a href="compcert.backend.RTL.html">RTL</a></li>
<li><a href="compcert.backend.RTLgen.html">RTLgen</a></li>
<li><a href="compcert.backend.RTLgenproof.html">RTLgenproof</a></li>
<li><a href="compcert.backend.RTLgenspec.html">RTLgenspec</a></li>
<li><a href="compcert.backend.RTLtyping.html">RTLtyping</a></li>
<li><a href="compcert.backend.SelectDiv.html">SelectDiv</a></li>
<li><a href="compcert.backend.SelectDivproof.html">SelectDivproof</a></li>
<li><a href="compcert.backend.Selection.html">Selection</a></li>
<li><a href="compcert.backend.Selectionproof.html">Selectionproof</a></li>
<li><a href="compcert.backend.SplitLong.html">SplitLong</a></li>
<li><a href="compcert.backend.SplitLongproof.html">SplitLongproof</a></li>
<li><a href="compcert.backend.Stacking.html">Stacking</a></li>
<li><a href="compcert.backend.Stackingproof.html">Stackingproof</a></li>
<li><a href="compcert.backend.Tailcall.html">Tailcall</a></li>
<li><a href="compcert.backend.Tailcallproof.html">Tailcallproof</a></li>
<li><a href="compcert.backend.Tunneling.html">Tunneling</a></li>
<li><a href="compcert.backend.Tunnelingproof.html">Tunnelingproof</a></li>
<li><a href="compcert.backend.Unusedglob.html">Unusedglob</a></li>
<li><a href="compcert.backend.Unusedglobproof.html">Unusedglobproof</a></li>
<li><a href="compcert.backend.ValueAnalysis.html">ValueAnalysis</a></li>
<li><a href="compcert.backend.ValueDomain.html">ValueDomain</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.cfrontend"><summary>cfrontend</summary>
          <ul>
          <li><a href="compcert.cfrontend.Cexec.html">Cexec</a></li>
<li><a href="compcert.cfrontend.Clight.html">Clight</a></li>
<li><a href="compcert.cfrontend.ClightBigstep.html">ClightBigstep</a></li>
<li><a href="compcert.cfrontend.Cminorgen.html">Cminorgen</a></li>
<li><a href="compcert.cfrontend.Cminorgenproof.html">Cminorgenproof</a></li>
<li><a href="compcert.cfrontend.Cop.html">Cop</a></li>
<li><a href="compcert.cfrontend.Csem.html">Csem</a></li>
<li><a href="compcert.cfrontend.Csharpminor.html">Csharpminor</a></li>
<li><a href="compcert.cfrontend.Cshmgen.html">Cshmgen</a></li>
<li><a href="compcert.cfrontend.Cshmgenproof.html">Cshmgenproof</a></li>
<li><a href="compcert.cfrontend.Cstrategy.html">Cstrategy</a></li>
<li><a href="compcert.cfrontend.Csyntax.html">Csyntax</a></li>
<li><a href="compcert.cfrontend.Ctypes.html">Ctypes</a></li>
<li><a href="compcert.cfrontend.Ctyping.html">Ctyping</a></li>
<li><a href="compcert.cfrontend.Initializers.html">Initializers</a></li>
<li><a href="compcert.cfrontend.Initializersproof.html">Initializersproof</a></li>
<li><a href="compcert.cfrontend.SimplExpr.html">SimplExpr</a></li>
<li><a href="compcert.cfrontend.SimplExprproof.html">SimplExprproof</a></li>
<li><a href="compcert.cfrontend.SimplExprspec.html">SimplExprspec</a></li>
<li><a href="compcert.cfrontend.SimplLocals.html">SimplLocals</a></li>
<li><a href="compcert.cfrontend.SimplLocalsproof.html">SimplLocalsproof</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.common"><summary>common</summary>
          <ul>
          <li><a href="compcert.common.AST.html">AST</a></li>
<li><a href="compcert.common.Behaviors.html">Behaviors</a></li>
<li><a href="compcert.common.Builtins.html">Builtins</a></li>
<li><a href="compcert.common.Builtins0.html">Builtins0</a></li>
<li><a href="compcert.common.Determinism.html">Determinism</a></li>
<li><a href="compcert.common.Errors.html">Errors</a></li>
<li><a href="compcert.common.Events.html">Events</a></li>
<li><a href="compcert.common.Globalenvs.html">Globalenvs</a></li>
<li><a href="compcert.common.Linking.html">Linking</a></li>
<li><a href="compcert.common.Memdata.html">Memdata</a></li>
<li><a href="compcert.common.Memory.html">Memory</a></li>
<li><a href="compcert.common.Memtype.html">Memtype</a></li>
<li><a href="compcert.common.Separation.html">Separation</a></li>
<li><a href="compcert.common.Smallstep.html">Smallstep</a></li>
<li><a href="compcert.common.Switch.html">Switch</a></li>
<li><a href="compcert.common.Unityping.html">Unityping</a></li>
<li><a href="compcert.common.Values.html">Values</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.cparser"><summary>cparser</summary>
          <ul>
          <li><a href="compcert.cparser.Cabs.html">Cabs</a></li>
<li><a href="compcert.cparser.Parser.html">Parser</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.driver"><summary>driver</summary>
          <ul>
          <li><a href="compcert.driver.Compiler.html">Compiler</a></li>
<li><a href="compcert.driver.Complements.html">Complements</a></li>
<li><a href="compcert.driver.Compopts.html">Compopts</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.lib"><summary>lib</summary>
          <ul>
          <li><a href="compcert.lib.Axioms.html">Axioms</a></li>
<li><a href="compcert.lib.BoolEqual.html">BoolEqual</a></li>
<li><a href="compcert.lib.Coqlib.html">Coqlib</a></li>
<li><a href="compcert.lib.Decidableplus.html">Decidableplus</a></li>
<li><a href="compcert.lib.Floats.html">Floats</a></li>
<li><a href="compcert.lib.FSetAVLplus.html">FSetAVLplus</a></li>
<li><a href="compcert.lib.Heaps.html">Heaps</a></li>
<li><a href="compcert.lib.IEEE754_extra.html">IEEE754_extra</a></li>
<li><a href="compcert.lib.Integers.html">Integers</a></li>
<li><a href="compcert.lib.Intv.html">Intv</a></li>
<li><a href="compcert.lib.IntvSets.html">IntvSets</a></li>
<li><a href="compcert.lib.Iteration.html">Iteration</a></li>
<li><a href="compcert.lib.Lattice.html">Lattice</a></li>
<li><a href="compcert.lib.Maps.html">Maps</a></li>
<li><a href="compcert.lib.Ordered.html">Ordered</a></li>
<li><a href="compcert.lib.Parmov.html">Parmov</a></li>
<li><a href="compcert.lib.Postorder.html">Postorder</a></li>
<li><a href="compcert.lib.UnionFind.html">UnionFind</a></li>
<li><a href="compcert.lib.Wfsimpl.html">Wfsimpl</a></li>
<li><a href="compcert.lib.Zbits.html">Zbits</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.x86"><summary>x86</summary>
          <ul>
          <li><a href="compcert.x86.Asm.html">Asm</a></li>
<li><a href="compcert.x86.Asmgen.html">Asmgen</a></li>
<li><a href="compcert.x86.Asmgenproof.html">Asmgenproof</a></li>
<li><a href="compcert.x86.Asmgenproof1.html">Asmgenproof1</a></li>
<li><a href="compcert.x86.Builtins1.html">Builtins1</a></li>
<li><a href="compcert.x86.CombineOp.html">CombineOp</a></li>
<li><a href="compcert.x86.CombineOpproof.html">CombineOpproof</a></li>
<li><a href="compcert.x86.ConstpropOp.html">ConstpropOp</a></li>
<li><a href="compcert.x86.ConstpropOpproof.html">ConstpropOpproof</a></li>
<li><a href="compcert.x86.Conventions1.html">Conventions1</a></li>
<li><a href="compcert.x86.Machregs.html">Machregs</a></li>
<li><a href="compcert.x86.NeedOp.html">NeedOp</a></li>
<li><a href="compcert.x86.Op.html">Op</a></li>
<li><a href="compcert.x86.SelectLong.html">SelectLong</a></li>
<li><a href="compcert.x86.SelectLongproof.html">SelectLongproof</a></li>
<li><a href="compcert.x86.SelectOp.html">SelectOp</a></li>
<li><a href="compcert.x86.SelectOpproof.html">SelectOpproof</a></li>
<li><a href="compcert.x86.Stacklayout.html">Stacklayout</a></li>
<li><a href="compcert.x86.ValueAOp.html">ValueAOp</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.x86_64"><summary>x86_64</summary>
          <ul>
          <li><a href="compcert.x86_64.Archi.html">Archi</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Flocq"><summary>Flocq</summary>
          <ul>
          <li><details id="Flocq.Calc"><summary>Calc</summary>
          <ul>
          <li><a href="Flocq.Calc.Bracket.html">Bracket</a></li>
<li><a href="Flocq.Calc.Div.html">Div</a></li>
<li><a href="Flocq.Calc.Operations.html">Operations</a></li>
<li><a href="Flocq.Calc.Plus.html">Plus</a></li>
<li><a href="Flocq.Calc.Round.html">Round</a></li>
<li><a href="Flocq.Calc.Sqrt.html">Sqrt</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.Core"><summary>Core</summary>
          <ul>
          <li><a href="Flocq.Core.Core.html">Core</a></li>
<li><a href="Flocq.Core.Defs.html">Defs</a></li>
<li><a href="Flocq.Core.Digits.html">Digits</a></li>
<li><a href="Flocq.Core.FIX.html">FIX</a></li>
<li><a href="Flocq.Core.Float_prop.html">Float_prop</a></li>
<li><a href="Flocq.Core.FLT.html">FLT</a></li>
<li><a href="Flocq.Core.FLX.html">FLX</a></li>
<li><a href="Flocq.Core.FTZ.html">FTZ</a></li>
<li><a href="Flocq.Core.Generic_fmt.html">Generic_fmt</a></li>
<li><a href="Flocq.Core.Raux.html">Raux</a></li>
<li><a href="Flocq.Core.Round_NE.html">Round_NE</a></li>
<li><a href="Flocq.Core.Round_pred.html">Round_pred</a></li>
<li><a href="Flocq.Core.Ulp.html">Ulp</a></li>
<li><a href="Flocq.Core.Zaux.html">Zaux</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.IEEE754"><summary>IEEE754</summary>
          <ul>
          <li><a href="Flocq.IEEE754.Binary.html">Binary</a></li>
<li><a href="Flocq.IEEE754.BinarySingleNaN.html">BinarySingleNaN</a></li>
<li><a href="Flocq.IEEE754.Bits.html">Bits</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.Prop"><summary>Prop</summary>
          <ul>
          <li><a href="Flocq.Prop.Div_sqrt_error.html">Div_sqrt_error</a></li>
<li><a href="Flocq.Prop.Double_rounding.html">Double_rounding</a></li>
<li><a href="Flocq.Prop.Mult_error.html">Mult_error</a></li>
<li><a href="Flocq.Prop.Plus_error.html">Plus_error</a></li>
<li><a href="Flocq.Prop.Relative.html">Relative</a></li>
<li><a href="Flocq.Prop.Round_odd.html">Round_odd</a></li>
<li><a href="Flocq.Prop.Sterbenz.html">Sterbenz</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="MenhirLib"><summary>MenhirLib</summary>
          <ul>
          <li><a href="MenhirLib.Alphabet.html">Alphabet</a></li>
<li><a href="MenhirLib.Automaton.html">Automaton</a></li>
<li><a href="MenhirLib.Grammar.html">Grammar</a></li>
<li><a href="MenhirLib.Interpreter.html">Interpreter</a></li>
<li><a href="MenhirLib.Interpreter_complete.html">Interpreter_complete</a></li>
<li><a href="MenhirLib.Interpreter_correct.html">Interpreter_correct</a></li>
<li><a href="MenhirLib.Main.html">Main</a></li>
<li><a href="MenhirLib.Validator_classes.html">Validator_classes</a></li>
<li><a href="MenhirLib.Validator_complete.html">Validator_complete</a></li>
<li><a href="MenhirLib.Validator_safe.html">Validator_safe</a></li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module Stackingproof</h1>
<br/>
<div class="doc">Correctness proof for the translation from Linear to Mach. </div>
<br/>
<div class="doc">This file proves semantic preservation for the <span class="bracket"><span class="id">Stacking</span></span> pass. </div>
<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="compcert.lib.Integers.html">Integers</a></span> <span class="id"><a href="compcert.common.AST.html">AST</a></span> <span class="id"><a href="compcert.common.Linking.html">Linking</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="compcert.common.Values.html">Values</a></span> <span class="id"><a href="compcert.common.Memory.html">Memory</a></span> <span class="id"><a href="compcert.common.Separation.html">Separation</a></span> <span class="id"><a href="compcert.common.Events.html">Events</a></span> <span class="id"><a href="compcert.common.Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="compcert.common.Smallstep.html">Smallstep</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="compcert.backend.LTL.html">LTL</a></span> <span class="id"><a href="compcert.x86.Op.html">Op</a></span> <span class="id"><a href="compcert.backend.Locations.html">Locations</a></span> <span class="id"><a href="compcert.backend.Linear.html">Linear</a></span> <span class="id"><a href="compcert.backend.Mach.html">Mach</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="compcert.backend.Bounds.html">Bounds</a></span> <span class="id"><a href="compcert.backend.Conventions.html">Conventions</a></span> <span class="id"><a href="compcert.x86.Stacklayout.html">Stacklayout</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html">Lineartyping</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="compcert.backend.Stacking.html">Stacking</a></span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">sep_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="match_prog" class="id"><a name="match_prog" class="">match_prog</a></span> (<span id="p:1" class="id"><a name="p:1" class="">p:</a></span> <span class="id"><a href="compcert.backend.Linear.html#program">Linear.program</a></span>) (<span id="tp:2" class="id"><a name="tp:2" class="">tp:</a></span> <span class="id"><a href="compcert.backend.Mach.html#program">Mach.program</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span id="f:3" class="id"><a name="f:3" class="">f</a></span> <span id="tf:4" class="id"><a name="tf:4" class="">tf</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:3">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:4">tf</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:1">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tp:2">tp</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="transf_program_match" class="id"><a name="transf_program_match" class="">transf_program_match:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="p:5" class="id"><a name="p:5" class="">p</a></span> <span id="tp:6" class="id"><a name="tp:6" class="">tp,</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transf_program">transf_program</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:5">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tp:6">tp</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:5">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tp:6">tp</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Linking.html#match_transform_partial_program">match_transform_partial_program;</a></span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<h1> Basic properties of the translation </h1>
<br/>
<span class="vernacular">Lemma</span> <span id="typesize_typesize" class="id"><a name="typesize_typesize" class="">typesize_typesize:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ty:7" class="id"><a name="ty:7" class="">ty,</a></span> <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:7">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:7">ty</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ty;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="size_type_chunk" class="id"><a name="size_type_chunk" class="">size_type_chunk:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ty:8" class="id"><a name="ty:8" class="">ty,</a></span> <span class="id"><a href="compcert.common.Memdata.html#size_chunk">size_chunk</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:8">ty</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:8">ty</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ty;</span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="align_type_chunk" class="id"><a name="align_type_chunk" class="">align_type_chunk:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ty:9" class="id"><a name="ty:9" class="">ty,</a></span> <span class="id"><a href="compcert.common.Memdata.html#align_chunk">align_chunk</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:9">ty</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Locations.html#typealign">Locations.typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:9">ty</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ty;</span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="slot_outgoing_argument_valid" class="id"><a name="slot_outgoing_argument_valid" class="">slot_outgoing_argument_valid:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="f:10" class="id"><a name="f:10" class="">f</a></span> <span id="ofs:11" class="id"><a name="ofs:11" class="">ofs</a></span> <span id="ty:12" class="id"><a name="ty:12" class="">ty</a></span> <span id="sg:13" class="id"><a name="sg:13" class="">sg,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:11">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:12">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:13">sg</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:10">f</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:11">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:12">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Conventions.html#loc_arguments_acceptable_2">loc_arguments_acceptable_2;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[A</span> <span class="id">B]</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span>. <span class="id">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zle_true">zle_true</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_true">pred_dec_true</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="load_result_inject" class="id"><a name="load_result_inject" class="">load_result_inject:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:14" class="id"><a name="j:14" class="">j</a></span> <span id="ty:15" class="id"><a name="ty:15" class="">ty</a></span> <span id="v:16" class="id"><a name="v:16" class="">v</a></span> <span id="v':17" class="id"><a name="v':17" class="">v',</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:14">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:16">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':17">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:16">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:15">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:14">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:16">v</a></span> (<span class="id"><a href="compcert.common.Values.html#Val.load_result">Val.load_result</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:15">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v':17">v'</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">until</span> <span class="id">v';</span> <span class="id">unfold</span> <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span><span class="id">,</span> <span class="id"><a href="compcert.common.Values.html#Val.load_result">Val.load_result</a></span><span class="id">;</span> <span class="id">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span><span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">1;</span> <span class="id">intros;</span> <span class="id">auto;</span> <span class="id">destruct</span> <span class="id">ty;</span> <span class="id">simpl;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> <span class="id">contradiction;</span> <span class="id">try</span> <span class="id">discriminate;</span> <span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Section</span> <span id="PRESERVATION" class="id"><a name="PRESERVATION" class="">PRESERVATION</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.return_address_offset" class="id"><a name="PRESERVATION.return_address_offset" class="">return_address_offset:</a></span> <span class="id"><a href="compcert.backend.Mach.html#function">Mach.function</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Mach.html#code">Mach.code</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Integers.html#ptrofs">ptrofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">Prop</span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.return_address_offset_exists" class="id"><a name="PRESERVATION.return_address_offset_exists" class="">return_address_offset_exists:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="f:19" class="id"><a name="f:19" class="">f</a></span> <span id="sg:20" class="id"><a name="sg:20" class="">sg</a></span> <span id="ros:21" class="id"><a name="ros:21" class="">ros</a></span> <span id="c:22" class="id"><a name="c:22" class="">c,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="compcert.backend.Mach.html#Mcall">Mcall</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:20">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ros:21">ros</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:22">c</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:19">f</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="ofs:23" class="id"><a name="ofs:23" class="">ofs,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.return_address_offset">return_address_offset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:19">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:22">c</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:23">ofs</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="PRESERVATION.step" class="id"><a name="PRESERVATION.step" class="">step</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Mach.html#step">Mach.step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.return_address_offset">return_address_offset</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.prog" class="id"><a name="PRESERVATION.prog" class="">prog:</a></span> <span class="id"><a href="compcert.backend.Linear.html#program">Linear.program</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.tprog" class="id"><a name="PRESERVATION.tprog" class="">tprog:</a></span> <span class="id"><a href="compcert.backend.Mach.html#program">Mach.program</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.TRANSF" class="id"><a name="PRESERVATION.TRANSF" class="">TRANSF:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tprog">tprog</a></span>.<br/>
<span class="vernacular">Let</span> <span id="PRESERVATION.ge" class="id"><a name="PRESERVATION.ge" class="">ge</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>.<br/>
<span class="vernacular">Let</span> <span id="PRESERVATION.tge" class="id"><a name="PRESERVATION.tge" class="">tge</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tprog">tprog</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="PRESERVATION.FRAME_PROPERTIES" class="id"><a name="PRESERVATION.FRAME_PROPERTIES" class="">FRAME_PROPERTIES</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.f" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.f" class="">f:</a></span> <span class="id"><a href="compcert.backend.Linear.html#function">Linear.function</a></span>.<br/>
<span class="vernacular">Let</span> <span id="PRESERVATION.FRAME_PROPERTIES.b" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.b" class="">b</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.<br/>
<span class="vernacular">Let</span> <span id="PRESERVATION.FRAME_PROPERTIES.fe" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.fe" class="">fe</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.tf" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.tf" class="">tf:</a></span> <span class="id"><a href="compcert.backend.Mach.html#function">Mach.function</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.FRAME_PROPERTIES.TRANSF_F" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.TRANSF_F" class="">TRANSF_F:</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="unfold_transf_function" class="id"><a name="unfold_transf_function" class="">unfold_transf_function:</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Mach.html#mkfunction">Mach.mkfunction</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stacking.html#transl_body">transl_body</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_link">fe_ofs_link</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_retaddr">fe_ofs_retaddr</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>)<span class="id">;</span> <span class="id">simpl</span> <span class="id">negb</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>)))).<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="transf_function_well_typed" class="id"><a name="transf_function_well_typed" class="">transf_function_well_typed:</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>)<span class="id">;</span> <span class="id">simpl</span> <span class="id">negb</span>. <span class="id">auto</span>. <span class="id">intros;</span> <span class="id">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="size_no_overflow" class="id"><a name="size_no_overflow" class="">size_no_overflow:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;<span class="id">generalize</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>)<span class="id">;</span> <span class="id">simpl</span> <span class="id">negb</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>)))).<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="bound_stack_data_stacksize" class="id"><a name="bound_stack_data_stacksize" class="">bound_stack_data_stacksize:</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b,</a></span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds,</a></span> <span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_l">Z.le_max_l</a></span>.<br/>
Qed.</div>
<br/>
<h1> Memory assertions used to describe the contents of stack frames </h1>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Opaque</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add">Z.add</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul">Z.mul</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide">Z.divide</a></span>.<br/>
<br/>
<div class="doc">Accessing the stack frame using <span class="bracket"><span class="id">load_stack</span></span> and <span class="bracket"><span class="id">store_stack</span></span>. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="contains_get_stack" class="id"><a name="contains_get_stack" class="">contains_get_stack:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="spec:31" class="id"><a name="spec:31" class="">spec</a></span> <span id="m:32" class="id"><a name="m:32" class="">m</a></span> <span id="ty:33" class="id"><a name="ty:33" class="">ty</a></span> <span id="sp:34" class="id"><a name="sp:34" class="">sp</a></span> <span id="ofs:35" class="id"><a name="ofs:35" class="">ofs,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:32">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#contains">contains</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:33">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp:34">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:35">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spec:31">spec</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="v:36" class="id"><a name="v:36" class="">v,</a></span> <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:32">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:34">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:33">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:35">ofs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:36">v</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spec:31">spec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:36">v</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)) <span class="gallina-kwd">with</span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#loadv_rule">loadv_rule;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="hasvalue_get_stack" class="id"><a name="hasvalue_get_stack" class="">hasvalue_get_stack:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ty:37" class="id"><a name="ty:37" class="">ty</a></span> <span id="m:38" class="id"><a name="m:38" class="">m</a></span> <span id="sp:39" class="id"><a name="sp:39" class="">sp</a></span> <span id="ofs:40" class="id"><a name="ofs:40" class="">ofs</a></span> <span id="v:41" class="id"><a name="v:41" class="">v,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:38">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#hasvalue">hasvalue</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:37">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp:39">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:40">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:41">v</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:38">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:39">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:37">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:40">ofs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:41">v</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_get_stack">contains_get_stack;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="contains_set_stack" class="id"><a name="contains_set_stack" class="">contains_set_stack:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span id="spec:42" class="id"><a name="spec:42" class="">spec:</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">Prop</span>) <span id="v:43" class="id"><a name="v:43" class="">v</a></span> <span id="spec1:44" class="id"><a name="spec1:44" class="">spec1</a></span> <span id="m:45" class="id"><a name="m:45" class="">m</a></span> <span id="ty:46" class="id"><a name="ty:46" class="">ty</a></span> <span id="sp:47" class="id"><a name="sp:47" class="">sp</a></span> <span id="ofs:48" class="id"><a name="ofs:48" class="">ofs</a></span> <span id="P:49" class="id"><a name="P:49" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:45">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#contains">contains</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:46">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp:47">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:48">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spec1:44">spec1</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:49">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#spec:42">spec</a></span> (<span class="id"><a href="compcert.common.Values.html#Val.load_result">Val.load_result</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:46">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:43">v</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="m':50" class="id"><a name="m':50" class="">m',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:45">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:47">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:46">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:48">ofs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:43">v</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':50">m'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':50">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#contains">contains</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:46">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp:47">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:48">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spec:42">spec</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:49">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)) <span class="gallina-kwd">with</span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#storev_rule">storev_rule;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">contains_locations</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span> <span class="id">ls</span></span> is a separation logic assertion
  that holds if the memory area at block <span class="bracket"><span class="id">sp</span></span>, offset <span class="bracket"><span class="id">pos</span></span>, size <span class="bracket">4 * <span class="id">bound</span></span>,
  reflects the values of the stack locations of kind <span class="bracket"><span class="id">sl</span></span> given by the
  location map <span class="bracket"><span class="id">ls</span></span>, up to the memory injection <span class="bracket"><span class="id">j</span></span>.
  Two such <span class="bracket"><span class="id">contains_locations</span></span> assertions will be used later, one to
  reason about the values of <span class="bracket"><span class="vernacular">Local</span></span> slots, the other about the values of
  <span class="bracket"><span class="id">Outgoing</span></span> slots. </div>
<br/>
<span class="id">Program</span> <span class="vernacular">Definition</span> <span id="contains_locations" class="id"><a name="contains_locations" class="">contains_locations</a></span> (<span id="j:51" class="id"><a name="j:51" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span id="sp:52" class="id"><a name="sp:52" class="">sp:</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span id="pos:53" class="id"><a name="pos:53" class="">pos</a></span> <span id="bound:54" class="id"><a name="bound:54" class="">bound:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="sl:55" class="id"><a name="sl:55" class="">sl:</a></span> <span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span>) (<span id="ls:56" class="id"><a name="ls:56" class="">ls:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) <span class="id">:</span> <span class="id"><a href="compcert.common.Separation.html#massert">massert</a></span> <span class="id">:=</span> <span class="id">{|</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#m_pred">m_pred</a></span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="m:57" class="id"><a name="m:57" class="">m</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">8</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#5cd21895b4d5f127eb2c0acb80e8d6fc">|</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:53">pos</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:53">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:53">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:54">bound</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.modulus">Ptrofs.modulus</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:57">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:52">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:53">pos</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos:53">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:54">bound</a></span>) <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ofs:58" class="id"><a name="ofs:58" class="">ofs</a></span> <span id="ty:59" class="id"><a name="ty:59" class="">ty,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:58">ofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:58">ofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:59">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:54">bound</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:59">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#5cd21895b4d5f127eb2c0acb80e8d6fc">|</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:58">ofs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="v:60" class="id"><a name="v:60" class="">v,</a></span> <span class="id"><a href="compcert.common.Memory.html#Mem.load">Mem.load</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:59">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#m:57">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:52">sp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos:53">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:58">ofs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:60">v</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:51">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:56">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:55">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:58">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:59">ty</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v:60">v;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#m_footprint">m_footprint</a></span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="b:61" class="id"><a name="b:61" class="">b</a></span> <span id="ofs:62" class="id"><a name="ofs:62" class="">ofs</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#b:61">b</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:52">sp</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:53">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:62">ofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:53">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:54">bound</a></span><br/>
<span class="id">|}</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Next Obligation.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;<span class="id">intuition</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">red;</span> <span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_unchanged_on">Mem.perm_unchanged_on</a></span><span class="id">;</span> <span class="id">eauto</span>. <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">exploit</span> <span class="id">H4;</span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="gallina-kwd">exists</span> <span class="id">v;</span> <span class="id">split;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.load_unchanged_on">Mem.load_unchanged_on</a></span><span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl;</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#typesize_typesize">typesize_typesize</a></span> <span class="gallina-kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">split;</span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Next Obligation.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;<span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="valid_access_location" class="id"><a name="valid_access_location" class="">valid_access_location:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="m:63" class="id"><a name="m:63" class="">m</a></span> <span id="sp:64" class="id"><a name="sp:64" class="">sp</a></span> <span id="pos:65" class="id"><a name="pos:65" class="">pos</a></span> <span id="bound:66" class="id"><a name="bound:66" class="">bound</a></span> <span id="ofs:67" class="id"><a name="ofs:67" class="">ofs</a></span> <span id="ty:68" class="id"><a name="ty:68" class="">ty</a></span> <span id="p:69" class="id"><a name="p:69" class="">p,</a></span><br/>
&nbsp;&nbsp;(<span class="id">8</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#5cd21895b4d5f127eb2c0acb80e8d6fc">|</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:65">pos</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:63">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:64">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:65">pos</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos:65">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:66">bound</a></span>) <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:67">ofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:67">ofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:68">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:66">bound</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:68">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#5cd21895b4d5f127eb2c0acb80e8d6fc">|</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:67">ofs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:63">m</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:68">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp:64">sp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos:65">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:67">ofs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#p:69">p</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">split</span>.<br/>
<span class="id">-</span> <span class="id">red;</span> <span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="gallina-kwd">with</span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable;</a></span> <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H0</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#typesize_typesize">typesize_typesize</a></span> <span class="gallina-kwd">in</span> <span class="id">H4</span>. <span class="id">lia</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#align_type_chunk">align_type_chunk</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_trans">Z.divide_trans</a></span> <span class="gallina-kwd">with</span> <span class="id">8;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">8</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3c2652250c7a120d67ccc0e8f58ae75">/</a></span> (<span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id">ty</span>))<span class="id">;</span> <span class="id">destruct</span> <span class="id">ty;</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_divide_mono_l">Z.mul_divide_mono_l</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="get_location" class="id"><a name="get_location" class="">get_location:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="m:70" class="id"><a name="m:70" class="">m</a></span> <span id="j:71" class="id"><a name="j:71" class="">j</a></span> <span id="sp:72" class="id"><a name="sp:72" class="">sp</a></span> <span id="pos:73" class="id"><a name="pos:73" class="">pos</a></span> <span id="bound:74" class="id"><a name="bound:74" class="">bound</a></span> <span id="sl:75" class="id"><a name="sl:75" class="">sl</a></span> <span id="ls:76" class="id"><a name="ls:76" class="">ls</a></span> <span id="ofs:77" class="id"><a name="ofs:77" class="">ofs</a></span> <span id="ty:78" class="id"><a name="ty:78" class="">ty,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:70">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:71">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:72">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:73">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:74">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:75">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:76">ls</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:77">ofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:77">ofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:78">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:74">bound</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:78">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#5cd21895b4d5f127eb2c0acb80e8d6fc">|</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:77">ofs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="v:79" class="id"><a name="v:79" class="">v,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:70">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:72">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:78">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos:73">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:77">ofs</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:79">v</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:71">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:76">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:75">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:77">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:78">ty</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v:79">v</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">H</span> <span class="gallina-kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span> &amp; <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H;</span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">U</span> &amp; <span class="id">V</span>). <span class="gallina-kwd">exists</span> <span class="id">v;</span> <span class="id">split;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack;</a></span> <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span><span class="id">,</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>. <span class="id">generalize</span> (<span class="id"><a href="compcert.backend.Locations.html#typesize_pos">typesize_pos</a></span> <span class="id">ty</span>). <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="set_location" class="id"><a name="set_location" class="">set_location:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="m:80" class="id"><a name="m:80" class="">m</a></span> <span id="j:81" class="id"><a name="j:81" class="">j</a></span> <span id="sp:82" class="id"><a name="sp:82" class="">sp</a></span> <span id="pos:83" class="id"><a name="pos:83" class="">pos</a></span> <span id="bound:84" class="id"><a name="bound:84" class="">bound</a></span> <span id="sl:85" class="id"><a name="sl:85" class="">sl</a></span> <span id="ls:86" class="id"><a name="ls:86" class="">ls</a></span> <span id="P:87" class="id"><a name="P:87" class="">P</a></span> <span id="ofs:88" class="id"><a name="ofs:88" class="">ofs</a></span> <span id="ty:89" class="id"><a name="ty:89" class="">ty</a></span> <span id="v:90" class="id"><a name="v:90" class="">v</a></span> <span id="v':91" class="id"><a name="v':91" class="">v',</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:80">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:81">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:82">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:83">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:84">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:85">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:86">ls</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:87">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:88">ofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:88">ofs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:89">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:84">bound</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:89">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#5cd21895b4d5f127eb2c0acb80e8d6fc">|</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:88">ofs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:81">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:90">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':91">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="m':92" class="id"><a name="m':92" class="">m',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:80">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:82">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:89">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos:83">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:88">ofs</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v':91">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':92">m'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':92">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:81">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:82">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:83">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:84">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:85">sl</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:85">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:88">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:89">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:90">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:86">ls</a></span>) <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:87">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">H</span> <span class="gallina-kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="id">destruct</span> <span class="id">A</span> <span class="gallina-kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span> &amp; <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_access_store">Mem.valid_access_store</a></span> <span class="gallina-kwd">as</span> <span class="id">[m'</span> <span class="id">STORE]</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#valid_access_location">valid_access_location;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">PERM:</span> <span class="id"><a href="compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m'</span> <span class="id">sp</span> <span class="id">pos</span> (<span class="id">pos</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id">bound</span>) <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">red;</span> <span class="id">intros;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">mem</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">m';</span> <span class="id">split</span>.<br/>
<span class="id">-</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack;</a></span> <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span><span class="id">,</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span><span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>. <span class="id">generalize</span> (<span class="id"><a href="compcert.backend.Locations.html#typesize_pos">typesize_pos</a></span> <span class="id">ty</span>). <span class="id">lia</span>.<br/>
<span class="id">-</span> <span class="id">simpl</span>. <span class="id">intuition</span> <span class="id">auto</span>.<br/>
<span class="id">+</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.eq">Loc.eq</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>) (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs0</span> <span class="id">ty0</span>))<span class="id">;</span> <span class="id">[|destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>) (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs0</span> <span class="id">ty0</span>))<span class="id">]</span>.<br/>
<span class="id">*</span> <span class="comment">(*&nbsp;same&nbsp;location&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">e</span>. <span class="id">rename</span> <span class="id">ofs0</span> <span class="id">into</span> <span class="id">ofs</span>. <span class="id">rename</span> <span class="id">ty0</span> <span class="id">into</span> <span class="id">ty</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id"><a href="compcert.common.Values.html#Val.load_result">Val.load_result</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>) <span class="id">v'</span>)<span class="id">;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.load_store_similar_2">Mem.load_store_similar_2</a></span><span class="id">;</span> <span class="id">eauto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.load_result_inject">Val.load_result_inject</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
<span class="id">*</span> <span class="comment">(*&nbsp;different&nbsp;locations&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H;</span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v0</span> &amp; <span class="id">X</span> &amp; <span class="id">Y</span>). <span class="gallina-kwd">exists</span> <span class="id">v0;</span> <span class="id">split;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">X;</span> <span class="id">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span><span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">d</span>. <span class="id">congruence</span>. <span class="id">right</span>. <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk,</a></span> <span class="id">!</span> <span class="id"><a href="compcert.backend.Stackingproof.html#typesize_typesize">typesize_typesize</a></span>. <span class="id">lia</span>.<br/>
<span class="id">*</span> <span class="comment">(*&nbsp;overlapping&nbsp;locations&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_access_load">Mem.valid_access_load</a></span> <span class="id">m'</span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty0</span>) <span class="id">sp</span> (<span class="id">pos</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id">ofs0</span>)) <span class="gallina-kwd">as</span> <span class="id">[v''</span> <span class="id">LOAD]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_access_implies">Mem.valid_access_implies</a></span> <span class="gallina-kwd">with</span> <span class="id"><a href="compcert.common.Memtype.html#Writable">Writable;</a></span> <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#valid_access_location">valid_access_location;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">v'';</span> <span class="id">auto</span>.<br/>
<span class="id">+</span> <span class="id">apply</span> (<span class="id"><a href="compcert.common.Separation.html#m_invar">m_invar</a></span> <span class="id">P</span>) <span class="gallina-kwd">with</span> <span class="id">m;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span><span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">i;</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#typesize_typesize">typesize_typesize</a></span>. <span class="id">intros;</span> <span class="id">red;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id">C;</span> <span class="id">eauto</span>. <span class="id">simpl</span>. <span class="id">split;</span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="initial_locations" class="id"><a name="initial_locations" class="">initial_locations:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:93" class="id"><a name="j:93" class="">j</a></span> <span id="sp:94" class="id"><a name="sp:94" class="">sp</a></span> <span id="pos:95" class="id"><a name="pos:95" class="">pos</a></span> <span id="bound:96" class="id"><a name="bound:96" class="">bound</a></span> <span id="P:97" class="id"><a name="P:97" class="">P</a></span> <span id="sl:98" class="id"><a name="sl:98" class="">sl</a></span> <span id="ls:99" class="id"><a name="ls:99" class="">ls</a></span> <span id="m:100" class="id"><a name="m:100" class="">m,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:100">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:94">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:95">pos</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos:95">pos</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:96">bound</a></span>) <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:97">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id">8</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#5cd21895b4d5f127eb2c0acb80e8d6fc">|</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:95">pos</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="ofs:101" class="id"><a name="ofs:101" class="">ofs</a></span> <span id="ty:102" class="id"><a name="ty:102" class="">ty,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:99">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:98">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:101">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:102">ty</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:100">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:93">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:94">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:95">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:96">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:98">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:99">ls</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:97">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">H</span> <span class="gallina-kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="id">destruct</span> <span class="id">A</span> <span class="gallina-kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>). <span class="id">split</span>.<br/>
<span class="id">-</span> <span class="id">simpl;</span> <span class="id">intuition</span> <span class="id">auto</span>. <span class="id">red;</span> <span class="id">intros;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_access_load">Mem.valid_access_load</a></span> <span class="id">m</span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>) <span class="id">sp</span> (<span class="id">pos</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">4</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id">ofs</span>)) <span class="gallina-kwd">as</span> <span class="id">[v</span> <span class="id">LOAD]</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#valid_access_location">valid_access_location;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">red;</span> <span class="id">intros;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">v;</span> <span class="id">split;</span> <span class="id">auto</span>. <span class="id">rewrite</span> <span class="id">H1;</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">split;</span> <span class="id">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="contains_locations_exten" class="id"><a name="contains_locations_exten" class="">contains_locations_exten:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls:103" class="id"><a name="ls:103" class="">ls</a></span> <span id="ls':104" class="id"><a name="ls':104" class="">ls'</a></span> <span id="j:105" class="id"><a name="j:105" class="">j</a></span> <span id="sp:106" class="id"><a name="sp:106" class="">sp</a></span> <span id="pos:107" class="id"><a name="pos:107" class="">pos</a></span> <span id="bound:108" class="id"><a name="bound:108" class="">bound</a></span> <span id="sl:109" class="id"><a name="sl:109" class="">sl,</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="ofs:110" class="id"><a name="ofs:110" class="">ofs</a></span> <span id="ty:111" class="id"><a name="ty:111" class="">ty,</a></span> <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls':104">ls'</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:109">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:110">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:111">ty</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:103">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:109">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:110">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:111">ty</a></span>))) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:105">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:106">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:107">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:108">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:109">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:103">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:105">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:106">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:107">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:108">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:109">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls':104">ls'</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">split;</span> <span class="id">simpl;</span> <span class="id">intros;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intuition</span> <span class="id">auto</span>. <span class="id">exploit</span> <span class="id">H5;</span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="gallina-kwd">exists</span> <span class="id">v;</span> <span class="id">split;</span> <span class="id">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">ofs</span> <span class="id">ty</span>). <span class="id">inv</span> <span class="id">H</span>. <span class="id">congruence</span>. <span class="id">auto</span>. <br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="contains_locations_incr" class="id"><a name="contains_locations_incr" class="">contains_locations_incr:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:112" class="id"><a name="j:112" class="">j</a></span> <span id="j':113" class="id"><a name="j':113" class="">j'</a></span> <span id="sp:114" class="id"><a name="sp:114" class="">sp</a></span> <span id="pos:115" class="id"><a name="pos:115" class="">pos</a></span> <span id="bound:116" class="id"><a name="bound:116" class="">bound</a></span> <span id="sl:117" class="id"><a name="sl:117" class="">sl</a></span> <span id="ls:118" class="id"><a name="ls:118" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:112">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':113">j'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:112">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:114">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:115">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:116">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:117">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:118">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':113">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:114">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:115">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound:116">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:117">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:118">ls</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">split;</span> <span class="id">simpl;</span> <span class="id">intros;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intuition</span> <span class="id">auto</span>. <span class="id">exploit</span> <span class="id">H5;</span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="gallina-kwd">exists</span> <span class="id">v;</span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">contains_callee_saves</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">rl</span> <span class="id">ls</span></span> is a memory assertion that holds
  if block <span class="bracket"><span class="id">sp</span></span>, starting at offset <span class="bracket"><span class="id">pos</span></span>, contains the values of the
  callee-save registers <span class="bracket"><span class="id">rl</span></span> as given by the location map <span class="bracket"><span class="id">ls</span></span>,
  up to the memory injection <span class="bracket"><span class="id">j</span></span>.  The memory layout of the registers in <span class="bracket"><span class="id">rl</span></span>
  is the same as that implemented by <span class="bracket"><span class="id">save_callee_save_rec</span></span>. </div>
<br/>
<span class="vernacular">Fixpoint</span> <span id="contains_callee_saves" class="id"><a name="contains_callee_saves" class="">contains_callee_saves</a></span> (<span id="j:119" class="id"><a name="j:119" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span id="sp:120" class="id"><a name="sp:120" class="">sp:</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span id="pos:121" class="id"><a name="pos:121" class="">pos:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="rl:122" class="id"><a name="rl:122" class="">rl:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) (<span id="ls:123" class="id"><a name="ls:123" class="">ls:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) <span class="id">:</span> <span class="id"><a href="compcert.common.Separation.html#massert">massert</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:122">rl</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">r</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id">rl</span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="ty:126" class="id"><a name="ty:126" class="">ty</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="sz:127" class="id"><a name="sz:127" class="">sz</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:126">ty</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="pos1:128" class="id"><a name="pos1:128" class="">pos1</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:121">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sz:127">sz</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#contains">contains</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:126">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp:120">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos1:128">pos1</a></span> (<span class="gallina-kwd">fun</span> <span id="v:129" class="id"><a name="v:129" class="">v</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:119">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:123">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">r</span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v:129">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves:124">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:119">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:120">sp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos1:128">pos1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sz:127">sz</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rl:122">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:123">ls</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="contains_callee_saves_incr" class="id"><a name="contains_callee_saves_incr" class="">contains_callee_saves_incr:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:130" class="id"><a name="j:130" class="">j</a></span> <span id="j':131" class="id"><a name="j':131" class="">j'</a></span> <span id="sp:132" class="id"><a name="sp:132" class="">sp</a></span> <span id="ls:133" class="id"><a name="ls:133" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:130">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':131">j'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="rl:134" class="id"><a name="rl:134" class="">rl</a></span> <span id="pos:135" class="id"><a name="pos:135" class="">pos,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:130">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:132">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:135">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:134">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:133">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':131">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:132">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:135">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:134">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:133">ls</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">rl</span> <span class="gallina-kwd">as</span> <span class="id">[</span> <span class="id">|</span> <span class="id">r1</span> <span class="id">rl];</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">reflexivity</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sepconj_morph_1">sepconj_morph_1;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#contains_imp">contains_imp</a></span>. <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="contains_callee_saves_exten" class="id"><a name="contains_callee_saves_exten" class="">contains_callee_saves_exten:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:136" class="id"><a name="j:136" class="">j</a></span> <span id="sp:137" class="id"><a name="sp:137" class="">sp</a></span> <span id="ls:138" class="id"><a name="ls:138" class="">ls</a></span> <span id="ls':139" class="id"><a name="ls':139" class="">ls'</a></span> <span id="rl:140" class="id"><a name="rl:140" class="">rl</a></span> <span id="pos:141" class="id"><a name="pos:141" class="">pos,</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:142" class="id"><a name="r:142" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:142">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:140">rl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls':139">ls'</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:142">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:138">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:142">r</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#massert_eqv">massert_eqv</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:136">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:137">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:141">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:140">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:138">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:136">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:137">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:141">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:140">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls':139">ls'</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">rl</span> <span class="gallina-kwd">as</span> <span class="id">[</span> <span class="id">|</span> <span class="id">r1</span> <span class="id">rl];</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">reflexivity</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sepconj_morph_2">sepconj_morph_2;</a></span> <span class="id">auto</span>. <span class="id">rewrite</span> <span class="id">H</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Separation logic assertions describing the stack frame at <span class="bracket"><span class="id">sp</span></span>.
  It must contain:
  - the values of the <span class="bracket"><span class="vernacular">Local</span></span> stack slots of <span class="bracket"><span class="id">ls</span></span>, as per <span class="bracket"><span class="id">contains_locations</span></span>
  - the values of the <span class="bracket"><span class="id">Outgoing</span></span> stack slots of <span class="bracket"><span class="id">ls</span></span>, as per <span class="bracket"><span class="id">contains_locations</span></span>
  - the <span class="bracket"><span class="id">parent</span></span> pointer representing the back link to the caller's frame
  - the <span class="bracket"><span class="id">retaddr</span></span> pointer representing the saved return address
  - the initial values of the used callee-save registers as given by <span class="bracket"><span class="id">ls0</span></span>,
    as per <span class="bracket"><span class="id">contains_callee_saves</span></span>.
In addition, we use a nonseparating conjunction to record the fact that
we have full access rights on the stack frame, except the part that
represents the Linear stack data. </div>
<br/>
<span class="vernacular">Definition</span> <span id="frame_contents_1" class="id"><a name="frame_contents_1" class="">frame_contents_1</a></span> (<span id="j:143" class="id"><a name="j:143" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span id="sp:144" class="id"><a name="sp:144" class="">sp:</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span id="ls:145" class="id"><a name="ls:145" class="">ls</a></span> <span id="ls0:146" class="id"><a name="ls0:146" class="">ls0:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) (<span id="parent:147" class="id"><a name="parent:147" class="">parent</a></span> <span id="retaddr:148" class="id"><a name="retaddr:148" class="">retaddr:</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:143">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:144">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_local">fe_ofs_local</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#bound_local">bound_local</a></span>) <span class="vernacular">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:145">ls</a></span><br/>
&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:143">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:144">sp</a></span> <span class="id"><a href="compcert.x86.Stacklayout.html#fe_ofs_arg">fe_ofs_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span>) <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:145">ls</a></span><br/>
&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.common.Separation.html#hasvalue">hasvalue</a></span> <span class="id"><a href="compcert.common.AST.html#Mptr">Mptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:144">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_link">fe_ofs_link</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#parent:147">parent</a></span><br/>
&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.common.Separation.html#hasvalue">hasvalue</a></span> <span class="id"><a href="compcert.common.AST.html#Mptr">Mptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:144">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_retaddr">fe_ofs_retaddr</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:148">retaddr</a></span><br/>
&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:143">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:144">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:146">ls0</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="frame_contents" class="id"><a name="frame_contents" class="">frame_contents</a></span> (<span id="j:149" class="id"><a name="j:149" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span id="sp:150" class="id"><a name="sp:150" class="">sp:</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span id="ls:151" class="id"><a name="ls:151" class="">ls</a></span> <span id="ls0:152" class="id"><a name="ls0:152" class="">ls0:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) (<span id="parent:153" class="id"><a name="parent:153" class="">parent</a></span> <span id="retaddr:154" class="id"><a name="retaddr:154" class="">retaddr:</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#mconj">mconj</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:149">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:150">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:151">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:152">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:153">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:154">retaddr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:150">sp</a></span> <span class="id">0</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>) <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:150">sp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span>)).<br/>
<br/>
<div class="doc">Accessing components of the frame. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="frame_get_local" class="id"><a name="frame_get_local" class="">frame_get_local:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ofs:155" class="id"><a name="ofs:155" class="">ofs</a></span> <span id="ty:156" class="id"><a name="ty:156" class="">ty</a></span> <span id="j:157" class="id"><a name="j:157" class="">j</a></span> <span id="sp:158" class="id"><a name="sp:158" class="">sp</a></span> <span id="ls:159" class="id"><a name="ls:159" class="">ls</a></span> <span id="ls0:160" class="id"><a name="ls0:160" class="">ls0</a></span> <span id="parent:161" class="id"><a name="parent:161" class="">parent</a></span> <span id="retaddr:162" class="id"><a name="retaddr:162" class="">retaddr</a></span> <span id="m:163" class="id"><a name="m:163" class="">m</a></span> <span id="P:164" class="id"><a name="P:164" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:163">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:157">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:158">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:159">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:160">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:161">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:162">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:164">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="vernacular">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:155">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:156">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="vernacular">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:155">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:156">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="v:165" class="id"><a name="v:165" class="">v,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:163">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:158">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:156">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#offset_local">offset_local</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:155">ofs</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:165">v</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:157">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:159">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="vernacular">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:155">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:156">ty</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v:165">v</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1;</a></span> <span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="gallina-kwd">in</span> <span class="id">H1;</span> <span class="id">InvBooleans</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#get_location">get_location;</a></span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="frame_get_outgoing" class="id"><a name="frame_get_outgoing" class="">frame_get_outgoing:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ofs:166" class="id"><a name="ofs:166" class="">ofs</a></span> <span id="ty:167" class="id"><a name="ty:167" class="">ty</a></span> <span id="j:168" class="id"><a name="j:168" class="">j</a></span> <span id="sp:169" class="id"><a name="sp:169" class="">sp</a></span> <span id="ls:170" class="id"><a name="ls:170" class="">ls</a></span> <span id="ls0:171" class="id"><a name="ls0:171" class="">ls0</a></span> <span id="parent:172" class="id"><a name="parent:172" class="">parent</a></span> <span id="retaddr:173" class="id"><a name="retaddr:173" class="">retaddr</a></span> <span id="m:174" class="id"><a name="m:174" class="">m</a></span> <span id="P:175" class="id"><a name="P:175" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:174">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:168">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:169">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:170">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:171">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:172">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:173">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:175">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:166">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:167">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:166">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:167">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="v:176" class="id"><a name="v:176" class="">v,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:174">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:169">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:167">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#offset_arg">offset_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:166">ofs</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:176">v</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:168">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:170">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:166">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:167">ty</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v:176">v</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1;</a></span> <span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="gallina-kwd">in</span> <span class="id">H1;</span> <span class="id">InvBooleans</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick2">sep_pick2</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#get_location">get_location;</a></span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="frame_get_parent" class="id"><a name="frame_get_parent" class="">frame_get_parent:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:177" class="id"><a name="j:177" class="">j</a></span> <span id="sp:178" class="id"><a name="sp:178" class="">sp</a></span> <span id="ls:179" class="id"><a name="ls:179" class="">ls</a></span> <span id="ls0:180" class="id"><a name="ls0:180" class="">ls0</a></span> <span id="parent:181" class="id"><a name="parent:181" class="">parent</a></span> <span id="retaddr:182" class="id"><a name="retaddr:182" class="">retaddr</a></span> <span id="m:183" class="id"><a name="m:183" class="">m</a></span> <span id="P:184" class="id"><a name="P:184" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:183">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:177">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:178">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:179">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:180">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:181">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:182">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:184">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:183">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:178">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_link">fe_ofs_link</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:181">parent</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick3">sep_pick3</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#hasvalue_get_stack">hasvalue_get_stack;</a></span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="frame_get_retaddr" class="id"><a name="frame_get_retaddr" class="">frame_get_retaddr:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:185" class="id"><a name="j:185" class="">j</a></span> <span id="sp:186" class="id"><a name="sp:186" class="">sp</a></span> <span id="ls:187" class="id"><a name="ls:187" class="">ls</a></span> <span id="ls0:188" class="id"><a name="ls0:188" class="">ls0</a></span> <span id="parent:189" class="id"><a name="parent:189" class="">parent</a></span> <span id="retaddr:190" class="id"><a name="retaddr:190" class="">retaddr</a></span> <span id="m:191" class="id"><a name="m:191" class="">m</a></span> <span id="P:192" class="id"><a name="P:192" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:191">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:185">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:186">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:187">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:188">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:189">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:190">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:192">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:191">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:186">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_retaddr">fe_ofs_retaddr</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:190">retaddr</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick4">sep_pick4</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#hasvalue_get_stack">hasvalue_get_stack;</a></span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Assigning a <span class="bracket"><span class="vernacular">Local</span></span> or <span class="bracket"><span class="id">Outgoing</span></span> stack slot. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="frame_set_local" class="id"><a name="frame_set_local" class="">frame_set_local:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ofs:193" class="id"><a name="ofs:193" class="">ofs</a></span> <span id="ty:194" class="id"><a name="ty:194" class="">ty</a></span> <span id="v:195" class="id"><a name="v:195" class="">v</a></span> <span id="v':196" class="id"><a name="v':196" class="">v'</a></span> <span id="j:197" class="id"><a name="j:197" class="">j</a></span> <span id="sp:198" class="id"><a name="sp:198" class="">sp</a></span> <span id="ls:199" class="id"><a name="ls:199" class="">ls</a></span> <span id="ls0:200" class="id"><a name="ls0:200" class="">ls0</a></span> <span id="parent:201" class="id"><a name="parent:201" class="">parent</a></span> <span id="retaddr:202" class="id"><a name="retaddr:202" class="">retaddr</a></span> <span id="m:203" class="id"><a name="m:203" class="">m</a></span> <span id="P:204" class="id"><a name="P:204" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:203">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:197">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:198">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:199">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:200">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:201">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:202">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:204">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="vernacular">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:193">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:194">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="vernacular">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:193">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:194">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:197">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:195">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':196">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="m':205" class="id"><a name="m':205" class="">m',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:203">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:198">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:194">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#offset_local">offset_local</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:193">ofs</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v':196">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':205">m'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':205">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:197">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:198">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="vernacular">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:193">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:194">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:195">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:199">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:200">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:201">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:202">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:204">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1;</a></span> <span class="id">eauto</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc;</a></span> <span class="id">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="gallina-kwd">in</span> <span class="id">H1;</span> <span class="id">InvBooleans</span>. <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#set_location">set_location;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">m'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">m';</span> <span class="id">split;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="gallina-kwd">forall</span> <span id="i:209" class="id"><span id="i:206" class="id"><a name="i:209" class="">i</a></span></span> <span id="k:210" class="id"><span id="k:207" class="id"><a name="k:210" class="">k</a></span></span> <span id="p:211" class="id"><span id="p:208" class="id"><a name="p:211" class="">p,</a></span></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span> <span class="id">sp</span> <span class="id"><a href="compcert.backend.Stackingproof.html#i:206">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:207">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:208">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m'</span> <span class="id">sp</span> <span class="id"><a href="compcert.backend.Stackingproof.html#i:206">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:207">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:208">p</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span>  <span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="gallina-kwd">in</span> <span class="id">A;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">A</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span><span class="id">;</span> <span class="id">eauto</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#frame_mconj">frame_mconj</a></span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1;</a></span> <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc;</a></span> <span class="id">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_preserved">sep_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved;</a></span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="frame_set_outgoing" class="id"><a name="frame_set_outgoing" class="">frame_set_outgoing:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ofs:212" class="id"><a name="ofs:212" class="">ofs</a></span> <span id="ty:213" class="id"><a name="ty:213" class="">ty</a></span> <span id="v:214" class="id"><a name="v:214" class="">v</a></span> <span id="v':215" class="id"><a name="v':215" class="">v'</a></span> <span id="j:216" class="id"><a name="j:216" class="">j</a></span> <span id="sp:217" class="id"><a name="sp:217" class="">sp</a></span> <span id="ls:218" class="id"><a name="ls:218" class="">ls</a></span> <span id="ls0:219" class="id"><a name="ls0:219" class="">ls0</a></span> <span id="parent:220" class="id"><a name="parent:220" class="">parent</a></span> <span id="retaddr:221" class="id"><a name="retaddr:221" class="">retaddr</a></span> <span id="m:222" class="id"><a name="m:222" class="">m</a></span> <span id="P:223" class="id"><a name="P:223" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:222">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:216">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:217">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:218">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:219">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:220">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:221">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:223">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:212">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:213">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:212">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:213">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:216">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:214">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':215">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="m':224" class="id"><a name="m':224" class="">m',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:222">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:217">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:213">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#offset_arg">offset_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:212">ofs</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v':215">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':224">m'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':224">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:216">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:217">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:212">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:213">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:214">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:218">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:219">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:220">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:221">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:223">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1;</a></span> <span class="id">eauto</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="id">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="gallina-kwd">in</span> <span class="id">H1;</span> <span class="id">InvBooleans</span>. <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#set_location">set_location;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">m'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">m';</span> <span class="id">split;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="gallina-kwd">forall</span> <span id="i:228" class="id"><span id="i:225" class="id"><a name="i:228" class="">i</a></span></span> <span id="k:229" class="id"><span id="k:226" class="id"><a name="k:229" class="">k</a></span></span> <span id="p:230" class="id"><span id="p:227" class="id"><a name="p:230" class="">p,</a></span></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span> <span class="id">sp</span> <span class="id"><a href="compcert.backend.Stackingproof.html#i:225">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:226">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:227">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m'</span> <span class="id">sp</span> <span class="id"><a href="compcert.backend.Stackingproof.html#i:225">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:226">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:227">p</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span>  <span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="gallina-kwd">in</span> <span class="id">A;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">A</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span><span class="id">;</span> <span class="id">eauto</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#frame_mconj">frame_mconj</a></span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1;</a></span> <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_preserved">sep_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved;</a></span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance by change of location maps. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="frame_contents_exten" class="id"><a name="frame_contents_exten" class="">frame_contents_exten:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls:231" class="id"><a name="ls:231" class="">ls</a></span> <span id="ls0:232" class="id"><a name="ls0:232" class="">ls0</a></span> <span id="ls':233" class="id"><a name="ls':233" class="">ls'</a></span> <span id="ls0':234" class="id"><a name="ls0':234" class="">ls0'</a></span> <span id="j:235" class="id"><a name="j:235" class="">j</a></span> <span id="sp:236" class="id"><a name="sp:236" class="">sp</a></span> <span id="parent:237" class="id"><a name="parent:237" class="">parent</a></span> <span id="retaddr:238" class="id"><a name="retaddr:238" class="">retaddr</a></span> <span id="P:239" class="id"><a name="P:239" class="">P</a></span> <span id="m:240" class="id"><a name="m:240" class="">m,</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="ofs:241" class="id"><a name="ofs:241" class="">ofs</a></span> <span id="ty:242" class="id"><a name="ty:242" class="">ty,</a></span> <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls':233">ls'</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="vernacular">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:241">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:242">ty</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:231">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="vernacular">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:241">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:242">ty</a></span>))) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="ofs:243" class="id"><a name="ofs:243" class="">ofs</a></span> <span id="ty:244" class="id"><a name="ty:244" class="">ty,</a></span> <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls':233">ls'</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:243">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:244">ty</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:231">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:243">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:244">ty</a></span>))) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:245" class="id"><a name="r:245" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:245">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0':234">ls0'</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:245">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:232">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:245">r</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:240">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:235">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:236">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:231">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:232">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:237">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:238">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:239">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:240">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:235">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:236">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls':233">ls'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0':234">ls0'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:237">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:238">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:239">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">!</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations_exten">contains_locations_exten</a></span> <span class="id">ls</span> <span class="id">ls'</span>) <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span>  <span class="id">&lt;-</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves_exten">contains_callee_saves_exten</a></span> <span class="gallina-kwd">by</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">assumption</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance by assignment to registers. </div>
<br/>
<span class="vernacular">Corollary</span> <span id="frame_set_reg" class="id"><a name="frame_set_reg" class="">frame_set_reg:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="r:246" class="id"><a name="r:246" class="">r</a></span> <span id="v:247" class="id"><a name="v:247" class="">v</a></span> <span id="j:248" class="id"><a name="j:248" class="">j</a></span> <span id="sp:249" class="id"><a name="sp:249" class="">sp</a></span> <span id="ls:250" class="id"><a name="ls:250" class="">ls</a></span> <span id="ls0:251" class="id"><a name="ls0:251" class="">ls0</a></span> <span id="parent:252" class="id"><a name="parent:252" class="">parent</a></span> <span id="retaddr:253" class="id"><a name="retaddr:253" class="">retaddr</a></span> <span id="m:254" class="id"><a name="m:254" class="">m</a></span> <span id="P:255" class="id"><a name="P:255" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:254">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:248">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:249">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:250">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:251">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:252">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:253">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:255">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:254">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:248">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:249">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:246">r</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:247">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:250">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:251">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:252">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:253">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:255">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_exten">frame_contents_exten</a></span> <span class="gallina-kwd">with</span> <span class="id">ls</span> <span class="id">ls0;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Corollary</span> <span id="frame_undef_regs" class="id"><a name="frame_undef_regs" class="">frame_undef_regs:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:256" class="id"><a name="j:256" class="">j</a></span> <span id="sp:257" class="id"><a name="sp:257" class="">sp</a></span> <span id="ls:258" class="id"><a name="ls:258" class="">ls</a></span> <span id="ls0:259" class="id"><a name="ls0:259" class="">ls0</a></span> <span id="parent:260" class="id"><a name="parent:260" class="">parent</a></span> <span id="retaddr:261" class="id"><a name="retaddr:261" class="">retaddr</a></span> <span id="m:262" class="id"><a name="m:262" class="">m</a></span> <span id="P:263" class="id"><a name="P:263" class="">P</a></span> <span id="rl:264" class="id"><a name="rl:264" class="">rl,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:262">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:256">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:257">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:258">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:259">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:260">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:261">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:263">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:262">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:256">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:257">sp</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:264">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:258">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:259">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:260">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:261">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:263">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="vernacular">Local</span> <span class="vernacular">Opaque</span> <span class="id"><a href="compcert.common.Separation.html#sepconj">sepconj</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">rl;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg;</a></span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Corollary</span> <span id="frame_set_regpair" class="id"><a name="frame_set_regpair" class="">frame_set_regpair:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:265" class="id"><a name="j:265" class="">j</a></span> <span id="sp:266" class="id"><a name="sp:266" class="">sp</a></span> <span id="ls0:267" class="id"><a name="ls0:267" class="">ls0</a></span> <span id="parent:268" class="id"><a name="parent:268" class="">parent</a></span> <span id="retaddr:269" class="id"><a name="retaddr:269" class="">retaddr</a></span> <span id="m:270" class="id"><a name="m:270" class="">m</a></span> <span id="P:271" class="id"><a name="P:271" class="">P</a></span> <span id="p:272" class="id"><a name="p:272" class="">p</a></span> <span id="v:273" class="id"><a name="v:273" class="">v</a></span> <span id="ls:274" class="id"><a name="ls:274" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:270">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:265">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:266">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:274">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:267">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:268">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:269">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:271">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:270">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:265">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:266">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:272">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:273">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:274">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:267">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:268">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:269">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:271">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">p;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg;</a></span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg;</a></span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Corollary</span> <span id="frame_set_res" class="id"><a name="frame_set_res" class="">frame_set_res:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:275" class="id"><a name="j:275" class="">j</a></span> <span id="sp:276" class="id"><a name="sp:276" class="">sp</a></span> <span id="ls0:277" class="id"><a name="ls0:277" class="">ls0</a></span> <span id="parent:278" class="id"><a name="parent:278" class="">parent</a></span> <span id="retaddr:279" class="id"><a name="retaddr:279" class="">retaddr</a></span> <span id="m:280" class="id"><a name="m:280" class="">m</a></span> <span id="P:281" class="id"><a name="P:281" class="">P</a></span> <span id="res:282" class="id"><a name="res:282" class="">res</a></span> <span id="v:283" class="id"><a name="v:283" class="">v</a></span> <span id="ls:284" class="id"><a name="ls:284" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:280">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:275">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:276">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:284">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:277">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:278">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:279">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:281">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:280">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:275">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:276">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res:282">res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:283">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:284">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:277">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:278">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:279">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:281">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">res;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg;</a></span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance by change of memory injection. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="frame_contents_incr" class="id"><a name="frame_contents_incr" class="">frame_contents_incr:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:285" class="id"><a name="j:285" class="">j</a></span> <span id="sp:286" class="id"><a name="sp:286" class="">sp</a></span> <span id="ls:287" class="id"><a name="ls:287" class="">ls</a></span> <span id="ls0:288" class="id"><a name="ls0:288" class="">ls0</a></span> <span id="parent:289" class="id"><a name="parent:289" class="">parent</a></span> <span id="retaddr:290" class="id"><a name="retaddr:290" class="">retaddr</a></span> <span id="m:291" class="id"><a name="m:291" class="">m</a></span> <span id="P:292" class="id"><a name="P:292" class="">P</a></span> <span id="j':293" class="id"><a name="j':293" class="">j',</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:291">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:285">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:286">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:287">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:288">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:289">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:290">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:292">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:285">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':293">j'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:291">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':293">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:286">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:287">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:288">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:289">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr:290">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:292">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations_incr">contains_locations_incr</a></span> <span class="id">j</span> <span class="id">j'</span>) <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations_incr">contains_locations_incr</a></span> <span class="id">j</span> <span class="id">j'</span>) <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span>  <span class="id">&lt;-</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves_incr">contains_callee_saves_incr</a></span> <span class="gallina-kwd">by</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">assumption</span>.<br/>
Qed.</div>
<br/>
<h1> Agreement between location sets and Mach states </h1>
<br/>
<div class="doc">Agreement with Mach register states </div>
<br/>
<span class="vernacular">Definition</span> <span id="agree_regs" class="id"><a name="agree_regs" class="">agree_regs</a></span> (<span id="j:294" class="id"><a name="j:294" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span id="ls:295" class="id"><a name="ls:295" class="">ls:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) (<span id="rs:296" class="id"><a name="rs:296" class="">rs:</a></span> <span class="id"><a href="compcert.backend.Mach.html#regset">regset</a></span>) <span class="id">:</span> <span class="gallina-kwd">Prop</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="r:297" class="id"><a name="r:297" class="">r,</a></span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:294">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:295">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:297">r</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs:296">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:297">r</a></span>).<br/>
<br/>
<div class="doc">Agreement over locations </div>
<br/>
<span class="vernacular">Record</span> <span id="agree_locs" class="id"><a name="agree_locs" class="">agree_locs</a></span> (<span id="ls:298" class="id"><a name="ls:298" class="">ls</a></span> <span id="ls0:299" class="id"><a name="ls0:299" class="">ls0:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) <span class="id">:</span> <span class="gallina-kwd">Prop</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">mk_agree_locs</span> <span class="id">{</span><br/>
<br/>
<div class="doc">Unused registers have the same value as in the caller </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span id="agree_unused_reg" class="id"><a name="agree_unused_reg" class="">agree_unused_reg:</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="r:301" class="id"><a name="r:301" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181">~</a></span>(<span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:301">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:298">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:301">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:299">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:301">r</a></span>)<span class="id">;</span><br/>
<br/>
<div class="doc">Incoming stack slots have the same value as the
        corresponding Outgoing stack slots in the caller </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span id="agree_incoming" class="id"><a name="agree_incoming" class="">agree_incoming:</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ofs:303" class="id"><a name="ofs:303" class="">ofs</a></span> <span id="ty:304" class="id"><a name="ty:304" class="">ty,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Incoming">Incoming</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:303">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:304">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="compcert.backend.Conventions.html#loc_parameters">loc_parameters</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span>))) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#ls:298">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Incoming">Incoming</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:303">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:304">ty</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:299">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:303">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:304">ty</a></span>)<br/>
<span class="id">}</span>.<br/>
<br/>
<h2> Properties of <span class="bracket"><span class="id">agree_regs</span></span>. </h2>
<br/>
<div class="doc">Values of registers </div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_reg" class="id"><a name="agree_reg" class="">agree_reg:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:306" class="id"><a name="j:306" class="">j</a></span> <span id="ls:307" class="id"><a name="ls:307" class="">ls</a></span> <span id="rs:308" class="id"><a name="rs:308" class="">rs</a></span> <span id="r:309" class="id"><a name="r:309" class="">r,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:306">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:307">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:308">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:306">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:307">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:309">r</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs:308">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:309">r</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_reglist" class="id"><a name="agree_reglist" class="">agree_reglist:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:310" class="id"><a name="j:310" class="">j</a></span> <span id="ls:311" class="id"><a name="ls:311" class="">ls</a></span> <span id="rs:312" class="id"><a name="rs:312" class="">rs</a></span> <span id="rl:313" class="id"><a name="rl:313" class="">rl,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:310">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:311">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:312">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:310">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#reglist">reglist</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:311">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:313">rl</a></span>) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs:312">rs##rl</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">rl;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>. <span class="id">constructor;</span> <span class="id">auto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reg">agree_reg</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Hint</span> <span class="id">Resolve</span> <span class="id">agree_reg</span> <span class="id">agree_reglist:</span> <span class="id">stacking</span>.<br/>
<br/>
<div class="doc">Preservation under assignments of machine registers. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_regs_set_reg" class="id"><a name="agree_regs_set_reg" class="">agree_regs_set_reg:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:314" class="id"><a name="j:314" class="">j</a></span> <span id="ls:315" class="id"><a name="ls:315" class="">ls</a></span> <span id="rs:316" class="id"><a name="rs:316" class="">rs</a></span> <span id="r:317" class="id"><a name="r:317" class="">r</a></span> <span id="v:318" class="id"><a name="v:318" class="">v</a></span> <span id="v':319" class="id"><a name="v':319" class="">v',</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:314">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:315">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:316">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:314">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:318">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':319">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:314">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:317">r</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:318">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:315">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#Regmap.set">Regmap.set</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:317">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':319">v'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:316">rs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">red;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#Regmap.set">Regmap.set</a></span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Mach.html#RegEq.eq">RegEq.eq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="id">subst</span> <span class="id">r0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gss">Locmap.gss</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span><span class="id">;</span> <span class="id">auto</span>. <span class="id">red</span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_regs_set_pair" class="id"><a name="agree_regs_set_pair" class="">agree_regs_set_pair:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:320" class="id"><a name="j:320" class="">j</a></span> <span id="p:321" class="id"><a name="p:321" class="">p</a></span> <span id="v:322" class="id"><a name="v:322" class="">v</a></span> <span id="v':323" class="id"><a name="v':323" class="">v'</a></span> <span id="ls:324" class="id"><a name="ls:324" class="">ls</a></span> <span id="rs:325" class="id"><a name="rs:325" class="">rs,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:320">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:324">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:325">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:320">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:322">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':323">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:320">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:321">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:322">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:324">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#set_pair">set_pair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:321">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':323">v'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:325">rs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">p;</span> <span class="id">simpl</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg;</a></span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.hiword_inject">Val.hiword_inject</a></span><span class="id">;</span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.loword_inject">Val.loword_inject</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_regs_set_res" class="id"><a name="agree_regs_set_res" class="">agree_regs_set_res:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:326" class="id"><a name="j:326" class="">j</a></span> <span id="res:327" class="id"><a name="res:327" class="">res</a></span> <span id="v:328" class="id"><a name="v:328" class="">v</a></span> <span id="v':329" class="id"><a name="v':329" class="">v'</a></span> <span id="ls:330" class="id"><a name="ls:330" class="">ls</a></span> <span id="rs:331" class="id"><a name="rs:331" class="">rs,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:326">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:330">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:331">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:326">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:328">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':329">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:326">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res:327">res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:328">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:330">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#set_res">set_res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res:327">res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':329">v'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:331">rs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">res;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg;</a></span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id">IHres2</span>. <span class="id">apply</span> <span class="id">IHres1</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.hiword_inject">Val.hiword_inject</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.loword_inject">Val.loword_inject</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_regs_exten" class="id"><a name="agree_regs_exten" class="">agree_regs_exten:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:332" class="id"><a name="j:332" class="">j</a></span> <span id="ls:333" class="id"><a name="ls:333" class="">ls</a></span> <span id="rs:334" class="id"><a name="rs:334" class="">rs</a></span> <span id="ls':335" class="id"><a name="ls':335" class="">ls'</a></span> <span id="rs':336" class="id"><a name="rs':336" class="">rs',</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:332">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:333">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:334">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:337" class="id"><a name="r:337" class="">r,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls':335">ls'</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:337">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls':335">ls'</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:337">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:333">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:337">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':336">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:337">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:334">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:337">r</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:332">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls':335">ls'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':336">rs'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">red;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">H0</span> <span class="id">r</span>) <span class="gallina-kwd">as</span> <span class="id">[A</span> <span class="id">|</span> <span class="id">[A</span> <span class="id">B]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">A</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">A;</span> <span class="id">rewrite</span> <span class="id">B;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_regs_undef_regs" class="id"><a name="agree_regs_undef_regs" class="">agree_regs_undef_regs:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:338" class="id"><a name="j:338" class="">j</a></span> <span id="rl:339" class="id"><a name="rl:339" class="">rl</a></span> <span id="ls:340" class="id"><a name="ls:340" class="">ls</a></span> <span id="rs:341" class="id"><a name="rs:341" class="">rs,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:338">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:340">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:341">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:338">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:339">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:340">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#undef_regs">Mach.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:339">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:341">rs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">rl;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg;</a></span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_regs_undef_caller_save_regs" class="id"><a name="agree_regs_undef_caller_save_regs" class="">agree_regs_undef_caller_save_regs:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:342" class="id"><a name="j:342" class="">j</a></span> <span id="ls:343" class="id"><a name="ls:343" class="">ls</a></span> <span id="rs:344" class="id"><a name="rs:344" class="">rs,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:342">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:343">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:344">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:342">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">LTL.undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:343">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#undef_caller_save_regs">Mach.undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:344">rs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">red;</span> <span class="id">intros</span>. <br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">LTL.undef_caller_save_regs</a></span><span class="id">,</span> <span class="id"><a href="compcert.backend.Mach.html#undef_caller_save_regs">Mach.undef_caller_save_regs</a></span>. <br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>)<span class="id">;</span> <span class="id">auto</span>. <br/>
Qed.</div>
<br/>
<div class="doc">Preservation under assignment of stack slot </div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_regs_set_slot" class="id"><a name="agree_regs_set_slot" class="">agree_regs_set_slot:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:345" class="id"><a name="j:345" class="">j</a></span> <span id="ls:346" class="id"><a name="ls:346" class="">ls</a></span> <span id="rs:347" class="id"><a name="rs:347" class="">rs</a></span> <span id="sl:348" class="id"><a name="sl:348" class="">sl</a></span> <span id="ofs:349" class="id"><a name="ofs:349" class="">ofs</a></span> <span id="ty:350" class="id"><a name="ty:350" class="">ty</a></span> <span id="v:351" class="id"><a name="v:351" class="">v,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:345">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:346">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:347">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:345">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:348">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:349">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:350">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:351">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:346">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs:347">rs</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">red;</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span><span class="id">;</span> <span class="id">auto</span>. <span class="id">red</span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by increasing memory injections </div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_regs_inject_incr" class="id"><a name="agree_regs_inject_incr" class="">agree_regs_inject_incr:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:352" class="id"><a name="j:352" class="">j</a></span> <span id="ls:353" class="id"><a name="ls:353" class="">ls</a></span> <span id="rs:354" class="id"><a name="rs:354" class="">rs</a></span> <span id="j':355" class="id"><a name="j':355" class="">j',</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:352">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:353">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:354">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:352">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':355">j'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':355">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:353">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:354">rs</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">red;</span> <span class="id">intros;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">stacking</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation at function entry. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_regs_call_regs" class="id"><a name="agree_regs_call_regs" class="">agree_regs_call_regs:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:356" class="id"><a name="j:356" class="">j</a></span> <span id="ls:357" class="id"><a name="ls:357" class="">ls</a></span> <span id="rs:358" class="id"><a name="rs:358" class="">rs,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:356">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:357">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:358">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:356">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:357">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs:358">rs</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs;</a></span> <span class="id">intros;</span> <span class="id">red;</span> <span class="id">intros;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of <span class="bracket"><span class="id">agree_locs</span></span> </h2>
<br/>
<div class="doc">Preservation under assignment of machine register. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_locs_set_reg" class="id"><a name="agree_locs_set_reg" class="">agree_locs_set_reg:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls:359" class="id"><a name="ls:359" class="">ls</a></span> <span id="ls0:360" class="id"><a name="ls0:360" class="">ls0</a></span> <span id="r:361" class="id"><a name="r:361" class="">r</a></span> <span id="v:362" class="id"><a name="v:362" class="">v,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:359">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:360">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:361">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:361">r</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:362">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:359">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:360">ls0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">inv</span> <span class="id">H;</span> <span class="id">constructor;</span> <span class="id">auto;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>. <span class="id">auto</span>. <span class="id">red</span>. <span class="id">intuition</span> <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="caller_save_reg_within_bounds" class="id"><a name="caller_save_reg_within_bounds" class="">caller_save_reg_within_bounds:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="r:363" class="id"><a name="r:363" class="">r,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:363">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:363">r</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">red;</span> <span class="id">intros</span>. <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_locs_set_pair" class="id"><a name="agree_locs_set_pair" class="">agree_locs_set_pair:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls0:364" class="id"><a name="ls0:364" class="">ls0</a></span> <span id="p:365" class="id"><a name="p:365" class="">p</a></span> <span id="v:366" class="id"><a name="v:366" class="">v</a></span> <span id="ls:367" class="id"><a name="ls:367" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:367">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:364">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.AST.html#forall_rpair">forall_rpair</a></span> (<span class="gallina-kwd">fun</span> <span id="r:368" class="id"><a name="r:368" class="">r</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:368">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#p:365">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:365">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:366">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:367">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:364">ls0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">p;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds;</a></span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_locs_set_res" class="id"><a name="agree_locs_set_res" class="">agree_locs_set_res:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls0:369" class="id"><a name="ls0:369" class="">ls0</a></span> <span id="res:370" class="id"><a name="res:370" class="">res</a></span> <span id="v:371" class="id"><a name="v:371" class="">v</a></span> <span id="ls:372" class="id"><a name="ls:372" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:372">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:369">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:373" class="id"><a name="r:373" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:373">r</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_res">params_of_builtin_res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res:370">res</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:373">r</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res:370">res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:371">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:372">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:369">ls0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">res;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg;</a></span> <span class="id">eauto</span>.<br/>
<span class="id">-</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id">IHres2;</span> <span class="id">auto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_locs_undef_regs" class="id"><a name="agree_locs_undef_regs" class="">agree_locs_undef_regs:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls0:374" class="id"><a name="ls0:374" class="">ls0</a></span> <span id="regs:375" class="id"><a name="regs:375" class="">regs</a></span> <span id="ls:376" class="id"><a name="ls:376" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:376">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:374">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:377" class="id"><a name="r:377" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:377">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs:375">regs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:377">r</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs:375">regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:376">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:374">ls0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">regs;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg;</a></span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_locs_undef_locs_1" class="id"><a name="agree_locs_undef_locs_1" class="">agree_locs_undef_locs_1:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls0:378" class="id"><a name="ls0:378" class="">ls0</a></span> <span id="regs:379" class="id"><a name="regs:379" class="">regs</a></span> <span id="ls:380" class="id"><a name="ls:380" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:380">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:378">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:381" class="id"><a name="r:381" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:381">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs:379">regs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:381">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs:379">regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:380">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:378">ls0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_regs">agree_locs_undef_regs;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_locs_undef_locs" class="id"><a name="agree_locs_undef_locs" class="">agree_locs_undef_locs:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls0:382" class="id"><a name="ls0:382" class="">ls0</a></span> <span id="regs:383" class="id"><a name="regs:383" class="">regs</a></span> <span id="ls:384" class="id"><a name="ls:384" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:384">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:382">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs:383">regs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs:383">regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:384">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:382">ls0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs_1">agree_locs_undef_locs_1;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>) <span class="id">eqn:CS;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">regs</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#existsb_exists">existsb_exists</a></span>. <span class="gallina-kwd">exists</span> <span class="id">r;</span> <span class="id">auto</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by assignment to local slot </div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_locs_set_slot" class="id"><a name="agree_locs_set_slot" class="">agree_locs_set_slot:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls:385" class="id"><a name="ls:385" class="">ls</a></span> <span id="ls0:386" class="id"><a name="ls0:386" class="">ls0</a></span> <span id="sl:387" class="id"><a name="sl:387" class="">sl</a></span> <span id="ofs:388" class="id"><a name="ofs:388" class="">ofs</a></span> <span id="ty:389" class="id"><a name="ty:389" class="">ty</a></span> <span id="v:390" class="id"><a name="v:390" class="">v,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:385">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:386">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Lineartyping.html#slot_writable">slot_writable</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:387">sl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:387">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:388">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:389">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:390">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:385">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:386">ls0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">H;</span> <span class="id">constructor;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span><span class="id">;</span> <span class="id">auto</span>. <span class="id">red;</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span><span class="id">;</span> <span class="id">auto</span>. <span class="id">red</span>. <span class="id">left</span>. <span class="id">destruct</span> <span class="id">sl;</span> <span class="id">discriminate</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation at return points (when <span class="bracket"><span class="id">ls</span></span> is changed but not <span class="bracket"><span class="id">ls0</span></span>). </div>
<br/>
<span class="vernacular">Lemma</span> <span id="agree_locs_return" class="id"><a name="agree_locs_return" class="">agree_locs_return:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ls:391" class="id"><a name="ls:391" class="">ls</a></span> <span id="ls0:392" class="id"><a name="ls0:392" class="">ls0</a></span> <span id="ls':393" class="id"><a name="ls':393" class="">ls',</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:391">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:392">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls':393">ls'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:391">ls</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls':393">ls'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:392">ls0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">red</span> <span class="gallina-kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H;</span> <span class="id">constructor;</span> <span class="id">auto;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">H0;</span> <span class="id">auto</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">tauto</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">agree_incoming0</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id">H0</span>. <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of destroyed registers. </h2>
<br/>
<span class="vernacular">Definition</span> <span id="no_callee_saves" class="id"><a name="no_callee_saves" class="">no_callee_saves</a></span> (<span id="l:394" class="id"><a name="l:394" class="">l:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) <span class="id">:</span> <span class="gallina-kwd">Prop</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:394">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
<span class="vernacular">Ltac</span> <span class="id">ByCases</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">reflexivity</span> <span class="id">||</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id">goal</span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">|-</span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="gallina-kwd">match</span> <span class="id">?x</span> <span class="gallina-kwd">with</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">_</span> <span class="gallina-kwd">end</span>) <span class="id">=&gt;</span> <span class="id">destruct</span> <span class="id">x;</span> <span class="id">ByCases</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Remark</span> <span id="destroyed_by_op_caller_save" class="id"><a name="destroyed_by_op_caller_save" class="">destroyed_by_op_caller_save:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="op:395" class="id"><a name="op:395" class="">op,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_op">destroyed_by_op</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#op:395">op</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
<span class="vernacular">Local</span> <span class="vernacular">Transparent</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_op">destroyed_by_op</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_op">destroyed_by_op;</a></span> <span class="id">ByCases</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="destroyed_by_load_caller_save" class="id"><a name="destroyed_by_load_caller_save" class="">destroyed_by_load_caller_save:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="chunk:396" class="id"><a name="chunk:396" class="">chunk</a></span> <span id="addr:397" class="id"><a name="addr:397" class="">addr,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_load">destroyed_by_load</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk:396">chunk</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr:397">addr</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
<span class="vernacular">Local</span> <span class="vernacular">Transparent</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_load">destroyed_by_load</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_load">destroyed_by_load;</a></span> <span class="id">ByCases</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="destroyed_by_store_caller_save" class="id"><a name="destroyed_by_store_caller_save" class="">destroyed_by_store_caller_save:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="chunk:398" class="id"><a name="chunk:398" class="">chunk</a></span> <span id="addr:399" class="id"><a name="addr:399" class="">addr,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk:398">chunk</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr:399">addr</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
<span class="vernacular">Local</span> <span class="vernacular">Transparent</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store;</a></span> <span class="id">ByCases</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="destroyed_by_cond_caller_save" class="id"><a name="destroyed_by_cond_caller_save" class="">destroyed_by_cond_caller_save:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="cond:400" class="id"><a name="cond:400" class="">cond,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_cond">destroyed_by_cond</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cond:400">cond</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
<span class="vernacular">Local</span> <span class="vernacular">Transparent</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_cond">destroyed_by_cond</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_cond">destroyed_by_cond;</a></span> <span class="id">ByCases</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="destroyed_by_jumptable_caller_save" class="id"><a name="destroyed_by_jumptable_caller_save" class="">destroyed_by_jumptable_caller_save:</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_jumptable">destroyed_by_jumptable</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
&nbsp;&nbsp;<span class="id">red;</span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="destroyed_by_setstack_caller_save" class="id"><a name="destroyed_by_setstack_caller_save" class="">destroyed_by_setstack_caller_save:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ty:401" class="id"><a name="ty:401" class="">ty,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:401">ty</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves;</a></span> <span class="id">destruct</span> <span class="id">ty;</span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="destroyed_at_function_entry_caller_save" class="id"><a name="destroyed_at_function_entry_caller_save" class="">destroyed_at_function_entry_caller_save:</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;<span class="id">red;</span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Hint</span> <span class="id">Resolve</span> <span class="id">destroyed_by_op_caller_save</span> <span class="id">destroyed_by_load_caller_save</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destroyed_by_store_caller_save</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destroyed_by_cond_caller_save</span> <span class="id">destroyed_by_jumptable_caller_save</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destroyed_at_function_entry_caller_save:</span> <span class="id">stacking</span>.<br/>
<br/>
<span class="vernacular">Remark</span> <span id="destroyed_by_setstack_function_entry" class="id"><a name="destroyed_by_setstack_function_entry" class="">destroyed_by_setstack_function_entry:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ty:402" class="id"><a name="ty:402" class="">ty,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:402">ty</a></span>) <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
<span class="vernacular">Local</span> <span class="vernacular">Transparent</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl;</a></span> <span class="id">destruct</span> <span class="id">ty;</span> <span class="id">simpl;</span> <span class="id">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="transl_destroyed_by_op" class="id"><a name="transl_destroyed_by_op" class="">transl_destroyed_by_op:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="op:403" class="id"><a name="op:403" class="">op</a></span> <span id="e:404" class="id"><a name="e:404" class="">e,</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_op">destroyed_by_op</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_op">transl_op</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#e:404">e</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#op:403">op</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_op">destroyed_by_op</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#op:403">op</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">destruct</span> <span class="id">op;</span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="transl_destroyed_by_load" class="id"><a name="transl_destroyed_by_load" class="">transl_destroyed_by_load:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="chunk:405" class="id"><a name="chunk:405" class="">chunk</a></span> <span id="addr:406" class="id"><a name="addr:406" class="">addr</a></span> <span id="e:407" class="id"><a name="e:407" class="">e,</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_load">destroyed_by_load</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk:405">chunk</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_addr">transl_addr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#e:407">e</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr:406">addr</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_load">destroyed_by_load</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk:405">chunk</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr:406">addr</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">destruct</span> <span class="id">chunk;</span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="transl_destroyed_by_store" class="id"><a name="transl_destroyed_by_store" class="">transl_destroyed_by_store:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="chunk:408" class="id"><a name="chunk:408" class="">chunk</a></span> <span id="addr:409" class="id"><a name="addr:409" class="">addr</a></span> <span id="e:410" class="id"><a name="e:410" class="">e,</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk:408">chunk</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_addr">transl_addr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#e:410">e</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr:409">addr</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk:408">chunk</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr:409">addr</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">destruct</span> <span class="id">chunk;</span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<h1> Correctness of saving and restoring of callee-save registers </h1>
<br/>
<div class="doc">The following lemmas show the correctness of the register saving
  code generated by <span class="bracket"><span class="id">save_callee_save</span></span>: after this code has executed,
  the register save areas of the current frame do contain the
  values of the callee-save registers used by the function. </div>
<br/>
<span class="vernacular">Section</span> <span id="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE" class="">SAVE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs" class="">cs:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">stackframe</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb" class="">fb:</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp" class="">sp:</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls" class="">ls:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls_temp_undef" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls_temp_undef" class="">ls_temp_undef:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ty:416" class="id"><a name="ty:416" class="">ty</a></span> <span id="r:417" class="id"><a name="r:417" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:417">r</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:416">ty</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:417">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.wt_ls" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.wt_ls" class="">wt_ls:</a></span> <span class="gallina-kwd">forall</span> <span id="r:419" class="id"><a name="r:419" class="">r,</a></span> <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:419">r</a></span>)) (<span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:419">r</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="save_callee_save_rec_correct" class="id"><a name="save_callee_save_rec_correct" class="">save_callee_save_rec_correct:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="k:421" class="id"><a name="k:421" class="">k</a></span> <span id="l:422" class="id"><a name="l:422" class="">l</a></span> <span id="pos:423" class="id"><a name="pos:423" class="">pos</a></span> <span id="rs:424" class="id"><a name="rs:424" class="">rs</a></span> <span id="m:425" class="id"><a name="m:425" class="">m</a></span> <span id="P:426" class="id"><a name="P:426" class="">P,</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:427" class="id"><a name="r:427" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:427">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:422">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:427">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:425">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:423">pos</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec">size_callee_save_area_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:422">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:423">pos</a></span>) <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:426">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:424">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="rs':428" class="id"><a name="rs':428" class="">rs',</a></span> <span class="gallina-kwd">exists</span> <span id="m':429" class="id"><a name="m':429" class="">m',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save_rec">save_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:422">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:423">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:421">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs:424">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:425">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k:421">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':428">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':429">m'</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':429">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos:423">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:422">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:426">P</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> (<span class="gallina-kwd">forall</span> <span id="ofs:430" class="id"><a name="ofs:430" class="">ofs</a></span> <span id="k:431" class="id"><a name="k:431" class="">k</a></span> <span id="p:432" class="id"><a name="p:432" class="">p,</a></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:425">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:430">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:431">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:432">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':429">m'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:430">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:431">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:432">p</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':428">rs'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
<span class="vernacular">Local</span> <span class="vernacular">Opaque</span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="gallina-kwd">as</span> <span class="id">[</span> <span class="id">|</span> <span class="id">r</span> <span class="id">l];</span> <span class="id">simpl;</span> <span class="id">intros</span> <span class="id">until</span> <span class="id">P;</span> <span class="id">intros</span> <span class="id">CS</span> <span class="id">SEP</span> <span class="id">AG</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">exists</span> <span class="id">rs,</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_pure">sep_pure;</a></span> <span class="id">split;</span> <span class="id">auto</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_drop">sep_drop;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">set</span> (<span class="id">ty</span> <span class="id">:=</span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">sz</span> <span class="id">:=</span> <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id">ty</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">pos1</span> <span class="id">:=</span> <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id">pos</span> <span class="id">sz</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">SZPOS:</span> <span class="id">sz</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&gt;'_x">&gt;</a></span> <span class="id">0</span>) <span class="gallina-kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="compcert.common.AST.html#typesize_pos">AST.typesize_pos</a></span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">SZREC:</span> <span class="id">pos1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">sz</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec">size_callee_save_area_rec</a></span> <span class="id">l</span> (<span class="id">pos1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">sz</span>)) <span class="gallina-kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec_incr">size_callee_save_area_rec_incr</a></span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">POS1:</span> <span class="id">pos</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id">pos1</span>) <span class="gallina-kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le;</a></span> <span class="id">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">AL1:</span> (<span class="id"><a href="compcert.common.Memdata.html#align_chunk">align_chunk</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#5cd21895b4d5f127eb2c0acb80e8d6fc">|</a></span> <span class="id">pos1</span>)).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">unfold</span> <span class="id">pos1</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_trans">Z.divide_trans</a></span> <span class="gallina-kwd">with</span> <span class="id">sz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">sz;</span> <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Memdata.html#align_size_chunk_divides">align_size_chunk_divides</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_divides">align_divides;</a></span> <span class="id">auto</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_drop_left">range_drop_left</a></span> <span class="gallina-kwd">with</span> (<span class="id">mid</span> <span class="id">:=</span> <span class="id">pos1</span>) <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">[</span> <span class="id">|</span> <span class="id">lia</span> <span class="id">]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_split">range_split</a></span> <span class="gallina-kwd">with</span> (<span class="id">mid</span> <span class="id">:=</span> <span class="id">pos1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">sz</span>) <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">[</span> <span class="id">|</span> <span class="id">lia</span> <span class="id">]</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">sz</span> <span class="gallina-kwd">at</span> <span class="id">1</span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_contains">range_contains</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_set_stack">contains_set_stack</a></span> (<span class="gallina-kwd">fun</span> <span id="v':434" class="id"><span id="v':433" class="id"><a name="v':434" class="">v'</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">r</span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v':433">v'</a></span>) (<span class="id">rs</span> <span class="id">r</span>)).<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#load_result_inject">load_result_inject;</a></span> <span class="id">[auto|apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.wt_ls">wt_ls]</a></span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span> <span class="id">intros</span> (<span class="id">m1</span> &amp; <span class="id">STORE</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">rs1</span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Mach.html#undef_regs">undef_regs</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>) <span class="id">rs</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">AG1:</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id">rs1</span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">red;</span> <span class="id">intros</span>. <span class="id">unfold</span> <span class="id">rs1</span>. <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r0</span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls_temp_undef">ls_temp_undef</a></span> <span class="gallina-kwd">by</span> <span class="id">eauto</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Mach.html#undef_regs_other">undef_regs_other</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id">AG</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHl</span> (<span class="id">pos1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">sz</span>) <span class="id">rs1</span> <span class="id">m1</span>)<span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">rs2</span> &amp; <span class="id">m2</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">rs2,</span> <span class="id">m2</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_left">star_left;</a></span> <span class="id">eauto</span>. <span class="id">constructor</span>. <span class="id">exact</span> <span class="id">STORE</span>. <span class="id">auto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="id">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">intros</span>. <span class="id">apply</span> <span class="id">C</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="gallina-kwd">in</span> <span class="id">STORE;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">STORE</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span><span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.SAVE_CALLEE_SAVE">SAVE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="vernacular">Remark</span> <span id="LTL_undef_regs_same" class="id"><a name="LTL_undef_regs_same" class="">LTL_undef_regs_same:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="r:435" class="id"><a name="r:435" class="">r</a></span> <span id="rl:436" class="id"><a name="rl:436" class="">rl</a></span> <span id="ls:437" class="id"><a name="ls:437" class="">ls,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:435">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:436">rl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:436">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:437">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:435">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">rl;</span> <span class="id">simpl;</span> <span class="id">intros</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.eq">Loc.eq</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">r</span>)). <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">r</span>))<span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHrl</span>. <span class="id">intuition</span> <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="LTL_undef_regs_others" class="id"><a name="LTL_undef_regs_others" class="">LTL_undef_regs_others:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="r:438" class="id"><a name="r:438" class="">r</a></span> <span id="rl:439" class="id"><a name="rl:439" class="">rl</a></span> <span id="ls:440" class="id"><a name="ls:440" class="">ls,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181">~In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:438">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:439">rl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:439">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:440">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:438">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:440">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:438">r</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">rl;</span> <span class="id">simpl;</span> <span class="id">intros</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>. <span class="id">apply</span> <span class="id">IHrl</span>. <span class="id">intuition</span>. <span class="id">red</span>. <span class="id">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="LTL_undef_regs_slot" class="id"><a name="LTL_undef_regs_slot" class="">LTL_undef_regs_slot:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="sl:441" class="id"><a name="sl:441" class="">sl</a></span> <span id="ofs:442" class="id"><a name="ofs:442" class="">ofs</a></span> <span id="ty:443" class="id"><a name="ty:443" class="">ty</a></span> <span id="rl:444" class="id"><a name="rl:444" class="">rl</a></span> <span id="ls:445" class="id"><a name="ls:445" class="">ls,</a></span> <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:444">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:445">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:441">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:442">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:443">ty</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:445">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:441">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:442">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:443">ty</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">rl;</span> <span class="id">simpl;</span> <span class="id">intros</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>. <span class="id">apply</span> <span class="id">IHrl</span>. <span class="id">red;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="undef_regs_type" class="id"><a name="undef_regs_type" class="">undef_regs_type:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="ty:446" class="id"><a name="ty:446" class="">ty</a></span> <span id="l:447" class="id"><a name="l:447" class="">l</a></span> <span id="rl:448" class="id"><a name="rl:448" class="">rl</a></span> <span id="ls:449" class="id"><a name="ls:449" class="">ls,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:449">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:447">l</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:446">ty</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl:448">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:449">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:447">l</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty:446">ty</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">rl;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.eq">Loc.eq</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">a</span>) <span class="id">l</span>). <span class="id">red;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">a</span>) <span class="id">l</span>)<span class="id">;</span> <span class="id">auto</span>. <span class="id">red;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="save_callee_save_correct" class="id"><a name="save_callee_save_correct" class="">save_callee_save_correct:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:450" class="id"><a name="j:450" class="">j</a></span> <span id="ls:451" class="id"><a name="ls:451" class="">ls</a></span> <span id="ls0:452" class="id"><a name="ls0:452" class="">ls0</a></span> <span id="rs:453" class="id"><a name="rs:453" class="">rs</a></span> <span id="sp:454" class="id"><a name="sp:454" class="">sp</a></span> <span id="cs:455" class="id"><a name="cs:455" class="">cs</a></span> <span id="fb:456" class="id"><a name="fb:456" class="">fb</a></span> <span id="k:457" class="id"><a name="k:457" class="">k</a></span> <span id="m:458" class="id"><a name="m:458" class="">m</a></span> <span id="P:459" class="id"><a name="P:459" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:458">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:454">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area">size_callee_save_area</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>)) <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:459">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:460" class="id"><a name="r:460" class="">r,</a></span> <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:451">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:460">r</a></span>)) (<span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:460">r</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:451">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:452">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:450">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:451">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:453">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="ls1:461" class="id"><a name="ls1:461" class="">ls1</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> (<span class="id"><a href="compcert.backend.LTL.html#call_regs">LTL.call_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:451">ls</a></span>) <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="rs1:462" class="id"><a name="rs1:462" class="">rs1</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Mach.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:453">rs</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="rs':463" class="id"><a name="rs':463" class="">rs',</a></span> <span class="gallina-kwd">exists</span> <span id="m':464" class="id"><a name="m':464" class="">m',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:455">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:456">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:454">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save">save_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:457">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs1:462">rs1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:458">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:455">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:456">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:454">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k:457">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':463">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':464">m'</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':464">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:450">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:454">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:452">ls0</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:459">P</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> (<span class="gallina-kwd">forall</span> <span id="ofs:465" class="id"><a name="ofs:465" class="">ofs</a></span> <span id="k:466" class="id"><a name="k:466" class="">k</a></span> <span id="p:467" class="id"><a name="p:467" class="">p,</a></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:458">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:454">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:465">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:466">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:467">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':464">m'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:454">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:465">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:466">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:467">p</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:450">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1:461">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':463">rs'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">until</span> <span class="id">P;</span> <span class="id">intros</span> <span class="id">SEP</span> <span class="id">TY</span> <span class="id">AGCS</span> <span class="id">AG;</span> <span class="id">intros</span> <span class="id">ls1</span> <span class="id">rs1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#save_callee_save_rec_correct">save_callee_save_rec_correct</a></span> <span class="id">j</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">sp</span> <span class="id">ls1</span>).<br/>
<span class="id">-</span> <span class="id">intros</span>. <span class="id">unfold</span> <span class="id">ls1</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#LTL_undef_regs_same">LTL_undef_regs_same</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_setstack_function_entry">destroyed_by_setstack_function_entry;</a></span> <span class="id">eauto</span>.<br/>
<span class="id">-</span> <span class="id">intros</span>. <span class="id">unfold</span> <span class="id">ls1</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#undef_regs_type">undef_regs_type</a></span>. <span class="id">apply</span> <span class="id">TY</span>.<br/>
<span class="id">-</span> <span class="id">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save_prop">used_callee_save_prop</a></span>).<br/>
<span class="id">-</span> <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
<span class="id">-</span> <span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">rs1</span>). <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_call_regs">agree_regs_call_regs</a></span>. <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">clear</span> <span class="id">SEP</span>. <span class="id">intros</span> (<span class="id">rs'</span> &amp; <span class="id">m'</span> &amp; <span class="id">EXEC</span> &amp; <span class="id">SEP</span> &amp; <span class="id">PERMS</span> &amp; <span class="id">AG'</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">rs',</span> <span class="id">m'</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">eexact</span> <span class="id">EXEC</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves_exten">contains_callee_saves_exten</a></span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls0</span> <span class="id">ls1</span>). <span class="id">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save_prop">used_callee_save_prop</a></span>) <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">ls1</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#LTL_undef_regs_others">LTL_undef_regs_others</a></span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">AGCS;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">red;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span>  (<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_at_function_entry_caller_save">destroyed_at_function_entry_caller_save</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#existsb_exists">existsb_exists</a></span>. <span class="gallina-kwd">exists</span> <span class="id">r;</span> <span class="id">auto</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">PERMS</span>. <span class="id">exact</span> <span class="id">AG'</span>.<br/>
Qed.</div>
<br/>
<div class="doc">As a corollary of the previous lemmas, we obtain the following
  correctness theorem for the execution of a function prologue
  (allocation of the frame + saving of the link and return address +
  saving of the used callee-save registers). </div>
<br/>
<span class="vernacular">Lemma</span> <span id="function_prologue_correct" class="id"><a name="function_prologue_correct" class="">function_prologue_correct:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:468" class="id"><a name="j:468" class="">j</a></span> <span id="ls:469" class="id"><a name="ls:469" class="">ls</a></span> <span id="ls0:470" class="id"><a name="ls0:470" class="">ls0</a></span> <span id="ls1:471" class="id"><a name="ls1:471" class="">ls1</a></span> <span id="rs:472" class="id"><a name="rs:472" class="">rs</a></span> <span id="rs1:473" class="id"><a name="rs1:473" class="">rs1</a></span> <span id="m1:474" class="id"><a name="m1:474" class="">m1</a></span> <span id="m1':475" class="id"><a name="m1':475" class="">m1'</a></span> <span id="m2:476" class="id"><a name="m2:476" class="">m2</a></span> <span id="sp:477" class="id"><a name="sp:477" class="">sp</a></span> <span id="parent:478" class="id"><a name="parent:478" class="">parent</a></span> <span id="ra:479" class="id"><a name="ra:479" class="">ra</a></span> <span id="cs:480" class="id"><a name="cs:480" class="">cs</a></span> <span id="fb:481" class="id"><a name="fb:481" class="">fb</a></span> <span id="k:482" class="id"><a name="k:482" class="">k</a></span> <span id="P:483" class="id"><a name="P:483" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:468">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:469">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:472">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:469">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:470">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Lineartyping.html#agree_outgoing_arguments">agree_outgoing_arguments</a></span> (<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls:469">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:470">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:484" class="id"><a name="r:484" class="">r,</a></span> <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls:469">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:484">r</a></span>)) (<span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:484">r</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#ls1:471">ls1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> (<span class="id"><a href="compcert.backend.LTL.html#call_regs">LTL.call_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:469">ls</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#rs1:473">rs1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Mach.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:472">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1:474">m1</a></span> <span class="id">0</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#m2:476">m2,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:477">sp</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:478">parent</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra:479">ra</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m1':475">m1'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:468">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1:474">m1</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:468">j</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:483">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="j':485" class="id"><a name="j':485" class="">j',</a></span> <span class="gallina-kwd">exists</span> <span id="rs':486" class="id"><a name="rs':486" class="">rs',</a></span> <span class="gallina-kwd">exists</span> <span id="m2':487" class="id"><a name="m2':487" class="">m2',</a></span> <span class="gallina-kwd">exists</span> <span id="sp':488" class="id"><a name="sp':488" class="">sp',</a></span> <span class="gallina-kwd">exists</span> <span id="m3':489" class="id"><a name="m3':489" class="">m3',</a></span> <span class="gallina-kwd">exists</span> <span id="m4':490" class="id"><a name="m4':490" class="">m4',</a></span> <span class="gallina-kwd">exists</span> <span id="m5':491" class="id"><a name="m5':491" class="">m5',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1':475">m1'</a></span> <span class="id">0</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_stacksize">fn_stacksize</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#m2':487">m2',</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':488">sp'</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m2':487">m2'</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':488">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_link_ofs">fn_link_ofs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#parent:478">parent</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m3':489">m3'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m3':489">m3'</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':488">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_retaddr_ofs">fn_retaddr_ofs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ra:479">ra</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m4':490">m4'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:480">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:481">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':488">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save">save_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:482">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs1:473">rs1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m4':490">m4'</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:480">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:481">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':488">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k:482">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':486">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m5':491">m5'</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':485">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1:471">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':486">rs'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1:471">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:470">ls0</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#m5':491">m5'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':485">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':488">sp'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1:471">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:470">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent:478">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra:479">ra</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':485">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m2:476">m2</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':485">j'</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:483">P</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':485">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:477">sp</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Stackingproof.html#sp':488">sp',</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>))<br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:468">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':485">j'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">until</span> <span class="id">P;</span> <span class="id">intros</span> <span class="id">AGREGS</span> <span class="id">AGCS</span> <span class="id">AGARGS</span> <span class="id">WTREGS</span> <span class="id">LS1</span> <span class="id">RS1</span> <span class="id">ALLOC</span> <span class="id">TYPAR</span> <span class="id">TYRA</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#fn_stacksize">fn_stacksize,</a></span> <span class="id"><a href="compcert.backend.Mach.html#fn_link_ofs">fn_link_ofs,</a></span> <span class="id"><a href="compcert.backend.Mach.html#fn_retaddr_ofs">fn_retaddr_ofs</a></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Stack&nbsp;layout&nbsp;info&nbsp;*)</span><br/>
<span class="vernacular">Local</span> <span class="vernacular">Opaque</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="compcert.x86.Stacklayout.html#frame_env_range">frame_env_range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="compcert.x86.Stacklayout.html#frame_env_aligned">frame_env_aligned</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>). <span class="id">replace</span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) <span class="gallina-kwd">with</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">LAYOUT1</span> <span class="id">LAYOUT2</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Allocation&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">m1'</span> <span class="id">0</span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>)) <span class="gallina-kwd">as</span> <span class="id">[m2'</span> <span class="id">sp']</span> <span class="id">eqn:ALLOC'</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#alloc_parallel_rule_2">alloc_parallel_rule_2</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">ALLOC</span>. <span class="id">eexact</span> <span class="id">ALLOC'</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>). <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>). <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max_comm">Z.max_comm</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data_pos">bound_stack_data_pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#size_no_overflow">size_no_overflow;</a></span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP</span>. <span class="id">intros</span> (<span class="id">j'</span> &amp; <span class="id">SEP</span> &amp; <span class="id">INCR</span> &amp; <span class="id">SAME</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Remember&nbsp;the&nbsp;freeable&nbsp;permissions&nbsp;using&nbsp;a&nbsp;mconj&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">SEPCONJ:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m2'</span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#mconj">mconj</a></span> (<span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id">sp'</span> <span class="id">0</span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>) <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id">sp'</span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id">sp'</span> <span class="id">0</span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>) <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id">sp'</span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j'</span> <span class="id">m2</span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id">j'</span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id">P</span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_intro">mconj_intro;</a></span> <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc;</a></span> <span class="id">assumption</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Dividing&nbsp;up&nbsp;the&nbsp;frame&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="compcert.x86.Stacklayout.html#frame_env_separated">frame_env_separated</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">replace</span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) <span class="gallina-kwd">with</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Store&nbsp;of&nbsp;parent&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap3">sep_swap3</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="compcert.common.Separation.html#range_contains">range_contains</a></span> <span class="id"><a href="compcert.common.AST.html#Mptr">Mptr</a></span>) <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">[|tauto]</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_set_stack">contains_set_stack</a></span> (<span class="gallina-kwd">fun</span> <span id="v':493" class="id"><span id="v':492" class="id"><a name="v':493" class="">v'</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':492">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">parent</span>) <span class="id">parent</span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>) <span class="id">m2'</span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr;</a></span> <span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.load_result_same">Val.load_result_same</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span> <span class="id">intros</span> (<span class="id">m3'</span> &amp; <span class="id">STORE_PARENT</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap3">sep_swap3</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Store&nbsp;of&nbsp;return&nbsp;address&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap4">sep_swap4</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="compcert.common.Separation.html#range_contains">range_contains</a></span> <span class="id"><a href="compcert.common.AST.html#Mptr">Mptr</a></span>) <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">[|tauto]</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_set_stack">contains_set_stack</a></span> (<span class="gallina-kwd">fun</span> <span id="v':495" class="id"><span id="v':494" class="id"><a name="v':495" class="">v'</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':494">v'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">ra</span>) <span class="id">ra</span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>) <span class="id">m3'</span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr;</a></span> <span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.load_result_same">Val.load_result_same</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span> <span class="id">intros</span> (<span class="id">m4'</span> &amp; <span class="id">STORE_RETADDR</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap4">sep_swap4</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Saving&nbsp;callee-save&nbsp;registers&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap5">sep_swap5</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#save_callee_save_correct">save_callee_save_correct</a></span> <span class="id">j'</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">rs</span>)<span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_inject_incr">agree_regs_inject_incr</a></span> <span class="gallina-kwd">with</span> <span class="id">j;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> (<span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span> <span class="id">ls</span>)) <span class="gallina-kwd">with</span> <span class="id">ls1</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="compcert.backend.Mach.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id">rs</span>) <span class="gallina-kwd">with</span> <span class="id">rs1</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span> <span class="id">intros</span> (<span class="id">rs2</span> &amp; <span class="id">m5'</span> &amp; <span class="id">SAVE_CS</span> &amp; <span class="id">SEP</span> &amp; <span class="id">PERMS</span> &amp; <span class="id">AGREGS'</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap5">sep_swap5</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Materializing&nbsp;the&nbsp;Local&nbsp;and&nbsp;Outgoing&nbsp;locations&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#initial_locations">initial_locations</a></span> <span class="id">j'</span>). <span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="vernacular">Local</span>). <span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">ls1</span>).<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">rewrite</span> <span class="id">LS1</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#LTL_undef_regs_slot">LTL_undef_regs_slot</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span> <span class="id">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#initial_locations">initial_locations</a></span> <span class="id">j'</span>). <span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span>). <span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">ls1</span>).<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">rewrite</span> <span class="id">LS1</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#LTL_undef_regs_slot">LTL_undef_regs_slot</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span> <span class="id">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Now&nbsp;we&nbsp;frame&nbsp;this&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">SEPFINAL:</span> <span class="id">m5'</span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">j'</span> <span class="id">sp'</span> <span class="id">ls1</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">ra</span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j'</span> <span class="id">m2</span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id">j'</span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id">P</span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#frame_mconj">frame_mconj</a></span>. <span class="id">eexact</span> <span class="id">SEPCONJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1;</a></span> <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>. <span class="id">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="gallina-kwd">forall</span> <span id="ofs:499" class="id"><span id="ofs:496" class="id"><a name="ofs:499" class="">ofs</a></span></span> <span id="k:500" class="id"><span id="k:497" class="id"><a name="k:500" class="">k</a></span></span> <span id="p:501" class="id"><span id="p:498" class="id"><a name="p:501" class="">p,</a></span></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m2'</span> <span class="id">sp'</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:496">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:497">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:498">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m5'</span> <span class="id">sp'</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:496">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:497">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:498">p</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{</span> <span class="id">intros</span>. <span class="id">apply</span> <span class="id">PERMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="gallina-kwd">in</span> <span class="id">STORE_PARENT,</span> <span class="id">STORE_RETADDR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">STORE_PARENT,</span> <span class="id">STORE_RETADDR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>. <span class="id">}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_preserved">sep_preserved</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEPCONJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved</a></span> <span class="gallina-kwd">with</span> <span class="id">m2';</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved</a></span> <span class="gallina-kwd">with</span> <span class="id">m2';</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP</span> <span class="id">SEPCONJ</span>.<br/>
<span class="comment">(*&nbsp;Conclusions&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">j',</span> <span class="id">rs2,</span> <span class="id">m2',</span> <span class="id">sp',</span> <span class="id">m3',</span> <span class="id">m4',</span> <span class="id">m5'</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">STORE_PARENT</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">STORE_RETADDR</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">eexact</span> <span class="id">SAVE_CS</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">AGREGS'</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">rewrite</span> <span class="id">LS1</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs;</a></span> <span class="id">[|reflexivity]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor;</span> <span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span>. <span class="id">apply</span> <span class="id">AGCS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="gallina-kwd">in</span> <span class="id">H;</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span>. <span class="id">apply</span> <span class="id">AGARGS</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Conventions.html#incoming_slot_in_parameters">incoming_slot_in_parameters;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">SEPFINAL</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">exact</span> <span class="id">SAME</span>. <span class="id">exact</span> <span class="id">INCR</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The following lemmas show the correctness of the register reloading
  code generated by <span class="bracket"><span class="id">reload_callee_save</span></span>: after this code has executed,
  all callee-save registers contain the same values they had at
  function entry. </div>
<br/>
<span class="vernacular">Section</span> <span id="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE" class="">RESTORE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs" class="">cs:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">stackframe</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb" class="">fb:</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp" class="">sp:</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0" class="">ls0:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m" class="id"><a name="PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m" class="">m:</a></span> <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="agree_unused" class="id"><a name="agree_unused" class="">agree_unused</a></span> (<span id="ls0:508" class="id"><a name="ls0:508" class="">ls0:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) (<span id="rs:509" class="id"><a name="rs:509" class="">rs:</a></span> <span class="id"><a href="compcert.backend.Mach.html#regset">regset</a></span>) <span class="id">:</span> <span class="gallina-kwd">Prop</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="r:510" class="id"><a name="r:510" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181">~</a></span>(<span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:510">r</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls0:508">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:510">r</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs:509">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:510">r</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="restore_callee_save_rec_correct" class="id"><a name="restore_callee_save_rec_correct" class="">restore_callee_save_rec_correct:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="l:511" class="id"><a name="l:511" class="">l</a></span> <span id="ofs:512" class="id"><a name="ofs:512" class="">ofs</a></span> <span id="rs:513" class="id"><a name="rs:513" class="">rs</a></span> <span id="k:514" class="id"><a name="k:514" class="">k,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:512">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:511">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_unused">agree_unused</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:513">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="r:515" class="id"><a name="r:515" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:515">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:511">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:515">r</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="rs':516" class="id"><a name="rs':516" class="">rs',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save_rec">restore_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:511">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:512">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:514">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs:513">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k:514">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':516">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> (<span class="gallina-kwd">forall</span> <span id="r:517" class="id"><a name="r:517" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:517">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:511">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:517">r</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs':516">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:517">r</a></span>))<br/>
&nbsp;&nbsp;<span class="id">/\</span> (<span class="gallina-kwd">forall</span> <span id="r:518" class="id"><a name="r:518" class="">r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181">~</a></span>(<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:518">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:511">l</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':516">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:518">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:513">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:518">r</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_unused">agree_unused</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':516">rs'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
<span class="vernacular">Local</span> <span class="vernacular">Opaque</span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span> <span class="gallina-kwd">as</span> <span class="id">[</span> <span class="id">|</span> <span class="id">r</span> <span class="id">l];</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;base&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">rs</span>. <span class="id">intuition</span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>.<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;inductive&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">ty</span> <span class="id">:=</span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">sz</span> <span class="id">:=</span> <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id">ty</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">ofs1</span> <span class="id">:=</span> <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id">ofs</span> <span class="id">sz</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">SZPOS:</span> <span class="id">sz</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&gt;'_x">&gt;</a></span> <span class="id">0</span>) <span class="gallina-kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="compcert.common.AST.html#typesize_pos">AST.typesize_pos</a></span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">OFSLE:</span> <span class="id">ofs</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id">ofs1</span>) <span class="gallina-kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le;</a></span> <span class="id">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">BOUND:</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span> <span class="id">r</span>) <span class="gallina-kwd">by</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_get_stack">contains_get_stack</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1;</a></span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">LOAD</span> &amp; <span class="id">SPEC</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHl</span> (<span class="id">ofs1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">sz</span>) (<span class="id">rs#r</span> <span class="id"><a href="compcert.backend.Mach.html#1c3052a4e65b5483b8c47507884ccd67">&lt;-</a></span> <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2;</a></span> <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">red;</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Mach.html#Regmap.gso">Regmap.gso</a></span>. <span class="id">auto</span>. <span class="id">intuition</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">rs'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_step">star_step;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">exact</span> <span class="id">LOAD</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r0</span> <span class="id">l</span>). <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">r</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">r0</span>) <span class="gallina-kwd">by</span> <span class="id">tauto</span>. <span class="id">subst</span> <span class="id">r0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">C</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Mach.html#Regmap.gss">Regmap.gss</a></span>. <span class="id">exact</span> <span class="id">SPEC</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">C</span> <span class="gallina-kwd">by</span> <span class="id">tauto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Mach.html#Regmap.gso">Regmap.gso</a></span>. <span class="id">intuition</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">D</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE">RESTORE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="restore_callee_save_correct" class="id"><a name="restore_callee_save_correct" class="">restore_callee_save_correct:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="m:519" class="id"><a name="m:519" class="">m</a></span> <span id="j:520" class="id"><a name="j:520" class="">j</a></span> <span id="sp:521" class="id"><a name="sp:521" class="">sp</a></span> <span id="ls:522" class="id"><a name="ls:522" class="">ls</a></span> <span id="ls0:523" class="id"><a name="ls0:523" class="">ls0</a></span> <span id="pa:524" class="id"><a name="pa:524" class="">pa</a></span> <span id="ra:525" class="id"><a name="ra:525" class="">ra</a></span> <span id="P:526" class="id"><a name="P:526" class="">P</a></span> <span id="rs:527" class="id"><a name="rs:527" class="">rs</a></span> <span id="k:528" class="id"><a name="k:528" class="">k</a></span> <span id="cs:529" class="id"><a name="cs:529" class="">cs</a></span> <span id="fb:530" class="id"><a name="fb:530" class="">fb,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:519">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:520">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:521">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:522">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:523">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pa:524">pa</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra:525">ra</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:526">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_unused">agree_unused</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:520">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:523">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:527">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="rs':531" class="id"><a name="rs':531" class="">rs',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:529">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:530">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:521">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:528">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs:527">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:519">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:529">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:530">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:521">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k:528">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':531">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:519">m</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> (<span class="gallina-kwd">forall</span> <span id="r:532" class="id"><a name="r:532" class="">r,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:532">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:520">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls0:523">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:532">r</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs':531">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:532">r</a></span>))<br/>
&nbsp;&nbsp;<span class="id">/\</span> (<span class="gallina-kwd">forall</span> <span id="r:533" class="id"><a name="r:533" class="">r,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:533">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs':531">rs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:533">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:527">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:533">r</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick5">sep_pick5</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#restore_callee_save_rec_correct">restore_callee_save_rec_correct;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">rs'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">rs'</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">eexact</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">split;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r</span> (<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">B;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">C</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id">H0</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds;</a></span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">C</span>. <span class="id">red;</span> <span class="id">intros</span>. <span class="id">apply</span> (<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save_prop">used_callee_save_prop</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.b">b</a></span>) <span class="gallina-kwd">in</span> <span class="id">H2</span>. <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">As a corollary, we obtain the following correctness result for
  the execution of a function epilogue (reloading of used callee-save
  registers + reloading of the link and return address + freeing
  of the frame). </div>
<br/>
<span class="vernacular">Lemma</span> <span id="function_epilogue_correct" class="id"><a name="function_epilogue_correct" class="">function_epilogue_correct:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="m':534" class="id"><a name="m':534" class="">m'</a></span> <span id="j:535" class="id"><a name="j:535" class="">j</a></span> <span id="sp':536" class="id"><a name="sp':536" class="">sp'</a></span> <span id="ls:537" class="id"><a name="ls:537" class="">ls</a></span> <span id="ls0:538" class="id"><a name="ls0:538" class="">ls0</a></span> <span id="pa:539" class="id"><a name="pa:539" class="">pa</a></span> <span id="ra:540" class="id"><a name="ra:540" class="">ra</a></span> <span id="P:541" class="id"><a name="P:541" class="">P</a></span> <span id="m:542" class="id"><a name="m:542" class="">m</a></span> <span id="rs:543" class="id"><a name="rs:543" class="">rs</a></span> <span id="sp:544" class="id"><a name="sp:544" class="">sp</a></span> <span id="m1:545" class="id"><a name="m1:545" class="">m1</a></span> <span id="k:546" class="id"><a name="k:546" class="">k</a></span> <span id="cs:547" class="id"><a name="cs:547" class="">cs</a></span> <span id="fb:548" class="id"><a name="fb:548" class="">fb,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m':534">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:535">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':536">sp'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:537">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:538">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pa:539">pa</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra:540">ra</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:535">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:542">m</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:541">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:535">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:537">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:543">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:537">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:538">ls0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#j:535">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:544">sp</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Stackingproof.html#sp':536">sp',</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:542">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:544">sp</a></span> <span class="id">0</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1:545">m1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="rs1:549" class="id"><a name="rs1:549" class="">rs1,</a></span> <span class="gallina-kwd">exists</span> <span id="m1':550" class="id"><a name="m1':550" class="">m1',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':534">m'</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':536">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_link_ofs">fn_link_ofs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pa:539">pa</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':534">m'</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':536">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_retaddr_ofs">fn_retaddr_ofs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra:540">ra</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':534">m'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':536">sp'</a></span> <span class="id">0</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_stacksize">fn_stacksize</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1':550">m1'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:547">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:548">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':536">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:546">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs:543">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':534">m'</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:547">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:548">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':536">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k:546">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs1:549">rs1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':534">m'</a></span>)<br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:535">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:538">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:537">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs1:549">rs1</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> (<span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:538">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:537">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0:538">ls0</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1':550">m1'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:535">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1:545">m1</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:541">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">until</span> <span class="id">fb;</span> <span class="id">intros</span> <span class="id">SEP</span> <span class="id">AGR</span> <span class="id">AGL</span> <span class="id">INJ</span> <span class="id">FREE</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Can&nbsp;free&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#free_parallel_rule">free_parallel_rule</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">FREE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">INJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">auto</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max_comm">Z.max_comm</a></span><span class="id">;</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">m1'</span> &amp; <span class="id">FREE'</span> &amp; <span class="id">SEP'</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Reloading&nbsp;the&nbsp;callee-save&nbsp;registers&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#restore_callee_save_correct">restore_callee_save_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">rs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">red;</span> <span class="id">intros</span>. <span class="id">destruct</span> <span class="id">AGL</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">agree_unused_reg0</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id">AGR</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">rs'</span> &amp; <span class="id">LOAD_CS</span> &amp; <span class="id">CS</span> &amp; <span class="id">NCS</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Reloading&nbsp;the&nbsp;back&nbsp;link&nbsp;and&nbsp;return&nbsp;address&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#hasvalue_get_stack">hasvalue_get_stack</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>). <span class="id">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick3">sep_pick3;</a></span> <span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">intros</span> <span class="id">LOAD_LINK</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#hasvalue_get_stack">hasvalue_get_stack</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>). <span class="id">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick4">sep_pick4;</a></span> <span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">intros</span> <span class="id">LOAD_RETADDR</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Conclusions&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function;</a></span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">rs',</span> <span class="id">m1'</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">red;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>) <span class="id">eqn:C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">CS;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">NCS</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id">AGR</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">red;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">l</span>. <span class="id">rewrite</span> <span class="id">H;</span> <span class="id">auto</span>. <span class="id">destruct</span> <span class="id">sl;</span> <span class="id">auto;</span> <span class="id">contradiction</span>. <br/>
&nbsp;&nbsp;<span class="id">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.FRAME_PROPERTIES">FRAME_PROPERTIES</a></span>.<br/>
<br/>
<h1> Call stack invariants </h1>
<br/>
<div class="doc">This is the memory assertion that captures the contents of the stack frames
  mentioned in the call stacks. </div>
<br/>
<span class="vernacular">Fixpoint</span> <span id="stack_contents" class="id"><a name="stack_contents" class="">stack_contents</a></span> (<span id="j:551" class="id"><a name="j:551" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span id="cs:552" class="id"><a name="cs:552" class="">cs:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Linear.html#stackframe">Linear.stackframe</a></span>) (<span id="cs':553" class="id"><a name="cs':553" class="">cs':</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">Mach.stackframe</a></span>) <span class="id">:</span> <span class="id"><a href="compcert.common.Separation.html#massert">massert</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:552">cs,</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':553">cs'</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="compcert.backend.Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id">f</span> <span class="id">_</span> <span class="id">ls</span> <span class="id">c</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id">cs,</span> <span class="id"><a href="compcert.backend.Mach.html#Stackframe">Mach.Stackframe</a></span> <span class="id">fb</span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp'</span> <span class="id">_</span>) <span class="id">ra</span> <span class="id">c'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id">cs'</span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">f</span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:551">j</a></span> <span class="id">sp'</span> <span class="id">ls</span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:552">cs</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':553">cs'</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':553">cs'</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents:554">stack_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:551">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:552">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':553">cs'</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">_,</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">match_stacks</span></span> captures additional properties (not related to memory)
  of the Linear and Mach call stacks. </div>
<br/>
<span class="vernacular">Inductive</span> <span id="match_stacks" class="id"><a name="match_stacks" class="">match_stacks</a></span> (<span id="j:557" class="id"><a name="j:557" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>)<span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Linear.html#stackframe">Linear.stackframe</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">stackframe</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.common.AST.html#signature">signature</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">Prop</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="match_stacks_empty" class="id"><a name="match_stacks_empty" class="">match_stacks_empty:</a></span> <span class="gallina-kwd">forall</span> <span id="sg:560" class="id"><a name="sg:560" class="">sg,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#tailcall_possible">tailcall_possible</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:560">sg</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks:558">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:557">j</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:560">sg</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="match_stacks_cons" class="id"><a name="match_stacks_cons" class="">match_stacks_cons:</a></span> <span class="gallina-kwd">forall</span> <span id="f:561" class="id"><a name="f:561" class="">f</a></span> <span id="sp:562" class="id"><a name="sp:562" class="">sp</a></span> <span id="ls:563" class="id"><a name="ls:563" class="">ls</a></span> <span id="c:564" class="id"><a name="c:564" class="">c</a></span> <span id="cs:565" class="id"><a name="cs:565" class="">cs</a></span> <span id="fb:566" class="id"><a name="fb:566" class="">fb</a></span> <span id="sp':567" class="id"><a name="sp':567" class="">sp'</a></span> <span id="ra:568" class="id"><a name="ra:568" class="">ra</a></span> <span id="c':569" class="id"><a name="c':569" class="">c'</a></span> <span id="cs':570" class="id"><a name="cs':570" class="">cs'</a></span> <span id="sg:571" class="id"><a name="sg:571" class="">sg</a></span> <span id="trf:572" class="id"><a name="trf:572" class="">trf</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="TAIL:573" class="id"><a name="TAIL:573" class="">TAIL:</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:564">c</a></span> (<span class="id"><a href="compcert.backend.Linear.html#fn_code">Linear.fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:561">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="FINDF:574" class="id"><a name="FINDF:574" class="">FINDF:</a></span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:566">fb</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#trf:572">trf</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="TRF:575" class="id"><a name="TRF:575" class="">TRF:</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:561">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#trf:572">trf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="TRC:576" class="id"><a name="TRC:576" class="">TRC:</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:561">f</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#c:564">c</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c':569">c'</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="INJ:577" class="id"><a name="INJ:577" class="">INJ:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:557">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:562">sp</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Stackingproof.html#sp':567">sp',</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:561">f</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="TY_RA:578" class="id"><a name="TY_RA:578" class="">TY_RA:</a></span> <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra:568">ra</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="AGL:579" class="id"><a name="AGL:579" class="">AGL:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:561">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:563">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:565">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="ARGS:582" class="id"><a name="ARGS:582" class="">ARGS:</a></span> <span class="gallina-kwd">forall</span> <span id="ofs:580" class="id"><a name="ofs:580" class="">ofs</a></span> <span id="ty:581" class="id"><a name="ty:581" class="">ty,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:580">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:581">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:571">sg</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:561">f</a></span>) <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:580">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:581">ty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="STK:583" class="id"><a name="STK:583" class="">STK:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks:558">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:557">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:565">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':570">cs'</a></span> (<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:561">f</a></span>))<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks:558">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:557">j</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:561">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:562">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls:563">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:564">c</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:565">cs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:566">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':567">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ra:568">ra</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c':569">c'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':570">cs'</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#sg:571">sg</a></span>.<br/>
<br/>
<div class="doc">Invariance with respect to change of memory injection. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="stack_contents_change_meminj" class="id"><a name="stack_contents_change_meminj" class="">stack_contents_change_meminj:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="m:584" class="id"><a name="m:584" class="">m</a></span> <span id="j:585" class="id"><a name="j:585" class="">j</a></span> <span id="j':586" class="id"><a name="j':586" class="">j',</a></span> <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:585">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':586">j'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="cs:587" class="id"><a name="cs:587" class="">cs</a></span> <span id="cs':588" class="id"><a name="cs':588" class="">cs'</a></span> <span id="P:589" class="id"><a name="P:589" class="">P,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:584">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:585">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:587">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':588">cs'</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:589">P</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:584">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':586">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:587">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':588">cs'</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#P:589">P</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
<span class="vernacular">Local</span> <span class="vernacular">Opaque</span> <span class="id"><a href="compcert.common.Separation.html#sepconj">sepconj</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">cs</span> <span class="gallina-kwd">as</span> <span class="id">[</span> <span class="id">|</span> <span class="id">[]</span> <span class="id">cs];</span> <span class="id">destruct</span> <span class="id">cs'</span> <span class="gallina-kwd">as</span> <span class="id">[</span> <span class="id">|</span> <span class="id">[]</span> <span class="id">cs'];</span> <span class="id">simpl;</span> <span class="id">intros;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">sp0;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_incr">frame_contents_incr</a></span> <span class="gallina-kwd">with</span> (<span class="id">j</span> <span class="id">:=</span> <span class="id">j</span>)<span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="id">apply</span> <span class="id">IHcs</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="id">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="match_stacks_change_meminj" class="id"><a name="match_stacks_change_meminj" class="">match_stacks_change_meminj:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:590" class="id"><a name="j:590" class="">j</a></span> <span id="j':591" class="id"><a name="j':591" class="">j',</a></span> <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:590">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':591">j'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="cs:592" class="id"><a name="cs:592" class="">cs</a></span> <span id="cs':593" class="id"><a name="cs':593" class="">cs'</a></span> <span id="sg:594" class="id"><a name="sg:594" class="">sg,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:590">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:592">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':593">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:594">sg</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j':591">j'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:592">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':593">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:594">sg</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">2;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">constructor;</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance with respect to change of signature. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="match_stacks_change_sig" class="id"><a name="match_stacks_change_sig" class="">match_stacks_change_sig:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="sg1:595" class="id"><a name="sg1:595" class="">sg1</a></span> <span id="j:596" class="id"><a name="j:596" class="">j</a></span> <span id="cs:597" class="id"><a name="cs:597" class="">cs</a></span> <span id="cs':598" class="id"><a name="cs':598" class="">cs'</a></span> <span id="sg:599" class="id"><a name="sg:599" class="">sg,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:596">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:597">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':598">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:599">sg</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#tailcall_possible">tailcall_possible</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg1:595">sg1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:596">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:597">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':598">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg1:595">sg1</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">1;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span>. <span class="id">intros</span>. <span class="id">elim</span> (<span class="id">H0</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
Qed.</div>
<br/>
<div class="doc">Typing properties of <span class="bracket"><span class="id">match_stacks</span></span>. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="match_stacks_type_sp" class="id"><a name="match_stacks_type_sp" class="">match_stacks_type_sp:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:600" class="id"><a name="j:600" class="">j</a></span> <span id="cs:601" class="id"><a name="cs:601" class="">cs</a></span> <span id="cs':602" class="id"><a name="cs':602" class="">cs'</a></span> <span id="sg:603" class="id"><a name="sg:603" class="">sg,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:600">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:601">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':602">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:603">sg</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':602">cs'</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">1;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.Vnullptr_has_type">Val.Vnullptr_has_type</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.Vptr_has_type">Val.Vptr_has_type</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="match_stacks_type_retaddr" class="id"><a name="match_stacks_type_retaddr" class="">match_stacks_type_retaddr:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:604" class="id"><a name="j:604" class="">j</a></span> <span id="cs:605" class="id"><a name="cs:605" class="">cs</a></span> <span id="cs':606" class="id"><a name="cs':606" class="">cs'</a></span> <span id="sg:607" class="id"><a name="sg:607" class="">sg,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:604">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:605">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':606">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:607">sg</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':606">cs'</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">1;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.Vnullptr_has_type">Val.Vnullptr_has_type</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Syntactic properties of the translation </h1>
<br/>
<div class="doc">Preservation of code labels through the translation. </div>
<br/>
<span class="vernacular">Section</span> <span id="PRESERVATION.LABELS" class="id"><a name="PRESERVATION.LABELS" class="">LABELS</a></span>.<br/>
<br/>
<span class="vernacular">Remark</span> <span id="find_label_save_callee_save" class="id"><a name="find_label_save_callee_save" class="">find_label_save_callee_save:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="lbl:608" class="id"><a name="lbl:608" class="">lbl</a></span> <span id="l:609" class="id"><a name="l:609" class="">l</a></span> <span id="ofs:610" class="id"><a name="ofs:610" class="">ofs</a></span> <span id="k:611" class="id"><a name="k:611" class="">k,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl:608">lbl</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save_rec">save_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:609">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:610">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:611">k</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl:608">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:611">k</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="find_label_restore_callee_save" class="id"><a name="find_label_restore_callee_save" class="">find_label_restore_callee_save:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="lbl:612" class="id"><a name="lbl:612" class="">lbl</a></span> <span id="l:613" class="id"><a name="l:613" class="">l</a></span> <span id="ofs:614" class="id"><a name="ofs:614" class="">ofs</a></span> <span id="k:615" class="id"><a name="k:615" class="">k,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl:612">lbl</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save_rec">restore_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:613">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:614">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:615">k</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl:612">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:615">k</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="transl_code_eq" class="id"><a name="transl_code_eq" class="">transl_code_eq:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="fe:616" class="id"><a name="fe:616" class="">fe</a></span> <span id="i:617" class="id"><a name="i:617" class="">i</a></span> <span id="c:618" class="id"><a name="c:618" class="">c,</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe:616">fe</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#i:617">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:618">c</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe:616">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i:617">i</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe:616">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:618">c</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code;</a></span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_fold_right_eq">list_fold_right_eq</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="find_label_transl_code" class="id"><a name="find_label_transl_code" class="">find_label_transl_code:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="fe:619" class="id"><a name="fe:619" class="">fe</a></span> <span id="lbl:620" class="id"><a name="lbl:620" class="">lbl</a></span> <span id="c:621" class="id"><a name="c:621" class="">c,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl:620">lbl</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe:619">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:621">c</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#option_map">option_map</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe:619">fe</a></span>) (<span class="id"><a href="compcert.backend.Linear.html#find_label">Linear.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl:620">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:621">c</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">c;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_code_eq">transl_code_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">a;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">s;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">s;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_restore_callee_save">find_label_restore_callee_save</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">lbl</span> <span class="id">l</span>). <span class="id">reflexivity</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_restore_callee_save">find_label_restore_callee_save</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="transl_find_label" class="id"><a name="transl_find_label" class="">transl_find_label:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="f:622" class="id"><a name="f:622" class="">f</a></span> <span id="tf:623" class="id"><a name="tf:623" class="">tf</a></span> <span id="lbl:624" class="id"><a name="lbl:624" class="">lbl</a></span> <span id="c:625" class="id"><a name="c:625" class="">c,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:622">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:623">tf</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Linear.html#find_label">Linear.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl:624">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:622">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">Linear.fn_code</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:625">c</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl:624">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:623">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_code">Mach.fn_code</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:622">f</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#c:625">c</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>).  <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_body">transl_body</a></span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#save_callee_save">save_callee_save</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_save_callee_save">find_label_save_callee_save</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_transl_code">find_label_transl_code</a></span>. <span class="id">rewrite</span> <span class="id">H0</span>. <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.LABELS">LABELS</a></span>.<br/>
<br/>
<div class="doc">Code tail property for Linear executions. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="find_label_tail" class="id"><a name="find_label_tail" class="">find_label_tail:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="lbl:626" class="id"><a name="lbl:626" class="">lbl</a></span> <span id="c:627" class="id"><a name="c:627" class="">c</a></span> <span id="c':628" class="id"><a name="c':628" class="">c',</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Linear.html#find_label">Linear.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl:626">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:627">c</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c':628">c'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c':628">c'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:627">c</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">c;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">intro</span> <span class="id">c'</span>. <span class="id">case</span> (<span class="id"><a href="compcert.backend.Linear.html#is_label">Linear.is_label</a></span> <span class="id">lbl</span> <span class="id">a</span>)<span class="id">;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">injection</span> <span class="id">H;</span> <span class="id">intro;</span> <span class="id">subst</span> <span class="id">c'</span>. <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Code tail property for translations </div>
<br/>
<span class="vernacular">Lemma</span> <span id="is_tail_save_callee_save" class="id"><a name="is_tail_save_callee_save" class="">is_tail_save_callee_save:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="l:629" class="id"><a name="l:629" class="">l</a></span> <span id="ofs:630" class="id"><a name="ofs:630" class="">ofs</a></span> <span id="k:631" class="id"><a name="k:631" class="">k,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:631">k</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save_rec">save_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:629">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:630">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:631">k</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l;</span> <span class="id">intros;</span> <span class="id">simpl</span>. <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="is_tail_restore_callee_save" class="id"><a name="is_tail_restore_callee_save" class="">is_tail_restore_callee_save:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="l:632" class="id"><a name="l:632" class="">l</a></span> <span id="ofs:633" class="id"><a name="ofs:633" class="">ofs</a></span> <span id="k:634" class="id"><a name="k:634" class="">k,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:634">k</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save_rec">restore_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:632">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:633">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:634">k</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l;</span> <span class="id">intros;</span> <span class="id">simpl</span>. <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="is_tail_transl_instr" class="id"><a name="is_tail_transl_instr" class="">is_tail_transl_instr:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="fe:635" class="id"><a name="fe:635" class="">fe</a></span> <span id="i:636" class="id"><a name="i:636" class="">i</a></span> <span id="k:637" class="id"><a name="k:637" class="">k,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:637">k</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe:635">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i:636">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k:637">k</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">i;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr;</a></span> <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">s;</span> <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">s;</span> <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span>.  <span class="id">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span>. <span class="id">2:</span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_restore_callee_save">is_tail_restore_callee_save</a></span>. <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span>.  <span class="id">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span>. <span class="id">2:</span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_restore_callee_save">is_tail_restore_callee_save</a></span>. <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="is_tail_transl_code" class="id"><a name="is_tail_transl_code" class="">is_tail_transl_code:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="fe:638" class="id"><a name="fe:638" class="">fe</a></span> <span id="c1:639" class="id"><a name="c1:639" class="">c1</a></span> <span id="c2:640" class="id"><a name="c2:640" class="">c2,</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c1:639">c1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c2:640">c2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe:638">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c1:639">c1</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe:638">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c2:640">c2</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">1;</span> <span class="id">simpl</span>. <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_code_eq">transl_code_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span>. <span class="id">eauto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_transl_instr">is_tail_transl_instr</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="is_tail_transf_function" class="id"><a name="is_tail_transf_function" class="">is_tail_transf_function:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="f:641" class="id"><a name="f:641" class="">f</a></span> <span id="tf:642" class="id"><a name="tf:642" class="">tf</a></span> <span id="c:643" class="id"><a name="c:643" class="">c,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:641">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:642">tf</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:643">c</a></span> (<span class="id"><a href="compcert.backend.Linear.html#fn_code">Linear.fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:641">f</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:641">f</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#c:643">c</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:642">tf</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_body">transl_body,</a></span> <span class="id"><a href="compcert.backend.Stacking.html#save_callee_save">save_callee_save</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span>. <span class="id">2:</span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_save_callee_save">is_tail_save_callee_save</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_transl_code">is_tail_transl_code;</a></span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Semantic preservation </h1>
<br/>
<div class="doc">Preservation / translation of global symbols and functions. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="symbols_preserved" class="id"><a name="symbols_preserved" class="">symbols_preserved:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span id="s:644" class="id"><a name="s:644" class="">s:</a></span> <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>)<span class="id">,</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s:644">s</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s:644">s</a></span>.<br/>
<span class="vernacular">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_match">Genv.find_symbol_match</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="senv_preserved" class="id"><a name="senv_preserved" class="">senv_preserved:</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Senv.equiv">Senv.equiv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span>.<br/>
<span class="vernacular">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.senv_match">Genv.senv_match</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="functions_translated" class="id"><a name="functions_translated" class="">functions_translated:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="v:645" class="id"><a name="v:645" class="">v</a></span> <span id="f:646" class="id"><a name="f:646" class="">f,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:645">v</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:646">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="tf:647" class="id"><a name="tf:647" class="">tf,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:645">v</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:647">tf</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:646">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:647">tf</a></span>.<br/>
<span class="vernacular">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_transf_partial">Genv.find_funct_transf_partial</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="function_ptr_translated" class="id"><a name="function_ptr_translated" class="">function_ptr_translated:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="b:648" class="id"><a name="b:648" class="">b</a></span> <span id="f:649" class="id"><a name="f:649" class="">f,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b:648">b</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:649">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="tf:650" class="id"><a name="tf:650" class="">tf,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b:648">b</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:650">tf</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:649">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:650">tf</a></span>.<br/>
<span class="vernacular">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr_transf_partial">Genv.find_funct_ptr_transf_partial</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="sig_preserved" class="id"><a name="sig_preserved" class="">sig_preserved:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="f:651" class="id"><a name="f:651" class="">f</a></span> <span id="tf:652" class="id"><a name="tf:652" class="">tf,</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:651">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:652">tf</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Mach.html#funsig">Mach.funsig</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:652">tf</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.backend.Linear.html#funsig">Linear.funsig</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:651">f</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">until</span> <span class="id">tf;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef,</a></span> <span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">f;</span> <span class="id">intros;</span> <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">EQ</span>). <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="find_function_translated" class="id"><a name="find_function_translated" class="">find_function_translated:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="j:653" class="id"><a name="j:653" class="">j</a></span> <span id="ls:654" class="id"><a name="ls:654" class="">ls</a></span> <span id="rs:655" class="id"><a name="rs:655" class="">rs</a></span> <span id="m:656" class="id"><a name="m:656" class="">m</a></span> <span id="ros:657" class="id"><a name="ros:657" class="">ros</a></span> <span id="f:658" class="id"><a name="f:658" class="">f,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:653">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:654">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:655">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m:656">m</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:653">j</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Linear.html#find_function">Linear.find_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ros:657">ros</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:654">ls</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:658">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="bf:659" class="id"><a name="bf:659" class="">bf,</a></span> <span class="gallina-kwd">exists</span> <span id="tf:660" class="id"><a name="tf:660" class="">tf,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#find_function_ptr">find_function_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ros:657">ros</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:655">rs</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bf:659">bf</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bf:659">bf</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:660">tf</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:658">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:660">tf</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</span></div>
<div class="proofscript" id="proof94">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">until</span> <span class="id">f;</span> <span class="id">intros</span> <span class="id">AG</span> <span class="id">[bound</span> <span class="id">[_</span> <span class="id">[?????]]]</span> <span class="id">FF</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">ros;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">FF</span>.<br/>
<span class="id">-</span> <span class="id">exploit</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_inv">Genv.find_funct_inv</a></span><span class="id">;</span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[b</span> <span class="id">EQ]</span>. <span class="id">rewrite</span> <span class="id">EQ</span> <span class="gallina-kwd">in</span> <span class="id">FF</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_find_funct_ptr">Genv.find_funct_find_funct_ptr</a></span> <span class="gallina-kwd">in</span> <span class="id">FF</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#function_ptr_translated">function_ptr_translated;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[tf</span> <span class="id">[A</span> <span class="id">B]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">b;</span> <span class="gallina-kwd">exists</span> <span class="id">tf;</span> <span class="id">split;</span> <span class="id">auto</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id">AG</span> <span class="id">m0</span>). <span class="id">rewrite</span> <span class="id">EQ</span>. <span class="id">intro</span> <span class="id">INJ</span>. <span class="id">inv</span> <span class="id">INJ</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">DOMAIN</span> <span class="gallina-kwd">in</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H2</span>. <span class="id">simpl</span>. <span class="id">auto</span>. <span class="id">eapply</span> <span class="id">FUNCTIONS;</span> <span class="id">eauto</span>.<br/>
<span class="id">-</span> <span class="id">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id">i</span>) <span class="gallina-kwd">as</span> <span class="id">[b|]</span> <span class="id">eqn:?;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#function_ptr_translated">function_ptr_translated;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[tf</span> <span class="id">[A</span> <span class="id">B]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">b;</span> <span class="gallina-kwd">exists</span> <span class="id">tf;</span> <span class="id">split;</span> <span class="id">auto</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of the arguments to an external call. </div>
<br/>
<span class="vernacular">Section</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS" class="">EXTERNAL_ARGUMENTS</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.j" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.j" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.cs" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.cs" class="">cs:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Linear.html#stackframe">Linear.stackframe</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.cs'" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.cs'" class="">cs':</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">stackframe</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.sg" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.sg" class="">sg:</a></span> <span class="id"><a href="compcert.common.AST.html#signature">signature</a></span>.<br/>
<span class="vernacular">Variables</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.bound" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.bound" class="">bound</a></span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.bound'" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.bound'" class="">bound':</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.MS" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.MS" class="">MS:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs'">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.ls" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.ls" class="">ls:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.rs" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.rs" class="">rs:</a></span> <span class="id"><a href="compcert.backend.Mach.html#regset">regset</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.AGR" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.AGR" class="">AGR:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.AGCS" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.AGCS" class="">AGCS:</a></span> <span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs">cs</a></span>).<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.AGARGS" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.AGARGS" class="">AGARGS:</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#agree_outgoing_arguments">agree_outgoing_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs">cs</a></span>).<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.m'" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.m'" class="">m':</a></span> <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.EXTERNAL_ARGUMENTS.SEP" class="id"><a name="PRESERVATION.EXTERNAL_ARGUMENTS.SEP" class="">SEP:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.m'">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs'">cs'</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="transl_external_argument" class="id"><a name="transl_external_argument" class="">transl_external_argument:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="l:675" class="id"><a name="l:675" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:675">l</a></span> (<span class="id"><a href="compcert.common.AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="v:676" class="id"><a name="v:676" class="">v,</a></span> <span class="id"><a href="compcert.backend.Mach.html#extcall_arg">extcall_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.m'">m'</a></span> (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs'">cs'</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#l:675">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:676">v</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:675">l</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:676">v</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</span></div>
<div class="proofscript" id="proof95">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_argument_acceptable">loc_argument_acceptable</a></span> <span class="id">l</span>) <span class="gallina-kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="compcert.backend.Conventions.html#loc_arguments_acceptable_2">loc_arguments_acceptable_2</a></span> <span class="gallina-kwd">with</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg;</a></span> <span class="id">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">l;</span> <span class="id">red</span> <span class="gallina-kwd">in</span> <span class="id">H0</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">exists</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">r</span>)<span class="id">;</span> <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">destruct</span> <span class="id">sl;</span> <span class="id">try</span> <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.MS">MS</a></span>.<br/>
<span class="id">+</span> <span class="id">elim</span> (<span class="id">H1</span> <span class="id">_</span> <span class="id">H</span>).<br/>
<span class="id">+</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id">f</span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id">pos</span> <span class="id">ty</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">destruct</span> <span class="id">H0</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid,</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zle_true">zle_true</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_true">pred_dec_true</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">reflexivity</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>) <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id">pos</span> <span class="id">ty</span>) <span class="gallina-kwd">by</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_outgoing">frame_get_outgoing;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">v;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">exact</span> <span class="id">A</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.AGARGS">AGARGS</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">exact</span> <span class="id">B</span>. <br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="transl_external_argument_2" class="id"><a name="transl_external_argument_2" class="">transl_external_argument_2:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="p:677" class="id"><a name="p:677" class="">p,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:677">p</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="v:678" class="id"><a name="v:678" class="">v,</a></span> <span class="id"><a href="compcert.backend.Mach.html#extcall_arg_pair">extcall_arg_pair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.m'">m'</a></span> (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs'">cs'</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#p:677">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:678">v</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:677">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v:678">v</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</span></div>
<div class="proofscript" id="proof96">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">p</span> <span class="gallina-kwd">as</span> <span class="id">[l</span> <span class="id">|</span> <span class="id">l1</span> <span class="id">l2]</span>.<br/>
<span class="id">-</span> <span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_argument">transl_external_argument</a></span> <span class="id">l</span>) <span class="gallina-kwd">as</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">eapply</span> <span class="id"><a href="compcert.common.AST.html#in_regs_of_rpairs">in_regs_of_rpairs;</a></span> <span class="id">eauto;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">v;</span> <span class="id">split;</span> <span class="id">auto</span>. <span class="id">constructor;</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_argument">transl_external_argument</a></span> <span class="id">l1</span>) <span class="gallina-kwd">as</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>). <span class="id">eapply</span> <span class="id"><a href="compcert.common.AST.html#in_regs_of_rpairs">in_regs_of_rpairs;</a></span> <span class="id">eauto;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_argument">transl_external_argument</a></span> <span class="id">l2</span>) <span class="gallina-kwd">as</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>). <span class="id">eapply</span> <span class="id"><a href="compcert.common.AST.html#in_regs_of_rpairs">in_regs_of_rpairs;</a></span> <span class="id">eauto;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id"><a href="compcert.common.Values.html#Val.longofwords">Val.longofwords</a></span> <span class="id">v1</span> <span class="id">v2</span>)<span class="id">;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.longofwords_inject">Val.longofwords_inject</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="transl_external_arguments_rec" class="id"><a name="transl_external_arguments_rec" class="">transl_external_arguments_rec:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="locs:679" class="id"><a name="locs:679" class="">locs,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#locs:679">locs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="vl:680" class="id"><a name="vl:680" class="">vl,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.backend.Mach.html#extcall_arg_pair">extcall_arg_pair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.m'">m'</a></span> (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs'">cs'</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#locs:679">locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#vl:680">vl</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="gallina-kwd">fun</span> <span id="p:681" class="id"><a name="p:681" class="">p</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:681">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#locs:679">locs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#vl:680">vl</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</span></div>
<div class="proofscript" id="proof97">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">locs;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>)<span class="id">;</span> <span class="id">split</span>. <span class="id">constructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_argument_2">transl_external_argument_2;</a></span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>. <span class="id">intros</span> <span class="id">[v</span> <span class="id">[A</span> <span class="id">B]]</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHlocs;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>. <span class="id">intros</span> <span class="id">[vl</span> <span class="id">[C</span> <span class="id">D]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">v</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id">vl</span>)<span class="id">;</span> <span class="id">split;</span> <span class="id">constructor;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="transl_external_arguments" class="id"><a name="transl_external_arguments" class="">transl_external_arguments:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="vl:682" class="id"><a name="vl:682" class="">vl,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#extcall_arguments">extcall_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.m'">m'</a></span> (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.cs'">cs'</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#vl:682">vl</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="gallina-kwd">fun</span> <span id="p:683" class="id"><a name="p:683" class="">p</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p:683">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.ls">ls</a></span>) (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS.sg">sg</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#vl:682">vl</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</span></div>
<div class="proofscript" id="proof98">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#extcall_arguments">extcall_arguments</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_arguments_rec">transl_external_arguments_rec</a></span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.EXTERNAL_ARGUMENTS">EXTERNAL_ARGUMENTS</a></span>.<br/>
<br/>
<div class="doc">Preservation of the arguments to a builtin. </div>
<br/>
<span class="vernacular">Section</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS" class="">BUILTIN_ARGUMENTS</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.f" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.f" class="">f:</a></span> <span class="id"><a href="compcert.backend.Linear.html#function">Linear.function</a></span>.<br/>
<span class="vernacular">Let</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.b" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.b" class="">b</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span>.<br/>
<span class="vernacular">Let</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.fe" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.fe" class="">fe</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.b">b</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.tf" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.tf" class="">tf:</a></span> <span class="id"><a href="compcert.backend.Mach.html#function">Mach.function</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.TRANSF_F" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.TRANSF_F" class="">TRANSF_F:</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.tf">tf</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.j" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.j" class="">j:</a></span> <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="vernacular">Variables</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.m" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.m" class="">m</a></span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.m'" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.m'" class="">m':</a></span> <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<span class="vernacular">Variables</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.ls" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.ls" class="">ls</a></span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.ls0" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.ls0" class="">ls0:</a></span> <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.rs" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.rs" class="">rs:</a></span> <span class="id"><a href="compcert.backend.Mach.html#regset">regset</a></span>.<br/>
<span class="vernacular">Variables</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.sp" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.sp" class="">sp</a></span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.sp'" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.sp'" class="">sp':</a></span> <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="vernacular">Variables</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.parent" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.parent" class="">parent</a></span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.retaddr" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.retaddr" class="">retaddr:</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.INJ" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.INJ" class="">INJ:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp'">sp',</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>)).<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.AGR" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.AGR" class="">AGR:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="PRESERVATION.BUILTIN_ARGUMENTS.SEP" class="id"><a name="PRESERVATION.BUILTIN_ARGUMENTS.SEP" class="">SEP:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.m'">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp'">sp'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.retaddr">retaddr</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="transl_builtin_arg_correct" class="id"><a name="transl_builtin_arg_correct" class="">transl_builtin_arg_correct:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="a:700" class="id"><a name="a:700" class="">a</a></span> <span id="v:701" class="id"><a name="v:701" class="">v,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a:700">a</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:701">v</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="l:702" class="id"><a name="l:702" class="">l,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:702">l</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_arg">params_of_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a:700">a</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:702">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="sl:703" class="id"><a name="sl:703" class="">sl</a></span> <span id="ofs:704" class="id"><a name="ofs:704" class="">ofs</a></span> <span id="ty:705" class="id"><a name="ty:705" class="">ty,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:703">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:704">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:705">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_arg">params_of_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a:700">a</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:703">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:704">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:705">ty</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="v':706" class="id"><a name="v':706" class="">v',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp'">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.m'">m'</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_builtin_arg">transl_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a:700">a</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v':706">v'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v:701">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':706">v'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</span></div>
<div class="proofscript" id="proof99">
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">SYMB:</span> <span class="gallina-kwd">forall</span> <span id="id:709" class="id"><span id="id:707" class="id"><a name="id:709" class="">id</a></span></span> <span id="ofs:710" class="id"><span id="ofs:708" class="id"><a name="ofs:710" class="">ofs,</a></span></span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#id:707">id</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:708">ofs</a></span>) (<span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#id:707">id</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:708">ofs</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">assert</span> (<span class="id">G:</span> <span class="id"><a href="compcert.common.Events.html#meminj_preserves_globals">meminj_preserves_globals</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{</span> <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.SEP">SEP</a></span>. <span class="id">}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span><span class="id">;</span> <span class="id">simpl;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id">id</span>) <span class="id">eqn:FS;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">G</span>. <span class="id">econstructor</span>. <span class="id">eauto</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span><span class="id">;</span> <span class="id">auto</span>. <span class="id">}</span><br/>
<span class="vernacular">Local</span> <span class="vernacular">Opaque</span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">1;</span> <span class="id">simpl;</span> <span class="id">intros</span> <span class="id">VALID</span> <span class="id">BOUNDS</span>.<br/>
<span class="id">-</span> <span class="id">assert</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span> <span class="gallina-kwd">as</span> <span class="id">[r</span> <span class="id">|</span> <span class="id">[]</span> <span class="id">ofs</span> <span class="id">ty];</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">exists</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span> <span class="id">r</span>)<span class="id">;</span> <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_local">frame_get_local;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">v;</span> <span class="id">split;</span> <span class="id">auto</span>. <span class="id">constructor;</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
<span class="id">-</span> <span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
<span class="id">-</span> <span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
<span class="id">-</span> <span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
<span class="id">-</span> <span class="id">set</span> (<span class="id">ofs'</span> <span class="id">:=</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span>))).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#loadv_parallel_rule">loadv_parallel_rule;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp'">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">ofs'</span>).<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>. <span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">v'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="gallina-kwd">exists</span> <span class="id">v';</span> <span class="id">split;</span> <span class="id">auto</span>. <span class="id">constructor;</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">econstructor;</span> <span class="id">split;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span>. <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>. <span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#loadv_parallel_rule">loadv_parallel_rule;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">v'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="gallina-kwd">exists</span> <span class="id">v';</span> <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
<span class="id">-</span> <span class="id">econstructor;</span> <span class="id">split;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
<span class="id">-</span> <span class="id">destruct</span> <span class="id">IHeval_builtin_arg1</span> <span class="gallina-kwd">as</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>)<span class="id">;</span> <span class="id">auto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">IHeval_builtin_arg2</span> <span class="gallina-kwd">as</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>)<span class="id">;</span> <span class="id">auto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id"><a href="compcert.common.Values.html#Val.longofwords">Val.longofwords</a></span> <span class="id">v1</span> <span class="id">v2</span>)<span class="id">;</span> <span class="id">split;</span> <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.longofwords_inject">Val.longofwords_inject</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">destruct</span> <span class="id">IHeval_builtin_arg1</span> <span class="gallina-kwd">as</span> (<span class="id">v1'</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>)<span class="id">;</span> <span class="id">auto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">IHeval_builtin_arg2</span> <span class="gallina-kwd">as</span> (<span class="id">v2'</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>)<span class="id">;</span> <span class="id">auto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>. <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span><span class="id">;</span> <span class="id">auto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="compcert.common.Values.html#Val.add_inject">Val.add_inject</a></span><span class="id">,</span> <span class="id"><a href="compcert.common.Values.html#Val.addl_inject">Val.addl_inject</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="transl_builtin_args_correct" class="id"><a name="transl_builtin_args_correct" class="">transl_builtin_args_correct:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="al:711" class="id"><a name="al:711" class="">al</a></span> <span id="vl:712" class="id"><a name="vl:712" class="">vl,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#al:711">al</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#vl:712">vl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="l:713" class="id"><a name="l:713" class="">l,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:713">l</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#al:711">al</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l:713">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="sl:714" class="id"><a name="sl:714" class="">sl</a></span> <span id="ofs:715" class="id"><a name="ofs:715" class="">ofs</a></span> <span id="ty:716" class="id"><a name="ty:716" class="">ty,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:714">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:715">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:716">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#al:711">al</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl:714">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs:715">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty:716">ty</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="vl':717" class="id"><a name="vl':717" class="">vl',</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.rs">rs</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.sp'">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.m'">m'</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_builtin_arg">transl_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.fe">fe</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#al:711">al</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#vl':717">vl'</a></span><br/>
&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#vl:712">vl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#vl':717">vl'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</span></div>
<div class="proofscript" id="proof100">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">1;</span> <span class="id">simpl;</span> <span class="id">intros</span> <span class="id">VALID</span> <span class="id">BOUNDS</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">exists</span> (@<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>)<span class="id">;</span> <span class="id">split;</span> <span class="id">constructor</span>.<br/>
<span class="id">-</span> <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_builtin_arg_correct">transl_builtin_arg_correct;</a></span> <span class="id">eauto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="id">intros</span> (<span class="id">v1'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHlist_forall2;</span> <span class="id">eauto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="id">intros</span> (<span class="id">vl'</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">v1'::vl'</span>)<span class="id">;</span> <span class="id">split;</span> <span class="id">constructor;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.BUILTIN_ARGUMENTS">BUILTIN_ARGUMENTS</a></span>.<br/>
<br/>
<div class="doc">The proof of semantic preservation relies on simulation diagrams
  of the following form:
<pre>
           st1 --------------- st2
            |                   |
           t|                  +|t
            |                   |
            v                   v
           st1'--------------- st2'</pre>
  Matching between source and target states is defined by <span class="bracket"><span class="id">match_states</span></span>
  below.  It implies:
<ul>
<li>
 Satisfaction of the separation logic assertions that describe the contents
  of memory.  This is a separating conjunction of facts about:
<ul>
<li>
 the current stack frame
</li>
<li>
 the frames in the call stack
</li>
<li>
 the injection from the Linear memory state into the Mach memory state
</li>
<li>
 the preservation of the global environment.
</li>
</ul>
 Agreement between, on the Linear side, the location sets <span class="bracket"><span class="id">ls</span></span>
  and <span class="bracket"><span class="id">parent_locset</span> <span class="id">s</span></span> of the current function and its caller,
  and on the Mach side the register set <span class="bracket"><span class="id">rs</span></span>.
</li>
<li>
 The Linear code <span class="bracket"><span class="id">c</span></span> is a suffix of the code of the
  function <span class="bracket"><span class="id">f</span></span> being executed.
</li>
<li>
 Well-typedness of <span class="bracket"><span class="id">f</span></span>.
</li>
</ul>
</div>
<br/>
<span class="vernacular">Inductive</span> <span id="match_states" class="id"><a name="match_states" class="">match_states:</a></span> <span class="id"><a href="compcert.backend.Linear.html#state">Linear.state</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Mach.html#state">Mach.state</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">Prop</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="match_states_intro" class="id"><a name="match_states_intro" class="">match_states_intro:</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="cs:720" class="id"><a name="cs:720" class="">cs</a></span> <span id="f:721" class="id"><a name="f:721" class="">f</a></span> <span id="sp:722" class="id"><a name="sp:722" class="">sp</a></span> <span id="c:723" class="id"><a name="c:723" class="">c</a></span> <span id="ls:724" class="id"><a name="ls:724" class="">ls</a></span> <span id="m:725" class="id"><a name="m:725" class="">m</a></span> <span id="cs':726" class="id"><a name="cs':726" class="">cs'</a></span> <span id="fb:727" class="id"><a name="fb:727" class="">fb</a></span> <span id="sp':728" class="id"><a name="sp':728" class="">sp'</a></span> <span id="rs:729" class="id"><a name="rs:729" class="">rs</a></span> <span id="m':730" class="id"><a name="m':730" class="">m'</a></span> <span id="j:731" class="id"><a name="j:731" class="">j</a></span> <span id="tf:732" class="id"><a name="tf:732" class="">tf</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="STACKS:733" class="id"><a name="STACKS:733" class="">STACKS:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:731">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:720">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':726">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:721">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="TRANSL:734" class="id"><a name="TRANSL:734" class="">TRANSL:</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:721">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:732">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="FIND:735" class="id"><a name="FIND:735" class="">FIND:</a></span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:727">fb</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:732">tf</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="AGREGS:736" class="id"><a name="AGREGS:736" class="">AGREGS:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:731">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:724">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:729">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="AGLOCS:737" class="id"><a name="AGLOCS:737" class="">AGLOCS:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:721">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:724">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:720">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="INJSP:738" class="id"><a name="INJSP:738" class="">INJSP:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:731">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:722">sp</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Stackingproof.html#sp':728">sp',</a></span> <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:721">f</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="TAIL:739" class="id"><a name="TAIL:739" class="">TAIL:</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c:723">c</a></span> (<span class="id"><a href="compcert.backend.Linear.html#fn_code">Linear.fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:721">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="SEP:740" class="id"><a name="SEP:740" class="">SEP:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':730">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:721">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:731">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':728">sp'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:724">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:720">cs</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':726">cs'</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':726">cs'</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:731">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:720">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':726">cs'</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:731">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:725">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:731">j</a></span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_states:718">match_states</a></span> (<span class="id"><a href="compcert.backend.Linear.html#State">Linear.State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:720">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:721">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp:722">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#c:723">c</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:724">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:725">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">Mach.State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':726">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:727">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp':728">sp'</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:721">f</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#c:723">c</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs:729">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':730">m'</a></span>)<br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="match_states_call" class="id"><a name="match_states_call" class="">match_states_call:</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="cs:741" class="id"><a name="cs:741" class="">cs</a></span> <span id="f:742" class="id"><a name="f:742" class="">f</a></span> <span id="ls:743" class="id"><a name="ls:743" class="">ls</a></span> <span id="m:744" class="id"><a name="m:744" class="">m</a></span> <span id="cs':745" class="id"><a name="cs':745" class="">cs'</a></span> <span id="fb:746" class="id"><a name="fb:746" class="">fb</a></span> <span id="rs:747" class="id"><a name="rs:747" class="">rs</a></span> <span id="m':748" class="id"><a name="m':748" class="">m'</a></span> <span id="j:749" class="id"><a name="j:749" class="">j</a></span> <span id="tf:750" class="id"><a name="tf:750" class="">tf</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="STACKS:751" class="id"><a name="STACKS:751" class="">STACKS:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:749">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:741">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':745">cs'</a></span> (<span class="id"><a href="compcert.backend.Linear.html#funsig">Linear.funsig</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:742">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="TRANSL:752" class="id"><a name="TRANSL:752" class="">TRANSL:</a></span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:742">f</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:750">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="FIND:753" class="id"><a name="FIND:753" class="">FIND:</a></span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:746">fb</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf:750">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="AGREGS:754" class="id"><a name="AGREGS:754" class="">AGREGS:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:749">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:743">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:747">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="SEP:755" class="id"><a name="SEP:755" class="">SEP:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':748">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:749">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:741">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':745">cs'</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:749">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:744">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:749">j</a></span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_states:718">match_states</a></span> (<span class="id"><a href="compcert.backend.Linear.html#Callstate">Linear.Callstate</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:741">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f:742">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:743">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:744">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#Callstate">Mach.Callstate</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':745">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb:746">fb</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:747">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':748">m'</a></span>)<br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="match_states_return" class="id"><a name="match_states_return" class="">match_states_return:</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="cs:756" class="id"><a name="cs:756" class="">cs</a></span> <span id="ls:757" class="id"><a name="ls:757" class="">ls</a></span> <span id="m:758" class="id"><a name="m:758" class="">m</a></span> <span id="cs':759" class="id"><a name="cs':759" class="">cs'</a></span> <span id="rs:760" class="id"><a name="rs:760" class="">rs</a></span> <span id="m':761" class="id"><a name="m':761" class="">m'</a></span> <span id="j:762" class="id"><a name="j:762" class="">j</a></span> <span id="sg:763" class="id"><a name="sg:763" class="">sg</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="STACKS:764" class="id"><a name="STACKS:764" class="">STACKS:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:762">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:756">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':759">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg:763">sg</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="AGREGS:765" class="id"><a name="AGREGS:765" class="">AGREGS:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:762">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:757">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:760">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span id="SEP:766" class="id"><a name="SEP:766" class="">SEP:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':761">m'</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents">stack_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:762">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:756">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':759">cs'</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:762">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:758">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j:762">j</a></span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_states:718">match_states</a></span> (<span class="id"><a href="compcert.backend.Linear.html#Returnstate">Linear.Returnstate</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs:756">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls:757">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m:758">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#Returnstate">Mach.Returnstate</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs':759">cs'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs:760">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m':761">m'</a></span>).<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="transf_step_correct" class="id"><a name="transf_step_correct" class="">transf_step_correct:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="s1:767" class="id"><a name="s1:767" class="">s1</a></span> <span id="t:768" class="id"><a name="t:768" class="">t</a></span> <span id="s2:769" class="id"><a name="s2:769" class="">s2,</a></span> <span class="id"><a href="compcert.backend.Linear.html#step">Linear.step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s1:767">s1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#t:768">t</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s2:769">s2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span id="WTS:770" class="id"><a name="WTS:770" class="">WTS:</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state">wt_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s1:767">s1</a></span>) <span id="s1':771" class="id"><a name="s1':771" class="">s1'</a></span> (<span id="MS:772" class="id"><a name="MS:772" class="">MS:</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s1:767">s1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s1':771">s1'</a></span>)<span class="id">,</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="s2':773" class="id"><a name="s2':773" class="">s2',</a></span> <span class="id"><a href="compcert.common.Smallstep.html#plus">plus</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s1':771">s1'</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#t:768">t</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s2':773">s2'</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s2:769">s2</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s2':773">s2'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</span></div>
<div class="proofscript" id="proof101">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">1;</span> <span class="id">intros;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> <span class="id">inv</span> <span class="id">MS;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_code_eq">transl_code_eq;</a></span><br/>
&nbsp;&nbsp;<span class="id">try</span> (<span class="id">generalize</span> (<span class="id"><a href="compcert.backend.Bounds.html#function_is_within_bounds">function_is_within_bounds</a></span> <span class="id">f</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Coqlib.html#is_tail_in">is_tail_in</a></span> <span class="id">TAIL</span>))<span class="id">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intro</span> <span class="id">BOUND;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">BOUND</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr</a></span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lgetstack&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">BOUND</span> <span class="gallina-kwd">as</span> <span class="id">[BOUND1</span> <span class="id">BOUND2]</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state_getstack">wt_state_getstack;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">SV</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#destroyed_by_getstack">destroyed_by_getstack;</a></span> <span class="id">destruct</span> <span class="id">sl</span>.<br/>
<span class="id">+</span> <span class="comment">(*&nbsp;Lgetstack,&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_local">frame_get_local;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mgetstack">exec_Mgetstack</a></span>. <span class="id">exact</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg;</a></span> <span class="id">auto</span>.<br/>
<span class="id">+</span> <span class="comment">(*&nbsp;Lgetstack,&nbsp;incoming&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="gallina-kwd">in</span> <span class="id">SV</span>. <span class="id">InvBooleans</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Conventions.html#incoming_slot_in_parameters">incoming_slot_in_parameters;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">IN_ARGS</span>.<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">STACKS;</span> <span class="id">clear</span> <span class="id">STACKS</span>.<br/>
&nbsp;&nbsp;<span class="id">elim</span> (<span class="id">H1</span> <span class="id">_</span> <span class="id">IN_ARGS</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">s</span> <span class="id">cs'</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_outgoing">frame_get_outgoing</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">ARGS;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#slot_outgoing_argument_valid">slot_outgoing_argument_valid;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mgetparam">exec_Mgetparam;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">TRANSL</span>). <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#fn_link_ofs">fn_link_ofs</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_parent">frame_get_parent</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>. <span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="id">auto</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_incoming">agree_incoming</a></span> <span class="gallina-kwd">by</span> <span class="id">eauto</span>. <span class="id">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs;</a></span> <span class="id">auto</span>.<br/>
<span class="id">+</span> <span class="comment">(*&nbsp;Lgetstack,&nbsp;outgoing&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_outgoing">frame_get_outgoing;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mgetstack">exec_Mgetstack</a></span>. <span class="id">exact</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg;</a></span> <span class="id">auto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lsetstack&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state_setstack">wt_state_setstack;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> (<span class="id">SV</span> &amp; <span class="id">SW</span>).<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">ofs'</span> <span class="id">:=</span> <span class="gallina-kwd">match</span> <span class="id">sl</span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="vernacular">Local</span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.backend.Stacking.html#offset_local">offset_local</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">ofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="compcert.backend.Locations.html#Incoming">Incoming</a></span> <span class="id">=&gt;</span> <span class="id">0</span> <span class="comment">(*&nbsp;dummy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.backend.Stacking.html#offset_arg">offset_arg</a></span> <span class="id">ofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">end</span>).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span> <span class="gallina-kwd">with</span> (<span class="id">rl</span> <span class="id">:=</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>) <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">A:</span> <span class="gallina-kwd">exists</span> <span id="m'':777" class="id"><span id="m'':776" class="id"><a name="m'':777" class="">m'',</a></span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id">m'</span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp'</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">ty</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs'</span>) (<span class="id">rs0</span> <span class="id">src</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m'':776">m''</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.backend.Stackingproof.html#m'':776">m''</a></span> <span class="id"><a href="compcert.common.Separation.html#a72a8e8de5afdccebc308c87179ed103">|=</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">f</span> <span class="id">j</span> <span class="id">sp'</span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>) (<span class="id">rs</span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">src</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>) <span class="id">rs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id">s</span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs'</span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents">stack_contents</a></span> <span class="id">j</span> <span class="id">s</span> <span class="id">cs'</span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j</span> <span class="id">m</span> <span class="id"><a href="compcert.common.Separation.html#bd5e47b14232d8437d86b4fb4a9ac5a6">**</a></span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">unfold</span> <span class="id">ofs';</span> <span class="id">destruct</span> <span class="id">sl;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_local">frame_set_local;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_outgoing">frame_set_outgoing;</a></span> <span class="id">eauto</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span> <span class="id">destruct</span> <span class="id">A</span> <span class="gallina-kwd">as</span> (<span class="id">m''</span> &amp; <span class="id">STORE</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">destruct</span> <span class="id">sl;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">STORE</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">STORE</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eauto</span>. <span class="id">eauto</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_slot">agree_regs_set_slot</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_slot">agree_locs_set_slot</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_setstack_caller_save">destroyed_by_setstack_caller_save</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eauto</span>. <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>. <span class="id">eauto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="gallina-kwd">exists</span> <span id="v':779" class="id"><span id="v':778" class="id"><a name="v':779" class="">v',</a></span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Op.html#eval_operation">eval_operation</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp'</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_op">transl_op</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">op</span>) <span class="id">rs0##args</span> <span class="id">m'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':778">v'</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">v</span> <span class="id"><a href="compcert.backend.Stackingproof.html#v':778">v'</a></span>).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_operation_inject">eval_operation_inject;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H0</span> <span class="gallina-kwd">as</span> <span class="id">[v'</span> <span class="id">[A</span> <span class="id">B]]</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">v'</span>). <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">A</span>. <span class="id">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_operation_preserved">eval_operation_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_destroyed_by_op">transl_destroyed_by_op</a></span>.  <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_op_caller_save">destroyed_by_op_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span>. <span class="id">exact</span> <span class="id">SEP</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lload&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="gallina-kwd">exists</span> <span id="a':781" class="id"><span id="a':780" class="id"><a name="a':781" class="">a',</a></span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Op.html#eval_addressing">eval_addressing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp'</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_addr">transl_addr</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">addr</span>) <span class="id">rs0##args</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a':780">a'</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">a</span> <span class="id"><a href="compcert.backend.Stackingproof.html#a':780">a'</a></span>).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_inject">eval_addressing_inject;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span> <span class="gallina-kwd">as</span> <span class="id">[a'</span> <span class="id">[A</span> <span class="id">B]]</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#loadv_parallel_rule">loadv_parallel_rule</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">eauto</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">[v'</span> <span class="id">[C</span> <span class="id">D]]</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">a'</span>). <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">A</span>. <span class="id">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="id">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">C</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_destroyed_by_load">transl_destroyed_by_load</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs;</a></span> <span class="id">auto</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_load_caller_save">destroyed_by_load_caller_save</a></span>. <span class="id">auto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lstore&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="gallina-kwd">exists</span> <span id="a':783" class="id"><span id="a':782" class="id"><a name="a':783" class="">a',</a></span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Op.html#eval_addressing">eval_addressing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp'</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_addr">transl_addr</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">addr</span>) <span class="id">rs0##args</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a':782">a'</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">/\</span> <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">a</span> <span class="id"><a href="compcert.backend.Stackingproof.html#a':782">a'</a></span>).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_inject">eval_addressing_inject;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span> <span class="gallina-kwd">as</span> <span class="id">[a'</span> <span class="id">[A</span> <span class="id">B]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap3">sep_swap3</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#storev_parallel_rule">storev_parallel_rule</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">eauto</span>. <span class="id">eauto</span>. <span class="id">apply</span> <span class="id">AGREGS</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span> <span class="id">intros</span> (<span class="id">m1'</span> &amp; <span class="id">C</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap3">sep_swap3</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">a'</span>). <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">A</span>. <span class="id">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="id">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">C</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eauto</span>. <span class="id">eauto</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_destroyed_by_store">transl_destroyed_by_store</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_store_caller_save">destroyed_by_store_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>. <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs;</a></span> <span class="id">eauto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_function_translated">find_function_translated;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">[bf</span> <span class="id">[tf'</span> <span class="id">[A</span> <span class="id">[B</span> <span class="id">C]]]]</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_transf_function">is_tail_transf_function;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">IST</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_code_eq">transl_code_eq</a></span> <span class="gallina-kwd">in</span> <span class="id">IST</span>. <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">IST</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.return_address_offset_exists">return_address_offset_exists</a></span>. <span class="id">eexact</span> <span class="id">IST</span>. <span class="id">intros</span> <span class="id">[ra</span> <span class="id">D]</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.Vptr_has_type">Val.Vptr_has_type</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="gallina-kwd">with</span> (<span class="id"><a href="compcert.backend.Conventions.html#size_arguments">size_arguments</a></span> (<span class="id"><a href="compcert.backend.Linear.html#funsig">Linear.funsig</a></span> <span class="id">f'</span>))<span class="id">;</span> <span class="id">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Conventions.html#loc_arguments_bounded">loc_arguments_bounded;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>. <span class="id">exact</span> <span class="id">SEP</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Ltailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents">stack_contents</a></span> <span class="id">j</span> <span class="id">s</span> <span class="id">cs'</span>)) <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#function_epilogue_correct">function_epilogue_correct;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP</span>. <span class="id">intros</span> (<span class="id">rs1</span> &amp; <span class="id">m1'</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span> &amp; <span class="id">S</span> &amp; <span class="id">T</span> &amp; <span class="id">U</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_function_translated">find_function_translated;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">[bf</span> <span class="id">[tf'</span> <span class="id">[A</span> <span class="id">[B</span> <span class="id">C]]]]</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_right">plus_right</a></span>. <span class="id">eexact</span> <span class="id">S</span>. <span class="id">econstructor;</span> <span class="id">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_change_sig">match_stacks_change_sig</a></span> <span class="gallina-kwd">with</span> (<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f</span>)<span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Conventions.html#zero_size_arguments_tailcall_possible">zero_size_arguments_tailcall_possible</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state_tailcall">wt_state_tailcall;</a></span> <span class="id">eauto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lbuiltin&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">BOUND</span> <span class="gallina-kwd">as</span> <span class="id">[BND1</span> <span class="id">BND2]</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_builtin_args_correct">transl_builtin_args_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. <span class="id">eauto</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eauto</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state_builtin">wt_state_builtin;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span> <span class="id">BND2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">[vargs'</span> <span class="id">[P</span> <span class="id">Q]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#external_call_parallel_rule">external_call_parallel_rule;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span> <span class="id">intros</span> (<span class="id">j'</span> &amp; <span class="id">res'</span> &amp; <span class="id">m1'</span> &amp; <span class="id">EC</span> &amp; <span class="id">RES</span> &amp; <span class="id">SEP</span> &amp; <span class="id">INCR</span> &amp; <span class="id">ISEP</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Events.html#eval_builtin_args_preserved">eval_builtin_args_preserved</a></span> <span class="gallina-kwd">with</span> (<span class="id">ge1</span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span>)<span class="id">;</span> <span class="id">eauto</span>. <span class="id">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_symbols_preserved">external_call_symbols_preserved;</a></span> <span class="id">eauto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#senv_preserved">senv_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states_intro">match_states_intro</a></span> <span class="gallina-kwd">with</span> (<span class="id">j</span> <span class="id">:=</span> <span class="id">j'</span>)<span class="id">;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_change_meminj">match_stacks_change_meminj;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_res">agree_regs_set_res;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs;</a></span> <span class="id">auto</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_inject_incr">agree_regs_inject_incr;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_res">agree_locs_set_res;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_regs">agree_locs_undef_regs;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_res">frame_set_res</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_incr">frame_contents_incr</a></span> <span class="gallina-kwd">with</span> <span class="id">j;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap2">sep_swap2</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_change_meminj">stack_contents_change_meminj</a></span> <span class="gallina-kwd">with</span> <span class="id">j;</span> <span class="id">auto</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap2">sep_swap2</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">SEP</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Llabel&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one;</a></span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mlabel">exec_Mlabel</a></span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lgoto&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one;</a></span> <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mgoto">exec_Mgoto;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_find_label">transl_find_label;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_tail">find_label_tail;</a></span> <span class="id">eauto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lcond,&nbsp;true&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mcond_true">exec_Mcond_true;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_condition_inject">eval_condition_inject</a></span> <span class="gallina-kwd">with</span> (<span class="id">m1</span> <span class="id">:=</span> <span class="id">m</span>). <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist;</a></span> <span class="id">eauto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick3">sep_pick3</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">exact</span> <span class="id">SEP</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_find_label">transl_find_label;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eauto</span>. <span class="id">eauto</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_cond_caller_save">destroyed_by_cond_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_tail">find_label_tail;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs;</a></span> <span class="id">auto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lcond,&nbsp;false&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mcond_false">exec_Mcond_false;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_condition_inject">eval_condition_inject</a></span> <span class="gallina-kwd">with</span> (<span class="id">m1</span> <span class="id">:=</span> <span class="id">m</span>). <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist;</a></span> <span class="id">eauto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick3">sep_pick3</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">exact</span> <span class="id">SEP</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eauto</span>. <span class="id">eauto</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_cond_caller_save">destroyed_by_cond_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>. <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs;</a></span> <span class="id">auto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Ljumptable&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">rs0</span> <span class="id">arg</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">generalize</span> (<span class="id">AGREGS</span> <span class="id">arg</span>). <span class="id">rewrite</span> <span class="id">H</span>. <span class="id">intro</span> <span class="id">IJ;</span> <span class="id">inv</span> <span class="id">IJ;</span> <span class="id">auto</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one;</a></span> <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mjumptable">exec_Mjumptable;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_find_label">transl_find_label;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eauto</span>. <span class="id">eauto</span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_jumptable_caller_save">destroyed_by_jumptable_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_tail">find_label_tail;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs;</a></span> <span class="id">auto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;Lreturn&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents">stack_contents</a></span> <span class="id">j</span> <span class="id">s</span> <span class="id">cs'</span>)) <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#function_epilogue_correct">function_epilogue_correct;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">rs'</span> &amp; <span class="id">m1'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_right">plus_right</a></span>. <span class="id">eexact</span> <span class="id">D</span>. <span class="id">econstructor;</span> <span class="id">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap;</a></span> <span class="id">exact</span> <span class="id">G</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;internal&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">TRANSL</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef,</a></span> <span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id">f</span>) <span class="gallina-kwd">as</span> <span class="id">[tfn|]</span> <span class="id">eqn:TRANSL;</span> <span class="id">simpl;</span> <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">EQ;</span> <span class="id">inversion</span> <span class="id">EQ;</span> <span class="id">clear</span> <span class="id">EQ;</span> <span class="id">subst</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_callstate_agree">wt_callstate_agree;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[AGCS</span> <span class="id">AGARGS]</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#function_prologue_correct">function_prologue_correct;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">red;</span> <span class="id">intros;</span> <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_callstate_wt_regs">wt_callstate_wt_regs;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_type_sp">match_stacks_type_sp;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_type_retaddr">match_stacks_type_retaddr;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">SEP;</span><br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">j'</span> &amp; <span class="id">rs'</span> &amp; <span class="id">m2'</span> &amp; <span class="id">sp'</span> &amp; <span class="id">m3'</span> &amp; <span class="id">m4'</span> &amp; <span class="id">m5'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">SEP</span> &amp; <span class="id">J</span> &amp; <span class="id">K</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm</a></span> (<span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.ge">ge</a></span> <span class="id">j'</span>)) <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> (<span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j'</span> <span class="id">m'</span>)) <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_left">plus_left</a></span>. <span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">TRANSL</span>). <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#fn_code">fn_code</a></span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_body">transl_body</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">D</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states_intro">match_states_intro</a></span> <span class="gallina-kwd">with</span> (<span class="id">j</span> <span class="id">:=</span> <span class="id">j'</span>)<span class="id">;</span> <span class="id">eauto</span> <span class="gallina-kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_change_meminj">match_stacks_change_meminj;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_change_meminj">stack_contents_change_meminj;</a></span> <span class="id">eauto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;external&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">TRANSL</span>. <span class="id">inversion</span> <span class="id">TRANSL;</span> <span class="id">subst</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_callstate_agree">wt_callstate_agree;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[AGCS</span> <span class="id">AGARGS]</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_arguments">transl_external_arguments;</a></span> <span class="id">eauto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP;</span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[vl</span> <span class="id">[ARGS</span> <span class="id">VINJ]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#external_call_parallel_rule">external_call_parallel_rule;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">j'</span> &amp; <span class="id">res'</span> &amp; <span class="id">m1'</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_function_external">exec_function_external;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_symbols_preserved">external_call_symbols_preserved;</a></span> <span class="id">eauto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#senv_preserved">senv_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states_return">match_states_return</a></span> <span class="gallina-kwd">with</span> (<span class="id">j</span> <span class="id">:=</span> <span class="id">j'</span>).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_change_meminj">match_stacks_change_meminj;</a></span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_pair">agree_regs_set_pair</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_caller_save_regs">agree_regs_undef_caller_save_regs</a></span>. <br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_inject_incr">agree_regs_inject_incr</a></span> <span class="gallina-kwd">with</span> <span class="id">j;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_change_meminj">stack_contents_change_meminj</a></span> <span class="gallina-kwd">with</span> <span class="id">j;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm,</a></span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc;</a></span> <span class="id">auto</span>.<br/>
<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKS</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_returnstate_agree">wt_returnstate_agree;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[AGCS</span> <span class="id">OUTU]</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">AGCS</span>. <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_return">exec_return</a></span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_return">agree_locs_return</a></span> <span class="gallina-kwd">with</span> <span class="id">rs0;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_exten">frame_contents_exten</a></span> <span class="gallina-kwd">with</span> <span class="id">rs0</span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id">s</span>)<span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.lessdef_same">Val.lessdef_same</a></span><span class="id">;</span> <span class="id">apply</span> <span class="id">AGCS;</span> <span class="id">red;</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">rewrite</span> (<span class="id">OUTU</span> <span class="id">ty</span> <span class="id">ofs</span>)<span class="id">;</span> <span class="id">auto</span>. <br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="transf_initial_states" class="id"><a name="transf_initial_states" class="">transf_initial_states:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="st1:784" class="id"><a name="st1:784" class="">st1,</a></span> <span class="id"><a href="compcert.backend.Linear.html#initial_state">Linear.initial_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st1:784">st1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="st2:785" class="id"><a name="st2:785" class="">st2,</a></span> <span class="id"><a href="compcert.backend.Mach.html#initial_state">Mach.initial_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tprog">tprog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st2:785">st2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st1:784">st1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st2:785">st2</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</span></div>
<div class="proofscript" id="proof102">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#function_ptr_translated">function_ptr_translated;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[tf</span> <span class="id">[FIND</span> <span class="id">TR]]</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.init_mem_transf_partial">Genv.init_mem_transf_partial</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>)<span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.common.Linking.html#match_program_main">match_program_main</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>. <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">j</span> <span class="id">:=</span> <span class="id"><a href="compcert.common.Memory.html#Mem.flat_inj">Mem.flat_inj</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m0</span>)).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states_call">match_states_call</a></span> <span class="gallina-kwd">with</span> (<span class="id">j</span> <span class="id">:=</span> <span class="id">j</span>)<span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">red;</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id">H3,</span> <span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments_main">loc_arguments_main</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id">red;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_pure">sep_pure</a></span>. <span class="id">split;</span> <span class="id">auto</span>. <span class="id">split;[|split]</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.initmem_inject">Genv.initmem_inject</a></span><span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="gallina-kwd">exists</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m0</span>)<span class="id">;</span> <span class="id">split</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">j,</span> <span class="id"><a href="compcert.common.Memory.html#Mem.flat_inj">Mem.flat_inj</a></span><span class="id">;</span> <span class="id">constructor;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_true">pred_dec_true;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">b1</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m0</span>))<span class="id">;</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m0</span> <span class="id">b0</span>). <span class="id">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_not_fresh">Genv.find_symbol_not_fresh</a></span><span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m0</span> <span class="id">b0</span>). <span class="id">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr_not_fresh">Genv.find_funct_ptr_not_fresh</a></span><span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m0</span> <span class="id">b0</span>). <span class="id">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_var_info_not_fresh">Genv.find_var_info_not_fresh</a></span><span class="id">;</span> <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">red;</span> <span class="id">simpl;</span> <span class="id">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="transf_final_states" class="id"><a name="transf_final_states" class="">transf_final_states:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="st1:786" class="id"><a name="st1:786" class="">st1</a></span> <span id="st2:787" class="id"><a name="st2:787" class="">st2</a></span> <span id="r:788" class="id"><a name="r:788" class="">r,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st1:786">st1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st2:787">st2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Linear.html#final_state">Linear.final_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st1:786">st1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:788">r</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Mach.html#final_state">Mach.final_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st2:787">st2</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:788">r</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</span></div>
<div class="proofscript" id="proof103">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">STACKS</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">R:</span> <span class="gallina-kwd">exists</span> <span id="r:790" class="id"><span id="r:789" class="id"><a name="r:790" class="">r,</a></span></span> <span class="id"><a href="compcert.x86.Conventions1.html#loc_result">loc_result</a></span> <span class="id"><a href="compcert.common.AST.html#signature_main">signature_main</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.common.AST.html#One">One</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r:789">r</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result">loc_result</a></span> <span class="id"><a href="compcert.common.AST.html#signature_main">signature_main</a></span>) <span class="gallina-kwd">as</span> <span class="id">[r1</span> <span class="id">|</span> <span class="id">r1</span> <span class="id">r2]</span> <span class="id">eqn:LR</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">exists</span> <span class="id">r1;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">generalize</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result_type">loc_result_type</a></span> <span class="id"><a href="compcert.common.AST.html#signature_main">signature_main</a></span>). <span class="id">rewrite</span> <span class="id">LR</span>. <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">R</span> <span class="gallina-kwd">as</span> <span class="id">[rres</span> <span class="id">EQ]</span>. <span class="id">rewrite</span> <span class="id">EQ</span> <span class="gallina-kwd">in</span> <span class="id">H1</span>. <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id">AGREGS</span> <span class="id">rres</span>). <span class="id">rewrite</span> <span class="id">H1</span>. <span class="id">intros</span> <span class="id">A;</span> <span class="id">inv</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor;</span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="wt_prog" class="id"><a name="wt_prog" class="">wt_prog:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="i:791" class="id"><a name="i:791" class="">i</a></span> <span id="fd:792" class="id"><a name="fd:792" class="">fd,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#i:791">i,</a></span> <span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fd:792">fd</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_defs">prog_defs</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_fundef">wt_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fd:792">fd</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</span></div>
<div class="proofscript" id="proof104">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2_in_left">list_forall2_in_left</a></span>. <span class="id">eexact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>). <span class="id">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> (<span class="id">[i'</span> <span class="id">g]</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>). <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">*</span>. <span class="id">inv</span> <span class="id">R</span>. <span class="id">destruct</span> <span class="id">fd;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
<span class="id">-</span> <span class="id">monadInv</span> <span class="id">H2</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="gallina-kwd">in</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id">f</span>). <span class="id">auto</span>. <span class="id">discriminate</span>.<br/>
<span class="id">-</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="transf_program_correct" class="id"><a name="transf_program_correct" class="">transf_program_correct:</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#forward_simulation">forward_simulation</a></span> (<span class="id"><a href="compcert.backend.Linear.html#semantics">Linear.semantics</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#semantics">Mach.semantics</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.return_address_offset">return_address_offset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tprog">tprog</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</span></div>
<div class="proofscript" id="proof105">
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">ms</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="s:795" class="id"><span id="s:793" class="id"><a name="s:795" class="">s</a></span></span> <span id="s':796" class="id"><span id="s':794" class="id"><a name="s':796" class="">s'</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state">wt_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s:793">s</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s:793">s</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s':794">s'</a></span>).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#forward_simulation_plus">forward_simulation_plus</a></span> <span class="gallina-kwd">with</span> (<span class="id">match_states</span> <span class="id">:=</span> <span class="id">ms</span>).<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#senv_preserved">senv_preserved</a></span>.<br/>
<span class="id">-</span> <span class="id">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transf_initial_states">transf_initial_states;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[st2</span> <span class="id">[A</span> <span class="id">B]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">st2;</span> <span class="id">split;</span> <span class="id">auto</span>. <span class="id">split;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_initial_state">wt_initial_state</a></span> <span class="gallina-kwd">with</span> (<span class="id">prog</span> <span class="id">:=</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>)<span class="id">;</span> <span class="id">auto</span>. <span class="id">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#wt_prog">wt_prog</a></span>.<br/>
<span class="id">-</span> <span class="id">intros</span>. <span class="id">destruct</span> <span class="id">H</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transf_final_states">transf_final_states;</a></span> <span class="id">eauto</span>.<br/>
<span class="id">-</span> <span class="id">intros</span>. <span class="id">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transf_step_correct">transf_step_correct;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[s2'</span> <span class="id">[A</span> <span class="id">B]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">s2';</span> <span class="id">split</span>. <span class="id">exact</span> <span class="id">A</span>. <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#step_type_preservation">step_type_preservation;</a></span> <span class="id">eauto</span>. <span class="id">eexact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#wt_prog">wt_prog</a></span>. <span class="id">eexact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION">PRESERVATION</a></span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
