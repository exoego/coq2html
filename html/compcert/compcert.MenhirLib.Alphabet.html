
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Alphabet</title>
<meta name="description" content="Documentation of Coq module Alphabet" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="compcert"><summary>compcert</summary>
          <ul>
          <li><details id="compcert.backend"><summary>backend</summary>
          <ul>
          <li><a href="compcert.backend.Allocation.html">Allocation</a></li>
<li><a href="compcert.backend.Allocproof.html">Allocproof</a></li>
<li><a href="compcert.backend.Asmgenproof0.html">Asmgenproof0</a></li>
<li><a href="compcert.backend.Bounds.html">Bounds</a></li>
<li><a href="compcert.backend.CleanupLabels.html">CleanupLabels</a></li>
<li><a href="compcert.backend.CleanupLabelsproof.html">CleanupLabelsproof</a></li>
<li><a href="compcert.backend.Cminor.html">Cminor</a></li>
<li><a href="compcert.backend.CminorSel.html">CminorSel</a></li>
<li><a href="compcert.backend.Cminortyping.html">Cminortyping</a></li>
<li><a href="compcert.backend.Constprop.html">Constprop</a></li>
<li><a href="compcert.backend.Constpropproof.html">Constpropproof</a></li>
<li><a href="compcert.backend.Conventions.html">Conventions</a></li>
<li><a href="compcert.backend.CSE.html">CSE</a></li>
<li><a href="compcert.backend.CSEdomain.html">CSEdomain</a></li>
<li><a href="compcert.backend.CSEproof.html">CSEproof</a></li>
<li><a href="compcert.backend.Deadcode.html">Deadcode</a></li>
<li><a href="compcert.backend.Deadcodeproof.html">Deadcodeproof</a></li>
<li><a href="compcert.backend.Debugvar.html">Debugvar</a></li>
<li><a href="compcert.backend.Debugvarproof.html">Debugvarproof</a></li>
<li><a href="compcert.backend.Inlining.html">Inlining</a></li>
<li><a href="compcert.backend.Inliningproof.html">Inliningproof</a></li>
<li><a href="compcert.backend.Inliningspec.html">Inliningspec</a></li>
<li><a href="compcert.backend.Kildall.html">Kildall</a></li>
<li><a href="compcert.backend.Linear.html">Linear</a></li>
<li><a href="compcert.backend.Linearize.html">Linearize</a></li>
<li><a href="compcert.backend.Linearizeproof.html">Linearizeproof</a></li>
<li><a href="compcert.backend.Lineartyping.html">Lineartyping</a></li>
<li><a href="compcert.backend.Liveness.html">Liveness</a></li>
<li><a href="compcert.backend.Locations.html">Locations</a></li>
<li><a href="compcert.backend.LTL.html">LTL</a></li>
<li><a href="compcert.backend.Mach.html">Mach</a></li>
<li><a href="compcert.backend.NeedDomain.html">NeedDomain</a></li>
<li><a href="compcert.backend.Registers.html">Registers</a></li>
<li><a href="compcert.backend.Renumber.html">Renumber</a></li>
<li><a href="compcert.backend.Renumberproof.html">Renumberproof</a></li>
<li><a href="compcert.backend.RTL.html">RTL</a></li>
<li><a href="compcert.backend.RTLgen.html">RTLgen</a></li>
<li><a href="compcert.backend.RTLgenproof.html">RTLgenproof</a></li>
<li><a href="compcert.backend.RTLgenspec.html">RTLgenspec</a></li>
<li><a href="compcert.backend.RTLtyping.html">RTLtyping</a></li>
<li><a href="compcert.backend.SelectDiv.html">SelectDiv</a></li>
<li><a href="compcert.backend.SelectDivproof.html">SelectDivproof</a></li>
<li><a href="compcert.backend.Selection.html">Selection</a></li>
<li><a href="compcert.backend.Selectionproof.html">Selectionproof</a></li>
<li><a href="compcert.backend.SplitLong.html">SplitLong</a></li>
<li><a href="compcert.backend.SplitLongproof.html">SplitLongproof</a></li>
<li><a href="compcert.backend.Stacking.html">Stacking</a></li>
<li><a href="compcert.backend.Stackingproof.html">Stackingproof</a></li>
<li><a href="compcert.backend.Tailcall.html">Tailcall</a></li>
<li><a href="compcert.backend.Tailcallproof.html">Tailcallproof</a></li>
<li><a href="compcert.backend.Tunneling.html">Tunneling</a></li>
<li><a href="compcert.backend.Tunnelingproof.html">Tunnelingproof</a></li>
<li><a href="compcert.backend.Unusedglob.html">Unusedglob</a></li>
<li><a href="compcert.backend.Unusedglobproof.html">Unusedglobproof</a></li>
<li><a href="compcert.backend.ValueAnalysis.html">ValueAnalysis</a></li>
<li><a href="compcert.backend.ValueDomain.html">ValueDomain</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.cfrontend"><summary>cfrontend</summary>
          <ul>
          <li><a href="compcert.cfrontend.Cexec.html">Cexec</a></li>
<li><a href="compcert.cfrontend.Clight.html">Clight</a></li>
<li><a href="compcert.cfrontend.ClightBigstep.html">ClightBigstep</a></li>
<li><a href="compcert.cfrontend.Cminorgen.html">Cminorgen</a></li>
<li><a href="compcert.cfrontend.Cminorgenproof.html">Cminorgenproof</a></li>
<li><a href="compcert.cfrontend.Cop.html">Cop</a></li>
<li><a href="compcert.cfrontend.Csem.html">Csem</a></li>
<li><a href="compcert.cfrontend.Csharpminor.html">Csharpminor</a></li>
<li><a href="compcert.cfrontend.Cshmgen.html">Cshmgen</a></li>
<li><a href="compcert.cfrontend.Cshmgenproof.html">Cshmgenproof</a></li>
<li><a href="compcert.cfrontend.Cstrategy.html">Cstrategy</a></li>
<li><a href="compcert.cfrontend.Csyntax.html">Csyntax</a></li>
<li><a href="compcert.cfrontend.Ctypes.html">Ctypes</a></li>
<li><a href="compcert.cfrontend.Ctyping.html">Ctyping</a></li>
<li><a href="compcert.cfrontend.Initializers.html">Initializers</a></li>
<li><a href="compcert.cfrontend.Initializersproof.html">Initializersproof</a></li>
<li><a href="compcert.cfrontend.SimplExpr.html">SimplExpr</a></li>
<li><a href="compcert.cfrontend.SimplExprproof.html">SimplExprproof</a></li>
<li><a href="compcert.cfrontend.SimplExprspec.html">SimplExprspec</a></li>
<li><a href="compcert.cfrontend.SimplLocals.html">SimplLocals</a></li>
<li><a href="compcert.cfrontend.SimplLocalsproof.html">SimplLocalsproof</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.common"><summary>common</summary>
          <ul>
          <li><a href="compcert.common.AST.html">AST</a></li>
<li><a href="compcert.common.Behaviors.html">Behaviors</a></li>
<li><a href="compcert.common.Builtins.html">Builtins</a></li>
<li><a href="compcert.common.Builtins0.html">Builtins0</a></li>
<li><a href="compcert.common.Determinism.html">Determinism</a></li>
<li><a href="compcert.common.Errors.html">Errors</a></li>
<li><a href="compcert.common.Events.html">Events</a></li>
<li><a href="compcert.common.Globalenvs.html">Globalenvs</a></li>
<li><a href="compcert.common.Linking.html">Linking</a></li>
<li><a href="compcert.common.Memdata.html">Memdata</a></li>
<li><a href="compcert.common.Memory.html">Memory</a></li>
<li><a href="compcert.common.Memtype.html">Memtype</a></li>
<li><a href="compcert.common.Separation.html">Separation</a></li>
<li><a href="compcert.common.Smallstep.html">Smallstep</a></li>
<li><a href="compcert.common.Switch.html">Switch</a></li>
<li><a href="compcert.common.Unityping.html">Unityping</a></li>
<li><a href="compcert.common.Values.html">Values</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.cparser"><summary>cparser</summary>
          <ul>
          <li><a href="compcert.cparser.Cabs.html">Cabs</a></li>
<li><a href="compcert.cparser.Parser.html">Parser</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.driver"><summary>driver</summary>
          <ul>
          <li><a href="compcert.driver.Compiler.html">Compiler</a></li>
<li><a href="compcert.driver.Complements.html">Complements</a></li>
<li><a href="compcert.driver.Compopts.html">Compopts</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.lib"><summary>lib</summary>
          <ul>
          <li><a href="compcert.lib.Axioms.html">Axioms</a></li>
<li><a href="compcert.lib.BoolEqual.html">BoolEqual</a></li>
<li><a href="compcert.lib.Coqlib.html">Coqlib</a></li>
<li><a href="compcert.lib.Decidableplus.html">Decidableplus</a></li>
<li><a href="compcert.lib.Floats.html">Floats</a></li>
<li><a href="compcert.lib.FSetAVLplus.html">FSetAVLplus</a></li>
<li><a href="compcert.lib.Heaps.html">Heaps</a></li>
<li><a href="compcert.lib.IEEE754_extra.html">IEEE754_extra</a></li>
<li><a href="compcert.lib.Integers.html">Integers</a></li>
<li><a href="compcert.lib.Intv.html">Intv</a></li>
<li><a href="compcert.lib.IntvSets.html">IntvSets</a></li>
<li><a href="compcert.lib.Iteration.html">Iteration</a></li>
<li><a href="compcert.lib.Lattice.html">Lattice</a></li>
<li><a href="compcert.lib.Maps.html">Maps</a></li>
<li><a href="compcert.lib.Ordered.html">Ordered</a></li>
<li><a href="compcert.lib.Parmov.html">Parmov</a></li>
<li><a href="compcert.lib.Postorder.html">Postorder</a></li>
<li><a href="compcert.lib.UnionFind.html">UnionFind</a></li>
<li><a href="compcert.lib.Wfsimpl.html">Wfsimpl</a></li>
<li><a href="compcert.lib.Zbits.html">Zbits</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.x86"><summary>x86</summary>
          <ul>
          <li><a href="compcert.x86.Asm.html">Asm</a></li>
<li><a href="compcert.x86.Asmgen.html">Asmgen</a></li>
<li><a href="compcert.x86.Asmgenproof.html">Asmgenproof</a></li>
<li><a href="compcert.x86.Asmgenproof1.html">Asmgenproof1</a></li>
<li><a href="compcert.x86.Builtins1.html">Builtins1</a></li>
<li><a href="compcert.x86.CombineOp.html">CombineOp</a></li>
<li><a href="compcert.x86.CombineOpproof.html">CombineOpproof</a></li>
<li><a href="compcert.x86.ConstpropOp.html">ConstpropOp</a></li>
<li><a href="compcert.x86.ConstpropOpproof.html">ConstpropOpproof</a></li>
<li><a href="compcert.x86.Conventions1.html">Conventions1</a></li>
<li><a href="compcert.x86.Machregs.html">Machregs</a></li>
<li><a href="compcert.x86.NeedOp.html">NeedOp</a></li>
<li><a href="compcert.x86.Op.html">Op</a></li>
<li><a href="compcert.x86.SelectLong.html">SelectLong</a></li>
<li><a href="compcert.x86.SelectLongproof.html">SelectLongproof</a></li>
<li><a href="compcert.x86.SelectOp.html">SelectOp</a></li>
<li><a href="compcert.x86.SelectOpproof.html">SelectOpproof</a></li>
<li><a href="compcert.x86.Stacklayout.html">Stacklayout</a></li>
<li><a href="compcert.x86.ValueAOp.html">ValueAOp</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.x86_64"><summary>x86_64</summary>
          <ul>
          <li><a href="compcert.x86_64.Archi.html">Archi</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Flocq"><summary>Flocq</summary>
          <ul>
          <li><details id="Flocq.Calc"><summary>Calc</summary>
          <ul>
          <li><a href="Flocq.Calc.Bracket.html">Bracket</a></li>
<li><a href="Flocq.Calc.Div.html">Div</a></li>
<li><a href="Flocq.Calc.Operations.html">Operations</a></li>
<li><a href="Flocq.Calc.Plus.html">Plus</a></li>
<li><a href="Flocq.Calc.Round.html">Round</a></li>
<li><a href="Flocq.Calc.Sqrt.html">Sqrt</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.Core"><summary>Core</summary>
          <ul>
          <li><a href="Flocq.Core.Core.html">Core</a></li>
<li><a href="Flocq.Core.Defs.html">Defs</a></li>
<li><a href="Flocq.Core.Digits.html">Digits</a></li>
<li><a href="Flocq.Core.FIX.html">FIX</a></li>
<li><a href="Flocq.Core.Float_prop.html">Float_prop</a></li>
<li><a href="Flocq.Core.FLT.html">FLT</a></li>
<li><a href="Flocq.Core.FLX.html">FLX</a></li>
<li><a href="Flocq.Core.FTZ.html">FTZ</a></li>
<li><a href="Flocq.Core.Generic_fmt.html">Generic_fmt</a></li>
<li><a href="Flocq.Core.Raux.html">Raux</a></li>
<li><a href="Flocq.Core.Round_NE.html">Round_NE</a></li>
<li><a href="Flocq.Core.Round_pred.html">Round_pred</a></li>
<li><a href="Flocq.Core.Ulp.html">Ulp</a></li>
<li><a href="Flocq.Core.Zaux.html">Zaux</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.IEEE754"><summary>IEEE754</summary>
          <ul>
          <li><a href="Flocq.IEEE754.Binary.html">Binary</a></li>
<li><a href="Flocq.IEEE754.BinarySingleNaN.html">BinarySingleNaN</a></li>
<li><a href="Flocq.IEEE754.Bits.html">Bits</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.Prop"><summary>Prop</summary>
          <ul>
          <li><a href="Flocq.Prop.Div_sqrt_error.html">Div_sqrt_error</a></li>
<li><a href="Flocq.Prop.Double_rounding.html">Double_rounding</a></li>
<li><a href="Flocq.Prop.Mult_error.html">Mult_error</a></li>
<li><a href="Flocq.Prop.Plus_error.html">Plus_error</a></li>
<li><a href="Flocq.Prop.Relative.html">Relative</a></li>
<li><a href="Flocq.Prop.Round_odd.html">Round_odd</a></li>
<li><a href="Flocq.Prop.Sterbenz.html">Sterbenz</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="MenhirLib"><summary>MenhirLib</summary>
          <ul>
          <li><a href="MenhirLib.Alphabet.html">Alphabet</a></li>
<li><a href="MenhirLib.Automaton.html">Automaton</a></li>
<li><a href="MenhirLib.Grammar.html">Grammar</a></li>
<li><a href="MenhirLib.Interpreter.html">Interpreter</a></li>
<li><a href="MenhirLib.Interpreter_complete.html">Interpreter_complete</a></li>
<li><a href="MenhirLib.Interpreter_correct.html">Interpreter_correct</a></li>
<li><a href="MenhirLib.Main.html">Main</a></li>
<li><a href="MenhirLib.Validator_classes.html">Validator_classes</a></li>
<li><a href="MenhirLib.Validator_complete.html">Validator_complete</a></li>
<li><a href="MenhirLib.Validator_safe.html">Validator_safe</a></li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module Alphabet</h1>
<pre class="ssrdoc">
                                                                         
                                  Menhir                                 
                                                                         
          Jacques-Henri Jourdan, CNRS, LRI, Université Paris Sud         
                                                                         
 Copyright Inria. All rights reserved. This file is distributed under    
 the terms of the GNU Lesser General Public License as published by the  
 Free Software Foundation, either version 3 of the License, or (at your  
 option) any later version, as described in the file LICENSE.            
                                                                         
</pre>
<br/>
<span class="vernacular">From</span> <span class="id">Coq</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">ZArith</span> <span class="id">List</span> <span class="id">Relations</span> <span class="id">RelationClasses</span>.<br/>
<span class="vernacular">Import</span> <span class="id">ListNotations</span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Obligation</span> <span class="vernacular">Tactic</span> <span class="id">:=</span> <span class="id">intros</span>.<br/>
<br/>
<div class="doc">A comparable type is equiped with a <span class="bracket"><span class="id">compare</span></span> function, that define an order
   relation. *</div>
<span class="vernacular">Class</span> <span class="id">Comparable</span> (<span class="id">A:Type</span>) <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">compare</span> <span class="id">:</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">comparison;</span><br/>
&nbsp;&nbsp;<span class="id">compare_antisym</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">x</span> <span class="id">y,</span> <span class="id">CompOpp</span> (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>) <span class="id">=</span> <span class="id">compare</span> <span class="id">y</span> <span class="id">x;</span><br/>
&nbsp;&nbsp;<span class="id">compare_trans</span> <span class="id">:</span>  <span class="gallina-kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">c,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>) <span class="id">=</span> <span class="id">c</span> <span class="id">-&gt;</span> (<span class="id">compare</span> <span class="id">y</span> <span class="id">z</span>) <span class="id">=</span> <span class="id">c</span> <span class="id">-&gt;</span> (<span class="id">compare</span> <span class="id">x</span> <span class="id">z</span>) <span class="id">=</span> <span class="id">c</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span class="id">compare_refl</span> <span class="id">{A:Type}</span> (<span class="id">C:</span> <span class="id">Comparable</span> <span class="id">A</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">x,</span> <span class="id">compare</span> <span class="id">x</span> <span class="id">x</span> <span class="id">=</span> <span class="id">Eq</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">intros</span>.<br/>
<span class="id">pose</span> <span class="id">proof</span> (<span class="id">compare_antisym</span> <span class="id">x</span> <span class="id">x</span>).<br/>
<span class="id">destruct</span> (<span class="id">compare</span> <span class="id">x</span> <span class="id">x</span>)<span class="id">;</span> <span class="id">intuition;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The corresponding order is a strict order. *</div>
<span class="vernacular">Definition</span> <span class="id">comparableLt</span> <span class="id">{A:Type}</span> (<span class="id">C:</span> <span class="id">Comparable</span> <span class="id">A</span>) <span class="id">:</span> <span class="id">relation</span> <span class="id">A</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span class="id">x</span> <span class="id">y</span> <span class="id">=&gt;</span> <span class="id">compare</span> <span class="id">x</span> <span class="id">y</span> <span class="id">=</span> <span class="id">Lt</span>.<br/>
<br/>
<span class="id">Global</span> <span class="vernacular">Instance</span> <span class="id">ComparableLtStrictOrder</span> <span class="id">{A:Type}</span> (<span class="id">C:</span> <span class="id">Comparable</span> <span class="id">A</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">StrictOrder</span> (<span class="id">comparableLt</span> <span class="id">C</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">apply</span> <span class="id">Build_StrictOrder</span>.<br/>
<span class="id">unfold</span> <span class="id">Irreflexive,</span> <span class="id">Reflexive,</span> <span class="id">complement,</span> <span class="id">comparableLt</span>.<br/>
<span class="id">intros</span>.<br/>
<span class="id">pose</span> <span class="id">proof</span> <span class="id">H</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">compare_antisym</span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
<span class="id">rewrite</span> <span class="id">H0</span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
<span class="id">discriminate</span> <span class="id">H</span>.<br/>
<span class="id">unfold</span> <span class="id">Transitive,</span> <span class="id">comparableLt</span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>.<br/>
<span class="id">apply</span> <span class="id">compare_trans</span>.<br/>
Qed.</div>
<br/>
<div class="doc">nat is comparable. *</div>
<span class="id">Global</span> <span class="id">Program</span> <span class="vernacular">Instance</span> <span class="id">natComparable</span> <span class="id">:</span> <span class="id">Comparable</span> <span class="id">nat</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">compare</span> <span class="id">:=</span> <span class="id">Nat.compare</span> <span class="id">}</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Next Obligation.</span></div>
<div class="proofscript" id="proof3">
<span class="id">symmetry</span>.<br/>
<span class="id">destruct</span> (<span class="id">Nat.compare</span> <span class="id">x</span> <span class="id">y</span>)  <span class="gallina-kwd">as</span> <span class="id">[]</span> <span class="id">eqn:?</span>.<br/>
<span class="id">rewrite</span> <span class="id">Nat.compare_eq_iff</span> <span class="gallina-kwd">in</span> <span class="id">Heqc</span>.<br/>
<span class="id">destruct</span> <span class="id">Heqc</span>.<br/>
<span class="id">rewrite</span> <span class="id">Nat.compare_eq_iff</span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">nat_compare_lt</span> <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">nat_compare_gt</span> <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
<span class="id">trivial</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">nat_compare_lt</span> <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">nat_compare_gt</span> <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
<span class="id">trivial</span>.<br/>
Qed.</div>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Next Obligation.</span></div>
<div class="proofscript" id="proof4">
<span class="id">destruct</span> <span class="id">c</span>.<br/>
<span class="id">rewrite</span> <span class="id">Nat.compare_eq_iff</span> <span class="gallina-kwd">in</span> <span class="id">*;</span> <span class="id">destruct</span> <span class="id">H;</span> <span class="id">assumption</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">nat_compare_lt</span> <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
<span class="id">apply</span> (<span class="id">Nat.lt_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H0</span>).<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">nat_compare_gt</span> <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
<span class="id">apply</span> (<span class="id">gt_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H0</span>).<br/>
Qed.</div>
<br/>
<div class="doc">A pair of comparable is comparable. *</div>
<span class="id">Global</span> <span class="id">Program</span> <span class="vernacular">Instance</span> <span class="id">PairComparable</span> <span class="id">{A:Type}</span> (<span class="id">CA:Comparable</span> <span class="id">A</span>) <span class="id">{B:Type}</span> (<span class="id">CB:Comparable</span> <span class="id">B</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">Comparable</span> (<span class="id">A*B</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">compare</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span class="id">x</span> <span class="id">y</span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> (<span class="id">xa,</span> <span class="id">xb</span>) <span class="id">:=</span> <span class="id">x</span> <span class="gallina-kwd">in</span> <span class="gallina-kwd">let</span> (<span class="id">ya,</span> <span class="id">yb</span>) <span class="id">:=</span> <span class="id">y</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id">compare</span> <span class="id">xa</span> <span class="id">ya</span> <span class="gallina-kwd">return</span> <span class="id">comparison</span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id">Eq</span> <span class="id">=&gt;</span> <span class="id">compare</span> <span class="id">xb</span> <span class="id">yb</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id">x</span> <span class="id">=&gt;</span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">end</span> <span class="id">}</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Next Obligation.</span></div>
<div class="proofscript" id="proof5">
<span class="id">destruct</span> <span class="id">x,</span> <span class="id">y</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id">compare_antisym</span> <span class="id">a</span> <span class="id">a0</span>).<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id">compare_antisym</span> <span class="id">b</span> <span class="id">b0</span>).<br/>
<span class="id">destruct</span> (<span class="id">compare</span> <span class="id">a</span> <span class="id">a0</span>)<span class="id">;</span> <span class="id">intuition</span>.<br/>
Qed.</div>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Next Obligation.</span></div>
<div class="proofscript" id="proof6">
<span class="id">destruct</span> <span class="id">x,</span> <span class="id">y,</span> <span class="id">z</span>.<br/>
<span class="id">destruct</span> (<span class="id">compare</span> <span class="id">a</span> <span class="id">a0</span>) <span class="gallina-kwd">as</span> <span class="id">[]</span> <span class="id">eqn:?,</span> (<span class="id">compare</span> <span class="id">a0</span> <span class="id">a1</span>) <span class="gallina-kwd">as</span> <span class="id">[]</span> <span class="id">eqn:?;</span><br/>
<span class="id">try</span> (<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H0</span> <span class="gallina-kwd">in</span> <span class="id">H;</span> <span class="id">discriminate</span>)<span class="id">;</span><br/>
<span class="id">try</span> (<span class="id">destruct</span> (<span class="id">compare</span> <span class="id">a</span> <span class="id">a1</span>) <span class="gallina-kwd">as</span> <span class="id">[]</span> <span class="id">eqn:?;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> (<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">compare_antisym</span> <span class="gallina-kwd">in</span> <span class="id">Heqc0;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">CompOpp_iff</span> <span class="gallina-kwd">in</span> <span class="id">Heqc0;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">compare_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>  <span class="id">_</span> <span class="id">Heqc0</span> <span class="id">Heqc2</span>) <span class="gallina-kwd">in</span> <span class="id">Heqc1;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">discriminate</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> (<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">compare_antisym</span> <span class="gallina-kwd">in</span> <span class="id">Heqc1;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">CompOpp_iff</span> <span class="gallina-kwd">in</span> <span class="id">Heqc1;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">compare_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heqc2</span> <span class="id">Heqc1</span>) <span class="gallina-kwd">in</span> <span class="id">Heqc0;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">discriminate</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">assumption</span>)<span class="id">;</span><br/>
<span class="id">rewrite</span> (<span class="id">compare_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Heqc0</span> <span class="id">Heqc1</span>)<span class="id">;</span><br/>
<span class="id">try</span> <span class="id">assumption</span>.<br/>
<span class="id">apply</span> (<span class="id">compare_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H0</span>).<br/>
Qed.</div>
<br/>
<div class="doc">Special case of comparable, where equality is Leibniz equality. *</div>
<span class="vernacular">Class</span> <span class="id">ComparableLeibnizEq</span> <span class="id">{A:Type}</span> (<span class="id">C:</span> <span class="id">Comparable</span> <span class="id">A</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">compare_eq</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">x</span> <span class="id">y,</span> <span class="id">compare</span> <span class="id">x</span> <span class="id">y</span> <span class="id">=</span> <span class="id">Eq</span> <span class="id">-&gt;</span> <span class="id">x</span> <span class="id">=</span> <span class="id">y</span>.<br/>
<br/>
<div class="doc">Boolean equality for a <span class="bracket"><span class="id">Comparable</span></span>. *</div>
<span class="vernacular">Definition</span> <span class="id">compare_eqb</span> <span class="id">{A:Type}</span> <span class="id">{C:Comparable</span> <span class="id">A}</span> (<span class="id">x</span> <span class="id">y:A</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id">compare</span> <span class="id">x</span> <span class="id">y</span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id">Eq</span> <span class="id">=&gt;</span> <span class="id">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">false</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span class="id">compare_eqb_iff</span> <span class="id">{A:Type}</span> <span class="id">{C:Comparable</span> <span class="id">A}</span> <span class="id">{U:ComparableLeibnizEq</span> <span class="id">C}</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">x</span> <span class="id">y,</span> <span class="id">compare_eqb</span> <span class="id">x</span> <span class="id">y</span> <span class="id">=</span> <span class="id">true</span> <span class="id">&lt;-&gt;</span> <span class="id">x</span> <span class="id">=</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">unfold</span> <span class="id">compare_eqb</span>.<br/>
<span class="id">intuition</span>.<br/>
<span class="id">apply</span> <span class="id">compare_eq</span>.<br/>
<span class="id">destruct</span> (<span class="id">compare</span> <span class="id">x</span> <span class="id">y</span>)<span class="id">;</span> <span class="id">intuition;</span> <span class="id">discriminate</span>.<br/>
<span class="id">destruct</span> <span class="id">H</span>.<br/>
<span class="id">rewrite</span> <span class="id">compare_refl;</span> <span class="id">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="id">Global</span> <span class="vernacular">Instance</span> <span class="id">NComparableLeibnizEq</span> <span class="id">:</span> <span class="id">ComparableLeibnizEq</span> <span class="id">natComparable</span> <span class="id">:=</span> <span class="id">Nat.compare_eq</span>.<br/>
<br/>
<div class="doc">A pair of ComparableLeibnizEq is ComparableLeibnizEq *</div>
<span class="id">Global</span> <span class="vernacular">Instance</span> <span class="id">PairComparableLeibnizEq</span><br/>
&nbsp;&nbsp;<span class="id">{A:Type}</span> <span class="id">{CA:Comparable</span> <span class="id">A}</span> (<span class="id">UA:ComparableLeibnizEq</span> <span class="id">CA</span>)<br/>
&nbsp;&nbsp;<span class="id">{B:Type}</span> <span class="id">{CB:Comparable</span> <span class="id">B}</span> (<span class="id">UB:ComparableLeibnizEq</span> <span class="id">CB</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ComparableLeibnizEq</span> (<span class="id">PairComparable</span> <span class="id">CA</span> <span class="id">CB</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">intros</span> <span class="id">x</span> <span class="id">y;</span> <span class="id">destruct</span> <span class="id">x,</span> <span class="id">y;</span> <span class="id">simpl</span>.<br/>
<span class="id">pose</span> <span class="id">proof</span> (<span class="id">compare_eq</span> <span class="id">a</span> <span class="id">a0</span>)<span class="id">;</span> <span class="id">pose</span> <span class="id">proof</span> (<span class="id">compare_eq</span> <span class="id">b</span> <span class="id">b0</span>).<br/>
<span class="id">destruct</span> (<span class="id">compare</span> <span class="id">a</span> <span class="id">a0</span>)<span class="id">;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
<span class="id">intuition</span>.<br/>
<span class="id">destruct</span> <span class="id">H2,</span> <span class="id">H0</span>.<br/>
<span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<div class="doc">An <span class="bracket"><span class="id">Finite</span></span> type is a type with the list of all elements. *</div>
<span class="vernacular">Class</span> <span class="id">Finite</span> (<span class="id">A:Type</span>) <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">all_list</span> <span class="id">:</span> <span class="id">list</span> <span class="id">A;</span><br/>
&nbsp;&nbsp;<span class="id">all_list_forall</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">x:A,</span> <span class="id">In</span> <span class="id">x</span> <span class="id">all_list</span><br/>
<span class="id">}</span>.<br/>
<br/>
<div class="doc">An alphabet is both <span class="bracket"><span class="id">ComparableLeibnizEq</span></span> and <span class="bracket"><span class="id">Finite</span></span>. *</div>
<span class="vernacular">Class</span> <span class="id">Alphabet</span> (<span class="id">A:Type</span>) <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">AlphabetComparable</span> <span class="id">:&gt;</span> <span class="id">Comparable</span> <span class="id">A;</span><br/>
&nbsp;&nbsp;<span class="id">AlphabetComparableLeibnizEq</span> <span class="id">:&gt;</span> <span class="id">ComparableLeibnizEq</span> <span class="id">AlphabetComparable;</span><br/>
&nbsp;&nbsp;<span class="id">AlphabetFinite</span> <span class="id">:&gt;</span> <span class="id">Finite</span> <span class="id">A</span><br/>
<span class="id">}</span>.<br/>
<br/>
<div class="doc">The <span class="bracket"><span class="id">Numbered</span></span> class provides a conveniant way to build <span class="bracket"><span class="id">Alphabet</span></span> instances,
   with a good computationnal complexity. It is mainly a injection from it to
   <span class="bracket"><span class="id">positive</span></span> *</div>
<span class="vernacular">Class</span> <span class="id">Numbered</span> (<span class="id">A:Type</span>) <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">inj</span> <span class="id">:</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">positive;</span><br/>
&nbsp;&nbsp;<span class="id">surj</span> <span class="id">:</span> <span class="id">positive</span> <span class="id">-&gt;</span> <span class="id">A;</span><br/>
&nbsp;&nbsp;<span class="id">surj_inj_compat</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">x,</span> <span class="id">surj</span> (<span class="id">inj</span> <span class="id">x</span>) <span class="id">=</span> <span class="id">x;</span><br/>
&nbsp;&nbsp;<span class="id">inj_bound</span> <span class="id">:</span> <span class="id">positive;</span><br/>
&nbsp;&nbsp;<span class="id">inj_bound_spec</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">x,</span> (<span class="id">inj</span> <span class="id">x</span> <span class="id">&lt;</span> <span class="id">Pos.succ</span> <span class="id">inj_bound</span>)%<span class="id">positive</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="id">Global</span> <span class="id">Program</span> <span class="vernacular">Instance</span> <span class="id">NumberedAlphabet</span> <span class="id">{A:Type}</span> (<span class="id">N:Numbered</span> <span class="id">A</span>) <span class="id">:</span> <span class="id">Alphabet</span> <span class="id">A</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">AlphabetComparable</span> <span class="id">:=</span> <span class="id">{|</span> <span class="id">compare</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span class="id">x</span> <span class="id">y</span> <span class="id">=&gt;</span> <span class="id">Pos.compare</span> (<span class="id">inj</span> <span class="id">x</span>) (<span class="id">inj</span> <span class="id">y</span>) <span class="id">|};</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">AlphabetFinite</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{|</span> <span class="id">all_list</span> <span class="id">:=</span> <span class="id">fst</span> (<span class="id">Pos.iter</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span class="id">l,</span> <span class="id">p</span>) <span class="id">=&gt;</span> (<span class="id">surj</span> <span class="id">p::l,</span> <span class="id">Pos.succ</span> <span class="id">p</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">[],</span> <span class="id">1</span>%<span class="id">positive</span>) <span class="id">inj_bound</span>) <span class="id">|}</span> <span class="id">}</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Next Obligation.</span></div>
<div class="proofscript" id="proof9">
 <span class="id">simpl</span>. <span class="id">now</span> <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">Pos.compare_antisym</span>. Qed.</div>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Next Obligation.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id">goal</span> <span class="gallina-kwd">with</span> <span class="id">c</span> <span class="id">:</span> <span class="id">comparison</span> <span class="id">|-</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">destruct</span> <span class="id">c</span> <span class="gallina-kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">Pos.compare_eq_iff</span> <span class="gallina-kwd">in</span> <span class="id">*</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">Pos.compare_lt_iff</span> <span class="gallina-kwd">in</span> <span class="id">*</span>. <span class="id">eauto</span> <span class="gallina-kwd">using</span> <span class="id">Pos.lt_trans</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">Pos.compare_gt_iff</span> <span class="gallina-kwd">in</span> <span class="id">*</span>. <span class="id">eauto</span> <span class="gallina-kwd">using</span> <span class="id">Pos.lt_trans</span>.<br/>
Qed.</div>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Next Obligation.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span>. <span class="id">unfold</span> <span class="id">compare</span>. <span class="id">intros</span> <span class="id">Hxy</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">Hxy'</span> <span class="id">:</span> <span class="id">inj</span> <span class="id">x</span> <span class="id">=</span> <span class="id">inj</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;do&nbsp;not&nbsp;use&nbsp;[Pos.compare_eq_iff]&nbsp;directly&nbsp;to&nbsp;make&nbsp;sure&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proof&nbsp;is&nbsp;executable.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">destruct</span> (<span class="id">Pos.eq_dec</span> (<span class="id">inj</span> <span class="id">x</span>) (<span class="id">inj</span> <span class="id">y</span>)) <span class="gallina-kwd">as</span> <span class="id">[|[]];</span> <span class="id">[now</span> <span class="id">auto|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id">Pos.compare_eq_iff</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Using&nbsp;rewrite&nbsp;here&nbsp;leads&nbsp;to&nbsp;non-executable&nbsp;proofs.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">transitivity</span> (<span class="id">surj</span> (<span class="id">inj</span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">apply</span> <span class="id">eq_sym,</span> <span class="id">surj_inj_compat</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">transitivity</span> (<span class="id">surj</span> (<span class="id">inj</span> <span class="id">y</span>))<span class="id">;</span> <span class="id">cycle</span> <span class="id">1</span>.<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">apply</span> <span class="id">surj_inj_compat</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">f_equal,</span> <span class="id">Hxy'</span>.<br/>
Defined.</div>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Next Obligation.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span>(<span class="id">surj_inj_compat</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id">inj_bound_spec</span> <span class="id">x</span>). <span class="id">generalize</span> (<span class="id">inj</span> <span class="id">x</span>). <span class="id">clear</span> <span class="id">x</span>. <span class="id">intros</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id">goal</span> <span class="gallina-kwd">with</span> <span class="id">|-</span> <span class="id">?Hx</span> <span class="id">-&gt;</span> <span class="id">In</span> <span class="id">?s</span> (<span class="id">fst</span> <span class="id">?p</span>) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> ((<span class="id">Hx</span> <span class="id">-&gt;</span> <span class="id">In</span> <span class="id">s</span> (<span class="id">fst</span> <span class="id">p</span>)) <span class="id">/\</span> <span class="id">snd</span> <span class="id">p</span> <span class="id">=</span> <span class="id">Pos.succ</span> <span class="id">inj_bound</span>)<span class="id">;</span> <span class="id">[|now</span> <span class="id">intuition]</span> <span class="gallina-kwd">end</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Pos.lt_succ_r</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">inj_bound</span> <span class="gallina-kwd">as</span> <span class="id">[|y</span> <span class="id">[IH1</span> <span class="id">IH2]]</span> <span class="gallina-kwd">using</span> <span class="id">Pos.peano_ind</span><span class="id">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">split;</span> <span class="id">[intros</span> <span class="id">Hx|]</span>)<span class="id">;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> (<span class="id">Pos.le_antisym</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hx</span>)<span class="id">;</span> <span class="id">auto</span> <span class="gallina-kwd">using</span> <span class="id">Pos.le_1_l</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">Pos.iter_succ</span>. <span class="id">destruct</span> <span class="id">Pos.iter</span><span class="id">;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">*</span>. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Pos.le_lteq</span> <span class="gallina-kwd">in</span> <span class="id">Hx</span>. <span class="id">destruct</span> <span class="id">Hx</span> <span class="gallina-kwd">as</span> <span class="id">[?</span>%<span class="id">Pos.lt_succ_r</span><span class="id">|</span> <span class="id">-&gt;];</span> <span class="id">now</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">Pos.iter_succ</span>. <span class="id">destruct</span> <span class="id">Pos.iter</span>. <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">IH2</span>. <span class="id">subst</span>. <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Definitions of <span class="bracket"><span class="id">FSet</span></span>/<span class="bracket"><span class="id">FMap</span></span> from <span class="bracket"><span class="id">Comparable</span></span> *</div>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">OrderedTypeAlt</span>.<br/>
<span class="vernacular">Require</span> <span class="id">FSetAVL</span>.<br/>
<span class="vernacular">Require</span> <span class="id">FMapAVL</span>.<br/>
<span class="vernacular">Import</span> <span class="id">OrderedType</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="gallina-kwd">Type</span> <span class="id">ComparableM</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Parameter</span> <span class="id">t</span> <span class="id">:</span> <span class="gallina-kwd">Type</span>.<br/>
&nbsp;&nbsp;<span class="id">Global</span> <span class="vernacular">Declare</span> <span class="vernacular">Instance</span> <span class="id">tComparable</span> <span class="id">:</span> <span class="id">Comparable</span> <span class="id">t</span>.<br/>
<span class="vernacular">End</span> <span class="id">ComparableM</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">OrderedTypeAlt_from_ComparableM</span> (<span class="id">C:ComparableM</span>) <span class="id">&lt;:</span> <span class="id">OrderedTypeAlt</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span> <span class="id">t</span> <span class="id">:=</span> <span class="id">C.t</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Definition</span> <span class="id">compare</span> <span class="id">:</span> <span class="id">t</span> <span class="id">-&gt;</span> <span class="id">t</span> <span class="id">-&gt;</span> <span class="id">comparison</span> <span class="id">:=</span> <span class="id">compare</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="vernacular">Infix</span> <span class="id">&quot;?=&quot;</span> <span class="id">:=</span> <span class="id">compare</span> (<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">70,</span> <span class="id">no</span> <span class="id">associativity</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="vernacular">Lemma</span> <span class="id">compare_sym</span> <span class="id">x</span> <span class="id">y</span> <span class="id">:</span> (<span class="id">y?=x</span>) <span class="id">=</span> <span class="id">CompOpp</span> (<span class="id">x?=y</span>).<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
 <span class="id">exact</span> (<span class="id">Logic.eq_sym</span> (<span class="id">compare_antisym</span> <span class="id">x</span> <span class="id">y</span>)). Qed.</div>
&nbsp;&nbsp;<span class="vernacular">Lemma</span> <span class="id">compare_trans</span> <span class="id">c</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x?=y</span>) <span class="id">=</span> <span class="id">c</span> <span class="id">-&gt;</span> (<span class="id">y?=z</span>) <span class="id">=</span> <span class="id">c</span> <span class="id">-&gt;</span> (<span class="id">x?=z</span>) <span class="id">=</span> <span class="id">c</span>.<br/>
<div>&nbsp;&nbsp;<span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">compare_trans</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<span class="vernacular">End</span> <span class="id">OrderedTypeAlt_from_ComparableM</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">OrderedType_from_ComparableM</span> (<span class="id">C:ComparableM</span>) <span class="id">&lt;:</span> <span class="id">OrderedType</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Module</span> <span class="id">Alt</span> <span class="id">:=</span> <span class="id">OrderedTypeAlt_from_ComparableM</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Include</span> (<span class="id">OrderedType_from_Alt</span> <span class="id">Alt</span>).<br/>
<span class="vernacular">End</span> <span class="id">OrderedType_from_ComparableM</span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
