
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Round</title>
<meta name="description" content="Documentation of Coq module Round" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="compcert"><summary>compcert</summary>
          <ul>
          <li><details id="compcert.backend"><summary>backend</summary>
          <ul>
          <li><a href="compcert.backend.Allocation.html">Allocation</a></li>
<li><a href="compcert.backend.Allocproof.html">Allocproof</a></li>
<li><a href="compcert.backend.Asmgenproof0.html">Asmgenproof0</a></li>
<li><a href="compcert.backend.Bounds.html">Bounds</a></li>
<li><a href="compcert.backend.CleanupLabels.html">CleanupLabels</a></li>
<li><a href="compcert.backend.CleanupLabelsproof.html">CleanupLabelsproof</a></li>
<li><a href="compcert.backend.Cminor.html">Cminor</a></li>
<li><a href="compcert.backend.CminorSel.html">CminorSel</a></li>
<li><a href="compcert.backend.Cminortyping.html">Cminortyping</a></li>
<li><a href="compcert.backend.Constprop.html">Constprop</a></li>
<li><a href="compcert.backend.Constpropproof.html">Constpropproof</a></li>
<li><a href="compcert.backend.Conventions.html">Conventions</a></li>
<li><a href="compcert.backend.CSE.html">CSE</a></li>
<li><a href="compcert.backend.CSEdomain.html">CSEdomain</a></li>
<li><a href="compcert.backend.CSEproof.html">CSEproof</a></li>
<li><a href="compcert.backend.Deadcode.html">Deadcode</a></li>
<li><a href="compcert.backend.Deadcodeproof.html">Deadcodeproof</a></li>
<li><a href="compcert.backend.Debugvar.html">Debugvar</a></li>
<li><a href="compcert.backend.Debugvarproof.html">Debugvarproof</a></li>
<li><a href="compcert.backend.Inlining.html">Inlining</a></li>
<li><a href="compcert.backend.Inliningproof.html">Inliningproof</a></li>
<li><a href="compcert.backend.Inliningspec.html">Inliningspec</a></li>
<li><a href="compcert.backend.Kildall.html">Kildall</a></li>
<li><a href="compcert.backend.Linear.html">Linear</a></li>
<li><a href="compcert.backend.Linearize.html">Linearize</a></li>
<li><a href="compcert.backend.Linearizeproof.html">Linearizeproof</a></li>
<li><a href="compcert.backend.Lineartyping.html">Lineartyping</a></li>
<li><a href="compcert.backend.Liveness.html">Liveness</a></li>
<li><a href="compcert.backend.Locations.html">Locations</a></li>
<li><a href="compcert.backend.LTL.html">LTL</a></li>
<li><a href="compcert.backend.Mach.html">Mach</a></li>
<li><a href="compcert.backend.NeedDomain.html">NeedDomain</a></li>
<li><a href="compcert.backend.Registers.html">Registers</a></li>
<li><a href="compcert.backend.Renumber.html">Renumber</a></li>
<li><a href="compcert.backend.Renumberproof.html">Renumberproof</a></li>
<li><a href="compcert.backend.RTL.html">RTL</a></li>
<li><a href="compcert.backend.RTLgen.html">RTLgen</a></li>
<li><a href="compcert.backend.RTLgenproof.html">RTLgenproof</a></li>
<li><a href="compcert.backend.RTLgenspec.html">RTLgenspec</a></li>
<li><a href="compcert.backend.RTLtyping.html">RTLtyping</a></li>
<li><a href="compcert.backend.SelectDiv.html">SelectDiv</a></li>
<li><a href="compcert.backend.SelectDivproof.html">SelectDivproof</a></li>
<li><a href="compcert.backend.Selection.html">Selection</a></li>
<li><a href="compcert.backend.Selectionproof.html">Selectionproof</a></li>
<li><a href="compcert.backend.SplitLong.html">SplitLong</a></li>
<li><a href="compcert.backend.SplitLongproof.html">SplitLongproof</a></li>
<li><a href="compcert.backend.Stacking.html">Stacking</a></li>
<li><a href="compcert.backend.Stackingproof.html">Stackingproof</a></li>
<li><a href="compcert.backend.Tailcall.html">Tailcall</a></li>
<li><a href="compcert.backend.Tailcallproof.html">Tailcallproof</a></li>
<li><a href="compcert.backend.Tunneling.html">Tunneling</a></li>
<li><a href="compcert.backend.Tunnelingproof.html">Tunnelingproof</a></li>
<li><a href="compcert.backend.Unusedglob.html">Unusedglob</a></li>
<li><a href="compcert.backend.Unusedglobproof.html">Unusedglobproof</a></li>
<li><a href="compcert.backend.ValueAnalysis.html">ValueAnalysis</a></li>
<li><a href="compcert.backend.ValueDomain.html">ValueDomain</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.cfrontend"><summary>cfrontend</summary>
          <ul>
          <li><a href="compcert.cfrontend.Cexec.html">Cexec</a></li>
<li><a href="compcert.cfrontend.Clight.html">Clight</a></li>
<li><a href="compcert.cfrontend.ClightBigstep.html">ClightBigstep</a></li>
<li><a href="compcert.cfrontend.Cminorgen.html">Cminorgen</a></li>
<li><a href="compcert.cfrontend.Cminorgenproof.html">Cminorgenproof</a></li>
<li><a href="compcert.cfrontend.Cop.html">Cop</a></li>
<li><a href="compcert.cfrontend.Csem.html">Csem</a></li>
<li><a href="compcert.cfrontend.Csharpminor.html">Csharpminor</a></li>
<li><a href="compcert.cfrontend.Cshmgen.html">Cshmgen</a></li>
<li><a href="compcert.cfrontend.Cshmgenproof.html">Cshmgenproof</a></li>
<li><a href="compcert.cfrontend.Cstrategy.html">Cstrategy</a></li>
<li><a href="compcert.cfrontend.Csyntax.html">Csyntax</a></li>
<li><a href="compcert.cfrontend.Ctypes.html">Ctypes</a></li>
<li><a href="compcert.cfrontend.Ctyping.html">Ctyping</a></li>
<li><a href="compcert.cfrontend.Initializers.html">Initializers</a></li>
<li><a href="compcert.cfrontend.Initializersproof.html">Initializersproof</a></li>
<li><a href="compcert.cfrontend.SimplExpr.html">SimplExpr</a></li>
<li><a href="compcert.cfrontend.SimplExprproof.html">SimplExprproof</a></li>
<li><a href="compcert.cfrontend.SimplExprspec.html">SimplExprspec</a></li>
<li><a href="compcert.cfrontend.SimplLocals.html">SimplLocals</a></li>
<li><a href="compcert.cfrontend.SimplLocalsproof.html">SimplLocalsproof</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.common"><summary>common</summary>
          <ul>
          <li><a href="compcert.common.AST.html">AST</a></li>
<li><a href="compcert.common.Behaviors.html">Behaviors</a></li>
<li><a href="compcert.common.Builtins.html">Builtins</a></li>
<li><a href="compcert.common.Builtins0.html">Builtins0</a></li>
<li><a href="compcert.common.Determinism.html">Determinism</a></li>
<li><a href="compcert.common.Errors.html">Errors</a></li>
<li><a href="compcert.common.Events.html">Events</a></li>
<li><a href="compcert.common.Globalenvs.html">Globalenvs</a></li>
<li><a href="compcert.common.Linking.html">Linking</a></li>
<li><a href="compcert.common.Memdata.html">Memdata</a></li>
<li><a href="compcert.common.Memory.html">Memory</a></li>
<li><a href="compcert.common.Memtype.html">Memtype</a></li>
<li><a href="compcert.common.Separation.html">Separation</a></li>
<li><a href="compcert.common.Smallstep.html">Smallstep</a></li>
<li><a href="compcert.common.Switch.html">Switch</a></li>
<li><a href="compcert.common.Unityping.html">Unityping</a></li>
<li><a href="compcert.common.Values.html">Values</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.cparser"><summary>cparser</summary>
          <ul>
          <li><a href="compcert.cparser.Cabs.html">Cabs</a></li>
<li><a href="compcert.cparser.Parser.html">Parser</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.driver"><summary>driver</summary>
          <ul>
          <li><a href="compcert.driver.Compiler.html">Compiler</a></li>
<li><a href="compcert.driver.Complements.html">Complements</a></li>
<li><a href="compcert.driver.Compopts.html">Compopts</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.lib"><summary>lib</summary>
          <ul>
          <li><a href="compcert.lib.Axioms.html">Axioms</a></li>
<li><a href="compcert.lib.BoolEqual.html">BoolEqual</a></li>
<li><a href="compcert.lib.Coqlib.html">Coqlib</a></li>
<li><a href="compcert.lib.Decidableplus.html">Decidableplus</a></li>
<li><a href="compcert.lib.Floats.html">Floats</a></li>
<li><a href="compcert.lib.FSetAVLplus.html">FSetAVLplus</a></li>
<li><a href="compcert.lib.Heaps.html">Heaps</a></li>
<li><a href="compcert.lib.IEEE754_extra.html">IEEE754_extra</a></li>
<li><a href="compcert.lib.Integers.html">Integers</a></li>
<li><a href="compcert.lib.Intv.html">Intv</a></li>
<li><a href="compcert.lib.IntvSets.html">IntvSets</a></li>
<li><a href="compcert.lib.Iteration.html">Iteration</a></li>
<li><a href="compcert.lib.Lattice.html">Lattice</a></li>
<li><a href="compcert.lib.Maps.html">Maps</a></li>
<li><a href="compcert.lib.Ordered.html">Ordered</a></li>
<li><a href="compcert.lib.Parmov.html">Parmov</a></li>
<li><a href="compcert.lib.Postorder.html">Postorder</a></li>
<li><a href="compcert.lib.UnionFind.html">UnionFind</a></li>
<li><a href="compcert.lib.Wfsimpl.html">Wfsimpl</a></li>
<li><a href="compcert.lib.Zbits.html">Zbits</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.x86"><summary>x86</summary>
          <ul>
          <li><a href="compcert.x86.Asm.html">Asm</a></li>
<li><a href="compcert.x86.Asmgen.html">Asmgen</a></li>
<li><a href="compcert.x86.Asmgenproof.html">Asmgenproof</a></li>
<li><a href="compcert.x86.Asmgenproof1.html">Asmgenproof1</a></li>
<li><a href="compcert.x86.Builtins1.html">Builtins1</a></li>
<li><a href="compcert.x86.CombineOp.html">CombineOp</a></li>
<li><a href="compcert.x86.CombineOpproof.html">CombineOpproof</a></li>
<li><a href="compcert.x86.ConstpropOp.html">ConstpropOp</a></li>
<li><a href="compcert.x86.ConstpropOpproof.html">ConstpropOpproof</a></li>
<li><a href="compcert.x86.Conventions1.html">Conventions1</a></li>
<li><a href="compcert.x86.Machregs.html">Machregs</a></li>
<li><a href="compcert.x86.NeedOp.html">NeedOp</a></li>
<li><a href="compcert.x86.Op.html">Op</a></li>
<li><a href="compcert.x86.SelectLong.html">SelectLong</a></li>
<li><a href="compcert.x86.SelectLongproof.html">SelectLongproof</a></li>
<li><a href="compcert.x86.SelectOp.html">SelectOp</a></li>
<li><a href="compcert.x86.SelectOpproof.html">SelectOpproof</a></li>
<li><a href="compcert.x86.Stacklayout.html">Stacklayout</a></li>
<li><a href="compcert.x86.ValueAOp.html">ValueAOp</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.x86_64"><summary>x86_64</summary>
          <ul>
          <li><a href="compcert.x86_64.Archi.html">Archi</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Flocq"><summary>Flocq</summary>
          <ul>
          <li><details id="Flocq.Calc"><summary>Calc</summary>
          <ul>
          <li><a href="Flocq.Calc.Bracket.html">Bracket</a></li>
<li><a href="Flocq.Calc.Div.html">Div</a></li>
<li><a href="Flocq.Calc.Operations.html">Operations</a></li>
<li><a href="Flocq.Calc.Plus.html">Plus</a></li>
<li><a href="Flocq.Calc.Round.html">Round</a></li>
<li><a href="Flocq.Calc.Sqrt.html">Sqrt</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.Core"><summary>Core</summary>
          <ul>
          <li><a href="Flocq.Core.Core.html">Core</a></li>
<li><a href="Flocq.Core.Defs.html">Defs</a></li>
<li><a href="Flocq.Core.Digits.html">Digits</a></li>
<li><a href="Flocq.Core.FIX.html">FIX</a></li>
<li><a href="Flocq.Core.Float_prop.html">Float_prop</a></li>
<li><a href="Flocq.Core.FLT.html">FLT</a></li>
<li><a href="Flocq.Core.FLX.html">FLX</a></li>
<li><a href="Flocq.Core.FTZ.html">FTZ</a></li>
<li><a href="Flocq.Core.Generic_fmt.html">Generic_fmt</a></li>
<li><a href="Flocq.Core.Raux.html">Raux</a></li>
<li><a href="Flocq.Core.Round_NE.html">Round_NE</a></li>
<li><a href="Flocq.Core.Round_pred.html">Round_pred</a></li>
<li><a href="Flocq.Core.Ulp.html">Ulp</a></li>
<li><a href="Flocq.Core.Zaux.html">Zaux</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.IEEE754"><summary>IEEE754</summary>
          <ul>
          <li><a href="Flocq.IEEE754.Binary.html">Binary</a></li>
<li><a href="Flocq.IEEE754.BinarySingleNaN.html">BinarySingleNaN</a></li>
<li><a href="Flocq.IEEE754.Bits.html">Bits</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.Prop"><summary>Prop</summary>
          <ul>
          <li><a href="Flocq.Prop.Div_sqrt_error.html">Div_sqrt_error</a></li>
<li><a href="Flocq.Prop.Double_rounding.html">Double_rounding</a></li>
<li><a href="Flocq.Prop.Mult_error.html">Mult_error</a></li>
<li><a href="Flocq.Prop.Plus_error.html">Plus_error</a></li>
<li><a href="Flocq.Prop.Relative.html">Relative</a></li>
<li><a href="Flocq.Prop.Round_odd.html">Round_odd</a></li>
<li><a href="Flocq.Prop.Sterbenz.html">Sterbenz</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="MenhirLib"><summary>MenhirLib</summary>
          <ul>
          <li><a href="MenhirLib.Alphabet.html">Alphabet</a></li>
<li><a href="MenhirLib.Automaton.html">Automaton</a></li>
<li><a href="MenhirLib.Grammar.html">Grammar</a></li>
<li><a href="MenhirLib.Interpreter.html">Interpreter</a></li>
<li><a href="MenhirLib.Interpreter_complete.html">Interpreter_complete</a></li>
<li><a href="MenhirLib.Interpreter_correct.html">Interpreter_correct</a></li>
<li><a href="MenhirLib.Main.html">Main</a></li>
<li><a href="MenhirLib.Validator_classes.html">Validator_classes</a></li>
<li><a href="MenhirLib.Validator_complete.html">Validator_complete</a></li>
<li><a href="MenhirLib.Validator_safe.html">Validator_safe</a></li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module Round</h1>
<br/>
<h1> Helper function for computing the rounded value of a real number. </h1>
<br/>
<span class="vernacular">From</span> <span class="id">Coq</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.ZArith.html">ZArith</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Reals.html">Reals</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.micromega.Lia.html">Lia</a></span>.<br/>
<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="Flocq.Core.Core.html">Core</a></span> <span class="id"><a href="Flocq.Core.Digits.html">Digits</a></span> <span class="id"><a href="Flocq.Core.Float_prop.html">Float_prop</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html">Bracket</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="Fcalc_round" class="id"><a name="Fcalc_round" class="">Fcalc_round</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="Fcalc_round.beta" class="id"><a name="Fcalc_round.beta" class="">beta</a></span> <span class="id">:</span> <span class="id"><a href="Flocq.Core.Zaux.html#radix">radix</a></span>.<br/>
<span class="vernacular">Notation</span> <span id="bpow" class="id"><a name="bpow" class="">bpow</a></span> <span class="id">e</span> <span class="id">:=</span> (<span class="id"><a href="Flocq.Core.Raux.html#bpow">bpow</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>).<br/>
<br/>
<span class="vernacular">Section</span> <span id="Fcalc_round.Fcalc_round_fexp" class="id"><a name="Fcalc_round.Fcalc_round_fexp" class="">Fcalc_round_fexp</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="Fcalc_round.Fcalc_round_fexp.fexp" class="id"><a name="Fcalc_round.Fcalc_round_fexp.fexp" class="">fexp</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{</span> <span id="valid_exp:3" class="id"><a name="valid_exp:3" class="">valid_exp</a></span> <span class="id">:</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">}</span>.<br/>
<span class="vernacular">Notation</span> <span id="format" class="id"><a name="format" class="">format</a></span> <span class="id">:=</span> (<span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span>).<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="cexp_inbetween_float" class="id"><a name="cexp_inbetween_float" class="">cexp_inbetween_float</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:4" class="id"><a name="x:4" class="">x</a></span> <span id="m:5" class="id"><a name="m:5" class="">m</a></span> <span id="e:6" class="id"><a name="e:6" class="">e</a></span> <span id="l:7" class="id"><a name="l:7" class="">l,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:4">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:5">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:6">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:4">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:7">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:6">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:4">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:6">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:5">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:6">e</a></span>))%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:4">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:5">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:6">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Px</span> <span class="id">Bx</span> <span class="id">He</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float_bounds">inbetween_float_bounds</a></span> <span class="gallina-kwd">in</span> <span class="id">Bx</span>.<br/>
<span class="id">assert</span> (<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id">m</span>)%<span class="id">Z</span> <span class="gallina-kwd">as</span> <span class="id">Hm</span>.<br/>
<span class="id">{</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ_le">Zlt_succ_le</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Flocq.Core.Float_prop.html#gt_0_F2R">gt_0_F2R</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Px</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">Bx</span>. <span class="id">}</span><br/>
<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_lt_or_eq">Zle_lt_or_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hm</span>) <span class="gallina-kwd">as</span> <span class="id">[Hm'|&lt;-]</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">erewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Core.Float_prop.html#mag_F2R_bounds_Zdigits">mag_F2R_bounds_Zdigits</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hm'</span>).<br/>
<span class="id">clear</span> <span class="id">Hm</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="Flocq.Core.Raux.html#mag">mag</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id">e</span>)%<span class="id">Z</span> <span class="gallina-kwd">as</span> <span class="id">Hx</span>.<br/>
<span class="id">{</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#mag_le_bpow">mag_le_bpow</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Core.Float_prop.html#F2R_bpow">F2R_bpow</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>. <span class="id">}</span><br/>
<span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">He</span> <span class="id">|-</span> <span class="id">*</span>.<br/>
<span class="id">clear</span> <span class="id">Bx</span>.<br/>
<span class="id">destruct</span> <span class="id">He</span> <span class="gallina-kwd">as</span> <span class="id">[He|He]</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.valid_exp">valid_exp</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">He</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="gallina-kwd">with</span> <span class="id">e</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.valid_exp">valid_exp</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">He</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="gallina-kwd">with</span> <span class="id">e</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="cexp_inbetween_float_loc_Exact" class="id"><a name="cexp_inbetween_float_loc_Exact" class="">cexp_inbetween_float_loc_Exact</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:8" class="id"><a name="x:8" class="">x</a></span> <span id="m:9" class="id"><a name="m:9" class="">m</a></span> <span id="e:10" class="id"><a name="e:10" class="">e</a></span> <span id="l:11" class="id"><a name="l:11" class="">l,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:8">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:9">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:10">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:8">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:11">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:10">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:8">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:11">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x">&lt;-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#e:10">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:9">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:10">e</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:11">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>)%<span class="id">Z</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Px</span> <span class="id">Bx</span>.<br/>
<span class="id">destruct</span> <span class="id">Px</span> <span class="gallina-kwd">as</span> <span class="id">[Px|Px]</span>.<br/>
<span class="id">-</span> <span class="id">split</span> <span class="id">;</span> (<span class="id">intros</span> <span class="id">[H|H]</span> <span class="id">;</span> <span class="id">[left|now</span> <span class="id">right]</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Calc.Round.html#cexp_inbetween_float">cexp_inbetween_float</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Px</span>) (<span class="id">2</span> <span class="id">:=</span> <span class="id">Bx</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Flocq.Calc.Round.html#cexp_inbetween_float">cexp_inbetween_float</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Px</span>) (<span class="id">2</span> <span class="id">:=</span> <span class="id">Bx</span>).<br/>
&nbsp;&nbsp;<span class="id">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">right</span>.<br/>
<span class="id">-</span> <span class="id">assert</span> (<span class="id">H</span> <span class="id">:=</span> <span class="id">Bx</span>).<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Bx</span> <span class="gallina-kwd">as</span> <span class="id">[|c</span> <span class="id">Bx</span> <span class="id">_]</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">split</span> <span class="id">;</span> <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">Px</span> <span class="gallina-kwd">in</span> <span class="id">Bx</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Bx</span> <span class="gallina-kwd">as</span> <span class="id">[Bx1</span> <span class="id">Bx2]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Float_prop.html#lt_0_F2R">lt_0_F2R</a></span> <span class="gallina-kwd">in</span> <span class="id">Bx1</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Float_prop.html#gt_0_F2R">gt_0_F2R</a></span> <span class="gallina-kwd">in</span> <span class="id">Bx2</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding. </div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_round" class="id"><a name="inbetween_float_round" class="">inbetween_float_round</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="rnd:12" class="id"><a name="rnd:12" class="">rnd</a></span> <span id="choice:13" class="id"><a name="choice:13" class="">choice,</a></span><br/>
&nbsp;&nbsp;( <span class="gallina-kwd">forall</span> <span id="x:14" class="id"><a name="x:14" class="">x</a></span> <span id="m:15" class="id"><a name="m:15" class="">m</a></span> <span id="l:16" class="id"><a name="l:16" class="">l,</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:15">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:14">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:16">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="Flocq.Calc.Round.html#rnd:12">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:14">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#choice:13">choice</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:15">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:16">l</a></span> ) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:17" class="id"><a name="x:17" class="">x</a></span> <span id="m:18" class="id"><a name="m:18" class="">m</a></span> <span id="l:19" class="id"><a name="l:19" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:20" class="id"><a name="e:20" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:17">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:18">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:20">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:17">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:19">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#rnd:12">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:17">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#choice:13">choice</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:18">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:19">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#e:20">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
<span class="id">intros</span> <span class="id">rnd</span> <span class="id">choice</span> <span class="id">Hc</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">e</span> <span class="id">Hl</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round,</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span>. <span class="id">simpl</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span> (<span class="gallina-kwd">fun</span> <span id="m:22" class="id"><span id="m:21" class="id"><a name="m:22" class="">m</a></span></span> <span class="id">=&gt;</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:21">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="Flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>)%<span class="id">R</span>)).<br/>
<span class="id">apply</span> <span class="id">Hc</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_mult_reg">inbetween_mult_reg</a></span> <span class="gallina-kwd">with</span> (<span class="id"><a href="Flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#scaled_mantissa_mult_bpow">scaled_mantissa_mult_bpow</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="cond_incr" class="id"><a name="cond_incr" class="">cond_incr</a></span> (<span id="b:23" class="id"><a name="b:23" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span id="m:24" class="id"><a name="m:24" class="">m</a></span> <span class="id">:=</span> <span class="gallina-kwd">if</span> <span class="id"><a href="Flocq.Calc.Round.html#b:23">b</a></span> <span class="gallina-kwd">then</span> (<span class="id"><a href="Flocq.Calc.Round.html#m:24">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>)%<span class="id">Z</span> <span class="gallina-kwd">else</span> <span class="id"><a href="Flocq.Calc.Round.html#m:24">m</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="le_cond_incr_le" class="id"><a name="le_cond_incr_le" class="">le_cond_incr_le</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="b:25" class="id"><a name="b:25" class="">b</a></span> <span id="m:26" class="id"><a name="m:26" class="">m,</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:26">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> <span class="id"><a href="Flocq.Calc.Round.html#b:25">b</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:26">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:26">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>)%<span class="id">Z</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr;</a></span> <span class="id">intros</span> <span class="id">b;</span> <span class="id">case</span> <span class="id">b;</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_round_sign" class="id"><a name="inbetween_float_round_sign" class="">inbetween_float_round_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="rnd:27" class="id"><a name="rnd:27" class="">rnd</a></span> <span id="choice:28" class="id"><a name="choice:28" class="">choice,</a></span><br/>
&nbsp;&nbsp;( <span class="gallina-kwd">forall</span> <span id="x:29" class="id"><a name="x:29" class="">x</a></span> <span id="m:30" class="id"><a name="m:30" class="">m</a></span> <span id="l:31" class="id"><a name="l:31" class="">l,</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:30">m</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:29">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:31">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#rnd:27">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:29">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:29">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#choice:28">choice</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:29">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#m:30">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:31">l</a></span>) ) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:32" class="id"><a name="x:32" class="">x</a></span> <span id="m:33" class="id"><a name="m:33" class="">m</a></span> <span id="l:34" class="id"><a name="l:34" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:35" class="id"><a name="e:35" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:32">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:33">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:35">e</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:32">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:34">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#rnd:27">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:32">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:32">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#choice:28">choice</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:32">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#m:33">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:34">l</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#e:35">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">intros</span> <span class="id">rnd</span> <span class="id">choice</span> <span class="id">Hc</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">e</span> <span class="id">Hx</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span> (<span class="gallina-kwd">fun</span> <span id="m:37" class="id"><span id="m:36" class="id"><a name="m:37" class="">m</a></span></span> <span class="id">=&gt;</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:36">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#e1dae7ed53bffa765009199d058dd327">*</a></span> <span class="id"><a href="Flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>)%<span class="id">R</span>)).<br/>
<span class="id">simpl</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id">x</span> <span class="id">0</span>) <span class="gallina-kwd">with</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> (<span class="id"><a href="Flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>) <span class="id">0</span>).<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">apply</span> <span class="id">Hc</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_mult_reg">inbetween_mult_reg</a></span> <span class="gallina-kwd">with</span> (<span class="id"><a href="Flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>)) <span class="gallina-kwd">at</span> <span class="id">3</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#scaled_mantissa_mult_bpow">scaled_mantissa_mult_bpow</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">destruct</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_spec">Rlt_bool_spec</a></span> <span class="id">x</span> <span class="id">0</span>) <span class="gallina-kwd">as</span> <span class="id">[Zx|Zx]</span> <span class="id">;</span> <span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#bpow">bpow</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-e</a></span>))).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding down. </div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_DN" class="id"><a name="inbetween_int_DN" class="">inbetween_int_DN</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:38" class="id"><a name="x:38" class="">x</a></span> <span id="m:39" class="id"><a name="m:39" class="">m</a></span> <span id="l:40" class="id"><a name="l:40" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:39">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:38">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:40">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:38">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:39">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">refine</span> (<span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span> <span class="id">m</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">Hl</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_DN" class="id"><a name="inbetween_float_DN" class="">inbetween_float_DN</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:41" class="id"><a name="x:41" class="">x</a></span> <span id="m:42" class="id"><a name="m:42" class="">m</a></span> <span id="l:43" class="id"><a name="l:43" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:44" class="id"><a name="e:44" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:41">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:42">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:44">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:41">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:43">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:41">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:42">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:44">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="m:47" class="id"><span id="m:45" class="id"><a name="m:47" class="">m</a></span></span> <span id="l:48" class="id"><span id="l:46" class="id"><a name="l:48" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#m:45">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="round_sign_DN" class="id"><a name="round_sign_DN" class="">round_sign_DN</a></span> <span id="s:49" class="id"><a name="s:49" class="">s</a></span> <span id="l:50" class="id"><a name="l:50" class="">l</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="Flocq.Calc.Round.html#l:50">l</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#s:49">s</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_DN_sign" class="id"><a name="inbetween_int_DN_sign" class="">inbetween_int_DN_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:52" class="id"><a name="x:52" class="">x</a></span> <span id="m:53" class="id"><a name="m:53" class="">m</a></span> <span id="l:54" class="id"><a name="l:54" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:53">m</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:52">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:54">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:52">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:52">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:52">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:54">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:53">m</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="gallina-kwd">in</span> <span class="id">Hl</span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="gallina-kwd">as</span> <span class="id">[Zx|Zx]</span> .<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">inversion_clear</span> <span class="id">Hl</span> <span class="id">;</span> <span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">x</span>).<br/>
<span class="id">rewrite</span> <span class="id">H,</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_IZR">Zfloor_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="id">split</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_cancel">Ropp_lt_cancel</a></span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="id">ring_simplify</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> (<span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>)%<span class="id">Z</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_cancel">Ropp_lt_cancel</a></span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="id">inversion_clear</span> <span class="id">Hl</span> <span class="id">;</span> <span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_IZR">Zfloor_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="id">split</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="id">apply</span> <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_DN_sign" class="id"><a name="inbetween_float_DN_sign" class="">inbetween_float_DN_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:55" class="id"><a name="x:55" class="">x</a></span> <span id="m:56" class="id"><a name="m:56" class="">m</a></span> <span id="l:57" class="id"><a name="l:57" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:58" class="id"><a name="e:58" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:55">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:56">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:58">e</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:55">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:57">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:55">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:55">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:55">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:57">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:56">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#e:58">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="s:62" class="id"><span id="s:59" class="id"><a name="s:62" class="">s</a></span></span> <span id="m:63" class="id"><span id="m:60" class="id"><a name="m:63" class="">m</a></span></span> <span id="l:64" class="id"><span id="l:61" class="id"><a name="l:64" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="Flocq.Calc.Round.html#s:59">s</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:61">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:60">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding up. </div>
<br/>
<span class="vernacular">Definition</span> <span id="round_UP" class="id"><a name="round_UP" class="">round_UP</a></span> <span id="l:65" class="id"><a name="l:65" class="">l</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="Flocq.Calc.Round.html#l:65">l</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_UP" class="id"><a name="inbetween_int_UP" class="">inbetween_int_UP</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:67" class="id"><a name="x:67" class="">x</a></span> <span id="m:68" class="id"><a name="m:68" class="">m</a></span> <span id="l:69" class="id"><a name="l:69" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:68">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:67">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:69">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:67">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:69">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:68">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">assert</span> (<span class="id">Hl':</span> <span class="id">l</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> (<span class="id">l</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x">&lt;&gt;</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="Flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id">l</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)).<br/>
<span class="id">case</span> <span class="id">l</span> <span class="id">;</span> <span class="id">try</span> (<span class="id">now</span> <span class="id">left</span>) <span class="id">;</span> <span class="id">now</span> <span class="id">right</span> <span class="id">;</span> <span class="id">split</span>.<br/>
<span class="id">destruct</span> <span class="id">Hl'</span> <span class="gallina-kwd">as</span> <span class="id">[Hl'|</span>(<span class="id">Hl1,</span> <span class="id">Hl2</span>)<span class="id">]</span>.<br/>
<span class="comment">(*&nbsp;Exact&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id">Hl'</span>.<br/>
<span class="id">destruct</span> <span class="id">Hl</span> <span class="id">;</span> <span class="id">try</span> <span class="id">easy</span>.<br/>
<span class="id">rewrite</span> <span class="id">H</span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="Flocq.Core.Raux.html#Zceil_IZR">Zceil_IZR</a></span> <span class="id">_</span>).<br/>
<span class="comment">(*&nbsp;not&nbsp;Exact&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id">Hl2</span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil_imp">Zceil_imp</a></span>.<br/>
<span class="id">ring_simplify</span> (<span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)%<span class="id">Z</span>.<br/>
<span class="id">refine</span> (<span class="gallina-kwd">let</span> <span id="H:71" class="id"><span id="H:70" class="id"><a name="H:71" class="">H</a></span></span> <span class="id">:=</span> <span class="id">_</span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id"><a href="Flocq.Calc.Round.html#H:70">H</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id"><a href="Flocq.Calc.Round.html#H:70">H</a></span>))).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_bounds_not_Eq">inbetween_bounds_not_Eq</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">Hl1</span>) (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hl</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_UP" class="id"><a name="inbetween_float_UP" class="">inbetween_float_UP</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:72" class="id"><a name="x:72" class="">x</a></span> <span id="m:73" class="id"><a name="m:73" class="">m</a></span> <span id="l:74" class="id"><a name="l:74" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:75" class="id"><a name="e:75" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:72">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:73">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:75">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:72">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:74">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:72">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:74">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:73">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#e:75">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="m:78" class="id"><span id="m:76" class="id"><a name="m:78" class="">m</a></span></span> <span id="l:79" class="id"><span id="l:77" class="id"><a name="l:79" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:77">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:76">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="round_sign_UP" class="id"><a name="round_sign_UP" class="">round_sign_UP</a></span> <span id="s:80" class="id"><a name="s:80" class="">s</a></span> <span id="l:81" class="id"><a name="l:81" class="">l</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="Flocq.Calc.Round.html#l:81">l</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id"><a href="Flocq.Calc.Round.html#s:80">s</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_UP_sign" class="id"><a name="inbetween_int_UP_sign" class="">inbetween_int_UP_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:83" class="id"><a name="x:83" class="">x</a></span> <span id="m:84" class="id"><a name="m:84" class="">m</a></span> <span id="l:85" class="id"><a name="l:85" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:84">m</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:83">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:85">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:83">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:83">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:83">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:85">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:84">m</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="gallina-kwd">in</span> <span class="id">Hl</span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="gallina-kwd">as</span> <span class="id">[Zx|Zx]</span> .<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">simpl</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil">Zceil</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">inversion_clear</span> <span class="id">Hl</span> <span class="id">;</span> <span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_IZR">Zfloor_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="id">split</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="id">apply</span> <span class="id">H</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">Hl</span> <span class="id">;</span> <span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil_IZR">Zceil_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil_imp">Zceil_imp</a></span>.<br/>
<span class="id">split</span>.<br/>
<span class="id">change</span> (<span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)%<span class="id">Z</span> <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id">m</span>)).<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zpred_succ">Zpred_succ</a></span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_UP_sign" class="id"><a name="inbetween_float_UP_sign" class="">inbetween_float_UP_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:86" class="id"><a name="x:86" class="">x</a></span> <span id="m:87" class="id"><a name="m:87" class="">m</a></span> <span id="l:88" class="id"><a name="l:88" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:89" class="id"><a name="e:89" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:86">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:87">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:89">e</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:86">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:88">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:86">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:86">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:86">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:88">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:87">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#e:89">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="s:93" class="id"><span id="s:90" class="id"><a name="s:93" class="">s</a></span></span> <span id="m:94" class="id"><span id="m:91" class="id"><a name="m:94" class="">m</a></span></span> <span id="l:95" class="id"><span id="l:92" class="id"><a name="l:95" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#s:90">s</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:92">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:91">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding toward zero. </div>
<br/>
<span class="vernacular">Definition</span> <span id="round_ZR" class="id"><a name="round_ZR" class="">round_ZR</a></span> (<span id="s:96" class="id"><a name="s:96" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span id="l:97" class="id"><a name="l:97" class="">l</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="Flocq.Calc.Round.html#l:97">l</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#s:96">s</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_ZR" class="id"><a name="inbetween_int_ZR" class="">inbetween_int_ZR</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:99" class="id"><a name="x:99" class="">x</a></span> <span id="m:100" class="id"><a name="m:100" class="">m</a></span> <span id="l:101" class="id"><a name="l:101" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:100">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:99">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:101">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:99">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:100">m</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:101">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:100">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof with</span></div>
<div class="proofscript" id="proof14">
 <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">Hl</span> <span class="gallina-kwd">as</span> <span class="id">[Hx|l'</span> <span class="id">Hx</span> <span class="id">Hl']</span>.<br/>
<span class="comment">(*&nbsp;Exact&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span>...<br/>
<span class="comment">(*&nbsp;not&nbsp;Exact&nbsp;*)</span><br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span>.<br/>
<span class="id">assert</span> (<span class="id">Hm:</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">m</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">case</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_spec">Rlt_bool_spec</a></span> <span class="id">;</span> <span class="id">intros</span> <span class="id">Hx'</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">case</span> <span class="id"><a href="Flocq.Core.Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">;</span> <span class="id">intros</span> <span class="id">Hm'</span> <span class="id">;</span> <span class="id">try</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
<span class="id">elim</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_le">Rlt_not_le</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hx'</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>).<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
<span class="id">elim</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hx'</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_succ">Zlt_le_succ</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_ZR" class="id"><a name="inbetween_float_ZR" class="">inbetween_float_ZR</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:102" class="id"><a name="x:102" class="">x</a></span> <span id="m:103" class="id"><a name="m:103" class="">m</a></span> <span id="l:104" class="id"><a name="l:104" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:105" class="id"><a name="e:105" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:102">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:103">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:105">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:102">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:104">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:102">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:103">m</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:104">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:103">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#e:105">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="m:108" class="id"><span id="m:106" class="id"><a name="m:108" class="">m</a></span></span> <span id="l:109" class="id"><span id="l:107" class="id"><a name="l:109" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:106">m</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:107">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:106">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_ZR_sign" class="id"><a name="inbetween_int_ZR_sign" class="">inbetween_int_ZR_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:110" class="id"><a name="x:110" class="">x</a></span> <span id="m:111" class="id"><a name="m:111" class="">m</a></span> <span id="l:112" class="id"><a name="l:112" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:111">m</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:110">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:112">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:110">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:110">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#m:111">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_dec">Rlt_le_dec</a></span> <span class="id">x</span> <span class="id">0</span>) <span class="gallina-kwd">as</span> <span class="id">[Zx|Zx]</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">simpl</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil">Zceil</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left">Rabs_left</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">Hl</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">Hl</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_ZR_sign" class="id"><a name="inbetween_float_ZR_sign" class="">inbetween_float_ZR_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:113" class="id"><a name="x:113" class="">x</a></span> <span id="m:114" class="id"><a name="m:114" class="">m</a></span> <span id="l:115" class="id"><a name="l:115" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:116" class="id"><a name="e:116" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:113">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:114">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:116">e</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:113">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:115">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:113">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:113">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#m:114">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#e:116">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="s:120" class="id"><span id="s:117" class="id"><a name="s:120" class="">s</a></span></span> <span id="m:121" class="id"><span id="m:118" class="id"><a name="m:121" class="">m</a></span></span> <span id="l:122" class="id"><span id="l:119" class="id"><a name="l:122" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#m:118">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding to nearest. </div>
<br/>
<span class="vernacular">Definition</span> <span id="round_N" class="id"><a name="round_N" class="">round_N</a></span> (<span id="p:123" class="id"><a name="p:123" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span id="l:124" class="id"><a name="l:124" class="">l</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="Flocq.Calc.Round.html#l:124">l</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Inexact">loc_Inexact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Lt">Lt</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Inexact">loc_Inexact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Eq">Eq</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#p:123">p</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Inexact">loc_Inexact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Gt">Gt</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_N" class="id"><a name="inbetween_int_N" class="">inbetween_int_N</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="choice:126" class="id"><a name="choice:126" class="">choice</a></span> <span id="x:127" class="id"><a name="x:127" class="">x</a></span> <span id="m:128" class="id"><a name="m:128" class="">m</a></span> <span id="l:129" class="id"><a name="l:129" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:128">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:127">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:129">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="Flocq.Calc.Round.html#choice:126">choice</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:127">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#choice:126">choice</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:128">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:129">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:128">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof with</span></div>
<div class="proofscript" id="proof18">
 <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="id">intros</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">Hl</span> <span class="gallina-kwd">as</span> <span class="id">[Hx|l'</span> <span class="id">Hx</span> <span class="id">Hl']</span>.<br/>
<span class="comment">(*&nbsp;Exact&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span>...<br/>
<span class="comment">(*&nbsp;not&nbsp;Exact&nbsp;*)</span><br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span>.<br/>
<span class="id">assert</span> (<span class="id">Hm:</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">m</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rcompare">Rcompare</a></span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/2</a></span>)) <span class="gallina-kwd">with</span> <span class="id">l'</span>.<br/>
<span class="id">now</span> <span class="id">case</span> <span class="id">l'</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">Hl'</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rcompare_plus_r">Rcompare_plus_r</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">-</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) <span class="id">x</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">field</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_N_sign" class="id"><a name="inbetween_int_N_sign" class="">inbetween_int_N_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="choice:130" class="id"><a name="choice:130" class="">choice</a></span> <span id="x:131" class="id"><a name="x:131" class="">x</a></span> <span id="m:132" class="id"><a name="m:132" class="">m</a></span> <span id="l:133" class="id"><a name="l:133" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:132">m</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:131">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:133">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="Flocq.Calc.Round.html#choice:130">choice</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:131">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:131">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="gallina-kwd">if</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:131">x</a></span> <span class="id">0</span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#choice:130">choice</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span>(<span class="id"><a href="Flocq.Calc.Round.html#m:132">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>))%<span class="id">Z</span>) <span class="gallina-kwd">else</span> <span class="id"><a href="Flocq.Calc.Round.html#choice:130">choice</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:132">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:133">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:132">m</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof with</span></div>
<div class="proofscript" id="proof19">
 <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="id">intros</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="gallina-kwd">in</span> <span class="id">Hl</span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="gallina-kwd">as</span> <span class="id">[Zx|Zx]</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">x</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Znearest_opp">Znearest_opp</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">inversion_clear</span> <span class="id">Hl</span> <span class="gallina-kwd">as</span> <span class="id">[Hx|l'</span> <span class="id">Hx</span> <span class="id">Hl']</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span>...<br/>
<span class="id">assert</span> (<span class="id">Hm:</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">-x</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">m</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rcompare">Rcompare</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">-</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/2</a></span>)) <span class="gallina-kwd">with</span> <span class="id">l'</span>.<br/>
<span class="id">now</span> <span class="id">case</span> <span class="id">l'</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">Hl'</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rcompare_plus_r">Rcompare_plus_r</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">-</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">-x</a></span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">field</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">generalize</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Zx</span>).<br/>
<span class="id">clear</span> <span class="id">Zx</span>. <span class="id">intros</span> <span class="id">Zx</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">simpl</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">Hl</span> <span class="gallina-kwd">as</span> <span class="id">[Hx|l'</span> <span class="id">Hx</span> <span class="id">Hl']</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span>...<br/>
<span class="id">assert</span> (<span class="id">Hm:</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">m</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="id">exact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rcompare">Rcompare</a></span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:x_'-'_x">-</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#2299a6ef56270a66cc1b95489d0f6e3a">/2</a></span>)) <span class="gallina-kwd">with</span> <span class="id">l'</span>.<br/>
<span class="id">now</span> <span class="id">case</span> <span class="id">l'</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">Hl'</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rcompare_plus_r">Rcompare_plus_r</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:'-'_x">-</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) <span class="id">x</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">field</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding to nearest even. </div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_NE" class="id"><a name="inbetween_int_NE" class="">inbetween_int_NE</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:134" class="id"><a name="x:134" class="">x</a></span> <span id="m:135" class="id"><a name="m:135" class="">m</a></span> <span id="l:136" class="id"><a name="l:136" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:135">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:134">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:136">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Round_NE.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:134">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:135">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:136">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:135">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_N">inbetween_int_N</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="x:138" class="id"><span id="x:137" class="id"><a name="x:138" class="">x</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:137">x</a></span>)).<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_NE" class="id"><a name="inbetween_float_NE" class="">inbetween_float_NE</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:139" class="id"><a name="x:139" class="">x</a></span> <span id="m:140" class="id"><a name="m:140" class="">m</a></span> <span id="l:141" class="id"><a name="l:141" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:142" class="id"><a name="e:142" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:139">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:140">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:142">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:139">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:141">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Round_NE.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:139">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:140">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:141">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:140">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#e:142">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="m:145" class="id"><span id="m:143" class="id"><a name="m:145" class="">m</a></span></span> <span id="l:146" class="id"><span id="l:144" class="id"><a name="l:146" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:143">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:144">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:143">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_NE_sign" class="id"><a name="inbetween_int_NE_sign" class="">inbetween_int_NE_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:147" class="id"><a name="x:147" class="">x</a></span> <span id="m:148" class="id"><a name="m:148" class="">m</a></span> <span id="l:149" class="id"><a name="l:149" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:148">m</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:147">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:149">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Round_NE.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:147">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:147">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:148">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:149">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:148">m</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">erewrite</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_N_sign">inbetween_int_N_sign</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="x:153" class="id"><span id="x:152" class="id"><span id="x:151" class="id"><span id="x:150" class="id"><a name="x:153" class="">x</a></span></span></span></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:150">x</a></span>)).<br/>
<span class="id">2:</span> <span class="id">eexact</span> <span class="id">Hl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">case</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even_opp">Z.even_opp</a></span><span class="id">,</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even_add">Z.even_add</a></span>.<br/>
<span class="id">now</span> <span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id">m</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_NE_sign" class="id"><a name="inbetween_float_NE_sign" class="">inbetween_float_NE_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:154" class="id"><a name="x:154" class="">x</a></span> <span id="m:155" class="id"><a name="m:155" class="">m</a></span> <span id="l:156" class="id"><a name="l:156" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:157" class="id"><a name="e:157" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:154">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:155">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:157">e</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:154">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:156">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Round_NE.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:154">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:154">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:155">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:156">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:155">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#e:157">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="s:161" class="id"><span id="s:158" class="id"><a name="s:161" class="">s</a></span></span> <span id="m:162" class="id"><span id="m:159" class="id"><a name="m:162" class="">m</a></span></span> <span id="l:163" class="id"><span id="l:160" class="id"><a name="l:163" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:159">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:160">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:159">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding to nearest away. </div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_NA" class="id"><a name="inbetween_int_NA" class="">inbetween_int_NA</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:164" class="id"><a name="x:164" class="">x</a></span> <span id="m:165" class="id"><a name="m:165" class="">m</a></span> <span id="l:166" class="id"><a name="l:166" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:165">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:164">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:166">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:164">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> <span class="id">0</span> <span class="id"><a href="Flocq.Calc.Round.html#m:165">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:166">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:165">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_N">inbetween_int_N</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="x:168" class="id"><span id="x:167" class="id"><a name="x:168" class="">x</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> <span class="id">0</span> <span class="id"><a href="Flocq.Calc.Round.html#x:167">x</a></span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_NA" class="id"><a name="inbetween_float_NA" class="">inbetween_float_NA</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:169" class="id"><a name="x:169" class="">x</a></span> <span id="m:170" class="id"><a name="m:170" class="">m</a></span> <span id="l:171" class="id"><a name="l:171" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:172" class="id"><a name="e:172" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:169">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:170">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:172">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:169">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:171">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:169">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> <span class="id">0</span> <span class="id"><a href="Flocq.Calc.Round.html#m:170">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:171">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:170">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#e:172">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="m:175" class="id"><span id="m:173" class="id"><a name="m:175" class="">m</a></span></span> <span id="l:176" class="id"><span id="l:174" class="id"><a name="l:176" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> <span class="id">0</span> <span class="id"><a href="Flocq.Calc.Round.html#m:173">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:174">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:173">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_int_NA_sign" class="id"><a name="inbetween_int_NA_sign" class="">inbetween_int_NA_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:177" class="id"><a name="x:177" class="">x</a></span> <span id="m:178" class="id"><a name="m:178" class="">m</a></span> <span id="l:179" class="id"><a name="l:179" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:178">m</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:177">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:179">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:177">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:177">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:179">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:178">m</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">erewrite</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_N_sign">inbetween_int_N_sign</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> <span class="id">0</span>).<br/>
<span class="id">2:</span> <span class="id">eexact</span> <span class="id">Hl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
<span class="id">assert</span> (<span class="id">Hm:</span> (<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id">m</span>)%<span class="id">Z</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ_le">Zlt_succ_le</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
<span class="id">refine</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hl</span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Zaux.html#Zle_bool_true">Zle_bool_true</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hm</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Zaux.html#Zle_bool_false">Zle_bool_false</a></span>.<br/>
<span class="id">now</span> <span class="id">case</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="inbetween_float_NA_sign" class="id"><a name="inbetween_float_NA_sign" class="">inbetween_float_NA_sign</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:180" class="id"><a name="x:180" class="">x</a></span> <span id="m:181" class="id"><a name="m:181" class="">m</a></span> <span id="l:182" class="id"><a name="l:182" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="e:183" class="id"><a name="e:183" class="">e</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:180">x</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:181">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:183">e</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:180">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:182">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:180">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:180">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:182">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:181">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#e:183">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="gallina-kwd">with</span> (<span class="id">choice</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="s:187" class="id"><span id="s:184" class="id"><a name="s:187" class="">s</a></span></span> <span id="m:188" class="id"><span id="m:185" class="id"><a name="m:188" class="">m</a></span></span> <span id="l:189" class="id"><span id="l:186" class="id"><a name="l:189" class="">l</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:186">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:185">m</a></span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NA_sign">inbetween_int_NA_sign</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="truncate_aux" class="id"><a name="truncate_aux" class="">truncate_aux</a></span> <span id="t:190" class="id"><a name="t:190" class="">t</a></span> <span id="k:191" class="id"><a name="k:191" class="">k</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m,</span> <span class="id">e,</span> <span class="id">l</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#t:190">t</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="p:193" class="id"><a name="p:193" class="">p</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#k:191">k</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id">m</span> <span class="id"><a href="Flocq.Calc.Round.html#p:193">p,</a></span> (<span class="id">e</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#k:191">k</a></span>)%<span class="id">Z,</span> <span class="id"><a href="Flocq.Calc.Bracket.html#new_location">new_location</a></span> <span class="id"><a href="Flocq.Calc.Round.html#p:193">p</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod">Zmod</a></span> <span class="id">m</span> <span class="id"><a href="Flocq.Calc.Round.html#p:193">p</a></span>) <span class="id">l</span>).<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="truncate_aux_comp" class="id"><a name="truncate_aux_comp" class="">truncate_aux_comp</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="t:194" class="id"><a name="t:194" class="">t</a></span> <span id="k1:195" class="id"><a name="k1:195" class="">k1</a></span> <span id="k2:196" class="id"><a name="k2:196" class="">k2,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="Flocq.Calc.Round.html#k1:195">k1</a></span>)%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="Flocq.Calc.Round.html#k2:196">k2</a></span>)%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span> <span class="id"><a href="Flocq.Calc.Round.html#t:194">t</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#k1:195">k1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#k2:196">k2</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span> <span class="id"><a href="Flocq.Calc.Round.html#t:194">t</a></span> <span class="id"><a href="Flocq.Calc.Round.html#k1:195">k1</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#k2:196">k2</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
<span class="id">intros</span> ((<span class="id">m,e</span>)<span class="id">,l</span>) <span class="id">k1</span> <span class="id">k2</span> <span class="id">Hk1</span> <span class="id">Hk2</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float_ex">inbetween_float_ex</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>) <span class="gallina-kwd">as</span> (<span class="id">x,Hx</span>).<br/>
<span class="id">assert</span> (<span class="id">B1</span> <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk1</span> <span class="id">Hx</span>).<br/>
<span class="id">assert</span> (<span class="id">Hk3:</span> (<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id">k1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">k2</span>)%<span class="id">Z</span>).<br/>
<span class="id">change</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> <span class="gallina-kwd">with</span> (<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">0</span>)%<span class="id">Z</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_lt_compat">Zplus_lt_compat</a></span>.<br/>
<span class="id">assert</span> (<span class="id">B3</span> <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk3</span> <span class="id">Hx</span>).<br/>
<span class="id">assert</span> (<span class="id">B2</span> <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk2</span> <span class="id">B1</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span> <span class="gallina-kwd">in</span> <span class="id">B3</span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float_unique">inbetween_float_unique</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">B2</span> <span class="id">B3</span>).<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id">H,</span> <span class="id">H0,</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Given a triple (mantissa, exponent, position), this function
    computes a triple with a canonic exponent, assuming the
    original triple had enough precision. </div>
<br/>
<span class="vernacular">Definition</span> <span id="truncate" class="id"><a name="truncate" class="">truncate</a></span> <span id="t:197" class="id"><a name="t:197" class="">t</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m,</span> <span class="id">e,</span> <span class="id">l</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#t:197">t</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="k:199" class="id"><a name="k:199" class="">k</a></span> <span class="id">:=</span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">e</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">e</span>)%<span class="id">Z</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id">0</span> <span class="id"><a href="Flocq.Calc.Round.html#k:199">k</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span> <span class="id"><a href="Flocq.Calc.Round.html#t:197">t</a></span> <span class="id"><a href="Flocq.Calc.Round.html#k:199">k</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="Flocq.Calc.Round.html#t:197">t</a></span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="truncate_0" class="id"><a name="truncate_0" class="">truncate_0</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="e:200" class="id"><a name="e:200" class="">e</a></span> <span id="l:201" class="id"><a name="l:201" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">0,</span> <span class="id"><a href="Flocq.Calc.Round.html#e:200">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:201">l</a></span>)%<span class="id">Z</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">m'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">intros</span> <span class="id">e</span> <span class="id">l</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span>.<br/>
<span class="id">case</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_0_l">Zdiv_0_l</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="generic_format_truncate" class="id"><a name="generic_format_truncate" class="">generic_format_truncate</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="m:202" class="id"><a name="m:202" class="">m</a></span> <span id="e:203" class="id"><a name="e:203" class="">e</a></span> <span id="l:204" class="id"><a name="l:204" class="">l,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:202">m</a></span>)%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:202">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:203">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:204">l</a></span>) <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#format">format</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m'</span> <span class="id">e'</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">intros</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hm</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span>.<br/>
<span class="id">set</span> (<span class="id">k</span> <span class="id">:=</span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">e</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="id">case</span> <span class="id"><a href="Flocq.Core.Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">;</span> <span class="id">intros</span> <span class="id">Hk</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="id">intros</span> <span class="id">Hd</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Float_prop.html#mag_F2R_Zdigits">mag_F2R_Zdigits</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hd</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Digits.html#Zdigits_div_Zpower">Zdigits_div_Zpower</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hm</span>).<br/>
<span class="id">replace</span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">k</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> (<span class="id">e</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">k</span>))%<span class="id">Z</span> <span class="gallina-kwd">with</span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">e</span>)%<span class="id">Z</span> <span class="gallina-kwd">by</span> <span class="id">ring</span>.<br/>
<span class="id">unfold</span> <span class="id">k</span>.<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_refl">Z.le_refl</a></span>.<br/>
<span class="id">split</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_weak">Zlt_le_weak</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Znot_gt_le">Znot_gt_le</a></span>.<br/>
<span class="id">contradict</span> <span class="id">Hd</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_small">Zdiv_small</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hm</span>).<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs_eq">Z.abs_eq</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hm</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Digits.html#Zpower_gt_Zdigits">Zpower_gt_Zdigits</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_weak">Zlt_le_weak</a></span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.gt_lt">Z.gt_lt</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_lt_or_eq">Zle_lt_or_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hm</span>) <span class="gallina-kwd">as</span> <span class="id">[Hm'|Hm']</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Float_prop.html#mag_F2R_Zdigits">mag_F2R_Zdigits</a></span>.<br/>
<span class="id">2:</span> <span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Core.Zaux.html#Zgt_not_eq">Zgt_not_eq</a></span>.<br/>
<span class="id">unfold</span> <span class="id">k</span> <span class="gallina-kwd">in</span> <span class="id">Hk</span>. <span class="id">clear</span> <span class="id">-Hk</span>.<br/>
<span class="id">lia</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">Hm',</span> <span class="id"><a href="Flocq.Core.Float_prop.html#F2R_0">F2R_0</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="truncate_correct_format" class="id"><a name="truncate_correct_format" class="">truncate_correct_format</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="m:205" class="id"><a name="m:205" class="">m</a></span> <span id="e:206" class="id"><a name="e:206" class="">e,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#m:205">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x">&lt;&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="x:207" class="id"><a name="x:207" class="">x</a></span> <span class="id">:=</span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:205">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:206">e</a></span>) <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:207">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:206">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:205">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:206">e</a></span>))%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:205">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:206">e,</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>) <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#x:207">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m'</span> <span class="id">e'</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id">e'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:207">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id">intros</span> <span class="id">m</span> <span class="id">e</span> <span class="id">Hm</span> <span class="id">x</span> <span class="id">Fx</span> <span class="id">He</span>.<br/>
<span class="id">assert</span> (<span class="id">Hc:</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">e</span>)).<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp,</a></span> <span class="id">x</span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Float_prop.html#mag_F2R_Zdigits">mag_F2R_Zdigits</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">Hc</span>.<br/>
<span class="id">set</span> (<span class="id">k</span> <span class="id">:=</span> (<span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="id">case</span> <span class="id"><a href="Flocq.Core.Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">;</span> <span class="id">intros</span> <span class="id">Hk</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Fx</span> <span class="gallina-kwd">at</span> <span class="id">1</span>.<br/>
<span class="id">assert</span> (<span class="id">H:</span> (<span class="id">e</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">k</span>)%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>).<br/>
<span class="id">unfold</span> <span class="id">k</span>. <span class="id">ring</span>.<br/>
<span class="id">refine</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">_</span> <span class="id">H</span>).<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Float_prop.html#F2R_eq">F2R_eq</a></span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="Flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>) <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="Flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>))).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Ztrunc_IZR">Ztrunc_IZR</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H</span>.<br/>
<span class="id">unfold</span> <span class="id">x,</span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span>. <span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc,</a></span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
<span class="id">ring_simplify</span> (<span class="id">e</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> (<span class="id">e</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">k</span>))%<span class="id">Z</span>.<br/>
<span class="id">clear</span> <span class="id">-Hm</span> <span class="id">Hk</span>.<br/>
<span class="id">destruct</span> <span class="id">k</span> <span class="gallina-kwd">as</span> <span class="id">[|k|k]</span> <span class="id">;</span> <span class="id">try</span> <span class="id">easy</span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_div">Zfloor_div</a></span>.<br/>
<span class="id">intros</span> <span class="id">H</span>.<br/>
<span class="id">generalize</span> (<span class="id"><a href="Flocq.Core.Zaux.html#Zpower_pos_gt_0">Zpower_pos_gt_0</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">k</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Flocq.Core.Zaux.html#radix_prop">radix_prop</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span>)).<br/>
<span class="id">lia</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#scaled_mantissa_generic">scaled_mantissa_generic</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Fx</span>).<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Zfloor_IZR">Zfloor_IZR</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">split</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
<span class="id">unfold</span> <span class="id">k</span> <span class="gallina-kwd">in</span> <span class="id">Hk</span>.<br/>
<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="truncate_correct_partial'" class="id"><a name="truncate_correct_partial'" class="">truncate_correct_partial'</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:208" class="id"><a name="x:208" class="">x</a></span> <span id="m:209" class="id"><a name="m:209" class="">m</a></span> <span id="e:210" class="id"><a name="e:210" class="">e</a></span> <span id="l:211" class="id"><a name="l:211" class="">l,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:208">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:209">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:210">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:208">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:211">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:210">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:208">x</a></span>)%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:209">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:210">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:211">l</a></span>) <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m'</span> <span class="id">e'</span> <span class="id"><a href="Flocq.Calc.Round.html#x:208">x</a></span> <span class="id">l'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id">e'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:208">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Calc.Round.html#cexp_inbetween_float">cexp_inbetween_float</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hx</span>) (<span class="id">2</span> <span class="id">:=</span> <span class="id">H1</span>) <span class="gallina-kwd">by</span> <span class="id">now</span> <span class="id">left</span>.<br/>
<span class="id">generalize</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_cases">Zlt_cases</a></span> <span class="id">0</span> (<span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">e</span>)).<br/>
<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id">;</span> <span class="id">intros</span> <span class="id">Hk</span>.<br/>
<span class="id">-</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span>.<br/>
&nbsp;&nbsp;<span class="id">ring</span>.<br/>
<span class="id">-</span> <span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="truncate_correct_partial" class="id"><a name="truncate_correct_partial" class="">truncate_correct_partial</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:212" class="id"><a name="x:212" class="">x</a></span> <span id="m:213" class="id"><a name="m:213" class="">m</a></span> <span id="e:214" class="id"><a name="e:214" class="">e</a></span> <span id="l:215" class="id"><a name="l:215" class="">l,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:212">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:213">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:214">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:212">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:215">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:214">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:213">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:214">e</a></span>))%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:213">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:214">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:215">l</a></span>) <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m'</span> <span class="id">e'</span> <span class="id"><a href="Flocq.Calc.Round.html#x:212">x</a></span> <span class="id">l'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id">e'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:212">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_correct_partial'">truncate_correct_partial'</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hx</span>) (<span class="id">2</span> <span class="id">:=</span> <span class="id">H1</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Calc.Round.html#cexp_inbetween_float">cexp_inbetween_float</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hx</span>) (<span class="id">2</span> <span class="id">:=</span> <span class="id">H1</span>).<br/>
<span class="id">exact</span> <span class="id">H2</span>.<br/>
<span class="id">now</span> <span class="id">right</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="truncate_correct'" class="id"><a name="truncate_correct'" class="">truncate_correct'</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:216" class="id"><a name="x:216" class="">x</a></span> <span id="m:217" class="id"><a name="m:217" class="">m</a></span> <span id="e:218" class="id"><a name="e:218" class="">e</a></span> <span id="l:219" class="id"><a name="l:219" class="">l,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:216">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:217">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:218">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:216">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:219">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:218">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:216">x</a></span>)%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:219">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:217">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:218">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:219">l</a></span>) <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m'</span> <span class="id">e'</span> <span class="id"><a href="Flocq.Calc.Round.html#x:216">x</a></span> <span class="id">l'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span><br/>
&nbsp;&nbsp;(<span class="id">e'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:216">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> (<span class="id">l'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="Flocq.Calc.Round.html#format">format</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:216">x</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">[Hx|Hx]</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="id">-</span> <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> <span class="id">e</span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">e</span>))) <span class="gallina-kwd">as</span> <span class="id">[H3|H3]</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">generalize</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate_correct_partial">truncate_correct_partial</a></span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m,</span> <span class="id">e,</span> <span class="id">l</span>)) <span class="gallina-kwd">as</span> <span class="id">[[m'</span> <span class="id">e']</span> <span class="id">l']</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">[H4</span> <span class="id">H5]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">destruct</span> <span class="id">H2</span> <span class="gallina-kwd">as</span> <span class="id">[H2|H2]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate_correct_partial'">truncate_correct_partial'</a></span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m,</span> <span class="id">e,</span> <span class="id">l</span>)) <span class="gallina-kwd">as</span> <span class="id">[[m'</span> <span class="id">e']</span> <span class="id">l']</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">[H4</span> <span class="id">H5]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H2</span> <span class="gallina-kwd">in</span> <span class="id">H1</span> <span class="id">|-</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_cases">Zlt_cases</a></span> <span class="id">0</span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">e</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">e</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False_ind">False_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion_clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">Zm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Float_prop.html#mag_F2R_Zdigits">mag_F2R_Zdigits</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_weak">Zlt_le_weak</a></span>.<br/>
<span class="id">-</span> <span class="id">assert</span> (<span class="id">Hm:</span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;<span class="id">cut</span> (<span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>)%<span class="id">Z</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id">e</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#b6aaeb1973f5e630a6779ff194ed22e3">&lt;=</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#b6aaeb1973f5e630a6779ff194ed22e3">&lt;</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>) <span class="id">e</span>))%<span class="id">R</span> <span class="gallina-kwd">as</span> <span class="id">Hx'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float_bounds">inbetween_float_bounds</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">Hx</span> <span class="gallina-kwd">in</span> <span class="id">Hx'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Float_prop.html#le_0_F2R">le_0_F2R</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Float_prop.html#gt_0_F2R">gt_0_F2R</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx'</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hm,</span> <span class="id">&lt;-</span> <span class="id">Hx</span> <span class="gallina-kwd">in</span> <span class="id">H1</span> <span class="id">|-</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">clear</span> <span class="id">-H1</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span> <span class="gallina-kwd">as</span> <span class="id">[_</span> <span class="id">|</span> <span class="id">l'</span> <span class="id">[H</span> <span class="id">_]</span> <span class="id">_]</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">assert</span> (<span class="gallina-kwd">exists</span> <span id="e':221" class="id"><span id="e':220" class="id"><a name="e':221" class="">e',</a></span></span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0,</a></span> <span class="id">e,</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e':220">e',</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_0_l">Zdiv_0_l,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod_0_l">Zmod_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f_equal">f_equal</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Bracket.html#new_location">new_location</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">case</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H</span> <span class="gallina-kwd">as</span> <span class="id">[e'</span> <span class="id">H]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym,</a></span> <span class="id"><a href="Flocq.Core.Float_prop.html#F2R_0">F2R_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Float_prop.html#F2R_0">F2R_0</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">elim</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">H</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="truncate_correct" class="id"><a name="truncate_correct" class="">truncate_correct</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:222" class="id"><a name="x:222" class="">x</a></span> <span id="m:223" class="id"><a name="m:223" class="">m</a></span> <span id="e:224" class="id"><a name="e:224" class="">e</a></span> <span id="l:225" class="id"><a name="l:225" class="">l,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:222">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:223">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:224">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:222">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:225">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:224">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:223">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:224">e</a></span>))%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:225">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:223">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:224">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:225">l</a></span>) <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m'</span> <span class="id">e'</span> <span class="id"><a href="Flocq.Calc.Round.html#x:222">x</a></span> <span class="id">l'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span><br/>
&nbsp;&nbsp;(<span class="id">e'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:222">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> (<span class="id">l'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="Flocq.Calc.Round.html#format">format</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:222">x</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_correct'">truncate_correct'</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hx</span>) (<span class="id">2</span> <span class="id">:=</span> <span class="id">H1</span>).<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#cexp_inbetween_float_loc_Exact">cexp_inbetween_float_loc_Exact</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">H1</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Section</span> <span id="Fcalc_round.Fcalc_round_fexp.round_dir" class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir" class="">round_dir</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="Fcalc_round.Fcalc_round_fexp.round_dir.rnd" class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir.rnd" class="">rnd</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{</span> <span id="valid_rnd:227" class="id"><a name="valid_rnd:227" class="">valid_rnd</a></span> <span class="id">:</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Valid_rnd">Valid_rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="Fcalc_round.Fcalc_round_fexp.round_dir.choice" class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir.choice" class="">choice</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#location">location</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid" class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid" class="">inbetween_int_valid</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:229" class="id"><a name="x:229" class="">x</a></span> <span id="m:230" class="id"><a name="m:230" class="">m</a></span> <span id="l:231" class="id"><a name="l:231" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:230">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:229">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:231">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:229">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:230">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:231">l</a></span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="round_any_correct" class="id"><a name="round_any_correct" class="">round_any_correct</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:233" class="id"><a name="x:233" class="">x</a></span> <span id="m:234" class="id"><a name="m:234" class="">m</a></span> <span id="e:235" class="id"><a name="e:235" class="">e</a></span> <span id="l:236" class="id"><a name="l:236" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:234">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:235">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:233">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:236">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:235">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:233">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#l:236">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="Flocq.Calc.Round.html#format">format</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:233">x</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:233">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:234">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:236">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#e:235">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof with</span></div>
<div class="proofscript" id="proof36">
 <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hin</span> <span class="id">[He|</span>(<span class="id">Hl,Hf</span>)<span class="id">]</span>.<br/>
<span class="id">rewrite</span> <span class="id">He</span> <span class="gallina-kwd">in</span> <span class="id">Hin</span> <span class="id">|-</span> <span class="id">*</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">Hin</span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Hl</span> <span class="gallina-kwd">in</span> <span class="id">Hin</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">Hin</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hl</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id">m</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>) <span class="gallina-kwd">with</span> <span class="id">m</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span>...<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="Flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id">m</span>) <span class="gallina-kwd">at</span> <span class="id">1</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">now</span> <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Truncating a triple is sufficient to round a real number. </div>
<br/>
<span class="vernacular">Theorem</span> <span id="round_trunc_any_correct" class="id"><a name="round_trunc_any_correct" class="">round_trunc_any_correct</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:237" class="id"><a name="x:237" class="">x</a></span> <span id="m:238" class="id"><a name="m:238" class="">m</a></span> <span id="e:239" class="id"><a name="e:239" class="">e</a></span> <span id="l:240" class="id"><a name="l:240" class="">l,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:237">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:238">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:239">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:237">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:240">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:239">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:238">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:239">e</a></span>))%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:240">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:237">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:238">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:239">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:240">l</a></span>) <span class="gallina-kwd">in</span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id">m'</span> <span class="id">l'</span>) <span class="id">e'</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="id">generalize</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate_correct">truncate_correct</a></span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>).<br/>
<span class="id">destruct</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m,</span> <span class="id">e,</span> <span class="id">l</span>)) <span class="gallina-kwd">as</span> ((<span class="id">m',</span> <span class="id">e'</span>)<span class="id">,</span> <span class="id">l'</span>).<br/>
<span class="id">intros</span> (<span class="id">H1,</span> <span class="id">H2</span>).<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="round_trunc_any_correct'" class="id"><a name="round_trunc_any_correct'" class="">round_trunc_any_correct'</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:241" class="id"><a name="x:241" class="">x</a></span> <span id="m:242" class="id"><a name="m:242" class="">m</a></span> <span id="e:243" class="id"><a name="e:243" class="">e</a></span> <span id="l:244" class="id"><a name="l:244" class="">l,</a></span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:241">x</a></span>)%<span class="id">R</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:242">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:243">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:241">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:244">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:243">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:241">x</a></span>)%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:244">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:241">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:242">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:243">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:244">l</a></span>) <span class="gallina-kwd">in</span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id">m'</span> <span class="id">l'</span>) <span class="id">e'</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="id">generalize</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate_correct'">truncate_correct'</a></span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>).<br/>
<span class="id">destruct</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m,</span> <span class="id">e,</span> <span class="id">l</span>)) <span class="gallina-kwd">as</span> <span class="id">[[m'</span> <span class="id">e']</span> <span class="id">l']</span>.<br/>
<span class="id">intros</span> <span class="id">[H1</span> <span class="id">H2]</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir">round_dir</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="Fcalc_round.Fcalc_round_fexp.round_dir_sign" class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign" class="">round_dir_sign</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd" class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd" class="">rnd</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{</span> <span id="valid_rnd:246" class="id"><a name="valid_rnd:246" class="">valid_rnd</a></span> <span class="id">:</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#Valid_rnd">Valid_rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice" class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice" class="">choice</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#location">location</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid" class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid" class="">inbetween_int_valid</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:248" class="id"><a name="x:248" class="">x</a></span> <span id="m:249" class="id"><a name="m:249" class="">m</a></span> <span id="l:250" class="id"><a name="l:250" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:249">m</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:248">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:250">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:248">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:248">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:248">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#m:249">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:250">l</a></span>).<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="round_sign_any_correct" class="id"><a name="round_sign_any_correct" class="">round_sign_any_correct</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:252" class="id"><a name="x:252" class="">x</a></span> <span id="m:253" class="id"><a name="m:253" class="">m</a></span> <span id="e:254" class="id"><a name="e:254" class="">e</a></span> <span id="l:255" class="id"><a name="l:255" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:253">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:254">e</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:252">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:255">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:254">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:252">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#l:255">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="Flocq.Calc.Round.html#format">format</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:252">x</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:252">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:252">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:252">x</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#m:253">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:255">l</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#e:254">e</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof with</span></div>
<div class="proofscript" id="proof39">
 <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hin</span> <span class="id">[He|</span>(<span class="id">Hl,Hf</span>)<span class="id">]</span>.<br/>
<span class="id">rewrite</span> <span class="id">He</span> <span class="gallina-kwd">in</span> <span class="id">Hin</span> <span class="id">|-</span> <span class="id">*</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">Hin</span>).<br/>
<span class="id">exact</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">Hl</span> <span class="gallina-kwd">in</span> <span class="id">Hin</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">Hin</span>.<br/>
<span class="id">rewrite</span> <span class="id">Hl</span>.<br/>
<span class="id">replace</span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id">x</span> <span class="id">0</span>) <span class="id">m</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>) <span class="gallina-kwd">with</span> <span class="id">m</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="gallina-kwd">as</span> <span class="id">[Zx|Zx]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Zx</span>).<br/>
<span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Float_prop.html#F2R_Zopp">F2R_Zopp</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H,</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span>...<br/>
<span class="id">rewrite</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="id">simpl</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="id">destruct</span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_spec">Rlt_bool_spec</a></span> <span class="id">x</span> <span class="id">0</span>) <span class="gallina-kwd">as</span> <span class="id">[Zx|Zx]</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.opp_inj">Z.opp_inj</a></span>.<br/>
<span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> <span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">m</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>))%<span class="id">Z</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="Flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-m</a></span>)) <span class="gallina-kwd">at</span> <span class="id">1</span>.<br/>
<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-m</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#::R_scope:x_'&lt;'_x">&lt;</a></span> <span class="id">0</span>)%<span class="id">R</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_gt_0_contravar">Ropp_lt_gt_0_contravar</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Float_prop.html#gt_0_F2R">gt_0_F2R</a></span> <span class="gallina-kwd">with</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_lt">Rabs_pos_lt</a></span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">H0</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">constructor</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left">Rabs_left</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">H0</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="id">change</span> (<span class="id">m</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">m</span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>))%<span class="id">Z</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> (<span class="id"><a href="Flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id">m</span>) <span class="gallina-kwd">at</span> <span class="id">1</span>.<br/>
<span class="id">assert</span> (<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#77d341fe206b2891763e25999ffddca2">&lt;=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>)%<span class="id">R</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Float_prop.html#ge_0_F2R">ge_0_F2R</a></span> <span class="gallina-kwd">with</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">H0</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">constructor</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Truncating a triple is sufficient to round a real number. </div>
<br/>
<span class="vernacular">Theorem</span> <span id="round_trunc_sign_any_correct'" class="id"><a name="round_trunc_sign_any_correct'" class="">round_trunc_sign_any_correct'</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:256" class="id"><a name="x:256" class="">x</a></span> <span id="m:257" class="id"><a name="m:257" class="">m</a></span> <span id="e:258" class="id"><a name="e:258" class="">e</a></span> <span id="l:259" class="id"><a name="l:259" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:257">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:258">e</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:256">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:259">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:258">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:256">x</a></span>)%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:259">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:256">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:257">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:258">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:259">l</a></span>) <span class="gallina-kwd">in</span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:256">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:256">x</a></span> <span class="id">0</span>) <span class="id">m'</span> <span class="id">l'</span>)) <span class="id">e'</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp_abs">cexp_abs</a></span> <span class="gallina-kwd">in</span> <span class="id">He</span>.<br/>
<span class="id">generalize</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate_correct'">truncate_correct'</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>) <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> <span class="id">_</span>) <span class="id">Hl</span> <span class="id">He</span>).<br/>
<span class="id">destruct</span> (<span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m,</span> <span class="id">e,</span> <span class="id">l</span>)) <span class="gallina-kwd">as</span> <span class="id">[[m'</span> <span class="id">e']</span> <span class="id">l']</span>.<br/>
<span class="id">intros</span> <span class="id">[H1</span> <span class="id">H2]</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span>.<br/>
<span class="id">exact</span> <span class="id">H1</span>.<br/>
<span class="id">destruct</span> <span class="id">H2</span> <span class="gallina-kwd">as</span> <span class="id">[H2|[H2</span> <span class="id">H3]]</span>.<br/>
<span class="id">left</span>.<br/>
<span class="id">now</span> <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp_abs">cexp_abs</a></span>.<br/>
<span class="id">right</span>.<br/>
<span class="id">apply</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H2</span>).<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format_abs_inv">generic_format_abs_inv</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="round_trunc_sign_any_correct" class="id"><a name="round_trunc_sign_any_correct" class="">round_trunc_sign_any_correct</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:260" class="id"><a name="x:260" class="">x</a></span> <span id="m:261" class="id"><a name="m:261" class="">m</a></span> <span id="e:262" class="id"><a name="e:262" class="">e</a></span> <span id="l:263" class="id"><a name="l:263" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:261">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:262">e</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:260">x</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:263">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:262">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="Flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:261">m</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:262">e</a></span>))%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:263">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:260">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:261">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:262">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:263">l</a></span>) <span class="gallina-kwd">in</span> <span class="id"><a href="Flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="Flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:260">x</a></span> <span class="id">0</span>) (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="Flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:260">x</a></span> <span class="id">0</span>) <span class="id">m'</span> <span class="id">l'</span>)) <span class="id">e'</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct'">round_trunc_sign_any_correct'</a></span> <span class="gallina-kwd">with</span> (<span class="id">1</span> <span class="id">:=</span> <span class="id">Hl</span>).<br/>
<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp_abs">cexp_abs</a></span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Round.html#cexp_inbetween_float_loc_Exact">cexp_inbetween_float_loc_Exact</a></span> <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id">:=</span> <span class="id">Hl</span>) (<span class="id">3</span> <span class="id">:=</span> <span class="id">He</span>).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign">round_dir_sign</a></span>.<br/>
<br/>
<h1> Instances of the theorems above, for the usual rounding modes. </h1>
<br/>
<span class="vernacular">Definition</span> <span id="round_DN_correct" class="id"><a name="round_DN_correct" class="">round_DN_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:264" class="id"><a name="m:264" class="">m</a></span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#m:264">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_DN_correct" class="id"><a name="round_trunc_DN_correct" class="">round_trunc_DN_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:265" class="id"><a name="m:265" class="">m</a></span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#m:265">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_DN_correct'" class="id"><a name="round_trunc_DN_correct'" class="">round_trunc_DN_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct'">round_trunc_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:266" class="id"><a name="m:266" class="">m</a></span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#m:266">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_sign_DN_correct" class="id"><a name="round_sign_DN_correct" class="">round_sign_DN_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:267" class="id"><a name="s:267" class="">s</a></span> <span id="m:268" class="id"><a name="m:268" class="">m</a></span> <span id="l:269" class="id"><a name="l:269" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="Flocq.Calc.Round.html#s:267">s</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:269">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:268">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_DN_correct" class="id"><a name="round_trunc_sign_DN_correct" class="">round_trunc_sign_DN_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:270" class="id"><a name="s:270" class="">s</a></span> <span id="m:271" class="id"><a name="m:271" class="">m</a></span> <span id="l:272" class="id"><a name="l:272" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="Flocq.Calc.Round.html#s:270">s</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:272">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:271">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_DN_correct'" class="id"><a name="round_trunc_sign_DN_correct'" class="">round_trunc_sign_DN_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct'">round_trunc_sign_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:273" class="id"><a name="s:273" class="">s</a></span> <span id="m:274" class="id"><a name="m:274" class="">m</a></span> <span id="l:275" class="id"><a name="l:275" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="Flocq.Calc.Round.html#s:273">s</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:275">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:274">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_UP_correct" class="id"><a name="round_UP_correct" class="">round_UP_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:276" class="id"><a name="m:276" class="">m</a></span> <span id="l:277" class="id"><a name="l:277" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:277">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:276">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_UP_correct" class="id"><a name="round_trunc_UP_correct" class="">round_trunc_UP_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:278" class="id"><a name="m:278" class="">m</a></span> <span id="l:279" class="id"><a name="l:279" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:279">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:278">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_UP_correct'" class="id"><a name="round_trunc_UP_correct'" class="">round_trunc_UP_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct'">round_trunc_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:280" class="id"><a name="m:280" class="">m</a></span> <span id="l:281" class="id"><a name="l:281" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:281">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:280">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_sign_UP_correct" class="id"><a name="round_sign_UP_correct" class="">round_sign_UP_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:282" class="id"><a name="s:282" class="">s</a></span> <span id="m:283" class="id"><a name="m:283" class="">m</a></span> <span id="l:284" class="id"><a name="l:284" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#s:282">s</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:284">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:283">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_UP_correct" class="id"><a name="round_trunc_sign_UP_correct" class="">round_trunc_sign_UP_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:285" class="id"><a name="s:285" class="">s</a></span> <span id="m:286" class="id"><a name="m:286" class="">m</a></span> <span id="l:287" class="id"><a name="l:287" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#s:285">s</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:287">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:286">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_UP_correct'" class="id"><a name="round_trunc_sign_UP_correct'" class="">round_trunc_sign_UP_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct'">round_trunc_sign_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:288" class="id"><a name="s:288" class="">s</a></span> <span id="m:289" class="id"><a name="m:289" class="">m</a></span> <span id="l:290" class="id"><a name="l:290" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="Flocq.Calc.Round.html#s:288">s</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:290">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:289">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_ZR_correct" class="id"><a name="round_ZR_correct" class="">round_ZR_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:291" class="id"><a name="m:291" class="">m</a></span> <span id="l:292" class="id"><a name="l:292" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:291">m</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:292">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:291">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_ZR_correct" class="id"><a name="round_trunc_ZR_correct" class="">round_trunc_ZR_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:293" class="id"><a name="m:293" class="">m</a></span> <span id="l:294" class="id"><a name="l:294" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:293">m</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:294">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:293">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_ZR_correct'" class="id"><a name="round_trunc_ZR_correct'" class="">round_trunc_ZR_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct'">round_trunc_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:295" class="id"><a name="m:295" class="">m</a></span> <span id="l:296" class="id"><a name="l:296" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:295">m</a></span> <span class="id">0</span>) <span class="id"><a href="Flocq.Calc.Round.html#l:296">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:295">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_sign_ZR_correct" class="id"><a name="round_sign_ZR_correct" class="">round_sign_ZR_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:297" class="id"><a name="s:297" class="">s</a></span> <span id="m:298" class="id"><a name="m:298" class="">m</a></span> <span id="l:299" class="id"><a name="l:299" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#m:298">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_ZR_correct" class="id"><a name="round_trunc_sign_ZR_correct" class="">round_trunc_sign_ZR_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:300" class="id"><a name="s:300" class="">s</a></span> <span id="m:301" class="id"><a name="m:301" class="">m</a></span> <span id="l:302" class="id"><a name="l:302" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#m:301">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_ZR_correct'" class="id"><a name="round_trunc_sign_ZR_correct'" class="">round_trunc_sign_ZR_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct'">round_trunc_sign_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:303" class="id"><a name="s:303" class="">s</a></span> <span id="m:304" class="id"><a name="m:304" class="">m</a></span> <span id="l:305" class="id"><a name="l:305" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#m:304">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_NE_correct" class="id"><a name="round_NE_correct" class="">round_NE_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:306" class="id"><a name="m:306" class="">m</a></span> <span id="l:307" class="id"><a name="l:307" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:306">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:307">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:306">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_NE_correct" class="id"><a name="round_trunc_NE_correct" class="">round_trunc_NE_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:308" class="id"><a name="m:308" class="">m</a></span> <span id="l:309" class="id"><a name="l:309" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:308">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:309">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:308">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_NE_correct'" class="id"><a name="round_trunc_NE_correct'" class="">round_trunc_NE_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct'">round_trunc_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:310" class="id"><a name="m:310" class="">m</a></span> <span id="l:311" class="id"><a name="l:311" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:310">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:311">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:310">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_sign_NE_correct" class="id"><a name="round_sign_NE_correct" class="">round_sign_NE_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:312" class="id"><a name="s:312" class="">s</a></span> <span id="m:313" class="id"><a name="m:313" class="">m</a></span> <span id="l:314" class="id"><a name="l:314" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:313">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:314">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:313">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_NE_correct" class="id"><a name="round_trunc_sign_NE_correct" class="">round_trunc_sign_NE_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:315" class="id"><a name="s:315" class="">s</a></span> <span id="m:316" class="id"><a name="m:316" class="">m</a></span> <span id="l:317" class="id"><a name="l:317" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:316">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:317">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:316">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_NE_correct'" class="id"><a name="round_trunc_sign_NE_correct'" class="">round_trunc_sign_NE_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct'">round_trunc_sign_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:318" class="id"><a name="s:318" class="">s</a></span> <span id="m:319" class="id"><a name="m:319" class="">m</a></span> <span id="l:320" class="id"><a name="l:320" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:319">m</a></span>)) <span class="id"><a href="Flocq.Calc.Round.html#l:320">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:319">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_NA_correct" class="id"><a name="round_NA_correct" class="">round_NA_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:321" class="id"><a name="m:321" class="">m</a></span> <span id="l:322" class="id"><a name="l:322" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> <span class="id">0</span> <span class="id"><a href="Flocq.Calc.Round.html#m:321">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:322">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:321">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_NA_correct" class="id"><a name="round_trunc_NA_correct" class="">round_trunc_NA_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:323" class="id"><a name="m:323" class="">m</a></span> <span id="l:324" class="id"><a name="l:324" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> <span class="id">0</span> <span class="id"><a href="Flocq.Calc.Round.html#m:323">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:324">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:323">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_NA_correct'" class="id"><a name="round_trunc_NA_correct'" class="">round_trunc_NA_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_any_correct'">round_trunc_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="m:325" class="id"><a name="m:325" class="">m</a></span> <span id="l:326" class="id"><a name="l:326" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> <span class="id">0</span> <span class="id"><a href="Flocq.Calc.Round.html#m:325">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#l:326">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:325">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_sign_NA_correct" class="id"><a name="round_sign_NA_correct" class="">round_sign_NA_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:327" class="id"><a name="s:327" class="">s</a></span> <span id="m:328" class="id"><a name="m:328" class="">m</a></span> <span id="l:329" class="id"><a name="l:329" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:329">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:328">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NA_sign">inbetween_int_NA_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_NA_correct" class="id"><a name="round_trunc_sign_NA_correct" class="">round_trunc_sign_NA_correct</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:330" class="id"><a name="s:330" class="">s</a></span> <span id="m:331" class="id"><a name="m:331" class="">m</a></span> <span id="l:332" class="id"><a name="l:332" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:332">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:331">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NA_sign">inbetween_int_NA_sign</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="round_trunc_sign_NA_correct'" class="id"><a name="round_trunc_sign_NA_correct'" class="">round_trunc_sign_NA_correct'</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Round.html#round_trunc_sign_any_correct'">round_trunc_sign_any_correct'</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span id="s:333" class="id"><a name="s:333" class="">s</a></span> <span id="m:334" class="id"><a name="m:334" class="">m</a></span> <span id="l:335" class="id"><a name="l:335" class="">l</a></span> <span class="id">=&gt;</span> <span class="id"><a href="Flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:335">l</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#m:334">m</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#inbetween_int_NA_sign">inbetween_int_NA_sign</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp">Fcalc_round_fexp</a></span>.<br/>
<br/>
<div class="doc">Specialization of truncate for FIX formats. </div>
<br/>
<span class="vernacular">Variable</span> <span id="Fcalc_round.emin" class="id"><a name="Fcalc_round.emin" class="">emin</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="truncate_FIX" class="id"><a name="truncate_FIX" class="">truncate_FIX</a></span> <span id="t:337" class="id"><a name="t:337" class="">t</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m,</span> <span class="id">e,</span> <span class="id">l</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#t:337">t</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="k:339" class="id"><a name="k:339" class="">k</a></span> <span class="id">:=</span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">e</span>)%<span class="id">Z</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id">0</span> <span class="id"><a href="Flocq.Calc.Round.html#k:339">k</a></span> <span class="gallina-kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="p:340" class="id"><a name="p:340" class="">p</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#k:339">k</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id">m</span> <span class="id"><a href="Flocq.Calc.Round.html#p:340">p,</a></span> (<span class="id">e</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="Flocq.Calc.Round.html#k:339">k</a></span>)%<span class="id">Z,</span> <span class="id"><a href="Flocq.Calc.Bracket.html#new_location">new_location</a></span> <span class="id"><a href="Flocq.Calc.Round.html#p:340">p</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod">Zmod</a></span> <span class="id">m</span> <span class="id"><a href="Flocq.Calc.Round.html#p:340">p</a></span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="Flocq.Calc.Round.html#t:337">t</a></span>.<br/>
<br/>
<span class="vernacular">Theorem</span> <span id="truncate_FIX_correct" class="id"><a name="truncate_FIX_correct" class="">truncate_FIX_correct</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:341" class="id"><a name="x:341" class="">x</a></span> <span id="m:342" class="id"><a name="m:342" class="">m</a></span> <span id="e:343" class="id"><a name="e:343" class="">e</a></span> <span id="l:344" class="id"><a name="l:344" class="">l,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="Flocq.Calc.Round.html#m:342">m</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:343">e</a></span> <span class="id"><a href="Flocq.Calc.Round.html#x:341">x</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:344">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="Flocq.Calc.Round.html#e:343">e</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span>)%<span class="id">Z</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:344">l</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span class="id">'</span>(<span class="id">m',</span> <span class="id">e',</span> <span class="id">l'</span>) <span class="id">:=</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_FIX">truncate_FIX</a></span> (<span class="id"><a href="Flocq.Calc.Round.html#m:342">m,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#e:343">e,</a></span> <span class="id"><a href="Flocq.Calc.Round.html#l:344">l</a></span>) <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m'</span> <span class="id">e'</span> <span class="id"><a href="Flocq.Calc.Round.html#x:341">x</a></span> <span class="id">l'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span><br/>
&nbsp;&nbsp;(<span class="id">e'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.FIX.html#FIX_exp">FIX_exp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#x:341">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> (<span class="id">l'</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="Flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="Flocq.Core.FIX.html#FIX_exp">FIX_exp</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span>) <span class="id"><a href="Flocq.Calc.Round.html#x:341">x</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
<span class="id">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Calc.Round.html#truncate_FIX">truncate_FIX</a></span>.<br/>
<span class="id">set</span> (<span class="id">k</span> <span class="id">:=</span> (<span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="id">set</span> (<span class="id">p</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">k</span>).<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp,</a></span> <span class="id"><a href="Flocq.Core.FIX.html#FIX_exp">FIX_exp</a></span>.<br/>
<span class="id">generalize</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_cases">Zlt_cases</a></span> <span class="id">0</span> <span class="id">k</span>).<br/>
<span class="id">case</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id">0</span> <span class="id">k</span>) <span class="id">;</span> <span class="id">intros</span> <span class="id">Hk</span>.<br/>
<span class="comment">(*&nbsp;shift&nbsp;*)</span><br/>
<span class="id">split</span>.<br/>
<span class="id">now</span> <span class="id">apply</span> <span class="id"><a href="Flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span>.<br/>
<span class="id">clear</span> <span class="id">H2</span>.<br/>
<span class="id">left</span>.<br/>
<span class="id">unfold</span> <span class="id">k</span>.<br/>
<span class="id">ring</span>.<br/>
<span class="comment">(*&nbsp;no&nbsp;shift&nbsp;*)</span><br/>
<span class="id">split</span>.<br/>
<span class="id">exact</span> <span class="id">H1</span>.<br/>
<span class="id">unfold</span> <span class="id">k</span> <span class="gallina-kwd">in</span> <span class="id">Hk</span>.<br/>
<span class="id">destruct</span> <span class="id">H2</span> <span class="gallina-kwd">as</span> <span class="id">[H2|H2]</span>.<br/>
<span class="id">left</span>.<br/>
<span class="id">lia</span>.<br/>
<span class="id">right</span>.<br/>
<span class="id">split</span>.<br/>
<span class="id">exact</span> <span class="id">H2</span>.<br/>
<span class="id">rewrite</span> <span class="id">H2</span> <span class="gallina-kwd">in</span> <span class="id">H1</span>.<br/>
<span class="id">inversion_clear</span> <span class="id">H1</span>.<br/>
<span class="id">rewrite</span> <span class="id">H</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="id">unfold</span> <span class="id"><a href="Flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="Flocq.Calc.Round.html#Fcalc_round">Fcalc_round</a></span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
