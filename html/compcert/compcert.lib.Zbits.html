
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Zbits</title>
<meta name="description" content="Documentation of Coq module Zbits" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="compcert"><summary>compcert</summary>
          <ul>
          <li><details id="compcert.backend"><summary>backend</summary>
          <ul>
          <li><a href="compcert.backend.Allocation.html">Allocation</a></li>
<li><a href="compcert.backend.Allocproof.html">Allocproof</a></li>
<li><a href="compcert.backend.Asmgenproof0.html">Asmgenproof0</a></li>
<li><a href="compcert.backend.Bounds.html">Bounds</a></li>
<li><a href="compcert.backend.CleanupLabels.html">CleanupLabels</a></li>
<li><a href="compcert.backend.CleanupLabelsproof.html">CleanupLabelsproof</a></li>
<li><a href="compcert.backend.Cminor.html">Cminor</a></li>
<li><a href="compcert.backend.CminorSel.html">CminorSel</a></li>
<li><a href="compcert.backend.Cminortyping.html">Cminortyping</a></li>
<li><a href="compcert.backend.Constprop.html">Constprop</a></li>
<li><a href="compcert.backend.Constpropproof.html">Constpropproof</a></li>
<li><a href="compcert.backend.Conventions.html">Conventions</a></li>
<li><a href="compcert.backend.CSE.html">CSE</a></li>
<li><a href="compcert.backend.CSEdomain.html">CSEdomain</a></li>
<li><a href="compcert.backend.CSEproof.html">CSEproof</a></li>
<li><a href="compcert.backend.Deadcode.html">Deadcode</a></li>
<li><a href="compcert.backend.Deadcodeproof.html">Deadcodeproof</a></li>
<li><a href="compcert.backend.Debugvar.html">Debugvar</a></li>
<li><a href="compcert.backend.Debugvarproof.html">Debugvarproof</a></li>
<li><a href="compcert.backend.Inlining.html">Inlining</a></li>
<li><a href="compcert.backend.Inliningproof.html">Inliningproof</a></li>
<li><a href="compcert.backend.Inliningspec.html">Inliningspec</a></li>
<li><a href="compcert.backend.Kildall.html">Kildall</a></li>
<li><a href="compcert.backend.Linear.html">Linear</a></li>
<li><a href="compcert.backend.Linearize.html">Linearize</a></li>
<li><a href="compcert.backend.Linearizeproof.html">Linearizeproof</a></li>
<li><a href="compcert.backend.Lineartyping.html">Lineartyping</a></li>
<li><a href="compcert.backend.Liveness.html">Liveness</a></li>
<li><a href="compcert.backend.Locations.html">Locations</a></li>
<li><a href="compcert.backend.LTL.html">LTL</a></li>
<li><a href="compcert.backend.Mach.html">Mach</a></li>
<li><a href="compcert.backend.NeedDomain.html">NeedDomain</a></li>
<li><a href="compcert.backend.Registers.html">Registers</a></li>
<li><a href="compcert.backend.Renumber.html">Renumber</a></li>
<li><a href="compcert.backend.Renumberproof.html">Renumberproof</a></li>
<li><a href="compcert.backend.RTL.html">RTL</a></li>
<li><a href="compcert.backend.RTLgen.html">RTLgen</a></li>
<li><a href="compcert.backend.RTLgenproof.html">RTLgenproof</a></li>
<li><a href="compcert.backend.RTLgenspec.html">RTLgenspec</a></li>
<li><a href="compcert.backend.RTLtyping.html">RTLtyping</a></li>
<li><a href="compcert.backend.SelectDiv.html">SelectDiv</a></li>
<li><a href="compcert.backend.SelectDivproof.html">SelectDivproof</a></li>
<li><a href="compcert.backend.Selection.html">Selection</a></li>
<li><a href="compcert.backend.Selectionproof.html">Selectionproof</a></li>
<li><a href="compcert.backend.SplitLong.html">SplitLong</a></li>
<li><a href="compcert.backend.SplitLongproof.html">SplitLongproof</a></li>
<li><a href="compcert.backend.Stacking.html">Stacking</a></li>
<li><a href="compcert.backend.Stackingproof.html">Stackingproof</a></li>
<li><a href="compcert.backend.Tailcall.html">Tailcall</a></li>
<li><a href="compcert.backend.Tailcallproof.html">Tailcallproof</a></li>
<li><a href="compcert.backend.Tunneling.html">Tunneling</a></li>
<li><a href="compcert.backend.Tunnelingproof.html">Tunnelingproof</a></li>
<li><a href="compcert.backend.Unusedglob.html">Unusedglob</a></li>
<li><a href="compcert.backend.Unusedglobproof.html">Unusedglobproof</a></li>
<li><a href="compcert.backend.ValueAnalysis.html">ValueAnalysis</a></li>
<li><a href="compcert.backend.ValueDomain.html">ValueDomain</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.cfrontend"><summary>cfrontend</summary>
          <ul>
          <li><a href="compcert.cfrontend.Cexec.html">Cexec</a></li>
<li><a href="compcert.cfrontend.Clight.html">Clight</a></li>
<li><a href="compcert.cfrontend.ClightBigstep.html">ClightBigstep</a></li>
<li><a href="compcert.cfrontend.Cminorgen.html">Cminorgen</a></li>
<li><a href="compcert.cfrontend.Cminorgenproof.html">Cminorgenproof</a></li>
<li><a href="compcert.cfrontend.Cop.html">Cop</a></li>
<li><a href="compcert.cfrontend.Csem.html">Csem</a></li>
<li><a href="compcert.cfrontend.Csharpminor.html">Csharpminor</a></li>
<li><a href="compcert.cfrontend.Cshmgen.html">Cshmgen</a></li>
<li><a href="compcert.cfrontend.Cshmgenproof.html">Cshmgenproof</a></li>
<li><a href="compcert.cfrontend.Cstrategy.html">Cstrategy</a></li>
<li><a href="compcert.cfrontend.Csyntax.html">Csyntax</a></li>
<li><a href="compcert.cfrontend.Ctypes.html">Ctypes</a></li>
<li><a href="compcert.cfrontend.Ctyping.html">Ctyping</a></li>
<li><a href="compcert.cfrontend.Initializers.html">Initializers</a></li>
<li><a href="compcert.cfrontend.Initializersproof.html">Initializersproof</a></li>
<li><a href="compcert.cfrontend.SimplExpr.html">SimplExpr</a></li>
<li><a href="compcert.cfrontend.SimplExprproof.html">SimplExprproof</a></li>
<li><a href="compcert.cfrontend.SimplExprspec.html">SimplExprspec</a></li>
<li><a href="compcert.cfrontend.SimplLocals.html">SimplLocals</a></li>
<li><a href="compcert.cfrontend.SimplLocalsproof.html">SimplLocalsproof</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.common"><summary>common</summary>
          <ul>
          <li><a href="compcert.common.AST.html">AST</a></li>
<li><a href="compcert.common.Behaviors.html">Behaviors</a></li>
<li><a href="compcert.common.Builtins.html">Builtins</a></li>
<li><a href="compcert.common.Builtins0.html">Builtins0</a></li>
<li><a href="compcert.common.Determinism.html">Determinism</a></li>
<li><a href="compcert.common.Errors.html">Errors</a></li>
<li><a href="compcert.common.Events.html">Events</a></li>
<li><a href="compcert.common.Globalenvs.html">Globalenvs</a></li>
<li><a href="compcert.common.Linking.html">Linking</a></li>
<li><a href="compcert.common.Memdata.html">Memdata</a></li>
<li><a href="compcert.common.Memory.html">Memory</a></li>
<li><a href="compcert.common.Memtype.html">Memtype</a></li>
<li><a href="compcert.common.Separation.html">Separation</a></li>
<li><a href="compcert.common.Smallstep.html">Smallstep</a></li>
<li><a href="compcert.common.Switch.html">Switch</a></li>
<li><a href="compcert.common.Unityping.html">Unityping</a></li>
<li><a href="compcert.common.Values.html">Values</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.cparser"><summary>cparser</summary>
          <ul>
          <li><a href="compcert.cparser.Cabs.html">Cabs</a></li>
<li><a href="compcert.cparser.Parser.html">Parser</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.driver"><summary>driver</summary>
          <ul>
          <li><a href="compcert.driver.Compiler.html">Compiler</a></li>
<li><a href="compcert.driver.Complements.html">Complements</a></li>
<li><a href="compcert.driver.Compopts.html">Compopts</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.lib"><summary>lib</summary>
          <ul>
          <li><a href="compcert.lib.Axioms.html">Axioms</a></li>
<li><a href="compcert.lib.BoolEqual.html">BoolEqual</a></li>
<li><a href="compcert.lib.Coqlib.html">Coqlib</a></li>
<li><a href="compcert.lib.Decidableplus.html">Decidableplus</a></li>
<li><a href="compcert.lib.Floats.html">Floats</a></li>
<li><a href="compcert.lib.FSetAVLplus.html">FSetAVLplus</a></li>
<li><a href="compcert.lib.Heaps.html">Heaps</a></li>
<li><a href="compcert.lib.IEEE754_extra.html">IEEE754_extra</a></li>
<li><a href="compcert.lib.Integers.html">Integers</a></li>
<li><a href="compcert.lib.Intv.html">Intv</a></li>
<li><a href="compcert.lib.IntvSets.html">IntvSets</a></li>
<li><a href="compcert.lib.Iteration.html">Iteration</a></li>
<li><a href="compcert.lib.Lattice.html">Lattice</a></li>
<li><a href="compcert.lib.Maps.html">Maps</a></li>
<li><a href="compcert.lib.Ordered.html">Ordered</a></li>
<li><a href="compcert.lib.Parmov.html">Parmov</a></li>
<li><a href="compcert.lib.Postorder.html">Postorder</a></li>
<li><a href="compcert.lib.UnionFind.html">UnionFind</a></li>
<li><a href="compcert.lib.Wfsimpl.html">Wfsimpl</a></li>
<li><a href="compcert.lib.Zbits.html">Zbits</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.x86"><summary>x86</summary>
          <ul>
          <li><a href="compcert.x86.Asm.html">Asm</a></li>
<li><a href="compcert.x86.Asmgen.html">Asmgen</a></li>
<li><a href="compcert.x86.Asmgenproof.html">Asmgenproof</a></li>
<li><a href="compcert.x86.Asmgenproof1.html">Asmgenproof1</a></li>
<li><a href="compcert.x86.Builtins1.html">Builtins1</a></li>
<li><a href="compcert.x86.CombineOp.html">CombineOp</a></li>
<li><a href="compcert.x86.CombineOpproof.html">CombineOpproof</a></li>
<li><a href="compcert.x86.ConstpropOp.html">ConstpropOp</a></li>
<li><a href="compcert.x86.ConstpropOpproof.html">ConstpropOpproof</a></li>
<li><a href="compcert.x86.Conventions1.html">Conventions1</a></li>
<li><a href="compcert.x86.Machregs.html">Machregs</a></li>
<li><a href="compcert.x86.NeedOp.html">NeedOp</a></li>
<li><a href="compcert.x86.Op.html">Op</a></li>
<li><a href="compcert.x86.SelectLong.html">SelectLong</a></li>
<li><a href="compcert.x86.SelectLongproof.html">SelectLongproof</a></li>
<li><a href="compcert.x86.SelectOp.html">SelectOp</a></li>
<li><a href="compcert.x86.SelectOpproof.html">SelectOpproof</a></li>
<li><a href="compcert.x86.Stacklayout.html">Stacklayout</a></li>
<li><a href="compcert.x86.ValueAOp.html">ValueAOp</a></li>
          </ul>
          </details>
          </li>
<li><details id="compcert.x86_64"><summary>x86_64</summary>
          <ul>
          <li><a href="compcert.x86_64.Archi.html">Archi</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="Flocq"><summary>Flocq</summary>
          <ul>
          <li><details id="Flocq.Calc"><summary>Calc</summary>
          <ul>
          <li><a href="Flocq.Calc.Bracket.html">Bracket</a></li>
<li><a href="Flocq.Calc.Div.html">Div</a></li>
<li><a href="Flocq.Calc.Operations.html">Operations</a></li>
<li><a href="Flocq.Calc.Plus.html">Plus</a></li>
<li><a href="Flocq.Calc.Round.html">Round</a></li>
<li><a href="Flocq.Calc.Sqrt.html">Sqrt</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.Core"><summary>Core</summary>
          <ul>
          <li><a href="Flocq.Core.Core.html">Core</a></li>
<li><a href="Flocq.Core.Defs.html">Defs</a></li>
<li><a href="Flocq.Core.Digits.html">Digits</a></li>
<li><a href="Flocq.Core.FIX.html">FIX</a></li>
<li><a href="Flocq.Core.Float_prop.html">Float_prop</a></li>
<li><a href="Flocq.Core.FLT.html">FLT</a></li>
<li><a href="Flocq.Core.FLX.html">FLX</a></li>
<li><a href="Flocq.Core.FTZ.html">FTZ</a></li>
<li><a href="Flocq.Core.Generic_fmt.html">Generic_fmt</a></li>
<li><a href="Flocq.Core.Raux.html">Raux</a></li>
<li><a href="Flocq.Core.Round_NE.html">Round_NE</a></li>
<li><a href="Flocq.Core.Round_pred.html">Round_pred</a></li>
<li><a href="Flocq.Core.Ulp.html">Ulp</a></li>
<li><a href="Flocq.Core.Zaux.html">Zaux</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.IEEE754"><summary>IEEE754</summary>
          <ul>
          <li><a href="Flocq.IEEE754.Binary.html">Binary</a></li>
<li><a href="Flocq.IEEE754.BinarySingleNaN.html">BinarySingleNaN</a></li>
<li><a href="Flocq.IEEE754.Bits.html">Bits</a></li>
          </ul>
          </details>
          </li>
<li><details id="Flocq.Prop"><summary>Prop</summary>
          <ul>
          <li><a href="Flocq.Prop.Div_sqrt_error.html">Div_sqrt_error</a></li>
<li><a href="Flocq.Prop.Double_rounding.html">Double_rounding</a></li>
<li><a href="Flocq.Prop.Mult_error.html">Mult_error</a></li>
<li><a href="Flocq.Prop.Plus_error.html">Plus_error</a></li>
<li><a href="Flocq.Prop.Relative.html">Relative</a></li>
<li><a href="Flocq.Prop.Round_odd.html">Round_odd</a></li>
<li><a href="Flocq.Prop.Sterbenz.html">Sterbenz</a></li>
          </ul>
          </details>
          </li>
          </ul>
          </details>
          </li>
<li><details id="MenhirLib"><summary>MenhirLib</summary>
          <ul>
          <li><a href="MenhirLib.Alphabet.html">Alphabet</a></li>
<li><a href="MenhirLib.Automaton.html">Automaton</a></li>
<li><a href="MenhirLib.Grammar.html">Grammar</a></li>
<li><a href="MenhirLib.Interpreter.html">Interpreter</a></li>
<li><a href="MenhirLib.Interpreter_complete.html">Interpreter_complete</a></li>
<li><a href="MenhirLib.Interpreter_correct.html">Interpreter_correct</a></li>
<li><a href="MenhirLib.Main.html">Main</a></li>
<li><a href="MenhirLib.Validator_classes.html">Validator_classes</a></li>
<li><a href="MenhirLib.Validator_complete.html">Validator_complete</a></li>
<li><a href="MenhirLib.Validator_safe.html">Validator_safe</a></li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module Zbits</h1>
<br/>
<div class="doc">Additional operations and proofs about binary integers,
    on top of the ZArith standard library. </div>
<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.micromega.Psatz.html">Psatz</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zquot.html">Zquot</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span>.<br/>
<br/>
<h2> Modulo arithmetic </h2>
<br/>
<div class="doc">We define and state properties of equality and arithmetic modulo a
  positive integer. </div>
<br/>
<span class="vernacular">Section</span> <span id="EQ_MODULO" class="id"><a name="EQ_MODULO" class="">EQ_MODULO</a></span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="EQ_MODULO.modul" class="id"><a name="EQ_MODULO.modul" class="">modul:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="EQ_MODULO.modul_pos" class="id"><a name="EQ_MODULO.modul_pos" class="">modul_pos:</a></span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&gt;'_x">&gt;</a></span> <span class="id">0</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="eqmod" class="id"><a name="eqmod" class="">eqmod</a></span> (<span id="x:3" class="id"><a name="x:3" class="">x</a></span> <span id="y:4" class="id"><a name="y:4" class="">y:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="gallina-kwd">Prop</span> <span class="id">:=</span> <span class="gallina-kwd">exists</span> <span id="k:5" class="id"><a name="k:5" class="">k,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:3">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#k:5">k</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:4">y</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_refl" class="id"><a name="eqmod_refl" class="">eqmod_refl:</a></span> <span class="gallina-kwd">forall</span> <span id="x:6" class="id"><a name="x:6" class="">x,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:6">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:6">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">red</span>. <span class="gallina-kwd">exists</span> <span class="id">0</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_refl2" class="id"><a name="eqmod_refl2" class="">eqmod_refl2:</a></span> <span class="gallina-kwd">forall</span> <span id="x:7" class="id"><a name="x:7" class="">x</a></span> <span id="y:8" class="id"><a name="y:8" class="">y,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:7">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:8">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:7">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:8">y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">subst</span> <span class="id">y</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod_refl">eqmod_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_sym" class="id"><a name="eqmod_sym" class="">eqmod_sym:</a></span> <span class="gallina-kwd">forall</span> <span id="x:9" class="id"><a name="x:9" class="">x</a></span> <span id="y:10" class="id"><a name="y:10" class="">y,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:9">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:10">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:10">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:9">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">[k</span> <span class="id">EQ];</span> <span class="id">red</span>. <span class="gallina-kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-k</a></span>). <span class="id">subst</span> <span class="id">x</span>. <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_trans" class="id"><a name="eqmod_trans" class="">eqmod_trans:</a></span> <span class="gallina-kwd">forall</span> <span id="x:11" class="id"><a name="x:11" class="">x</a></span> <span id="y:12" class="id"><a name="y:12" class="">y</a></span> <span id="z:13" class="id"><a name="z:13" class="">z,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:11">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:12">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:12">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#z:13">z</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:11">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#z:13">z</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">[k1</span> <span class="id">EQ1]</span> <span class="id">[k2</span> <span class="id">EQ2];</span> <span class="id">red</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">k1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">k2</span>). <span class="id">subst</span> <span class="id">x;</span> <span class="id">subst</span> <span class="id">y</span>. <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_small_eq" class="id"><a name="eqmod_small_eq" class="">eqmod_small_eq:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:14" class="id"><a name="x:14" class="">x</a></span> <span id="y:15" class="id"><a name="y:15" class="">y,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:14">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:15">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:14">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:15">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:14">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:15">y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">[k</span> <span class="id">EQ]</span> <span class="id">I1</span> <span class="id">I2</span>.<br/>
&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_unique">Zdiv_unique</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">EQ</span> <span class="id">I2</span>). <span class="id">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div_small">Z.div_small</a></span> <span class="id">x</span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span> <span class="id">I1</span>) <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">subst</span> <span class="id">k</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_mod_eq" class="id"><a name="eqmod_mod_eq" class="">eqmod_mod_eq:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:16" class="id"><a name="x:16" class="">x</a></span> <span id="y:17" class="id"><a name="y:17" class="">y,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:16">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:17">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:16">x</a></span> <span class="id">mod</span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:17">y</a></span> <span class="id">mod</span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">[k</span> <span class="id">EQ]</span>. <span class="id">subst</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_comm">Z.add_comm</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_mod_plus">Z_mod_plus</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_mod" class="id"><a name="eqmod_mod" class="">eqmod_mod:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:18" class="id"><a name="x:18" class="">x,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:18">x</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#x:18">x</a></span> <span class="id">mod</span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">red</span>. <span class="gallina-kwd">exists</span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3c2652250c7a120d67ccc0e8f58ae75">/</a></span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Z_div_mod_eq">Z_div_mod_eq</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_add" class="id"><a name="eqmod_add" class="">eqmod_add:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="a:19" class="id"><a name="a:19" class="">a</a></span> <span id="b:20" class="id"><a name="b:20" class="">b</a></span> <span id="c:21" class="id"><a name="c:21" class="">c</a></span> <span id="d:22" class="id"><a name="d:22" class="">d,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#a:19">a</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:20">b</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#c:21">c</a></span> <span class="id"><a href="compcert.lib.Zbits.html#d:22">d</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#a:19">a</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#c:21">c</a></span>) (<span class="id"><a href="compcert.lib.Zbits.html#b:20">b</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#d:22">d</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">[k1</span> <span class="id">EQ1]</span> <span class="id">[k2</span> <span class="id">EQ2];</span> <span class="id">red</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">a;</span> <span class="id">subst</span> <span class="id">c</span>. <span class="gallina-kwd">exists</span> (<span class="id">k1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">k2</span>). <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_neg" class="id"><a name="eqmod_neg" class="">eqmod_neg:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:23" class="id"><a name="x:23" class="">x</a></span> <span id="y:24" class="id"><a name="y:24" class="">y,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:23">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:24">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-x</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-y</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">[k</span> <span class="id">EQ];</span> <span class="id">red</span>. <span class="gallina-kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-k</a></span>). <span class="id">rewrite</span> <span class="id">EQ</span>. <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_sub" class="id"><a name="eqmod_sub" class="">eqmod_sub:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="a:25" class="id"><a name="a:25" class="">a</a></span> <span id="b:26" class="id"><a name="b:26" class="">b</a></span> <span id="c:27" class="id"><a name="c:27" class="">c</a></span> <span id="d:28" class="id"><a name="d:28" class="">d,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#a:25">a</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:26">b</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#c:27">c</a></span> <span class="id"><a href="compcert.lib.Zbits.html#d:28">d</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#a:25">a</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id"><a href="compcert.lib.Zbits.html#c:27">c</a></span>) (<span class="id"><a href="compcert.lib.Zbits.html#b:26">b</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id"><a href="compcert.lib.Zbits.html#d:28">d</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">[k1</span> <span class="id">EQ1]</span> <span class="id">[k2</span> <span class="id">EQ2];</span> <span class="id">red</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">a;</span> <span class="id">subst</span> <span class="id">c</span>. <span class="gallina-kwd">exists</span> (<span class="id">k1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">k2</span>). <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_mult" class="id"><a name="eqmod_mult" class="">eqmod_mult:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="a:29" class="id"><a name="a:29" class="">a</a></span> <span id="b:30" class="id"><a name="b:30" class="">b</a></span> <span id="c:31" class="id"><a name="c:31" class="">c</a></span> <span id="d:32" class="id"><a name="d:32" class="">d,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#a:29">a</a></span> <span class="id"><a href="compcert.lib.Zbits.html#c:31">c</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:30">b</a></span> <span class="id"><a href="compcert.lib.Zbits.html#d:32">d</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#a:29">a</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:30">b</a></span>) (<span class="id"><a href="compcert.lib.Zbits.html#c:31">c</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.lib.Zbits.html#d:32">d</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">[k1</span> <span class="id">EQ1]</span> <span class="id">[k2</span> <span class="id">EQ2];</span> <span class="id">red</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">a;</span> <span class="id">subst</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">k1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id">k2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO.modul">modul</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">c</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id">k2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">k1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id">d</span>).<br/>
&nbsp;&nbsp;<span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="compcert.lib.Zbits.html#EQ_MODULO">EQ_MODULO</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_divides" class="id"><a name="eqmod_divides" class="">eqmod_divides:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:33" class="id"><a name="n:33" class="">n</a></span> <span id="m:34" class="id"><a name="m:34" class="">m</a></span> <span id="x:35" class="id"><a name="x:35" class="">x</a></span> <span id="y:36" class="id"><a name="y:36" class="">y,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:33">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:35">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:36">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide">Z.divide</a></span> <span class="id"><a href="compcert.lib.Zbits.html#m:34">m</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:33">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> <span class="id"><a href="compcert.lib.Zbits.html#m:34">m</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:35">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:36">y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">H</span> <span class="gallina-kwd">as</span> <span class="id">[k1</span> <span class="id">EQ1]</span>. <span class="id">destruct</span> <span class="id">H0</span> <span class="gallina-kwd">as</span> <span class="id">[k2</span> <span class="id">EQ2]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">k1*k2</span>). <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_assoc">Z.mul_assoc</a></span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">EQ2</span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Fast normalization modulo <span class="bracket">2^<span class="id">n</span></span> </h2>
<br/>
<span class="vernacular">Fixpoint</span> <span id="P_mod_two_p" class="id"><a name="P_mod_two_p" class="">P_mod_two_p</a></span> (<span id="p:37" class="id"><a name="p:37" class="">p:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>) (<span id="n:38" class="id"><a name="n:38" class="">n:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">{struct</span> <span class="id">n}</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.lib.Zbits.html#n:38">n</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">=&gt;</span> <span class="id">0</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.lib.Zbits.html#p:37">p</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id">=&gt;</span> <span class="id">1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xO">xO</a></span> <span class="id">q</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.double">Z.double</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p:39">P_mod_two_p</a></span> <span class="id">q</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xI">xI</a></span> <span class="id">q</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ_double">Z.succ_double</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p:39">P_mod_two_p</a></span> <span class="id">q</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">end</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Z_mod_two_p" class="id"><a name="Z_mod_two_p" class="">Z_mod_two_p</a></span> (<span id="x:42" class="id"><a name="x:42" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="n:43" class="id"><a name="n:43" class="">n:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.lib.Zbits.html#x:42">x</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> <span class="id">=&gt;</span> <span class="id">0</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p">P_mod_two_p</a></span> <span class="id">p</span> <span class="id"><a href="compcert.lib.Zbits.html#n:43">n</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zneg">Zneg</a></span> <span class="id">p</span> <span class="id">=&gt;</span> <span class="gallina-kwd">let</span> <span id="r:45" class="id"><a name="r:45" class="">r</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p">P_mod_two_p</a></span> <span class="id">p</span> <span class="id"><a href="compcert.lib.Zbits.html#n:43">n</a></span> <span class="gallina-kwd">in</span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id"><a href="compcert.lib.Zbits.html#r:45">r</a></span> <span class="id">0</span> <span class="gallina-kwd">then</span> <span class="id">0</span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:43">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id"><a href="compcert.lib.Zbits.html#r:45">r</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="P_mod_two_p_range" class="id"><a name="P_mod_two_p_range" class="">P_mod_two_p_range:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:46" class="id"><a name="n:46" class="">n</a></span> <span id="p:47" class="id"><a name="p:47" class="">p,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p">P_mod_two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#p:47">p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:46">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:46">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_O">two_power_nat_O</a></span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat_S">two_power_nat_S</a></span>. <span class="id">destruct</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">generalize</span> (<span class="id">IHn</span> <span class="id">p</span>). <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ_double_spec">Z.succ_double_spec</a></span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">generalize</span> (<span class="id">IHn</span> <span class="id">p</span>). <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.double_spec">Z.double_spec</a></span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_pos">two_power_nat_pos</a></span> <span class="id">n</span>). <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="P_mod_two_p_eq" class="id"><a name="P_mod_two_p_eq" class="">P_mod_two_p_eq:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:48" class="id"><a name="n:48" class="">n</a></span> <span id="p:49" class="id"><a name="p:49" class="">p,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p">P_mod_two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#p:49">p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:48">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Zbits.html#p:49">p</a></span>) <span class="id">mod</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:48">n</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
&nbsp;&nbsp;<span class="id">assert</span> (<span class="gallina-kwd">forall</span> <span id="n:53" class="id"><span id="n:50" class="id"><a name="n:53" class="">n</a></span></span> <span id="p:54" class="id"><span id="p:51" class="id"><a name="p:54" class="">p,</a></span></span> <span class="gallina-kwd">exists</span> <span id="y:55" class="id"><span id="y:52" class="id"><a name="y:55" class="">y,</a></span></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Zbits.html#p:51">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:52">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:50">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p">P_mod_two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#p:51">p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:50">n</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">simpl;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_O">two_power_nat_O</a></span>. <span class="gallina-kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span>). <span class="id">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat_S">two_power_nat_S</a></span>. <span class="id">destruct</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">destruct</span> (<span class="id">IHn</span> <span class="id">p</span>) <span class="gallina-kwd">as</span> <span class="id">[y</span> <span class="id">EQ]</span>. <span class="gallina-kwd">exists</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p~1</span>) <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>). <span class="id">rewrite</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ_double_spec">Z.succ_double_spec</a></span>. <span class="id">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">destruct</span> (<span class="id">IHn</span> <span class="id">p</span>) <span class="gallina-kwd">as</span> <span class="id">[y</span> <span class="id">EQ]</span>. <span class="gallina-kwd">exists</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p~0</span>) <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span>). <span class="id">rewrite</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.double_spec">Z.double_spec</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p">P_mod_two_p</a></span> <span class="id">p</span> <span class="id">n</span>)). <span class="id">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="gallina-kwd">exists</span> <span class="id">0;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">H</span> <span class="id">n</span> <span class="id">p</span>) <span class="gallina-kwd">as</span> <span class="id">[y</span> <span class="id">EQ]</span>.<br/>
&nbsp;&nbsp;<span class="id">symmetry</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmod_unique">Zmod_unique</a></span> <span class="gallina-kwd">with</span> <span class="id">y</span>. <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p_range">P_mod_two_p_range</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_mod_two_p_range" class="id"><a name="Z_mod_two_p_range" class="">Z_mod_two_p_range:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:56" class="id"><a name="n:56" class="">n</a></span> <span id="x:57" class="id"><a name="x:57" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_mod_two_p">Z_mod_two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:57">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:56">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:56">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
&nbsp;&nbsp;<span class="id">intros;</span> <span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_mod_two_p">Z_mod_two_p</a></span>. <span class="id">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_pos">two_power_nat_pos</a></span> <span class="id">n</span>)<span class="id">;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p_range">P_mod_two_p_range</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">set</span> (<span class="id">r</span> <span class="id">:=</span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p">P_mod_two_p</a></span> <span class="id">p</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id">r</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id">n</span>) <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p_range">P_mod_two_p_range</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">r</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">intuition</span>  <span class="id">auto</span> <span class="gallina-kwd">with</span> <span class="id">crelations</span> <span class="id">zarith</span> <span class="id">bool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">Psatz.lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_mod_two_p_eq" class="id"><a name="Z_mod_two_p_eq" class="">Z_mod_two_p_eq:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:58" class="id"><a name="n:58" class="">n</a></span> <span id="x:59" class="id"><a name="x:59" class="">x,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_mod_two_p">Z_mod_two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:59">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:58">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:59">x</a></span> <span class="id">mod</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:58">n</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_mod_two_p">Z_mod_two_p</a></span>. <span class="id">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_pos">two_power_nat_pos</a></span> <span class="id">n</span>)<span class="id">;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod_0_l">Zmod_0_l</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p_eq">P_mod_two_p_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">generalize</span> (<span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p_range">P_mod_two_p_range</a></span> <span class="id">n</span> <span class="id">p</span>) (<span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p_eq">P_mod_two_p_eq</a></span> <span class="id">n</span> <span class="id">p</span>). <span class="id">intros</span> <span class="id">A</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.lib.Coqlib.html#Z_div_mod_eq">Z_div_mod_eq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id">n</span>))<span class="id">;</span> <span class="id">auto</span>. <span class="id">intros</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">q</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3c2652250c7a120d67ccc0e8f58ae75">/</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id">n</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">r</span> <span class="id">:=</span> <span class="id"><a href="compcert.lib.Zbits.html#P_mod_two_p">P_mod_two_p</a></span> <span class="id">p</span> <span class="id">n</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">B</span> <span class="gallina-kwd">in</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.neg">Z.neg</a></span> <span class="id">p</span>) <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>)). <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">r</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">symmetry</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmod_unique">Zmod_unique</a></span> <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-q</a></span>). <span class="id">rewrite</span> <span class="id">C;</span> <span class="id">rewrite</span> <span class="id">e</span>. <span class="id">lia</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">symmetry</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmod_unique">Zmod_unique</a></span> <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-q</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>). <span class="id">rewrite</span> <span class="id">C</span>. <span class="id">lia</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<h2> Bit-level operations and properties </h2>
<br/>
<div class="doc">Shift <span class="bracket"><span class="id">x</span></span> left by one and insert <span class="bracket"><span class="id">b</span></span> as the low bit of the result. </div>
<br/>
<span class="vernacular">Definition</span> <span id="Zshiftin" class="id"><a name="Zshiftin" class="">Zshiftin</a></span> (<span id="b:60" class="id"><a name="b:60" class="">b:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span id="x:61" class="id"><a name="x:61" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Zbits.html#b:60">b</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ_double">Z.succ_double</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:61">x</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.double">Z.double</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:61">x</a></span>.<br/>
<br/>
<span class="vernacular">Remark</span> <span id="Ztestbit_0" class="id"><a name="Ztestbit_0" class="">Ztestbit_0:</a></span> <span class="gallina-kwd">forall</span> <span id="n:62" class="id"><a name="n:62" class="">n,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id">0</span> <span class="id"><a href="compcert.lib.Zbits.html#n:62">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<span class="vernacular">Proof</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit_0_l">Z.testbit_0_l</a></span>.<br/>
<br/>
<span class="vernacular">Remark</span> <span id="Ztestbit_1" class="id"><a name="Ztestbit_1" class="">Ztestbit_1:</a></span> <span class="gallina-kwd">forall</span> <span id="n:63" class="id"><a name="n:63" class="">n,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id">1</span> <span class="id"><a href="compcert.lib.Zbits.html#n:63">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:63">n</a></span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">n;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Ztestbit_m1" class="id"><a name="Ztestbit_m1" class="">Ztestbit_m1:</a></span> <span class="gallina-kwd">forall</span> <span id="n:64" class="id"><a name="n:64" class="">n,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:64">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id">-1</span>) <span class="id"><a href="compcert.lib.Zbits.html#n:64">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">n;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Zshiftin_spec" class="id"><a name="Zshiftin_spec" class="">Zshiftin_spec:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="b:65" class="id"><a name="b:65" class="">b</a></span> <span id="x:66" class="id"><a name="x:66" class="">x,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:65">b</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:66">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:66">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> (<span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Zbits.html#b:65">b</a></span> <span class="gallina-kwd">then</span> <span class="id">1</span> <span class="gallina-kwd">else</span> <span class="id">0</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin;</a></span> <span class="id">intros</span>. <span class="id">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ_double_spec">Z.succ_double_spec</a></span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.double_spec">Z.double_spec</a></span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Zshiftin_inj" class="id"><a name="Zshiftin_inj" class="">Zshiftin_inj:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="b1:67" class="id"><a name="b1:67" class="">b1</a></span> <span id="x1:68" class="id"><a name="x1:68" class="">x1</a></span> <span id="b2:69" class="id"><a name="b2:69" class="">b2</a></span> <span id="x2:70" class="id"><a name="x2:70" class="">x2,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b1:67">b1</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x1:68">x1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b2:69">b2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x2:70">x2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b1:67">b1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b2:69">b2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x1:68">x1</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x2:70">x2</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id">!Zshiftin_spec</span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b1;</span> <span class="id">destruct</span> <span class="id">b2</span>.<br/>
&nbsp;&nbsp;<span class="id">split;</span> <span class="id">[auto|lia]</span>.<br/>
&nbsp;&nbsp;<span class="id">extlia</span>.<br/>
&nbsp;&nbsp;<span class="id">extlia</span>.<br/>
&nbsp;&nbsp;<span class="id">split;</span> <span class="id">[auto|lia]</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Zdecomp" class="id"><a name="Zdecomp" class="">Zdecomp:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:71" class="id"><a name="x:71" class="">x,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:71">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:71">x</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:71">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">x;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">destruct</span> <span class="id">p;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">destruct</span> <span class="id">p;</span> <span class="id">auto</span>. <span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.pred_double_succ">Pos.pred_double_succ</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Ztestbit_shiftin" class="id"><a name="Ztestbit_shiftin" class="">Ztestbit_shiftin:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="b:72" class="id"><a name="b:72" class="">b</a></span> <span id="x:73" class="id"><a name="x:73" class="">x</a></span> <span id="n:74" class="id"><a name="n:74" class="">n,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:74">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:72">b</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:73">x</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#n:74">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:74">n</a></span> <span class="id">0</span> <span class="gallina-kwd">then</span> <span class="id"><a href="compcert.lib.Zbits.html#b:72">b</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:73">x</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:74">n</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_spec">Zshiftin_spec</a></span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">n</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">subst</span> <span class="id">n</span>. <span class="id">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit_odd_0">Z.testbit_odd_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_r">Z.add_0_r</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit_even_0">Z.testbit_even_0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">assert</span> (<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id">n</span>) <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set</span> (<span class="id">n'</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id">n</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> <span class="id">n</span> <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id">n'</span>) <span class="gallina-kwd">by</span> (<span class="id">unfold</span> <span class="id">n';</span> <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit_odd_succ">Z.testbit_odd_succ</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_r">Z.add_0_r</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit_even_succ">Z.testbit_even_succ</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Ztestbit_shiftin_base" class="id"><a name="Ztestbit_shiftin_base" class="">Ztestbit_shiftin_base:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="b:75" class="id"><a name="b:75" class="">b</a></span> <span id="x:76" class="id"><a name="x:76" class="">x,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:75">b</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:76">x</a></span>) <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:75">b</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin">Ztestbit_shiftin;</a></span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Ztestbit_shiftin_succ" class="id"><a name="Ztestbit_shiftin_succ" class="">Ztestbit_shiftin_succ:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="b:77" class="id"><a name="b:77" class="">b</a></span> <span id="x:78" class="id"><a name="x:78" class="">x</a></span> <span id="n:79" class="id"><a name="n:79" class="">n,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:79">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:77">b</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:78">x</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:79">n</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:78">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:79">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin">Ztestbit_shiftin</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq_false">zeq_false</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred_succ">Z.pred_succ</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zshiftin_ind" class="id"><a name="Zshiftin_ind" class="">Zshiftin_ind:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span id="P:80" class="id"><a name="P:80" class="">P:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">Prop</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#P:80">P</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="b:81" class="id"><a name="b:81" class="">b</a></span> <span id="x:82" class="id"><a name="x:82" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:82">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:80">P</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:82">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:80">P</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:81">b</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:82">x</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:83" class="id"><a name="x:83" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:83">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:80">P</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:83">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">induction</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">change</span> (<span class="id">P</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>))). <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">change</span> (<span class="id">P</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>))). <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">change</span> (<span class="id">P</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">0</span>)). <span class="id">apply</span> <span class="id">H0</span>. <span class="id">lia</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">compute</span> <span class="gallina-kwd">in</span> <span class="id">H1</span>. <span class="id">intuition</span> <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zshiftin_pos_ind" class="id"><a name="Zshiftin_pos_ind" class="">Zshiftin_pos_ind:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span id="P:84" class="id"><a name="P:84" class="">P:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">Prop</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#P:84">P</a></span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="b:85" class="id"><a name="b:85" class="">b</a></span> <span id="x:86" class="id"><a name="x:86" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:86">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:84">P</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:86">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:84">P</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:85">b</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:86">x</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:87" class="id"><a name="x:87" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:87">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:84">P</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:87">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">x;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">H1;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">change</span> (<span class="id">P</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>))). <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">change</span> (<span class="id">P</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>))). <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Bit-wise decomposition (<span class="bracket"><span class="id">Z.testbit</span></span>) </h2>
<br/>
<span class="vernacular">Remark</span> <span id="Ztestbit_eq" class="id"><a name="Ztestbit_eq" class="">Ztestbit_eq:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:88" class="id"><a name="n:88" class="">n</a></span> <span id="x:89" class="id"><a name="x:89" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:88">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:89">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:88">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:88">n</a></span> <span class="id">0</span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:89">x</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:89">x</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:88">n</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>) <span class="gallina-kwd">at</span> <span class="id">1</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin">Ztestbit_shiftin;</a></span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Ztestbit_base" class="id"><a name="Ztestbit_base" class="">Ztestbit_base:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:90" class="id"><a name="x:90" class="">x,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:90">x</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:90">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_eq">Ztestbit_eq;</a></span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Ztestbit_succ" class="id"><a name="Ztestbit_succ" class="">Ztestbit_succ:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:91" class="id"><a name="n:91" class="">n</a></span> <span id="x:92" class="id"><a name="x:92" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:91">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:92">x</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:91">n</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:92">x</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#n:91">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_eq">Ztestbit_eq</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq_false">zeq_false</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred_succ">Z.pred_succ</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_same_bits" class="id"><a name="eqmod_same_bits" class="">eqmod_same_bits:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:93" class="id"><a name="n:93" class="">n</a></span> <span id="x:94" class="id"><a name="x:94" class="">x</a></span> <span id="y:95" class="id"><a name="y:95" class="">y,</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="i:96" class="id"><a name="i:96" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:96">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:93">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:94">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:96">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:95">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:96">i</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:93">n</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#x:94">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:95">y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id">0</span>) <span class="gallina-kwd">with</span> <span class="id">1</span>. <span class="gallina-kwd">exists</span> (<span class="id">x-y</span>)<span class="id">;</span> <span class="id">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat_S">two_power_nat_S</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id">n</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHn</span>. <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">!Ztestbit_succ</span>. <span class="id">apply</span> <span class="id">H</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span><span class="id">;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H0</span> <span class="gallina-kwd">as</span> <span class="id">[k</span> <span class="id">EQ]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span class="id">k</span>. <span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>). <span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">y</span>) <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">EQ</span>. <span class="id">rewrite</span> <span class="id">!Zshiftin_spec</span>. <span class="id">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H</span> <span class="id">0</span>). <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span><span class="id">;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!Ztestbit_base</span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="same_bits_eqmod" class="id"><a name="same_bits_eqmod" class="">same_bits_eqmod:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:97" class="id"><a name="n:97" class="">n</a></span> <span id="x:98" class="id"><a name="x:98" class="">x</a></span> <span id="y:99" class="id"><a name="y:99" class="">y</a></span> <span id="i:100" class="id"><a name="i:100" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:97">n</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#x:98">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:99">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:100">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:97">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:98">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:100">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:99">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:100">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">H0</span>. <span class="id">extlia</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span> <span class="gallina-kwd">in</span> <span class="id">H0</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat_S">two_power_nat_S</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!</span>(<span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_eq">Ztestbit_eq</a></span> <span class="id">i</span>)<span class="id">;</span> <span class="id">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H</span> <span class="gallina-kwd">as</span> <span class="id">[k</span> <span class="id">EQ]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">EQ':</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">y</span>) (<span class="id">k</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>) <span class="gallina-kwd">in</span> <span class="id">EQ</span>. <span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">y</span>) <span class="gallina-kwd">in</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">EQ</span>. <span class="id">rewrite</span> <span class="id">!Zshiftin_spec</span>. <span class="id">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_inj">Zshiftin_inj;</a></span> <span class="id">eauto</span>. <span class="id">intros</span> <span class="id">[A</span> <span class="id">B]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">i</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply</span> <span class="id">IHn</span>. <span class="gallina-kwd">exists</span> <span class="id">k;</span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="equal_same_bits" class="id"><a name="equal_same_bits" class="">equal_same_bits:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:101" class="id"><a name="x:101" class="">x</a></span> <span id="y:102" class="id"><a name="y:102" class="">y,</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="i:103" class="id"><a name="i:103" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:103">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:101">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:103">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:102">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:103">i</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#x:101">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:102">y</a></span>.<br/>
<span class="vernacular">Proof</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.bits_inj'">Z.bits_inj</a></span><span class="id">'</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_one_complement" class="id"><a name="Z_one_complement" class="">Z_one_complement:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="i:104" class="id"><a name="i:104" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:104">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:105" class="id"><a name="x:105" class="">x,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-x-1</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#i:104">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:105">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:104">i</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">i0</span> <span class="id">POS0</span>. <span class="id">pattern</span> <span class="id">i0</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Wf_Z.html#Zlt_0_ind">Zlt_0_ind;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">i</span> <span class="id">IND</span> <span class="id">POS</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>). <span class="id">set</span> (<span class="id">y</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>) <span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">with</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> <span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!Ztestbit_shiftin;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">i</span> <span class="id">0</span>). <span class="id">auto</span>. <span class="id">apply</span> <span class="id">IND</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!Zshiftin_spec</span>. <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">simpl</span> <span class="id">negb;</span> <span class="id">ring</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Ztestbit_above" class="id"><a name="Ztestbit_above" class="">Ztestbit_above:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:106" class="id"><a name="n:106" class="">n</a></span> <span id="x:107" class="id"><a name="x:107" class="">x</a></span> <span id="i:108" class="id"><a name="i:108" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:107">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:106">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#i:108">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4">&gt;=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:106">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:107">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:108">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id">0</span>) <span class="gallina-kwd">with</span> <span class="id">1</span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> <span class="id">x</span> <span class="gallina-kwd">with</span> <span class="id">0</span> <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit_0_l">Z.testbit_0_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span> <span class="gallina-kwd">in</span> <span class="id">H0</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_eq">Ztestbit_eq</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq_false">zeq_false</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHn</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat_S">two_power_nat_S</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>) <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_spec">Zshiftin_spec</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">lia</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Ztestbit_above_neg" class="id"><a name="Ztestbit_above_neg" class="">Ztestbit_above_neg:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:109" class="id"><a name="n:109" class="">n</a></span> <span id="x:110" class="id"><a name="x:110" class="">x</a></span> <span id="i:111" class="id"><a name="i:111" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:109">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:110">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#i:111">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4">&gt;=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:109">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:110">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:111">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">set</span> (<span class="id">y</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-x-1</a></span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id">y</span> <span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_above">Ztestbit_above</a></span> <span class="gallina-kwd">with</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">y;</span> <span class="id">lia</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">y</span> <span class="gallina-kwd">in</span> <span class="id">H1</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_one_complement">Z_one_complement</a></span> <span class="gallina-kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>). <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H1</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#negb_involutive">negb_involutive;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zsign_bit" class="id"><a name="Zsign_bit" class="">Zsign_bit:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:112" class="id"><a name="n:112" class="">n</a></span> <span id="x:113" class="id"><a name="x:113" class="">x,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:113">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:112">n</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:113">x</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:112">n</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:113">x</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:112">n</a></span>) <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id">1</span>) <span class="gallina-kwd">with</span> <span class="id">2</span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">1</span>) <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H0;</span> <span class="id">subst</span> <span class="id">x;</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_eq">Ztestbit_eq</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq_false">zeq_false</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred_succ">Z.pred_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHn</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat_S">two_power_nat_S</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id">n</span>))<span class="id">;</span> <span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_spec">Zshiftin_spec</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true</a></span>. <span class="id">auto</span>. <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_false">zlt_false</a></span>. <span class="id">auto</span>. <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>) <span class="gallina-kwd">in</span> <span class="id">H;</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_spec">Zshiftin_spec</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat_S">two_power_nat_S</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Ztestbit_le" class="id"><a name="Ztestbit_le" class="">Ztestbit_le:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:114" class="id"><a name="x:114" class="">x</a></span> <span id="y:115" class="id"><a name="y:115" class="">y,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:115">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="i:116" class="id"><a name="i:116" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:116">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:114">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:116">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:115">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:116">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#x:114">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:115">y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y0</span> <span class="id">POS0;</span> <span class="id">revert</span> <span class="id">x;</span> <span class="id">pattern</span> <span class="id">y0;</span> <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_ind">Zshiftin_ind;</a></span> <span class="id">auto;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">replace</span> <span class="id">x</span> <span class="gallina-kwd">with</span> <span class="id">0</span>. <span class="id">lia</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#equal_same_bits">equal_same_bits;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_0">Ztestbit_0</a></span>. <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id">x</span> <span class="id">i</span>) <span class="gallina-kwd">as</span> <span class="id">[]</span> <span class="id">eqn:E;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H;</span> <span class="id">eauto</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_0">Ztestbit_0</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{</span> <span class="id">apply</span> <span class="id">H0</span>. <span class="id">intros</span>. <span class="id">exploit</span> (<span class="id">H1</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_succ">Ztestbit_succ;</a></span> <span class="id">auto</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin_succ">Ztestbit_shiftin_succ;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">}</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x0</span>). <span class="id">rewrite</span> <span class="id">!Zshiftin_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x0</span>) <span class="gallina-kwd">as</span> <span class="id">[]</span> <span class="id">eqn:E1;</span> <span class="id">destruct</span> <span class="id">b</span> <span class="gallina-kwd">as</span> <span class="id">[]</span> <span class="id">eqn:E2;</span> <span class="id">try</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H1</span> <span class="id">0</span>). <span class="id">lia</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_base">Ztestbit_base;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin_base">Ztestbit_shiftin_base</a></span>. <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Ztestbit_mod_two_p" class="id"><a name="Ztestbit_mod_two_p" class="">Ztestbit_mod_two_p:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:117" class="id"><a name="n:117" class="">n</a></span> <span id="x:118" class="id"><a name="x:118" class="">x</a></span> <span id="i:119" class="id"><a name="i:119" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:117">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:119">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#x:118">x</a></span> <span class="id">mod</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:117">n</a></span>)) <span class="id"><a href="compcert.lib.Zbits.html#i:119">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:119">i</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:117">n</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:118">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:119">i</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n0</span> <span class="id">x</span> <span class="id">i</span> <span class="id">N0POS</span>. <span class="id">revert</span> <span class="id">x</span> <span class="id">i;</span> <span class="id">pattern</span> <span class="id">n0;</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Wf_Z.html#natlike_ind">natlike_ind;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">intros</span>. <span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">0</span>) <span class="gallina-kwd">with</span> <span class="id">1</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod_1_r">Zmod_1_r</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit_0_l">Z.testbit_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_false">zlt_false;</a></span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_S">two_p_S;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="id">x0</span> <span class="id">mod</span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">with</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x0</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x0</span> <span class="id">mod</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin">Ztestbit_shiftin;</a></span> <span class="id">auto</span>. <span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_eq">Ztestbit_eq</a></span> <span class="id">i</span> <span class="id">x0</span>)<span class="id">;</span> <span class="id">auto</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">i</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true;</a></span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> <span class="id">H0</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id">i</span>) <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true;</a></span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_false">zlt_false;</a></span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x0</span>) <span class="gallina-kwd">at</span> <span class="id">3</span>. <span class="id">set</span> (<span class="id">x1</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x0</span>). <span class="id">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmod_unique">Zmod_unique</a></span> <span class="gallina-kwd">with</span> (<span class="id">x1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3c2652250c7a120d67ccc0e8f58ae75">/</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!Zshiftin_spec</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_assoc">Z.add_assoc</a></span>. <span class="id">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">transitivity</span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> (<span class="id">x1</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3c2652250c7a120d67ccc0e8f58ae75">/</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">x1</span> <span class="id">mod</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f_equal</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Z_div_mod_eq">Z_div_mod_eq</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_spec">Zshiftin_spec</a></span>. <span class="id">exploit</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_mod_lt">Z_mod_lt</a></span> <span class="id">x1</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span>)). <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x0</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Corollary</span> <span id="Ztestbit_two_p_m1" class="id"><a name="Ztestbit_two_p_m1" class="">Ztestbit_two_p_m1:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:120" class="id"><a name="n:120" class="">n</a></span> <span id="i:121" class="id"><a name="i:121" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:120">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:121">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:120">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id"><a href="compcert.lib.Zbits.html#i:121">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:121">i</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:120">n</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="gallina-kwd">with</span> ((<span class="id">-1</span>) <span class="id">mod</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_mod_two_p">Ztestbit_mod_two_p;</a></span> <span class="id">auto</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">n</span>)<span class="id">;</span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_m1">Ztestbit_m1;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmod_unique">Zmod_unique</a></span> <span class="gallina-kwd">with</span> (<span class="id">-1</span>). <span class="id">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> <span class="id">n</span>). <span class="id">auto</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Corollary</span> <span id="Ztestbit_neg_two_p" class="id"><a name="Ztestbit_neg_two_p" class="">Ztestbit_neg_two_p:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:122" class="id"><a name="n:122" class="">n</a></span> <span id="i:123" class="id"><a name="i:123" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:122">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:123">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:122">n</a></span>)) <span class="id"><a href="compcert.lib.Zbits.html#i:123">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:123">i</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:122">n</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
&nbsp;&nbsp;<span class="id">intros</span>. <br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">n</span>) <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="gallina-kwd">by</span> <span class="id">lia</span>. <br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_one_complement">Z_one_complement</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_two_p_m1">Ztestbit_two_p_m1</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">n</span>)<span class="id">;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_add_is_or" class="id"><a name="Z_add_is_or" class="">Z_add_is_or:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="i:124" class="id"><a name="i:124" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:124">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:125" class="id"><a name="x:125" class="">x</a></span> <span id="y:126" class="id"><a name="y:126" class="">y,</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="j:127" class="id"><a name="j:127" class="">j,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#j:127">j</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:124">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:125">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#j:127">j</a></span> &amp;&amp; <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:126">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#j:127">j</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#x:125">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:126">y</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#i:124">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:125">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:124">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185">||</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:126">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:124">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">i0</span> <span class="id">POS0</span>. <span class="id">pattern</span> <span class="id">i0</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Wf_Z.html#Zlt_0_ind">Zlt_0_ind;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">i</span> <span class="id">IND</span> <span class="id">POS</span> <span class="id">x</span> <span class="id">y</span> <span class="id">EXCL</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>. <span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">y</span>) <span class="gallina-kwd">in</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">transitivity</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185">||</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">y</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">y</span>)) <span class="id">i</span>).<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">f_equal</span>. <span class="id">rewrite</span> <span class="id">!Zshiftin_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">EXCL</span> <span class="id">0</span>). <span class="id">lia</span>. <span class="id">rewrite</span> <span class="id">!Ztestbit_shiftin_base</span>. <span class="id">intros</span>.<br/>
<span class="vernacular">Opaque</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul">Z.mul</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">y</span>)<span class="id">;</span> <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">*;</span> <span class="id">discriminate</span> <span class="id">||</span> <span class="id">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">!Ztestbit_shiftin;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">i</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply</span> <span class="id">IND</span>. <span class="id">lia</span>. <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">EXCL</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id">j</span>)). <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!Ztestbit_shiftin_succ</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<h2> Zero and sign extensions </h2>
<br/>
<div class="doc">In pseudo-code:
<pre>
    Fixpoint Zzero_ext (n: Z) (x: Z) : Z :=
      if zle n 0 then
        0
      else
        Zshiftin (Z.odd x) (Zzero_ext (Z.pred n) (Z.div2 x)).
    Fixpoint Zsign_ext (n: Z) (x: Z) : Z :=
      if zle n 1 then
        if Z.odd x then -1 else 0
      else
        Zshiftin (Z.odd x) (Zzero_ext (Z.pred n) (Z.div2 x)).</pre>
  We encode this <span class="bracket"><span class="id">nat</span></span>-like recursion using the <span class="bracket"><span class="id">Z.iter</span></span> iteration
  function, in order to make the <span class="bracket"><span class="id">Zzero_ext</span></span> and <span class="bracket"><span class="id">Zsign_ext</span></span>
  functions efficiently executable within Coq.
</div>
<br/>
<span class="vernacular">Definition</span> <span id="Zzero_ext" class="id"><a name="Zzero_ext" class="">Zzero_ext</a></span> (<span id="n:128" class="id"><a name="n:128" class="">n:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="x:129" class="id"><a name="x:129" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.iter">Z.iter</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:128">n</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="rec:131" class="id"><a name="rec:131" class="">rec</a></span> <span id="x:132" class="id"><a name="x:132" class="">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:132">x</a></span>) (<span class="id"><a href="compcert.lib.Zbits.html#rec:131">rec</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:132">x</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="x:130" class="id"><a name="x:130" class="">x</a></span> <span class="id">=&gt;</span> <span class="id">0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#x:129">x</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Zsign_ext" class="id"><a name="Zsign_ext" class="">Zsign_ext</a></span> (<span id="n:133" class="id"><a name="n:133" class="">n:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="x:134" class="id"><a name="x:134" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.iter">Z.iter</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:133">n</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="rec:136" class="id"><a name="rec:136" class="">rec</a></span> <span id="x:137" class="id"><a name="x:137" class="">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:137">x</a></span>) (<span class="id"><a href="compcert.lib.Zbits.html#rec:136">rec</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:137">x</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="x:135" class="id"><a name="x:135" class="">x</a></span> <span class="id">=&gt;</span> <span class="gallina-kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:135">x</a></span> &amp;&amp; <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">0</span> <span class="id"><a href="compcert.lib.Zbits.html#n:133">n</a></span> <span class="gallina-kwd">then</span> <span class="id">-1</span> <span class="gallina-kwd">else</span> <span class="id">0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#x:134">x</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Ziter_base" class="id"><a name="Ziter_base" class="">Ziter_base:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span id="A:138" class="id"><a name="A:138" class="">A:</a></span> <span class="gallina-kwd">Type</span>) <span id="n:139" class="id"><a name="n:139" class="">n</a></span> (<span id="f:140" class="id"><a name="f:140" class="">f:</a></span> <span class="id"><a href="compcert.lib.Zbits.html#A:138">A</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#A:138">A</a></span>) <span id="x:141" class="id"><a name="x:141" class="">x,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:139">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.iter">Z.iter</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:139">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#f:140">f</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:141">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:141">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.iter">Z.iter</a></span>. <span class="id">destruct</span> <span class="id">n;</span> <span class="id">auto</span>. <span class="id">compute</span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">elim</span> <span class="id">H;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Ziter_succ" class="id"><a name="Ziter_succ" class="">Ziter_succ:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span id="A:142" class="id"><a name="A:142" class="">A:</a></span> <span class="gallina-kwd">Type</span>) <span id="n:143" class="id"><a name="n:143" class="">n</a></span> (<span id="f:144" class="id"><a name="f:144" class="">f:</a></span> <span class="id"><a href="compcert.lib.Zbits.html#A:142">A</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#A:142">A</a></span>) <span id="x:145" class="id"><a name="x:145" class="">x,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:143">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.iter">Z.iter</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:143">n</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#f:144">f</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:145">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#f:144">f</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.iter">Z.iter</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:143">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#f:144">f</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:145">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">n;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.add_1_r">Pos.add_1_r</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.iter_succ">Pos.iter_succ</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">compute</span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">elim</span> <span class="id">H;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Znatlike_ind" class="id"><a name="Znatlike_ind" class="">Znatlike_ind:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span id="P:146" class="id"><a name="P:146" class="">P:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">Prop</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="n:147" class="id"><a name="n:147" class="">n,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:147">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:146">P</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:147">n</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="n:148" class="id"><a name="n:148" class="">n,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:148">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:146">P</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:148">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:146">P</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:148">n</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:149" class="id"><a name="n:149" class="">n,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P:146">P</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:149">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">0</span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Wf_Z.html#natlike_ind">natlike_ind;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id">H;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zzero_ext_spec" class="id"><a name="Zzero_ext_spec" class="">Zzero_ext_spec:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:150" class="id"><a name="n:150" class="">n</a></span> <span id="x:151" class="id"><a name="x:151" class="">x</a></span> <span id="i:152" class="id"><a name="i:152" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:152">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:150">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:151">x</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#i:152">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:152">i</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:150">n</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:151">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:152">i</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span>. <span class="id">induction</span> <span class="id">n</span> <span class="gallina-kwd">using</span> <span class="id"><a href="compcert.lib.Zbits.html#Znatlike_ind">Znatlike_ind</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ziter_base">Ziter_base;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_false">zlt_false</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_0">Ztestbit_0;</a></span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ziter_succ">Ziter_succ;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin">Ztestbit_shiftin;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_eq">Ztestbit_eq</a></span> <span class="id">i</span> <span class="id">x</span>)<span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">i</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">subst</span> <span class="id">i</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true;</a></span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> <span class="id">IHn</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id">i</span>) <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true;</a></span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_false">zlt_false;</a></span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zsign_ext_spec" class="id"><a name="Zsign_ext_spec" class="">Zsign_ext_spec:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:153" class="id"><a name="n:153" class="">n</a></span> <span id="x:154" class="id"><a name="x:154" class="">x</a></span> <span id="i:155" class="id"><a name="i:155" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:155">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext">Zsign_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:153">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:154">x</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#i:155">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:154">x</a></span> (<span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:155">i</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:153">n</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="compcert.lib.Zbits.html#i:155">i</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="compcert.lib.Zbits.html#n:153">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n0</span> <span class="id">x</span> <span class="id">i</span> <span class="id">I0</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext">Zsign_ext</a></span>. <br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool;</a></span> <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">0</span> <span class="id">n0</span>) <span class="gallina-kwd">as</span> <span class="id">[N0|N0];</span> <span class="id">simpl</span>.<br/>
<span class="id">-</span> <span class="id">revert</span> <span class="id">x</span> <span class="id">i</span> <span class="id">I0</span>. <span class="id">pattern</span> <span class="id">n0</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Wf_Z.html#Zlt_lower_bound_ind">Zlt_lower_bound_ind</a></span> <span class="gallina-kwd">with</span> (<span class="id">z</span> <span class="id">:=</span> <span class="id">1</span>)<span class="id">;</span> <span class="id">[</span> <span class="id">|</span> <span class="id">lia</span> <span class="id">]</span>.<br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext">Zsign_ext</a></span>. <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">x</span> <span class="id">1</span>).<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">subst</span> <span class="id">x;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">replace</span> (<span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">1</span> <span class="gallina-kwd">then</span> <span class="id">i</span> <span class="gallina-kwd">else</span> <span class="id">0</span>) <span class="gallina-kwd">with</span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_base">Ztestbit_base</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x0</span>)<span class="id">;</span> <span class="id">[</span> <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_m1">Ztestbit_m1;</a></span> <span class="id">auto</span> <span class="id">|</span> <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_0">Ztestbit_0</a></span> <span class="id">]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">1</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">set</span> (<span class="id">x1</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id">x</span>). <span class="id">replace</span> <span class="id">x1</span> <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id">x1</span>)) <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ziter_succ">Ziter_succ</a></span> <span class="gallina-kwd">by</span> (<span class="id">unfold</span> <span class="id">x1;</span> <span class="id">lia</span>). <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin">Ztestbit_shiftin</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">i</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="id">subst</span> <span class="id">i</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_base">Ztestbit_base;</a></span> <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> <span class="id">rewrite</span> <span class="id">H</span> <span class="gallina-kwd">by</span> (<span class="id">unfold</span> <span class="id">x1;</span> <span class="id">lia</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id">x1;</span> <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id">i</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_eq">Ztestbit_eq</a></span> <span class="id">i</span> <span class="id">x0</span>) <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq_false">zeq_false</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">**</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_false">zlt_false</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_eq">Ztestbit_eq</a></span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id">x0</span>) <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq_false">zeq_false</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ziter_base">Ziter_base</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_false_r">andb_false_r</a></span>. <br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit_0_l">Z.testbit_0_l</a></span><span class="id">,</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit_neg_r">Z.testbit_neg_r</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">n0</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">Zzero_ext</span> <span class="id">n</span> <span class="id">x</span></span> is <span class="bracket"><span class="id">x</span> <span class="id">modulo</span> 2^<span class="id">n</span></span> </div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zzero_ext_mod" class="id"><a name="Zzero_ext_mod" class="">Zzero_ext_mod:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:156" class="id"><a name="n:156" class="">n</a></span> <span id="x:157" class="id"><a name="x:157" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:156">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:156">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:157">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:157">x</a></span> <span class="id">mod</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:156">n</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#equal_same_bits">equal_same_bits;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext_spec">Zzero_ext_spec,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_mod_two_p">Ztestbit_mod_two_p</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">Zzero_ext</span> <span class="id">n</span> <span class="id">x</span></span> is the unique integer congruent to <span class="bracket"><span class="id">x</span></span> modulo <span class="bracket">2^<span class="id">n</span></span> in the range <span class="bracket">0...2^<span class="id">n</span>-1</span>. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zzero_ext_range" class="id"><a name="Zzero_ext_range" class="">Zzero_ext_range:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:158" class="id"><a name="n:158" class="">n</a></span> <span id="x:159" class="id"><a name="x:159" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:158">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:158">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:159">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:158">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext_mod">Zzero_ext_mod;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_mod_lt">Z_mod_lt</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_Zzero_ext" class="id"><a name="eqmod_Zzero_ext" class="">eqmod_Zzero_ext:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:160" class="id"><a name="n:160" class="">n</a></span> <span id="x:161" class="id"><a name="x:161" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:160">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:160">n</a></span>) (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:160">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:161">x</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#x:161">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext_mod">Zzero_ext_mod;</a></span> <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod_sym">eqmod_sym</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod_mod">eqmod_mod</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relation between <span class="bracket"><span class="id">Zsign_ext</span> <span class="id">n</span> <span class="id">x</span></span> and (Zzero_ext n x] </div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zsign_ext_zero_ext" class="id"><a name="Zsign_ext_zero_ext" class="">Zsign_ext_zero_ext:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:162" class="id"><a name="n:162" class="">n,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:162">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">forall</span> <span id="x:163" class="id"><a name="x:163" class="">x,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext">Zsign_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:162">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:163">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:162">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:163">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> (<span class="gallina-kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:163">x</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#n:162">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:162">n</a></span> <span class="gallina-kwd">else</span> <span class="id">0</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#equal_same_bits">equal_same_bits;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext_spec">Zsign_ext_spec</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id">x</span> (<span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)) <span class="id">eqn:SIGNBIT</span>.<br/>
<span class="id">-</span> <span class="id">set</span> (<span class="id">n'</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">n</span>). <br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id">n</span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">n</span>) <span class="gallina-kwd">with</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id">n</span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">n'</span>) <span class="gallina-kwd">by</span> (<span class="id">unfold</span> <span class="id">n';</span> <span class="id">lia</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_add_is_or">Z_add_is_or;</a></span> <span class="id">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext_spec">Zzero_ext_spec</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">unfold</span> <span class="id">n';</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_neg_two_p">Ztestbit_neg_two_p</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">n</span>). <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_r">orb_false_r;</a></span> <span class="id">auto</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext_spec">Zzero_ext_spec</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">unfold</span> <span class="id">n';</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_neg_two_p">Ztestbit_neg_two_p</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">j</span> <span class="id">n</span>)<span class="id">;</span> <span class="id">auto</span> <span class="gallina-kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_false_r">andb_false_r</a></span>.<br/>
<span class="id">-</span> <span class="id">replace</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id">n</span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">0</span>) <span class="gallina-kwd">with</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id">n</span> <span class="id">x</span>) <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext_spec">Zzero_ext_spec</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">n</span>)<span class="id">;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">Zsign_ext</span> <span class="id">n</span> <span class="id">x</span></span> is the unique integer congruent to <span class="bracket"><span class="id">x</span></span> modulo <span class="bracket">2^<span class="id">n</span></span>
    in the range <span class="bracket">-2^(<span class="id">n</span>-1)...2^(<span class="id">n</span>-1) - 1</span>. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zsign_ext_range" class="id"><a name="Zsign_ext_range" class="">Zsign_ext_range:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:164" class="id"><a name="n:164" class="">n</a></span> <span id="x:165" class="id"><a name="x:165" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:164">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:'-'_x">-two_p</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#n:164">n-1</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext">Zsign_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:164">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:165">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#n:164">n-1</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">A:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id">n</span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">n</span>) <span class="gallina-kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext_range">Zzero_ext_range;</a></span> <span class="id">lia</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">B:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id">n</span> <span class="id">x</span>) (<span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id">n</span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)) <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">set</span> (<span class="id">N</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> (<span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsign_bit">Zsign_bit</a></span> <span class="id">N</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id">n</span> <span class="id">x</span>)). <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_two_p">two_power_nat_two_p</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#inj_S">inj_S</a></span>.  <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#N">N;</a></span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2Nat.id">Z2Nat.id</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">X;</span> <span class="id">apply</span> <span class="id">X</span>.  <span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> (<span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)) <span class="gallina-kwd">with</span> <span class="id">n</span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">exact</span> <span class="id">A</span>. <br/>
&nbsp;&nbsp;<span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">C:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_S">two_p_S</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">f_equal;</span> <span class="id">lia</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext_spec">Zzero_ext_spec,</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true</a></span> <span class="gallina-kwd">in</span> <span class="id">B</span> <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext_zero_ext">Zsign_ext_zero_ext</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">rewrite</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id">n</span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)))<span class="id">;</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eqmod_Zsign_ext" class="id"><a name="eqmod_Zsign_ext" class="">eqmod_Zsign_ext:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:166" class="id"><a name="n:166" class="">n</a></span> <span id="x:167" class="id"><a name="x:167" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:166">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#eqmod">eqmod</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:166">n</a></span>) (<span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext">Zsign_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:166">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:167">x</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#x:167">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext_zero_ext">Zsign_ext_zero_ext</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod_trans">eqmod_trans</a></span> <span class="gallina-kwd">with</span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">0</span>). <br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod_sub">eqmod_sub</a></span>. <br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod_Zzero_ext">eqmod_Zzero_ext;</a></span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="gallina-kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id">x</span> (<span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="gallina-kwd">then</span> <span class="id">1</span> <span class="gallina-kwd">else</span> <span class="id">0</span>). <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id">x</span> (<span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>))<span class="id">;</span> <span class="id">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#eqmod_refl2">eqmod_refl2;</a></span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<h2> Decomposition of a number as a sum of powers of two. </h2>
<br/>
<span class="vernacular">Fixpoint</span> <span id="Z_one_bits" class="id"><a name="Z_one_bits" class="">Z_one_bits</a></span> (<span id="n:168" class="id"><a name="n:168" class="">n:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span id="x:169" class="id"><a name="x:169" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="i:170" class="id"><a name="i:170" class="">i:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">{struct</span> <span class="id">n}:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.lib.Zbits.html#n:168">n</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> <span class="id">m</span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:169">x</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">then</span> <span class="id"><a href="compcert.lib.Zbits.html#i:170">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits:171">Z_one_bits</a></span> <span class="id">m</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:169">x</a></span>) (<span class="id"><a href="compcert.lib.Zbits.html#i:170">i+1</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits:171">Z_one_bits</a></span> <span class="id">m</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:169">x</a></span>) (<span class="id"><a href="compcert.lib.Zbits.html#i:170">i+1</a></span>)<br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="powerserie" class="id"><a name="powerserie" class="">powerserie</a></span> (<span id="l:173" class="id"><a name="l:173" class="">l:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)<span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.lib.Zbits.html#l:173">l</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">=&gt;</span> <span class="id">0</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#::list_scope:x_'::'_x">::</a></span> <span class="id">xs</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#powerserie:174">powerserie</a></span> <span class="id">xs</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_one_bits_powerserie" class="id"><a name="Z_one_bits_powerserie" class="">Z_one_bits_powerserie:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:176" class="id"><a name="n:176" class="">n</a></span> <span id="x:177" class="id"><a name="x:177" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:177">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:176">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:177">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#powerserie">powerserie</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits">Z_one_bits</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:176">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:177">x</a></span> <span class="id">0</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
&nbsp;&nbsp;<span class="id">assert</span> (<span class="gallina-kwd">forall</span> <span id="n:181" class="id"><span id="n:178" class="id"><a name="n:181" class="">n</a></span></span> <span id="x:182" class="id"><span id="x:179" class="id"><a name="x:182" class="">x</a></span></span> <span id="i:183" class="id"><span id="i:180" class="id"><a name="i:183" class="">i,</a></span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:180">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:179">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:178">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#x:179">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:180">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#powerserie">powerserie</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits">Z_one_bits</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:178">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:179">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:180">i</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_O">two_power_nat_O</a></span> <span class="gallina-kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>) <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">subst</span> <span class="id">x</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat_S">two_power_nat_S</a></span> <span class="gallina-kwd">in</span> <span class="id">H0</span>. <span class="id">simpl</span> <span class="id">Z_one_bits</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>) <span class="gallina-kwd">in</span> <span class="id">H0</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_spec">Zshiftin_spec</a></span> <span class="gallina-kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">EQ:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#powerserie">powerserie</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits">Z_one_bits</a></span> <span class="id">n</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x</span>) (<span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHn</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span> <span class="gallina-kwd">in</span> <span class="id">EQ</span>. <span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">1</span>) <span class="gallina-kwd">with</span> <span class="id">2</span> <span class="gallina-kwd">in</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span> <span class="id">x</span>) <span class="gallina-kwd">at</span> <span class="id">1</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_spec">Zshiftin_spec</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">simpl</span> <span class="id">powerserie;</span> <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">EQ;</span> <span class="id">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H</span>. <span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">0</span>) <span class="gallina-kwd">with</span> <span class="id">1</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">exact</span> <span class="id">H0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_one_bits_range" class="id"><a name="Z_one_bits_range" class="">Z_one_bits_range:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:184" class="id"><a name="n:184" class="">n</a></span> <span id="x:185" class="id"><a name="x:185" class="">x</a></span> <span id="i:186" class="id"><a name="i:186" class="">i,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:186">i</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits">Z_one_bits</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:184">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:185">x</a></span> <span class="id">0</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:186">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:184">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
&nbsp;&nbsp;<span class="id">assert</span> (<span class="gallina-kwd">forall</span> <span id="n:191" class="id"><span id="n:187" class="id"><a name="n:191" class="">n</a></span></span> <span id="x:192" class="id"><span id="x:188" class="id"><a name="x:192" class="">x</a></span></span> <span id="i:193" class="id"><span id="i:189" class="id"><a name="i:193" class="">i</a></span></span> <span id="j:194" class="id"><span id="j:190" class="id"><a name="j:194" class="">j,</a></span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.lib.Zbits.html#j:190">j</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits">Z_one_bits</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:187">n</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:188">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:189">i</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:189">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#j:190">j</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:189">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:187">n</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">simpl</span> <span class="id">In</span>.<br/>
&nbsp;&nbsp;<span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">i</span> <span class="id">j</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">j</span> (<span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits">Z_one_bits</a></span> <span class="id">n</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> <span class="id">x</span>) (<span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">1</span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id">j</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">exploit</span> <span class="id">IHn;</span> <span class="id">eauto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id">x</span>)<span class="id">;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">[A|B]</span>. <span class="id">subst</span> <span class="id">j</span>. <span class="id">lia</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">generalize</span> (<span class="id">H</span> <span class="id">n</span> <span class="id">x</span> <span class="id">0</span> <span class="id">i</span> <span class="id">H0</span>). <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Z_one_bits_zero" class="id"><a name="Z_one_bits_zero" class="">Z_one_bits_zero:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:195" class="id"><a name="n:195" class="">n</a></span> <span id="i:196" class="id"><a name="i:196" class="">i,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits">Z_one_bits</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:195">n</a></span> <span class="id">0</span> <span class="id"><a href="compcert.lib.Zbits.html#i:196">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">intros;</span> <span class="id">simpl;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Z_one_bits_two_p" class="id"><a name="Z_one_bits_two_p" class="">Z_one_bits_two_p:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:197" class="id"><a name="n:197" class="">n</a></span> <span id="x:198" class="id"><a name="x:198" class="">x</a></span> <span id="i:199" class="id"><a name="i:199" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:198">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:197">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits">Z_one_bits</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:197">n</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:198">x</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#i:199">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#i:199">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:198">x</a></span>) <span class="id">::</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">n;</span> <span class="id">intros;</span> <span class="id">simpl</span>. <span class="id">simpl</span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">extlia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25">\/</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id">x</span>) <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">x;</span> <span class="id">simpl</span>. <span class="id">decEq</span>. <span class="id">lia</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_one_bits_zero">Z_one_bits_zero</a></span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div2">Z.div2</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">x</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id">x-1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_inj">Zshiftin_inj</a></span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.lib.Zbits.html#Zdecomp">Zdecomp</a></span>. <span class="id">rewrite</span> <span class="id">!Zshiftin_spec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_S">two_p_S</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_r">Z.add_0_r</a></span>. <span class="id">f_equal;</span> <span class="id">lia</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span> <span class="gallina-kwd">as</span> <span class="id">[A</span> <span class="id">B];</span> <span class="id">rewrite</span> <span class="id">A;</span> <span class="id">rewrite</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHn</span>. <span class="id">f_equal;</span> <span class="id">lia</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<h2> Recognition of powers of two </h2>
<br/>
<span class="vernacular">Fixpoint</span> <span id="P_is_power2" class="id"><a name="P_is_power2" class="">P_is_power2</a></span> (<span id="p:200" class="id"><a name="p:200" class="">p:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.lib.Zbits.html#p:200">p</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xO">xO</a></span> <span class="id">q</span> <span class="id">=&gt;</span> <span class="id"><a href="compcert.lib.Zbits.html#P_is_power2:201">P_is_power2</a></span> <span class="id">q</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xI">xI</a></span> <span class="id">q</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Z_is_power2" class="id"><a name="Z_is_power2" class="">Z_is_power2</a></span> (<span id="x:203" class="id"><a name="x:203" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.lib.Zbits.html#x:203">x</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span> <span class="id">=&gt;</span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Zbits.html#P_is_power2">P_is_power2</a></span> <span class="id">p</span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:203">x</a></span>) <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zneg">Zneg</a></span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Remark</span> <span id="P_is_power2_sound" class="id"><a name="P_is_power2_sound" class="">P_is_power2_sound:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="p:205" class="id"><a name="p:205" class="">p,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#P_is_power2">P_is_power2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#p:205">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id"><a href="compcert.lib.Zbits.html#p:205">p</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id"><a href="compcert.lib.Zbits.html#p:205">p</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">p;</span> <span class="id">simpl</span> <span class="id">P_is_power2;</span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">discriminate</span>.<br/>
<span class="id">-</span> <span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p~0</span>) <span class="gallina-kwd">with</span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>).  <span class="id">apply</span> <span class="id">IHp</span> <span class="gallina-kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_double">Z.log2_double</a></span> <span class="gallina-kwd">by</span> <span class="id">extlia</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_S">two_p_S</a></span>.  <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_nonneg">Z.log2_nonneg</a></span>.<br/>
<span class="id">-</span> <span class="id">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_is_power2_nonneg" class="id"><a name="Z_is_power2_nonneg" class="">Z_is_power2_nonneg:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:206" class="id"><a name="x:206" class="">x</a></span> <span id="i:207" class="id"><a name="i:207" class="">i,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2">Z_is_power2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:206">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:207">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:207">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2">Z_is_power2;</a></span> <span class="id">intros</span>. <span class="id">destruct</span> <span class="id">x;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Zbits.html#P_is_power2">P_is_power2</a></span> <span class="id">p</span>) <span class="id">eqn:P;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> <span class="id">i</span> <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>)) <span class="gallina-kwd">by</span> <span class="id">congruence</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_nonneg">Z.log2_nonneg</a></span>.<br/>
Qed.</div>
&nbsp;<br/>
<span class="vernacular">Lemma</span> <span id="Z_is_power2_sound" class="id"><a name="Z_is_power2_sound" class="">Z_is_power2_sound:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:208" class="id"><a name="x:208" class="">x</a></span> <span id="i:209" class="id"><a name="i:209" class="">i,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2">Z_is_power2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:208">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:209">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:208">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:209">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd">/\</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:209">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:208">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2">Z_is_power2;</a></span> <span class="id">intros</span>. <span class="id">destruct</span> <span class="id">x;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Zbits.html#P_is_power2">P_is_power2</a></span> <span class="id">p</span>) <span class="id">eqn:P;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#P_is_power2_sound">P_is_power2_sound</a></span> <span class="gallina-kwd">in</span> <span class="id">P</span>. <span class="id">rewrite</span> <span class="id">P;</span> <span class="id">split;</span> <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Corollary</span> <span id="Z_is_power2_range" class="id"><a name="Z_is_power2_range" class="">Z_is_power2_range:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:210" class="id"><a name="n:210" class="">n</a></span> <span id="x:211" class="id"><a name="x:211" class="">x</a></span> <span id="i:212" class="id"><a name="i:212" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:210">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:211">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:210">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2">Z_is_power2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:211">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:212">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:212">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:210">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x">&lt;&gt;</a></span> <span class="id">0</span>) <span class="gallina-kwd">by</span> (<span class="id">red;</span> <span class="id">intros;</span> <span class="id">subst</span> <span class="id">x;</span> <span class="id">discriminate</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2_sound">Z_is_power2_sound</a></span> <span class="gallina-kwd">in</span> <span class="id">H1</span>. <span class="id">destruct</span> <span class="id">H1</span> <span class="gallina-kwd">as</span> <span class="id">[P</span> <span class="id">Q]</span>. <span class="id">subst</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_nonneg">Z.log2_nonneg</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_lt_pow2">Z.log2_lt_pow2</a></span>. <span class="id">lia</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_equiv">two_p_equiv;</a></span> <span class="id">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_is_power2_complete" class="id"><a name="Z_is_power2_complete" class="">Z_is_power2_complete:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="i:213" class="id"><a name="i:213" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:213">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2">Z_is_power2</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:213">i</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:213">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
<span class="vernacular">Opaque</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">A:</span> <span class="gallina-kwd">forall</span> <span id="x:216" class="id"><span id="x:214" class="id"><a name="x:216" class="">x</a></span></span> <span id="i:217" class="id"><span id="i:215" class="id"><a name="i:217" class="">i,</a></span></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2">Z_is_power2</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:214">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:215">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2">Z_is_power2</a></span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:214">x</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:215">i</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">destruct</span> <span class="id">x;</span> <span class="id">simpl;</span> <span class="id">intros;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">p</span>) <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#xO">xO</a></span> <span class="id">p</span>))<span class="id">;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Zbits.html#P_is_power2">P_is_power2</a></span> <span class="id">p</span>)<span class="id">;</span> <span class="id">inv</span> <span class="id">H</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_double">Z.log2_double</a></span> <span class="gallina-kwd">by</span> <span class="id">extlia</span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">i</span> <span class="gallina-kwd">using</span> <span class="id"><a href="compcert.lib.Zbits.html#Znatlike_ind">Znatlike_ind;</a></span> <span class="id">intros</span>.<br/>
<span class="id">-</span> <span class="id">replace</span> <span class="id">i</span> <span class="gallina-kwd">with</span> <span class="id">0</span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">reflexivity</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_S">two_p_S</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">apply</span> <span class="id">A</span>. <span class="id">apply</span> <span class="id">IHi;</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="Z_is_power2m1" class="id"><a name="Z_is_power2m1" class="">Z_is_power2m1</a></span> (<span id="x:218" class="id"><a name="x:218" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2">Z_is_power2</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:218">x</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_is_power2m1_nonneg" class="id"><a name="Z_is_power2m1_nonneg" class="">Z_is_power2m1_nonneg:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:219" class="id"><a name="x:219" class="">x</a></span> <span id="i:220" class="id"><a name="i:220" class="">i,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2m1">Z_is_power2m1</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:219">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:220">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:220">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2m1">Z_is_power2m1;</a></span> <span class="id">intros</span>. <span class="id">eapply</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2_nonneg">Z_is_power2_nonneg;</a></span> <span class="id">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_is_power2m1_sound" class="id"><a name="Z_is_power2m1_sound" class="">Z_is_power2m1_sound:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:221" class="id"><a name="x:221" class="">x</a></span> <span id="i:222" class="id"><a name="i:222" class="">i,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2m1">Z_is_power2m1</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:221">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:222">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:221">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:222">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2m1">Z_is_power2m1;</a></span> <span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2_sound">Z_is_power2_sound</a></span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_is_power2m1_complete" class="id"><a name="Z_is_power2m1_complete" class="">Z_is_power2m1_complete:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="i:223" class="id"><a name="i:223" class="">i,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:223">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2m1">Z_is_power2m1</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:223">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:223">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2m1">Z_is_power2m1</a></span>. <span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)) <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">i</span>) <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2_complete">Z_is_power2_complete;</a></span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Z_is_power2m1_range" class="id"><a name="Z_is_power2m1_range" class="">Z_is_power2m1_range:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="n:224" class="id"><a name="n:224" class="">n</a></span> <span id="x:225" class="id"><a name="x:225" class="">x</a></span> <span id="i:226" class="id"><a name="i:226" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:224">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:225">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:224">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2m1">Z_is_power2m1</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:225">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:226">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:226">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:224">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">x</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">n</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)).<br/>
<span class="id">-</span> <span class="id">subst</span> <span class="id">x</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2m1_complete">Z_is_power2m1_complete</a></span> <span class="gallina-kwd">in</span> <span class="id">H1</span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">inv</span> <span class="id">H1;</span> <span class="id">lia</span>.<br/>
<span class="id">-</span> <span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2m1">Z_is_power2m1</a></span> <span class="gallina-kwd">in</span> <span class="id">H1</span>. <span class="id">apply</span> (<span class="id"><a href="compcert.lib.Zbits.html#Z_is_power2_range">Z_is_power2_range</a></span> <span class="id">n</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id">x</span>) <span class="id">i</span>) <span class="gallina-kwd">in</span> <span class="id">H1;</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<h2> Relation between bitwise operations and multiplications / divisions by powers of 2 </h2>
<br/>
<div class="doc">Left shifts and multiplications by powers of 2. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zshiftl_mul_two_p" class="id"><a name="Zshiftl_mul_two_p" class="">Zshiftl_mul_two_p:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:227" class="id"><a name="x:227" class="">x</a></span> <span id="n:228" class="id"><a name="n:228" class="">n,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:228">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl">Z.shiftl</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:227">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:228">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:227">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:228">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">n;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">pattern</span> <span class="id">p</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.peano_ind">Pos.peano_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_pos">two_power_pos</a></span> <span class="id">1</span>) <span class="gallina-kwd">with</span> <span class="id">2</span>. <span class="id">simpl</span>. <span class="id">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.iter_succ">Pos.iter_succ</a></span>. <span class="id">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pplus_one_succ_l">Pplus_one_succ_l</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_pos_is_exp">two_power_pos_is_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_pos">two_power_pos</a></span> <span class="id">1</span>) <span class="gallina-kwd">with</span> <span class="id">2</span>. <span class="id">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">compute</span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Right shifts and divisions by powers of 2. </div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zshiftr_div_two_p" class="id"><a name="Zshiftr_div_two_p" class="">Zshiftr_div_two_p:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:229" class="id"><a name="x:229" class="">x</a></span> <span id="n:230" class="id"><a name="n:230" class="">n,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:230">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr">Z.shiftr</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:229">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:230">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:229">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3c2652250c7a120d67ccc0e8f58ae75">/</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:230">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">n;</span> <span class="id">unfold</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr">Z.shiftr</a></span><span class="id">;</span> <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_1_r">Zdiv_1_r</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">pattern</span> <span class="id">p</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.peano_ind">Pos.peano_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_pos">two_power_pos</a></span> <span class="id">1</span>) <span class="gallina-kwd">with</span> <span class="id">2</span>. <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv2_div">Zdiv2_div</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.iter_succ">Pos.iter_succ</a></span>. <span class="id">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pplus_one_succ_l">Pplus_one_succ_l</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_pos_is_exp">two_power_pos_is_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_pos">two_power_pos</a></span> <span class="id">1</span>) <span class="gallina-kwd">with</span> <span class="id">2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv2_div">Zdiv2_div</a></span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_Zdiv">Zdiv_Zdiv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_pos_nat">two_power_pos_nat</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_pos">two_power_nat_pos</a></span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">compute</span> <span class="gallina-kwd">in</span> <span class="id">H</span>. <span class="id">congruence</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of <span class="bracket"><span class="id">shrx</span></span> (signed division by a power of 2) </h2>
<br/>
<span class="vernacular">Lemma</span> <span id="Zquot_Zdiv" class="id"><a name="Zquot_Zdiv" class="">Zquot_Zdiv:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:231" class="id"><a name="x:231" class="">x</a></span> <span id="y:232" class="id"><a name="y:232" class="">y,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#y:232">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&gt;'_x">&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.quot">Z.quot</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:231">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:232">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:231">x</a></span> <span class="id">0</span> <span class="gallina-kwd">then</span> (<span class="id"><a href="compcert.lib.Zbits.html#x:231">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:232">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id">/</span> <span class="id"><a href="compcert.lib.Zbits.html#y:232">y</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="compcert.lib.Zbits.html#x:231">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3c2652250c7a120d67ccc0e8f58ae75">/</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:232">y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">x</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">symmetry</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zquot.html#Zquot_unique_full">Zquot_unique_full</a></span> <span class="gallina-kwd">with</span> ((<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id">mod</span> <span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> (<span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">red</span>. <span class="id">right;</span> <span class="id">split</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_mod_lt">Z_mod_lt</a></span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id">y</span>)<span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs_eq">Z.abs_eq</a></span>. <span class="id">lia</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">transitivity</span> ((<span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3ea1afb7d81263dc23c4eb0da2a3c4e">*</a></span> ((<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id">/</span> <span class="id">y</span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id">mod</span> <span class="id">y</span>) <span class="id">-</span> (<span class="id">y-1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.lib.Coqlib.html#Z_div_mod_eq">Z_div_mod_eq</a></span>. <span class="id">ring</span>. <span class="id">auto</span>. <span class="id">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zquot.html#Zquot_Zdiv_pos">Zquot_Zdiv_pos;</a></span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zdiv_shift" class="id"><a name="Zdiv_shift" class="">Zdiv_shift:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:233" class="id"><a name="x:233" class="">x</a></span> <span id="y:234" class="id"><a name="y:234" class="">y,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:234">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&gt;'_x">&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Zbits.html#x:233">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#y:234">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)) <span class="id">/</span> <span class="id"><a href="compcert.lib.Zbits.html#y:234">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:233">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3c2652250c7a120d67ccc0e8f58ae75">/</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:234">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.modulo">Z.modulo</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:233">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:234">y</a></span>) <span class="id">0</span> <span class="gallina-kwd">then</span> <span class="id">0</span> <span class="gallina-kwd">else</span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#Z_div_mod_eq">Z_div_mod_eq</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>). <span class="id">generalize</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_mod_lt">Z_mod_lt</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">set</span> (<span class="id">q</span> <span class="id">:=</span> <span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#d3c2652250c7a120d67ccc0e8f58ae75">/</a></span> <span class="id">y</span>). <span class="id">set</span> (<span class="id">r</span> <span class="id">:=</span> <span class="id">x</span> <span class="id">mod</span> <span class="id">y</span>). <span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">r</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_unique">Zdiv_unique</a></span> <span class="gallina-kwd">with</span> (<span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>). <span class="id">rewrite</span> <span class="id">H1</span>. <span class="id">rewrite</span> <span class="id">e</span>. <span class="id">ring</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_unique">Zdiv_unique</a></span> <span class="gallina-kwd">with</span> (<span class="id">r</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>). <span class="id">rewrite</span> <span class="id">H1</span>. <span class="id">ring</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<h2> Size of integers, in bits. </h2>
<br/>
<span class="vernacular">Definition</span> <span id="Zsize" class="id"><a name="Zsize" class="">Zsize</a></span> (<span id="x:235" class="id"><a name="x:235" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="compcert.lib.Zbits.html#x:235">x</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span> <span class="id">=&gt;</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.size">Pos.size</a></span> <span class="id">p</span>)<br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">0</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Remark</span> <span id="Zsize_pos" class="id"><a name="Zsize_pos" class="">Zsize_pos:</a></span> <span class="gallina-kwd">forall</span> <span id="x:237" class="id"><a name="x:237" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:237">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x;</span> <span class="id">simpl</span>. <span class="id">lia</span>. <span class="id">compute;</span> <span class="id">intuition</span> <span class="id">congruence</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Remark</span> <span id="Zsize_pos'" class="id"><a name="Zsize_pos'" class="">Zsize_pos':</a></span> <span class="gallina-kwd">forall</span> <span id="x:238" class="id"><a name="x:238" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:238">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:238">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x;</span> <span class="id">simpl;</span> <span class="id">intros;</span> <span class="id">try</span> <span class="id">discriminate</span>. <span class="id">compute;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zsize_shiftin" class="id"><a name="Zsize_shiftin" class="">Zsize_shiftin:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="b:239" class="id"><a name="b:239" class="">b</a></span> <span id="x:240" class="id"><a name="x:240" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:240">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="compcert.lib.Zbits.html#b:239">b</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:240">x</a></span>) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:240">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">destruct</span> <span class="id">x;</span> <span class="id">compute</span> <span class="gallina-kwd">in</span> <span class="id">H;</span> <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span>)) <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> (<span class="id">p~1</span>)).<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">f_equal</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.add_1_r">Pos.add_1_r</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span>)) <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> (<span class="id">p~0</span>)).<br/>
&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">f_equal</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.add_1_r">Pos.add_1_r</a></span><span class="id">;</span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Ztestbit_size_1" class="id"><a name="Ztestbit_size_1" class="">Ztestbit_size_1:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:241" class="id"><a name="x:241" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:241">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:241">x</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:241">x</a></span>)) <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x0</span> <span class="id">POS0;</span> <span class="id">pattern</span> <span class="id">x0;</span> <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_pos_ind">Zshiftin_pos_ind;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize_shiftin">Zsize_shiftin;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">replace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id">x</span>))) <span class="gallina-kwd">with</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id">x</span>))) <span class="gallina-kwd">by</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin_succ">Ztestbit_shiftin_succ</a></span>. <span class="id">auto</span>. <span class="id">generalize</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize_pos'">Zsize_pos'</a></span> <span class="id">x</span> <span class="id">H</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Ztestbit_size_2" class="id"><a name="Ztestbit_size_2" class="">Ztestbit_size_2:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:242" class="id"><a name="x:242" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:242">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">forall</span> <span id="i:243" class="id"><a name="i:243" class="">i,</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:243">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4">&gt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:242">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:242">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:243">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x0</span> <span class="id">POS0</span>. <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">x0</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">subst</span> <span class="id">x0;</span> <span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_0">Ztestbit_0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">pattern</span> <span class="id">x0;</span> <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Zshiftin_pos_ind">Zshiftin_pos_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">simpl</span>. <span class="id">intros</span>. <span class="id">change</span> <span class="id">1</span> <span class="gallina-kwd">with</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zshiftin">Zshiftin</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">0</span>). <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin">Ztestbit_shiftin</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq_false">zeq_false</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_0">Ztestbit_0</a></span>. <span class="id">lia</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize_shiftin">Zsize_shiftin</a></span> <span class="gallina-kwd">in</span> <span class="id">H1;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">generalize</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize_pos'">Zsize_pos'</a></span> <span class="id">_</span> <span class="id">H</span>)<span class="id">;</span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_shiftin">Ztestbit_shiftin</a></span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq_false">zeq_false</a></span>. <span class="id">apply</span> <span class="id">H0</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lia</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">+</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zsize_interval_1" class="id"><a name="Zsize_interval_1" class="">Zsize_interval_1:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:244" class="id"><a name="x:244" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:244">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:244">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:244">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
&nbsp;&nbsp;<span class="id">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">x</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">x</span> <span class="id">mod</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#equal_same_bits">equal_same_bits;</a></span> <span class="id">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_mod_two_p">Ztestbit_mod_two_p;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id">x</span>)). <span class="id">auto</span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_size_2">Ztestbit_size_2;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize_pos">Zsize_pos;</a></span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H0</span> <span class="gallina-kwd">at</span> <span class="id">1</span>. <span class="id">rewrite</span> <span class="id">H0</span> <span class="gallina-kwd">at</span> <span class="id">3</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_mod_lt">Z_mod_lt</a></span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize_pos">Zsize_pos;</a></span> <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zsize_interval_2" class="id"><a name="Zsize_interval_2" class="">Zsize_interval_2:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:245" class="id"><a name="x:245" class="">x</a></span> <span id="n:246" class="id"><a name="n:246" class="">n,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:246">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:245">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#bdb3edde5f841a282ce8fc1b00e3d211">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:246">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#n:246">n</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#b1f0780291abe9bd18804d2c9a5039d4">&gt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:245">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">set</span> (<span class="id">N</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.to_nat">Z.to_nat</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">N</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">n</span>) <span class="gallina-kwd">by</span> (<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2Nat.id">Z2Nat.id</a></span><span class="id">;</span> <span class="id">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id">H1</span> <span class="gallina-kwd">in</span> <span class="id">H0</span>. <span class="id">rewrite</span> <span class="id">&lt;-</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_two_p">two_power_nat_two_p</a></span> <span class="gallina-kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">x</span> <span class="id">0</span>).<br/>
&nbsp;&nbsp;<span class="id">subst</span> <span class="id">x;</span> <span class="id">simpl;</span> <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">n</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id">x</span>))<span class="id">;</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_above">Ztestbit_above</a></span> <span class="id">N</span> <span class="id">x</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id">x</span>))). <span class="id">auto</span>. <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_size_1">Ztestbit_size_1</a></span>. <span class="id">congruence</span>. <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zsize_monotone" class="id"><a name="Zsize_monotone" class="">Zsize_monotone:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:247" class="id"><a name="x:247" class="">x</a></span> <span id="y:248" class="id"><a name="y:248" class="">y,</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:247">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:248">y</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:247">x</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize">Zsize</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:248">y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
&nbsp;&nbsp;<span class="id">intros</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ge_le">Z.ge_le</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize_interval_2">Zsize_interval_2</a></span>. <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsize_pos">Zsize_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.lib.Zbits.html#Zsize_interval_1">Zsize_interval_1</a></span> <span class="id">y</span>). <span class="id">lia</span>.<br/>
&nbsp;&nbsp;<span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<h2> Bit insertion, bit extraction </h2>
<br/>
<div class="doc">Extract and optionally sign-extend bits <span class="bracket"><span class="id">from</span>...<span class="id">from</span>+<span class="id">len</span>-1</span> of <span class="bracket"><span class="id">x</span></span> </div>
<span class="vernacular">Definition</span> <span id="Zextract_u" class="id"><a name="Zextract_u" class="">Zextract_u</a></span> (<span id="x:249" class="id"><a name="x:249" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="from:250" class="id"><a name="from:250" class="">from:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="len:251" class="id"><a name="len:251" class="">len:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext">Zzero_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:251">len</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr">Z.shiftr</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:249">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#from:250">from</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="Zextract_s" class="id"><a name="Zextract_s" class="">Zextract_s</a></span> (<span id="x:252" class="id"><a name="x:252" class="">x:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="from:253" class="id"><a name="from:253" class="">from:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="len:254" class="id"><a name="len:254" class="">len:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext">Zsign_ext</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:254">len</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr">Z.shiftr</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:252">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#from:253">from</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Zextract_u_spec" class="id"><a name="Zextract_u_spec" class="">Zextract_u_spec:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:255" class="id"><a name="x:255" class="">x</a></span> <span id="from:256" class="id"><a name="from:256" class="">from</a></span> <span id="len:257" class="id"><a name="len:257" class="">len</a></span> <span id="i:258" class="id"><a name="i:258" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#from:256">from</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:257">len</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:258">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zextract_u">Zextract_u</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:255">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#from:256">from</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:257">len</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#i:258">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:258">i</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:257">len</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:255">x</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#from:256">from</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:258">i</a></span>) <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Zextract_u">Zextract_u;</a></span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zzero_ext_spec">Zzero_ext_spec,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr_spec">Z.shiftr_spec</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_comm">Z.add_comm</a></span>. <span class="id">auto</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="Zextract_s_spec" class="id"><a name="Zextract_s_spec" class="">Zextract_s_spec:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:259" class="id"><a name="x:259" class="">x</a></span> <span id="from:260" class="id"><a name="from:260" class="">from</a></span> <span id="len:261" class="id"><a name="len:261" class="">len</a></span> <span id="i:262" class="id"><a name="i:262" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#from:260">from</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:261">len</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:262">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zextract_s">Zextract_s</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:259">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#from:260">from</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:261">len</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#i:262">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:259">x</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#from:260">from</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> (<span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:262">i</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:261">len</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="compcert.lib.Zbits.html#i:262">i</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="compcert.lib.Zbits.html#len:261">len</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Zextract_s">Zextract_s;</a></span> <span class="id">intros</span>. <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Zbits.html#Zsign_ext_spec">Zsign_ext_spec</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr_spec">Z.shiftr_spec</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_comm">Z.add_comm</a></span>. <span class="id">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">i</span> <span class="id">len</span>)<span class="id">;</span> <span class="id">lia</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Insert bits <span class="bracket">0...<span class="id">len</span>-1</span> of <span class="bracket"><span class="id">y</span></span> into bits <span class="bracket"><span class="id">to</span>...<span class="id">to</span>+<span class="id">len</span>-1</span> of <span class="bracket"><span class="id">x</span></span> </div>
<br/>
<span class="vernacular">Definition</span> <span id="Zinsert" class="id"><a name="Zinsert" class="">Zinsert</a></span> (<span id="x:263" class="id"><a name="x:263" class="">x</a></span> <span id="y:264" class="id"><a name="y:264" class="">y:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="to:265" class="id"><a name="to:265" class="">to:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span id="len:266" class="id"><a name="len:266" class="">len:</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="mask:267" class="id"><a name="mask:267" class="">mask</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl">Z.shiftl</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:266">len</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>) <span class="id"><a href="compcert.lib.Zbits.html#to:265">to</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lor">Z.lor</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.land">Z.land</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl">Z.shiftl</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:264">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#to:265">to</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#mask:267">mask</a></span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ldiff">Z.ldiff</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:263">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#mask:267">mask</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="Zinsert_spec" class="id"><a name="Zinsert_spec" class="">Zinsert_spec:</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:268" class="id"><a name="x:268" class="">x</a></span> <span id="y:269" class="id"><a name="y:269" class="">y</a></span> <span id="to:270" class="id"><a name="to:270" class="">to</a></span> <span id="len:271" class="id"><a name="len:271" class="">len</a></span> <span id="i:272" class="id"><a name="i:272" class="">i,</a></span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#to:270">to</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:271">len</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:272">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#Zinsert">Zinsert</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:268">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:269">y</a></span> <span class="id"><a href="compcert.lib.Zbits.html#to:270">to</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:271">len</a></span>) <span class="id"><a href="compcert.lib.Zbits.html#i:272">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id"><a href="compcert.lib.Zbits.html#to:270">to</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:272">i</a></span> &amp;&amp; <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:272">i</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#to:270">to</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a">+</a></span> <span class="id"><a href="compcert.lib.Zbits.html#len:271">len</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#y:269">y</a></span> (<span class="id"><a href="compcert.lib.Zbits.html#i:272">i</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id"><a href="compcert.lib.Zbits.html#to:270">to</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Zbits.html#x:268">x</a></span> <span class="id"><a href="compcert.lib.Zbits.html#i:272">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Zbits.html#Zinsert">Zinsert;</a></span> <span class="id">intros</span>. <span class="id">set</span> (<span class="id">mask</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">len</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">1</span>).<br/>
&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">M:</span> <span class="gallina-kwd">forall</span> <span id="j:274" class="id"><span id="j:273" class="id"><a name="j:274" class="">j,</a></span></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e">&lt;=</a></span> <span class="id"><a href="compcert.lib.Zbits.html#j:273">j</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id">mask</span> <span class="id"><a href="compcert.lib.Zbits.html#j:273">j</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Zbits.html#j:273">j</a></span> <span class="id">len</span> <span class="gallina-kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">intros;</span> <span class="id">apply</span> <span class="id"><a href="compcert.lib.Zbits.html#Ztestbit_two_p_m1">Ztestbit_two_p_m1;</a></span> <span class="id">auto</span>. <span class="id">}</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lor_spec">Z.lor_spec</a></span><span class="id">,</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.land_spec">Z.land_spec</a></span><span class="id">,</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ldiff_spec">Z.ldiff_spec</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">to</span> <span class="id">i</span>).<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl_spec">Z.shiftl_spec</a></span> <span class="gallina-kwd">by</span> <span class="id">auto</span>. <span class="id">rewrite</span> <span class="id">!</span> <span class="id">M</span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <br/>
&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool;</a></span> <span class="id">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id">i</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x">-</a></span> <span class="id">to</span>) <span class="id">len</span>)<span class="id">;</span> <span class="id">simpl;</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_r">andb_true_r,</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_false_r">andb_false_r</a></span>.<br/>
<span class="id">+</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_r">orb_false_r</a></span>.<br/>
<span class="id">+</span> <span class="id">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_false">zlt_false</a></span> <span class="gallina-kwd">by</span> <span class="id">lia;</span> <span class="id">auto</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">!</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl_spec_low">Z.shiftl_spec_low</a></span> <span class="gallina-kwd">by</span> <span class="id">lia</span>. <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_r">andb_true_r</a></span>.<br/>
Qed.</div>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
