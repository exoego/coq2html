
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module monae.example_quicksort</title>
<meta name="description" content="Documentation of Coq module monae.example_quicksort" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">
<h1 class="title">Module monae.example_quicksort</h1>
<div class="coq">
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.classical.boolp">boolp</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monae.monae_lib.html">monae_lib</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monae.hierarchy.html">hierarchy</a></span> <span class="id"><a href="monae.monad_lib.html">monad_lib</a></span> <span class="id"><a href="monae.fail_lib.html">fail_lib</a></span> <span class="id"><a href="monae.state_lib.html">state_lib</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">infotheo</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext">ssr_ext</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.funind.Recdef.html">Recdef</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">Equations</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for Equations.Prop.Equations">Equations</a></span>.<br/>
<br/>
<pre class="ssrdoc">
                           Quicksort example                               
                                                                           
This file provides a formalization of quicksort on lists as proved in      
[1, Sect. 4]. The main lemmas is quicksort_slowsort.                       
                                                                           
is_partition p (s, t) == elements of s are smaller or equal to p, and      
                         elements of t are greater of equal to p           
        partition p s == partitions s into a partition w.r.t. p            
                         type: T -&gt; seq T -&gt; seq T * seq T                 
           slowsort s == choose a sorted list among all permutations of s  
              qsort s == sort s by quicksort                               
                         type: seq T -&gt; seq T                              
                                                                           
Reference:                                                                 
- [1] Shin-Cheng Mu, Tsung-Ju Chiang, Declarative Pearl: Deriving Monadic  
      Quicksort, FLOPS 2020                                                
</pre>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="id">Unset</span> <span class="id">Printing</span> <span class="vernacular">Implicit</span> <span class="id">Defensive</span>.<br/>
<br/>
<span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.TTheory">Order.TTheory</a></span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">order_scope</span>.<br/>
<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html">ssrnat</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="sorted" class="id">
  <a name="sorted" class="">sorted</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="sorted.d" class="id">
  <a name="sorted.d" class="">d</a>
</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="sorted.T" class="id">
  <a name="sorted.T" class="">T</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_quicksort.html#d:1">d</a></span>).<br/>
<br/>
<span class="id">Local</span> <span class="vernacular">Notation</span> <span id="sorted" class="id">
  <a name="sorted" class="">sorted</a>
</span> <span class="id">:=</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.path.html#sorted">sorted</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::fun_scope:'<=%O'">&lt;=%O</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="sorted_cat_cons" class="id">
  <a name="sorted_cat_cons" class="">sorted_cat_cons</a>
</span> (<span id="x:3" class="id">
  <a name="x:3" class="">x</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.example_quicksort.html#sorted.T">T</a></span>) (<span id="ys:4" class="id">
  <a name="ys:4" class="">ys</a>
</span> <span id="zs:5" class="id">
  <a name="zs:5" class="">zs</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#sorted.T">T</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_quicksort.html#sorted">sorted</a></span> (<span class="id"><a href="monae.example_quicksort.html#ys:4">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'++'_x">++</a></span> <span class="id"><a href="monae.example_quicksort.html#x:3">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#zs:5">zs</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:'['_'&&'_x_','_x_','_'..'_','_x_'&'_x_']'">[&amp;&amp;</a></span> <span class="id"><a href="monae.example_quicksort.html#sorted">sorted</a></span> <span class="id"><a href="monae.example_quicksort.html#ys:4">ys,</a></span> <span class="id"><a href="monae.example_quicksort.html#sorted">sorted</a></span> <span class="id"><a href="monae.example_quicksort.html#zs:5">zs,</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#all">all</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:'<='_x">&lt;=</a></span> <span class="id"><a href="monae.example_quicksort.html#x:3">x</a></span>) <span class="id"><a href="monae.example_quicksort.html#ys:4">ys</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:'['_'&&'_x_','_x_','_'..'_','_x_'&'_x_']'">&amp;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#all">all</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:'>='_x">&gt;=</a></span> <span class="id"><a href="monae.example_quicksort.html#x:3">x</a></span>) <span class="id"><a href="monae.example_quicksort.html#zs:5">zs]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">apply/idP/idP</span> <span class="id">=&gt;</span> <span class="id">[|]</span>.<br/>
<span class="id">elim:</span> <span class="id">ys</span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">[|h</span> <span class="id">t</span> <span class="id">ih];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_path_sortedE">le_path_sortedE</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">!le_path_sortedE</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#all_cat">all_cat</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">/andP[/andP[-&gt;</span> <span class="id">/=</span> <span class="id">/andP[-&gt;</span> <span class="id">_]]</span> <span class="id">hs];</span> <span class="id">move:</span> (<span class="id">ih</span> <span class="id">hs</span>) <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
<span class="id">case/and4P</span> <span class="id">=&gt;</span> <span class="id">ss</span> <span class="id">ss'</span> <span class="id">ps</span> <span class="id">ps';</span> <span class="id">apply</span> (<span class="id">@sorted_cat</span> <span class="id">_</span>) <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_path_sortedE">le_path_sortedE</a></span> <span class="id">ss'</span> <span class="id">ps'</span>.<br/>
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">a</span> <span class="id">ain</span> <span class="id">b</span> <span class="id">bin;</span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POrderTheory.le_trans">le_trans</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">ps</span> <span class="id">=&gt;</span> <span class="id">/allP;</span> <span class="id">apply</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">bin</span> <span class="id">ps';</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.finset.html#inE">inE</a></span> <span class="id">=&gt;</span> <span class="id">/orP[/eqP</span> <span class="id">-&gt;//|]</span> <span class="id">=&gt;</span> <span class="id">/allP;</span> <span class="id">apply</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_quicksort.html#sorted">sorted</a></span>.<br/>
<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">monae_scope</span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">tuple_ext_scope</span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="partition" class="id">
  <a name="partition" class="">partition</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="partition.M" class="id">
  <a name="partition.M" class="">M</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>) (<span id="partition.d" class="id">
  <a name="partition.d" class="">d</a>
</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="partition.T" class="id">
  <a name="partition.T" class="">T</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_quicksort.html#d:7">d</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="is_partition" class="id">
  <a name="is_partition" class="">is_partition</a>
</span> <span id="p:9" class="id">
  <a name="p:9" class="">p</a>
</span> (<span id="yz:10" class="id">
  <a name="yz:10" class="">yz</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#::type_scope:x_'*'_x">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#all">all</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:'<='_x">&lt;=</a></span> <span class="id"><a href="monae.example_quicksort.html#p:9">p</a></span>) <span class="id"><a href="monae.example_quicksort.html#yz:10">yz</a></span>.<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#::bool_scope:x_'&&'_x">&amp;&amp;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#all">all</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:'>='_x">&gt;=</a></span> <span class="id"><a href="monae.example_quicksort.html#p:9">p</a></span>) <span class="id"><a href="monae.example_quicksort.html#yz:10">yz</a></span>.<span class="id">2</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="is_partition_consL" class="id">
  <a name="is_partition_consL" class="">is_partition_consL</a>
</span> <span id="p:11" class="id">
  <a name="p:11" class="">p</a>
</span> <span id="x:12" class="id">
  <a name="x:12" class="">x</a>
</span> (<span id="ys:13" class="id">
  <a name="ys:13" class="">ys</a>
</span> <span id="zs:14" class="id">
  <a name="zs:14" class="">zs</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_quicksort.html#is_partition">is_partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:11">p</a></span> (<span class="id"><a href="monae.example_quicksort.html#x:12">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#ys:13">ys,</a></span> <span class="id"><a href="monae.example_quicksort.html#zs:14">zs</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> (<span class="id"><a href="monae.example_quicksort.html#x:12">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="monae.example_quicksort.html#p:11">p</a></span>) <span class="id">&amp;&amp;</span> <span class="id"><a href="monae.example_quicksort.html#is_partition">is_partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:11">p</a></span> (<span class="id"><a href="monae.example_quicksort.html#ys:13">ys,</a></span> <span class="id"><a href="monae.example_quicksort.html#zs:14">zs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/is_partition</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbA">andbA</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="is_partition_consR" class="id">
  <a name="is_partition_consR" class="">is_partition_consR</a>
</span> <span id="p:15" class="id">
  <a name="p:15" class="">p</a>
</span> <span id="x:16" class="id">
  <a name="x:16" class="">x</a>
</span> (<span id="ys:17" class="id">
  <a name="ys:17" class="">ys</a>
</span> <span id="zs:18" class="id">
  <a name="zs:18" class="">zs</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_quicksort.html#is_partition">is_partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:15">p</a></span> (<span class="id"><a href="monae.example_quicksort.html#ys:17">ys,</a></span> <span class="id"><a href="monae.example_quicksort.html#x:16">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#zs:18">zs</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> (<span class="id"><a href="monae.example_quicksort.html#x:16">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:x_'>='_x">&gt;=</a></span> <span class="id"><a href="monae.example_quicksort.html#p:15">p</a></span>) <span class="id">&amp;&amp;</span> <span class="id"><a href="monae.example_quicksort.html#is_partition">is_partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:15">p</a></span> (<span class="id"><a href="monae.example_quicksort.html#ys:17">ys,</a></span> <span class="id"><a href="monae.example_quicksort.html#zs:18">zs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/is_partition</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbCA">andbCA</a></span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="is_partition_consE" class="id">
  <a name="is_partition_consE" class="">is_partition_consE</a>
</span> <span class="id">:=</span> (<span class="id"><a href="monae.example_quicksort.html#is_partition_consL">is_partition_consL,</a></span> <span class="id"><a href="monae.example_quicksort.html#is_partition_consR">is_partition_consR</a></span>).<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="partition" class="id">
  <a name="partition" class="">partition</a>
</span> <span id="p:19" class="id">
  <a name="p:19" class="">p</a>
</span> (<span id="s:20" class="id">
  <a name="s:20" class="">s</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span>) <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#::type_scope:x_'*'_x">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_quicksort.html#s:20">s</a></span> <span class="id">isn't</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span> <span class="gallina-kwd">then</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_']'">[::],</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_']'">[::]</a></span>) <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;<span class="id">let:</span> <span class="id">yz</span> <span class="id">:=</span> <span class="id"><a href="monae.example_quicksort.html#partition:21">partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:19">p</a></span> <span class="id">xs</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="monae.example_quicksort.html#p:19">p</a></span> <span class="gallina-kwd">then</span> (<span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">yz</span>.<span class="id">1,</span> <span class="id">yz</span>.<span class="id">2</span>) <span class="gallina-kwd">else</span> (<span class="id">yz</span>.<span class="id">1,</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">yz</span>.<span class="id">2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="size_partition" class="id">
  <a name="size_partition" class="">size_partition</a>
</span> <span id="p:23" class="id">
  <a name="p:23" class="">p</a>
</span> (<span id="s:24" class="id">
  <a name="s:24" class="">s</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> (<span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:23">p</a></span> <span class="id"><a href="monae.example_quicksort.html#s:24">s</a></span>).<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'+'_x">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> (<span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:23">p</a></span> <span class="id"><a href="monae.example_quicksort.html#s:24">s</a></span>).<span class="id">2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_quicksort.html#s:24">s</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">p</span> <span class="id">=&gt;</span> <span class="id">//=</span> <span class="id">x</span> <span class="id">xs</span> <span class="id">ih</span> <span class="id">p;</span> <span class="id">have</span> <span class="id">{ih}</span> <span class="id">:=</span> <span class="id">ih</span> <span class="id">p</span>.<br/>
<span class="id">move</span> <span class="id">H</span> <span class="id">:</span> (<span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id">p</span> <span class="id">xs</span>) <span class="id">=&gt;</span> <span class="id">h;</span> <span class="id">case:</span> <span class="id">h</span> <span class="id">H</span> <span class="id">=&gt;</span> <span class="id">a</span> <span class="id">b</span> <span class="id">ab</span> <span class="id">/=</span> <span class="id">abxs</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">xp;</span> <span class="id">rewrite</span> <span class="id">!</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#addSn">addSn,addnS</a></span>) <span class="id">abxs</span>.<br/>
<span class="comment">(*&nbsp;!&nbsp;was&nbsp;?&nbsp;:conflict&nbsp;with&nbsp;Equations&nbsp;TODO&nbsp;bug&nbsp;report&nbsp;*)</span><br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="partition_spec" class="id">
  <a name="partition_spec" class="">partition_spec</a>
</span> (<span id="p:25" class="id">
  <a name="p:25" class="">p</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span>) (<span id="xs:26" class="id">
  <a name="xs:26" class="">xs</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#partition.T">T</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;((<span class="id">@ret</span> <span class="id"><a href="monae.example_quicksort.html#partition.M">M</a></span> <span class="id">_</span>) <span class="id">\o</span> <span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:25">p</a></span>) <span class="id"><a href="monae.example_quicksort.html#xs:26">xs</a></span> <span class="id"><a href="monae.fail_lib.html#:::x_'`<=`'_x">`&lt;=`</a></span> <span class="id"><a href="monae.fail_lib.html#splits">splits</a></span> <span class="id"><a href="monae.example_quicksort.html#xs:26">xs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> <span class="id"><a href="monae.hierarchy.html#assert">assert</a></span> (<span class="id"><a href="monae.example_quicksort.html#is_partition">is_partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:25">p</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">elim:</span> <span class="id">xs</span> <span class="id">p</span> <span class="id">=&gt;</span> <span class="id">[/=|x</span> <span class="id">xs</span> <span class="id">ih]</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id">!assertE</span> <span class="id">/is_partition</span> <span class="id"><a href="monae.hierarchy.html#guardT">guardT</a></span> <span class="id"><a href="monae.hierarchy.html#bindskipf">bindskipf;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">apply:</span> (<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> (<span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">_</span> <span class="id">_</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span> <span class="id">=&gt;</span> <span class="id">[yz|]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#alt_bindDl">alt_bindDl</a></span> <span class="id">2!bindretf</span> <span class="id">2!assertE</span>.<br/>
<span class="id">rewrite</span> <span class="id">2!is_partition_consE</span> <span class="id">2!guard_and</span> <span class="id">2!bindA</span>.<br/>
<span class="id">exact/</span>(<span class="id"><a href="monae.fail_lib.html#refin_alt">refin_alt</a></span> (<span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span> <span class="id">_</span>))<span class="id">/refin_bindr/refin_guard_le</span>.<br/>
<span class="comment">(*&nbsp;under&nbsp;eq_bind&nbsp;do&nbsp;rewrite&nbsp;alt_bindDl&nbsp;2!bindretf&nbsp;2!assertE.<br/>
under&nbsp;eq_bind&nbsp;do&nbsp;rewrite&nbsp;2!is_partition_consE&nbsp;2!guard_and&nbsp;2!bindA.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;apply:&nbsp;(refin_trans&nbsp;_&nbsp;(refin_bindl&nbsp;_&nbsp;_));&nbsp;last&nbsp;first&nbsp;=&gt;&nbsp;[yz|].&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;apply&nbsp;(refin_alt).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;exact/(refin_alt&nbsp;(refin_refl&nbsp;_))/refin_bindr/refin_guard_le.&nbsp;*)</span><br/>
<span class="id">apply:</span> (<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> (<span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">_</span> <span class="id">_</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span> <span class="id">=&gt;</span> <span class="id">[yz|]</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_if_guard">refin_if_guard</a></span>.<br/>
<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">-bind_if</span>.<br/>
<span class="id">apply:</span> (<span class="id">@refin_trans</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="monae.fail_lib.html#splits">splits</a></span> <span class="id">xs</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span id="a:29" class="id"><span id="a:27" class="id">
  <a name="a:29" class="">a</a>
</span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> (<span class="id"><a href="monae.example_quicksort.html#is_partition">is_partition</a></span> <span class="id">p</span> <span class="id"><a href="monae.example_quicksort.html#a:27">a</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>'_x">&gt;&gt;</a></span> (<span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monae.example_quicksort.html#a:27">a</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span id="a:30" class="id"><span id="a:28" class="id">
  <a name="a:30" class="">a</a>
</span></span> <span class="id">=&gt;</span> (<span class="gallina-kwd">if</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:x_'<='_x">&lt;=</a></span> <span class="id">p</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#a:28">a</a></span>.<span class="id">1,</span> <span class="id"><a href="monae.example_quicksort.html#a:28">a</a></span>.<span class="id">2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_quicksort.html#a:28">a</a></span>.<span class="id">1,</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#a:28">a</a></span>.<span class="id">2</span>)))))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">?;</span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">?</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">-bindA</span> <span class="id">-assertE</span>.<br/>
<span class="id">rewrite</span> <span class="id">-bindA;</span> <span class="id">apply:</span> (<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> (<span class="id"><a href="monae.fail_lib.html#refin_bindr">refin_bindr</a></span> <span class="id">_</span> (<span class="id">ih</span> <span class="id">_</span>))).<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">?;</span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="slowsort" class="id">
  <a name="slowsort" class="">slowsort</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="slowsort.M" class="id">
  <a name="slowsort.M" class="">M</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>) (<span id="slowsort.d" class="id">
  <a name="slowsort.d" class="">d</a>
</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="slowsort.T" class="id">
  <a name="slowsort.T" class="">T</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_quicksort.html#d:32">d</a></span>).<br/>
<br/>
<span class="id">Local</span> <span class="vernacular">Notation</span> <span id="sorted" class="id">
  <a name="sorted" class="">sorted</a>
</span> <span class="id">:=</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.path.html#sorted">sorted</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::fun_scope:'<=%O'">&lt;=%O</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="slowsort" class="id">
  <a name="slowsort" class="">slowsort</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort.T">T</a></span>) <span class="id">:=</span> (<span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>=>'_x">&gt;=&gt;</a></span> <span class="id"><a href="monae.hierarchy.html#assert">assert</a></span> <span class="id"><a href="monae.example_quicksort.html#sorted">sorted</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="slowsort_nil" class="id">
  <a name="slowsort_nil" class="">slowsort_nil</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_']'">[::]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_']'">[::]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/slowsort</span> <span class="id"><a href="monae.hierarchy.html#kleisliE">kleisliE</a></span> <span class="id"><a href="monae.fail_lib.html#qpermE">qpermE</a></span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monae.hierarchy.html#assertE">assertE</a></span> <span class="id"><a href="monae.hierarchy.html#guardT">guardT</a></span> <span class="id"><a href="monae.hierarchy.html#bindskipf">bindskipf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="slowsort_cons" class="id">
  <a name="slowsort_cons" class="">slowsort_cons</a>
</span> <span id="p:34" class="id">
  <a name="p:34" class="">p</a>
</span> <span id="xs:35" class="id">
  <a name="xs:35" class="">xs</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> (<span class="id"><a href="monae.example_quicksort.html#p:34">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#xs:35">xs</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.fail_lib.html#splits">splits</a></span> <span class="id"><a href="monae.example_quicksort.html#xs:35">xs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="ys:37" class="id">
  <a name="ys:37" class="">ys,</a>
</span> <span id="zs:36" class="id">
  <a name="zs:36" class="">zs</a>
</span>) <span class="id">=&gt;</span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id"><a href="monae.example_quicksort.html#ys:37">ys</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="ys':39" class="id">
  <a name="ys':39" class="">ys'</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id"><a href="monae.example_quicksort.html#zs:36">zs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="zs':40" class="id">
  <a name="zs':40" class="">zs'</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#assert">assert</a></span> <span class="id"><a href="monae.example_quicksort.html#sorted">sorted</a></span> (<span class="id"><a href="monae.example_quicksort.html#ys':39">ys'</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'++'_x">++</a></span> <span class="id"><a href="monae.example_quicksort.html#p:34">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#zs':40">zs'</a></span>)))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">rewrite</span> <span class="id">/slowsort</span> <span class="id"><a href="monae.hierarchy.html#kleisliE">kleisliE</a></span> <span class="id"><a href="monae.fail_lib.html#qperm_cons">qperm_cons</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[a</span> <span class="id">b];</span> <span class="id">rewrite</span> <span class="id"><a href="monae.monad_lib.html#liftM2E">liftM2E</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="slowsort_splits" class="id">
  <a name="slowsort_splits" class="">slowsort_splits</a>
</span> <span id="p:41" class="id">
  <a name="p:41" class="">p</a>
</span> <span id="s:42" class="id">
  <a name="s:42" class="">s</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> (<span class="id"><a href="monae.example_quicksort.html#p:41">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#s:42">s</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.fail_lib.html#splits">splits</a></span> <span class="id"><a href="monae.example_quicksort.html#s:42">s</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x:43" class="id">
  <a name="x:43" class="">x</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> (<span class="id"><a href="monae.example_quicksort.html#is_partition">is_partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:41">p</a></span> <span class="id"><a href="monae.example_quicksort.html#x:43">x</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#x:43">x</a></span>.<span class="id">1</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="a:44" class="id">
  <a name="a:44" class="">a</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#x:43">x</a></span>.<span class="id">2</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="b:45" class="id">
  <a name="b:45" class="">b</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_quicksort.html#a:44">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'++'_x">++</a></span> <span class="id"><a href="monae.example_quicksort.html#p:41">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#b:45">b</a></span>)))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">rewrite</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_cons">slowsort_cons;</a></span> <span class="id">bind_ext=&gt;</span> <span class="id">{s}</span> <span class="id">-[a</span> <span class="id">b]</span>.<br/>
<span class="id">rewrite</span> <span class="id">/is_partition</span> <span class="id">/slowsort</span> <span class="id">!kleisliE</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#guard_and">guard_and</a></span> <span class="id">!bindA/=</span> (<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#all">all</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:'>='_x">&gt;=</a></span> <span class="id">p</span>) <span class="id">b</span>)))<span class="id">//=</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#all">all</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:'<='_x">&lt;=</a></span> <span class="id">p</span>) <span class="id">a</span>)))<span class="id">//</span> <span class="id"><a href="monae.fail_lib.html#guard_all_qperm">guard_all_qperm</a></span>.<br/>
<span class="id">bind_ext=&gt;</span> <span class="id">a'</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute//</a></span> <span class="id"><a href="monae.hierarchy.html#assertE">assertE</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> (<span class="id"><a href="monae.example_quicksort.html#sorted">sorted</a></span> <span class="id">a'</span>)))<span class="id">//</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#all">all</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:'<='_x">&lt;=</a></span> <span class="id">p</span>) <span class="id">a'</span>)))<span class="id">//</span> <span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute//</a></span> <span class="id"><a href="monae.fail_lib.html#guard_all_qperm">guard_all_qperm</a></span>.<br/>
<span class="id">bind_ext=&gt;</span> <span class="id">b'</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#all">all</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::order_scope:'>='_x">&gt;=</a></span> <span class="id">p</span>) <span class="id">b'</span>)))<span class="id">//</span> <span class="id">!assertE</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.example_quicksort.html#sorted_cat_cons">sorted_cat_cons</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span> <span class="id">-!andbA</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span> <span class="id">!guard_and</span> <span class="id">!bindA</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_partition_slowsort" class="id">
  <a name="refin_partition_slowsort" class="">refin_partition_slowsort</a>
</span> <span id="p:46" class="id">
  <a name="p:46" class="">p</a>
</span> <span id="s:47" class="id">
  <a name="s:47" class="">s</a>
</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id"><a href="monae.example_quicksort.html#p:46">p</a></span> <span class="id"><a href="monae.example_quicksort.html#s:47">s</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="a:49" class="id">
  <a name="a:49" class="">a,</a>
</span> <span id="b:48" class="id">
  <a name="b:48" class="">b</a>
</span>) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#a:49">a</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="a':51" class="id">
  <a name="a':51" class="">a'</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#b:48">b</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="b':52" class="id">
  <a name="b':52" class="">b'</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_quicksort.html#a':51">a'</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'++'_x">++</a></span> <span class="id"><a href="monae.example_quicksort.html#p:46">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#b':52">b'</a></span>))))<br/>
&nbsp;&nbsp;<span class="id">`&lt;=`</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> (<span class="id"><a href="monae.example_quicksort.html#p:46">p</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#s:47">s</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort.M">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
<span class="id">rewrite</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_splits">slowsort_splits</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans;</a></span> <span class="id">first</span> <span class="id">exact/refin_bindr/</span>(<span class="id"><a href="monae.example_quicksort.html#partition_spec">partition_spec</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort.M">M</a></span> <span class="id">p</span> <span class="id">s</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[a</span> <span class="id">b]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#assertE">assertE</a></span> (<span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id">a,</span> <span class="id">b</span>))) <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="slowsort_isNondet" class="id">
  <a name="slowsort_isNondet" class="">slowsort_isNondet</a>
</span> <span id="s:53" class="id">
  <a name="s:53" class="">s</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.fail_lib.html#plus_isNondet">plus_isNondet</a></span> (<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#s:53">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort.M">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">rewrite</span> <span class="id">/slowsort</span> <span class="id"><a href="monae.hierarchy.html#kleisliE">kleisliE</a></span>.<br/>
<span class="id">have</span> <span class="id">[syn</span> <span class="id">syn_qperm]</span> <span class="id">:=</span> <span class="id">@qperm_isNondet</span> <span class="id"><a href="monae.example_quicksort.html#slowsort.M">M</a></span> <span class="id">_</span> <span class="id">s</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndBind">ndBind</a></span> <span class="id">syn</span> (<span class="gallina-kwd">fun</span> <span id="a:55" class="id"><span id="a:54" class="id">
  <a name="a:55" class="">a</a>
</span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndBind">ndBind</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_quicksort.html#sorted">sorted</a></span> <span class="id"><a href="monae.example_quicksort.html#a:54">a</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndRet">ndRet</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndFail">ndFail</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndRet">ndRet</a></span> <span class="id"><a href="monae.example_quicksort.html#a:54">a</a></span>))).<br/>
<span class="id">rewrite</span> <span class="id">/=</span> <span class="id">syn_qperm;</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s'</span> <span class="id">/=</span>.<br/>
<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">sorteds'</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monae.hierarchy.html#assertE">assertE</a></span> <span class="id">sorteds'</span> <span class="id"><a href="monae.hierarchy.html#guardT">guardT</a></span> <span class="id"><a href="monae.hierarchy.html#bindskipf">bindskipf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#assertE">assertE</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">sorteds'</span>) <span class="id"><a href="monae.hierarchy.html#guardF">guardF</a></span> <span class="id"><a href="monae.hierarchy.html#bindfailf">bindfailf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="qperm_slowsort" class="id">
  <a name="qperm_slowsort" class="">qperm_slowsort</a>
</span> <span class="id">:</span> (<span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>=>'_x">&gt;=&gt;</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span>) <span class="id">=</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x_':>'_x">:&gt;</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort.T">T</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/slowsort</span> <span class="id">-kleisliA</span> <span class="id"><a href="monae.fail_lib.html#qperm_idempotent">qperm_idempotent</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id">{M}</span> <span class="id">{_}</span> <span class="id">{_}</span>.<br/>
<br/>
<span class="id">#[global]</span> <span class="vernacular">Hint</span> <span class="id">Extern</span> <span class="id">0</span> (<span class="id"><a href="monae.fail_lib.html#plus_isNondet">plus_isNondet</a></span> (<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id">_</span>)) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id">solve[exact:</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_isNondet">slowsort_isNondet]</a></span> <span class="id">:</span> <span class="id">core</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="slowsort_example" class="id">
  <a name="slowsort_example" class="">slowsort_example</a>
</span>.<br/>
<span class="vernacular">Variable</span> <span id="slowsort_example.M" class="id">
  <a name="slowsort_example.M" class="">M</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="slowsort_example.bindskipE" class="id">
  <a name="slowsort_example.bindskipE" class="">bindskipE</a>
</span> <span class="id">:=</span> (<span class="id"><a href="monae.hierarchy.html#bindskipf">bindskipf,</a></span> <span class="id"><a href="monae.hierarchy.html#bindmskip">bindmskip</a></span>).<br/>
<br/>
<span class="vernacular">Ltac</span> <span class="id">sub</span> <span class="id">:=</span> <span class="id">repeat</span> <span class="id">rewrite</span> <span class="id">!alt_bindDl</span> <span class="id">!bindretf;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">repeat</span> <span class="id">rewrite</span> <span class="id">!qpermE</span> <span class="id">!bindA</span> <span class="id">!bindretf</span> <span class="id">/=</span>.<br/>
<span class="vernacular">Ltac</span> <span class="id">bindSF</span> <span class="id">:=</span> <span class="id">rewrite</span> <span class="id">!bindskipf</span> <span class="id">!bindfailf</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span id="slowsort_example.d" class="id">
  <a name="slowsort_example.d" class="">d</a>
</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="slowsort_example.T" class="id">
  <a name="slowsort_example.T" class="">T</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_quicksort.html#d:57">d</a></span>).<br/>
<br/>
<span class="vernacular">Example</span> <span id="slowsort2" class="id">
  <a name="slowsort2" class="">slowsort2</a>
</span> <span class="id">:</span> <span class="id">@slowsort</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_example.M">M</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_x_';'_x_';'_'..'_';'_x_']'">[::</a></span> <span class="id">2;</span> <span class="id">1]%N</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_x_';'_x_';'_'..'_';'_x_']'">[::</a></span> <span class="id">1;</span> <span class="id">2]%N</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">rewrite</span> <span class="id">/slowsort</span> <span class="id"><a href="monae.hierarchy.html#kleisliE">kleisliE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">!qpermE</span> <span class="id">/bindA</span> <span class="id">/=</span> <span class="id">!bindretf</span>.<br/>
<span class="id">repeat</span> <span class="id">sub</span>.<br/>
<span class="id">rewrite</span> <span class="id">/sorted</span> <span class="id">/assert</span> <span class="id">/guard</span> <span class="id">/path</span> <span class="id">/=;</span> <span class="id">unlock</span>.<br/>
<span class="id">bindSF</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#altmfail">altmfail</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_example">slowsort_example</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="slowsort_preserves" class="id">
  <a name="slowsort_preserves" class="">slowsort_preserves</a>
</span>.<br/>
<span class="vernacular">Context</span> (<span id="M:59" class="id">
  <a name="M:59" class="">M</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>) <span class="id">{d</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit}</a></span> <span class="id">{E</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_quicksort.html#d:60">d}</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="slowsort_preserves.slowsort_preserves_size" class="id">
  <a name="slowsort_preserves.slowsort_preserves_size" class="">slowsort_preserves_size</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.monad_lib.html#preserves">preserves</a></span> (<span class="id">@slowsort</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.M">M</a></span> <span class="id">_</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.E">E</a></span>) <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">move=&gt;</span> <span class="id">s;</span> <span class="id">have</span> <span class="id">[n</span> <span class="id">ns]</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#ubnP">ubnP</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">s</span>)<span class="id">;</span> <span class="id">elim:</span> <span class="id">n</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">n</span> <span class="id">ih</span> <span class="id">s</span> <span class="id">ns</span>.<br/>
<span class="id">move:</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">=&gt;</span> <span class="id">[ns|p</span> <span class="id">s];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_nil">slowsort_nil</a></span> <span class="id">2!bindretf</span>.<br/>
<span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span> <span class="id">=&gt;</span> <span class="id">ns</span>. <span class="id">rewrite</span> <span class="id">/slowsort</span> <span class="id"><a href="monae.hierarchy.html#kleisliE">kleisliE</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">[RHS]bindA</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="monae.fail_lib.html#qperm_preserves_size2">qperm_preserves_size2</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="a:68" class="id"><span id="a:65" class="id"><span id="a:62" class="id">
  <a name="a:68" class="">a</a>
</span></span></span> <span id="b:69" class="id"><span id="b:66" class="id"><span id="b:63" class="id">
  <a name="b:69" class="">b</a>
</span></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#assert">assert</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.path.html#sorted">sorted</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.POSyntax.::fun_scope:'<=%O'">&lt;=%O</a></span>) <span class="id"><a href="monae.example_quicksort.html#a:62">a</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x':70" class="id"><span id="x':67" class="id"><span id="x':64" class="id">
  <a name="x':70" class="">x'</a>
</span></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_quicksort.html#x':64">x',</a></span> <span class="id"><a href="monae.example_quicksort.html#b:63">b</a></span>)))).<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">ht;</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#assertE">assertE</a></span> <span class="id">2!bindA;</span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#bind_ext_guard">bind_ext_guard</a></span> <span class="id">=&gt;</span> <span class="id">_</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">2!bindretf</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="slowsort_preserves_size2" class="id">
  <a name="slowsort_preserves_size2" class="">slowsort_preserves_size2</a>
</span> (<span id="x:71" class="id">
  <a name="x:71" class="">x</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.E">E</a></span>) <span id="B:72" class="id">
  <a name="B:72" class="">B</a>
</span> (<span id="f:73" class="id">
  <a name="f:73" class="">f</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.E">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.M">M</a></span> <span class="id"><a href="monae.example_quicksort.html#B:72">B</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#x:71">x</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> <span class="gallina-kwd">fun</span> <span id="x':74" class="id">
  <a name="x':74" class="">x'</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_quicksort.html#f:73">f</a></span> <span class="id"><a href="monae.example_quicksort.html#x':74">x'</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_quicksort.html#x:71">x</a></span>)) <span class="id">=</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#x:71">x</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> <span class="gallina-kwd">fun</span> <span id="x':75" class="id">
  <a name="x':75" class="">x'</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_quicksort.html#f:73">f</a></span> <span class="id"><a href="monae.example_quicksort.html#x':75">x'</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_quicksort.html#x':75">x'</a></span>)) <span class="id">:&gt;</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">transitivity</span> (<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id">x</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="y:78" class="id"><span id="y:76" class="id">
  <a name="y:78" class="">y</a>
</span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_quicksort.html#y:76">y,</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_quicksort.html#y:76">y</a></span>)) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="z:79" class="id"><span id="z:77" class="id">
  <a name="z:79" class="">z</a>
</span></span> <span class="id">=&gt;</span> <span class="id">f</span> <span class="id"><a href="monae.example_quicksort.html#z:77">z</a></span>.<span class="id">1</span> <span class="id"><a href="monae.example_quicksort.html#z:77">z</a></span>.<span class="id">2</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.slowsort_preserves_size">slowsort_preserves_size</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s;</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s;</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="bind_slowsort_guard" class="id">
  <a name="bind_slowsort_guard" class="">bind_slowsort_guard</a>
</span> (<span id="s:80" class="id">
  <a name="s:80" class="">s</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.E">E</a></span>) <span id="B:81" class="id">
  <a name="B:81" class="">B</a>
</span> (<span id="f:82" class="id">
  <a name="f:82" class="">f</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.E">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves.M">M</a></span> <span class="id"><a href="monae.example_quicksort.html#B:81">B</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#s:80">s</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> <span class="id"><a href="monae.example_quicksort.html#f:82">f</a></span>) <span class="id">=</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#s:80">s</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x:83" class="id">
  <a name="x:83" class="">x</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_quicksort.html#s:80">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#::bool_scope:x_'=='_x">==</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_quicksort.html#x:83">x</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_quicksort.html#f:82">f</a></span> <span class="id"><a href="monae.example_quicksort.html#x:83">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="monae.example_quicksort.html#slowsort_preserves_size2">slowsort_preserves_size2</a></span> <span class="id">s</span> (<span class="gallina-kwd">fun</span> <span id="a:88" class="id"><span id="a:86" class="id"><span id="a:84" class="id">
  <a name="a:88" class="">a</a>
</span></span></span> <span id="b:89" class="id"><span id="b:87" class="id"><span id="b:85" class="id">
  <a name="b:89" class="">b</a>
</span></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">s</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#::bool_scope:x_'=='_x">==</a></span> <span class="id"><a href="monae.example_quicksort.html#b:85">b</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>'_x">&gt;&gt;</a></span> <span class="id">f</span> <span class="id"><a href="monae.example_quicksort.html#a:84">a</a></span>)).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.eqtype.html#eqxx">eqxx</a></span> <span class="id"><a href="monae.hierarchy.html#guardT">guardT;</a></span> <span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindskipf">bindskipf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_preserves">slowsort_preserves</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="qsort" class="id">
  <a name="qsort" class="">qsort</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="qsort.M" class="id">
  <a name="qsort.M" class="">M</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>).<br/>
<span class="vernacular">Variables</span> (<span id="qsort.d" class="id">
  <a name="qsort.d" class="">d</a>
</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="qsort.T" class="id">
  <a name="qsort.T" class="">T</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_quicksort.html#d:91">d</a></span>).<br/>
<br/>
<span class="id">Equations?</span> <span id="qsort" class="id">
  <a name="qsort" class="">qsort</a>
</span> (<span id="s:93" class="id">
  <a name="s:93" class="">s</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort.T">T</a></span>) <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort.T">T</a></span> <span class="gallina-kwd">by</span> <span class="id">wf</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">s</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Peano.html#lt">lt</a></span> <span class="id">:=</span><br/>
<span class="id">|</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_']'">[::]</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_']'">[::]</a></span><br/>
<span class="id">|</span> <span class="id"><a href="monae.example_quicksort.html#h:95">h</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#t:96">t</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_quicksort.html#qsort:94">qsort</a></span> (<span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id">h</span> <span class="id">t</span>).<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'++'_x">++</a></span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort:94">qsort</a></span> (<span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id">h</span> <span class="id">t</span>).<span class="id">2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
<span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="monae.example_quicksort.html#size_partition">size_partition</a></span> <span class="id">h</span> <span class="id">t</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">&lt;-;</span> <span class="id">apply</span> <span class="id">/ltP;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#leq_addr">leq_addr</a></span>.<br/>
<span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="monae.example_quicksort.html#size_partition">size_partition</a></span> <span class="id">h</span> <span class="id">t</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">&lt;-;</span> <span class="id">apply</span> <span class="id">/ltP;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#leq_addl">leq_addl</a></span>.<br/>
Defined.</div>
<br/>
<span class="vernacular">Definition</span> <span id="partition_slowsort" class="id">
  <a name="partition_slowsort" class="">partition_slowsort</a>
</span> (<span id="xs:97" class="id">
  <a name="xs:97" class="">xs</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort.T">T</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_quicksort.html#qsort.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort.T">T</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_quicksort.html#xs:97">xs</a></span> <span class="id">isn't</span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_']'">[::]</a></span> <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;<span class="id">let:</span> (<span class="id">ys,</span> <span class="id">zs</span>) <span class="id">:=</span> <span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id">h</span> <span class="id">t</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.monad_lib.html#liftM2">liftM2</a></span> (<span class="gallina-kwd">fun</span> <span id="a:99" class="id">
  <a name="a:99" class="">a</a>
</span> <span id="b:100" class="id">
  <a name="b:100" class="">b</a>
</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_quicksort.html#a:99">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'++'_x">++</a></span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#b:100">b</a></span>) (<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id">ys</span>) (<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id">zs</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="partition_slowsort_spec" class="id">
  <a name="partition_slowsort_spec" class="">partition_slowsort_spec</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.example_quicksort.html#partition_slowsort">partition_slowsort</a></span> <span class="id"><a href="monae.fail_lib.html#:::x_'`<.=`'_x">`&lt;</a></span>.<span class="id">=`</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
<span class="id">move;</span> <span class="id">elim</span> <span class="id">=&gt;</span> <span class="id">[/=|h</span> <span class="id">t</span> <span class="id">ih]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_nil">slowsort_nil;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_splits">slowsort_splits</a></span>.<br/>
<span class="id">apply:</span> (<span class="id">@refin_trans</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="monae.fail_lib.html#splits">splits</a></span> <span class="id">t</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span> <span class="gallina-kwd">fun</span> <span id="yz:107" class="id"><span id="yz:101" class="id">
  <a name="yz:107" class="">yz</a>
</span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#assert">assert</a></span> (<span class="id"><a href="monae.example_quicksort.html#is_partition">is_partition</a></span> <span class="id">h</span>) <span class="id"><a href="monae.example_quicksort.html#yz:101">yz</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="ys:109" class="id"><span id="ys:103" class="id">
  <a name="ys:109" class="">ys,</a>
</span></span> <span id="zs:108" class="id"><span id="zs:102" class="id">
  <a name="zs:108" class="">zs</a>
</span></span>) <span class="id">=&gt;</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#ys:103">ys</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span id="ys':111" class="id"><span id="ys':105" class="id">
  <a name="ys':111" class="">ys'</a>
</span></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort.T">T</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_quicksort.html#zs:102">zs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'>>='_x">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span id="zs':112" class="id"><span id="zs':106" class="id">
  <a name="zs':112" class="">zs'</a>
</span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_quicksort.html#ys':105">ys'</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'++'_x">++</a></span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#zs':106">zs'</a></span>)))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[?</span> <span class="id">?]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#assertE">assertE</a></span> <span class="id">!bindA</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-bindA;</span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans;</a></span> <span class="id">last</span> <span class="id">exact/refin_bindr/partition_spec</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id">/partition_slowsort;</span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="qsort_spec" class="id">
  <a name="qsort_spec" class="">qsort_spec</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort">qsort</a></span> <span class="id"><a href="monae.fail_lib.html#:::x_'`<.=`'_x">`&lt;</a></span>.<span class="id">=`</span> (<span class="id">@slowsort</span> <span class="id"><a href="monae.example_quicksort.html#qsort.M">M</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="id">move=&gt;</span> <span class="id">s</span> <span class="id">/=</span>.<br/>
<span class="id">apply</span> <span class="id"><a href="monae.example_quicksort.html#qsort_elim">qsort_elim</a></span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">t</span> <span class="id">ihys</span> <span class="id">ihzs]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.example_quicksort.html#slowsort_nil">slowsort_nil;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="id">apply:</span> (<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> (<span class="id"><a href="monae.example_quicksort.html#partition_slowsort_spec">partition_slowsort_spec</a></span> <span class="id">_</span>)).<br/>
<span class="id">rewrite</span> <span class="id">/=</span>.<br/>
<span class="id">move</span> <span class="id">H</span> <span class="id">:</span> (<span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id">h</span> <span class="id">t</span>) <span class="id">=&gt;</span> <span class="id">ht</span>.<br/>
<span class="id">move:</span> <span class="id">ht</span> <span class="id">H</span> <span class="id">=&gt;</span> <span class="id">[ys</span> <span class="id">zs]</span> <span class="id">/=</span> <span class="id">pht</span>.<br/>
<span class="id">rewrite</span> <span class="id">pht</span> <span class="gallina-kwd">in</span> <span class="id">ihys</span> <span class="id">ihzs</span>.<br/>
<span class="id">apply:</span> (<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> (<span class="id"><a href="monae.fail_lib.html#refin_liftM2">refin_liftM2</a></span> <span class="id">ihys</span> <span class="id">ihzs</span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.monad_lib.html#liftM2_ret">liftM2_ret;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_quicksort.html#qsort">qsort</a></span>.<br/>
<br/>
<span class="vernacular">Module</span> <span id="qsort_function" class="id">
  <a name="qsort_function" class="">qsort_function</a>
</span>.<br/>
<span class="vernacular">Section</span> <span id="qsort_function.qsort_function" class="id">
  <a name="qsort_function.qsort_function" class="">qsort_function</a>
</span>.<br/>
<span class="vernacular">Variables</span> (<span id="qsort_function.qsort_function.M" class="id">
  <a name="qsort_function.qsort_function.M" class="">M</a>
</span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>) (<span id="qsort_function.qsort_function.d" class="id">
  <a name="qsort_function.qsort_function.d" class="">d</a>
</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="qsort_function.qsort_function.T" class="id">
  <a name="qsort_function.qsort_function.T" class="">T</a>
</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_quicksort.html#d:114">d</a></span>).<br/>
<span class="vernacular">Function</span> <span class="id">qsort</span> (<span id="s:125" class="id"><span id="s:124" class="id"><span id="s:122" class="id"><span id="s:120" class="id"><span id="s:119" class="id"><span id="s:116" class="id">
  <a name="s:125" class="">s</a>
</span></span></span></span></span></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort_function.qsort_function.T">T</a></span>) <span class="id">{measure</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">s}</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort_function.qsort_function.T">T</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="monae.example_quicksort.html#s:116">s</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_']'">[::]</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:'['_'::'_']'">[::]</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span> <span class="id">=&gt;</span> <span class="id">let:</span> (<span class="id">ys,</span> <span class="id">zs</span>) <span class="id">:=</span> <span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id">h</span> <span class="id">t</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_quicksort.html#qsort:117">qsort</a></span> <span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'++'_x">++</a></span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_quicksort.html#qsort:117">qsort</a></span> <span class="id">zs</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">move=&gt;</span> <span class="id">s</span> <span class="id">h</span> <span class="id">t</span> <span class="id">_</span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">pht_yz;</span> <span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="monae.example_quicksort.html#size_partition">size_partition</a></span> <span class="id">h</span> <span class="id">t</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">pht_yz</span> <span class="id">/=</span> <span class="id">=&gt;</span> <span class="id">&lt;-;</span> <span class="id">apply/ltP;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#leq_addl">leq_addl</a></span>.<br/>
<span class="id">move=&gt;</span> <span class="id">s</span> <span class="id">h</span> <span class="id">t</span> <span class="id">_</span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">pht_yz;</span> <span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="monae.example_quicksort.html#size_partition">size_partition</a></span> <span class="id">h</span> <span class="id">t</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">pht_yz</span> <span class="id">/=</span> <span class="id">=&gt;</span> <span class="id">&lt;-;</span> <span class="id">apply/ltP;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc/mathcomp.ssreflect.ssrnat.html#leq_addr">leq_addr</a></span>.<br/>
Defined.</div>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_quicksort.html#qsort_function.qsort_function">qsort_function</a></span>.<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_quicksort.html#qsort_function">qsort_function</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
</body>
</html>
