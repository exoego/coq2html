
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.probability</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.probability" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">
<h1 class="title">Module mathcomp.analysis.probability</h1>
<div class="coq">
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">all_ssreflect</span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">ssralg</span> <span class="id">poly</span> <span class="id">ssrnum</span> <span class="id">ssrint</span> <span class="id">interval</span> <span class="id">finmap</span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></span> <span class="id"><a href="mathcomp.classical.boolp.html">boolp</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html">classical_sets</a></span> <span class="id"><a href="mathcomp.classical.functions.html">functions</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.classical.cardinality.html">cardinality</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">HB</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">structures</span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.analysis.exp.html">exp</a></span> <span class="id"><a href="mathcomp.analysis.numfun.html">numfun</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html">lebesgue_integral</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.analysis.reals.html">reals</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html">ereal</a></span> <span class="id"><a href="mathcomp.analysis.signed.html">signed</a></span> <span class="id"><a href="mathcomp.analysis.topology.html">topology</a></span> <span class="id"><a href="mathcomp.analysis.normedtype.html">normedtype</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html">sequences</a></span> <span class="id"><a href="mathcomp.analysis.esum.html">esum</a></span> <span class="id"><a href="mathcomp.analysis.measure.html">measure</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="mathcomp.analysis.exp.html">exp</a></span> <span class="id"><a href="mathcomp.analysis.numfun.html">numfun</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html">lebesgue_integral</a></span>.<br/>
<br/>
<div class="ssrdoc markdown">
# Probability                                                              
                                                                           
This file provides basic notions of probability theory. See measure.v for  
the type probability T R (a measure that sums to 1).                       
                                                                           
```                                                                        
         {RV P &gt;-&gt; R} == real random variable: a measurable function from  
                         the measurableType of the probability P to R      
       distribution X == measure image of P by X : {RV P -&gt; R}, declared   
                         as an instance of probability measure             
              'E_P[X] == expectation of the real measurable function X     
       covariance X Y == covariance between real random variable X and Y   
              'V_P[X] == variance of the real random variable X            
        mmt_gen_fun X == moment generating function of the random variable 
                         X 
      {dmfun T &gt;-&gt; R} == type of discrete real-valued measurable functions 
        {dRV P &gt;-&gt; R} == real-valued discrete random variable              
            dRV_dom X == domain of the discrete random variable X          
           dRV_enum X == bijection between the domain and the range of X   
              pmf X r := fine (P (X @^-1` [set r]))                        
        enum_prob X k == probability of the kth value in the range of X    
```                                                                        
                                                                           
</div>
<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">"'{' 'RV' P &gt;-&gt; R '}'"</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span> <span class="id">format</span> <span class="id">"'{' 'RV'  P  '&gt;-&gt;'  R '}'"</span>).<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">"''E_' P [ X ]" (format "''E_' P [ X ]"</span><span class="id">,</span> <span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">5</span>).<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">"''V_' P [ X ]" (format "''V_' P [ X ]"</span><span class="id">,</span> <span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">5</span>).<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">"{ 'dmfun' aT &gt;-&gt; T }"</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span> <span class="id">format</span> <span class="id">"{ 'dmfun'  aT  &gt;-&gt;  T }"</span>).<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">"'{' 'dRV' P &gt;-&gt; R '}'"</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span> <span class="id">format</span> <span class="id">"'{' 'dRV'  P  '&gt;-&gt;'  R '}'"</span>).<br/>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="id">Unset</span> <span class="id">Printing</span> <span class="vernacular">Implicit</span> <span class="id">Defensive</span>.<br/>
<br/>
<span class="vernacular">Import</span> <span class="id">Order.TTheory</span> <span class="id">GRing.Theory</span> <span class="id">Num.Def</span> <span class="id">Num.Theory</span>.<br/>
<span class="vernacular">Import</span> <span class="id"><a href="mathcomp.analysis.topology.html#numFieldTopology.Exports">numFieldTopology.Exports</a></span>.<br/>
<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">classical_set_scope</span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ring_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="random_variable">random_variable</a></span> (<span class="id"><a name="d:1">d</a></span> <span class="id">:</span> <span class="id">_</span>) (<span class="id"><a name="T:2">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:1">d</a></span>) (<span class="id"><a name="R:3">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;(<span class="id"><a name="P:4">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:2">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:3">R</a></span>) <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:2">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:3">R}</a></span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id"><a name="::form_scope:'{'_'RV'_x_'>->'_x_'}'">"{ 'RV' P &gt;-&gt; R }"</a></span> <span class="id">:=</span> (<span class="id">@random_variable</span> <span class="id">_</span> <span class="id">_</span> <span class="id">R</span> <span class="id">P</span>) <span class="id">:</span> <span class="id">form_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="notin_range_measure">notin_range_measure</a></span> <span class="id"><a name="d:5">d</a></span> (<span class="id"><a name="T:6">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:5">d</a></span>) (<span class="id"><a name="R:7">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="P:8">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#::ring_scope:'{'_'measure'_'set'_x_'->'_'\bar'_x_'}'">{measure</a></span> <span class="id">set</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:6">T</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#::ring_scope:'{'_'measure'_'set'_x_'->'_'\bar'_x_'}'">-&gt;</a></span> <span class="id">\bar</span> <span class="id"><a href="mathcomp.analysis.probability.html#R:7">R}</a></span>) (<span class="id"><a name="X:9">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:6">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:7">R</a></span>) <span class="id"><a name="r:10">r</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#r:10">r</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\notin'_x">\notin</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:9">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#P:8">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:9">X</a></span> <span class="id">@^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:10">r]</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">0%E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_set">notin_set</a></span> <span class="id">=&gt;</span> <span class="id">hr;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage10">preimage10</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="probability_range">probability_range</a></span> <span class="id"><a name="d:11">d</a></span> (<span class="id"><a name="T:12">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:11">d</a></span>) (<span class="id"><a name="R:13">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;(<span class="id"><a name="P:14">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:12">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:13">R</a></span>) (<span class="id"><a name="X:15">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#P:14">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:13">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#P:14">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:15">X</a></span> <span class="id">@^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:15">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">1%E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_range">preimage_range</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT</a></span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="distribution">distribution</a></span> (<span class="id"><a name="d:16">d</a></span> <span class="id">:</span> <span class="id">_</span>) (<span class="id"><a name="T:17">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:16">d</a></span>) (<span class="id"><a name="R:18">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="P:19">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:17">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:18">R</a></span>) (<span class="id"><a name="X:20">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:17">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:18">R}</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#pushforward">pushforward</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#P:19">P</a></span> (<span class="id">@measurable_funP</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:20">X</a></span>).<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a name="distribution_is_probability">distribution_is_probability</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id"><a name="d:21">d</a></span> (<span class="id"><a name="T:22">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:21">d</a></span>) (<span class="id"><a name="R:23">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:24">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:22">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:23">R</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="X:25">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:22">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:23">R}</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span class="id"><a name="distribution_is_probability.distribution0">distribution0</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">0%E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
 <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure0">measure0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span class="id"><a name="distribution_is_probability.distribution_ge0">distribution_ge0</a></span> <span class="id"><a name="A:26">A</a></span> <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:26">A</a></span>)<span class="id">%E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_ge0">measure_ge0</a></span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span class="id"><a name="distribution_is_probability.distribution_sigma_additive">distribution_sigma_additive</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#semi_sigma_additive">semi_sigma_additive</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
 <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_semi_sigma_additive">measure_semi_sigma_additive</a></span>. Qed.</div>
<br/>
<span class="hierarchy-builder">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.measure.html#isMeasure.Build">isMeasure.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.R">R</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span>)<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.distribution0">distribution0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.distribution_ge0">distribution_ge0</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.distribution_sigma_additive">distribution_sigma_additive</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span class="id"><a name="distribution_is_probability.distribution_is_probability">distribution_is_probability</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id">_]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">1%:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/distribution</span> <span class="id">/=</span> <span class="id">/pushforward</span> <span class="id">/=</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setT">preimage_setT</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT</a></span>.<br/>
Qed.</div>
<br/>
<span class="hierarchy-builder">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measure_isProbability.Build">Measure_isProbability.Build</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.R">R</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.X">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability.distribution_is_probability">distribution_is_probability</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_is_probability">distribution_is_probability</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a name="transfer_probability">transfer_probability</a></span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span class="id"><a name="d:27">d</a></span> (<span class="id"><a name="T:28">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:27">d</a></span>) (<span class="id"><a name="R:29">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:30">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:28">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:29">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="probability_distribution">probability_distribution</a></span> (<span class="id"><a name="X:31">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R}</a></span>) <span class="id"><a name="r:32">r</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:33">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:31">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:33">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:32">r]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:31">X</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:32">r]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="integral_distribution">integral_distribution</a></span> (<span class="id"><a name="X:34">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R}</a></span>) (<span class="id"><a name="f:35">f</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::type_scope:'\bar'_x">\bar</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.R">R]</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:35">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> (<span class="gallina-kwd">forall</span> <span class="id"><a name="y:36">y,</a></span> <span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:35">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#y:36">y</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::ereal_scope:'\int'_'['_x_']_'_x_x">\int[distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:34">X]_y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:35">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#y:37">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::ereal_scope:'\int'_'['_x_']_'_x_x">\int[P]_x</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#f:35">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:34">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#x:38">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">mf</span> <span class="id">f0;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_pushforward">integral_pushforward</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#transfer_probability">transfer_probability</a></span>.<br/>
<br/>
<span class="id"><a name="expectationLocked">HB.lock</a></span> <span class="vernacular">Definition</span> <span class="id">expectation</span> <span class="id">{d}</span> <span class="id">{T</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:39">d}</a></span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a name="P:42">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:40">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:41">R</a></span>) (<span class="id"><a name="X:43">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:40">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:41">R</a></span>) <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::ereal_scope:'\int'_'['_x_']_'_x_x">\int[P]_w</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:43">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#w:44">w</a></span>)<span class="id">%:E</span>)<span class="id">%E</span>.<br/>
<span class="vernacular">Canonical</span> <span class="id"><a name="expectation_unlockable">expectation_unlockable</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#Unlockable">Unlockable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#unlock">expectation.unlock</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="mathcomp.analysis.probability.html#body">expectation</a></span> <span class="id">{d</span> <span class="id">T</span> <span class="id">R}</span> <span class="id">P</span> <span class="id">_%R</span>.<br/>
<span class="vernacular">Notation</span> <span class="id"><a name="::ereal_scope:'''E_'_x_'['_x_']'">"''E_' P [ X ]"</a></span> <span class="id">:=</span> (<span class="id">@expectation</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">P</span> <span class="id">X</span>) <span class="id">:</span> <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a name="expectation_lemmas">expectation_lemmas</a></span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span class="id"><a name="d:45">d</a></span> (<span class="id"><a name="T:46">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:45">d</a></span>) (<span class="id"><a name="R:47">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:48">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:46">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:47">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectation_fin_num">expectation_fin_num</a></span> (<span class="id"><a name="X:49">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:49">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\is'_'a'_x">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_fune_fin_num">integral_fune_fin_num</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectation_cst">expectation_cst</a></span> <span class="id"><a name="r:50">r</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:50">r]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:50">r%:E</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock/=</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_cst">integral_cst//=</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectation_indic">expectation_indic</a></span> (<span class="id"><a name="A:51">A</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T</a></span>) (<span class="id"><a name="mA:52">mA</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:51">A</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[\1_A]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:51">A</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_indic">integral_indic//</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIT">setIT</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="integrable_expectation">integrable_expectation</a></span> (<span class="id"><a name="X:53">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>)<br/>
&nbsp;&nbsp;(<span class="id"><a name="iX:54">iX</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:53">X</a></span>)) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'`|'_x_'|'">`|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'`|'_x_'|'">|</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<'_x">&lt;</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'+oo'">+oo</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">move:</span> <span class="id">iX</span> <span class="id">=&gt;</span> <span class="id">/integrableP[?</span> <span class="id">Xoo];</span> <span class="id">rewrite</span> (<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">Xoo</span>)<span class="id">//</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span>.<br/>
<span class="id">exact:</span> <span class="id">le_trans</span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#le_abse_integral">le_abse_integral</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectationM">expectationM</a></span> (<span class="id"><a name="X:55">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) (<span class="id"><a name="iX:56">iX</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:55">X</a></span>))<br/>
&nbsp;&nbsp;(<span class="id"><a name="k:57">k</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[k</a></span> <span class="id">\o*</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:55">X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:57">k%:E</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock;</a></span> <span class="id">under</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-integralZl//;</span> <span class="id">under</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectation_ge0">expectation_ge0</a></span> (<span class="id"><a name="X:58">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span class="id"><a name="x:59">x,</a></span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:58">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:59">x</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_ge0">integral_ge0//</a></span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectation_le">expectation_le</a></span> (<span class="id"><a name="X:60">X</a></span> <span class="id"><a name="Y:61">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:60">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:61">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span class="id"><a name="x:62">x,</a></span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:60">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:62">x</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> (<span class="gallina-kwd">forall</span> <span class="id"><a name="x:63">x,</a></span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:61">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:63">x</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#::type_scope:'{'_'ae'_x_','_x_'}'">{ae</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P,</a></span> (<span class="gallina-kwd">forall</span> <span class="id"><a name="x:64">x,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:60">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:64">x</a></span> <span class="id">&lt;=</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:61">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:64">x</a></span>)<span class="id">%R}</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">move=&gt;</span> <span class="id">mX</span> <span class="id">mY</span> <span class="id">X0</span> <span class="id">Y0</span> <span class="id">XY;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ae_ge0_le_integral">ae_ge0_le_integral</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">t</span> <span class="id">_;</span> <span class="id">apply:</span> <span class="id">X0</span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">t</span> <span class="id">_;</span> <span class="id">apply:</span> <span class="id">Y0</span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun</span>.<br/>
<span class="id">-</span> <span class="id">move:</span> <span class="id">XY</span> <span class="id">=&gt;</span> <span class="id">[N</span> <span class="id">[mN</span> <span class="id">PN</span> <span class="id">XYN]];</span> <span class="gallina-kwd">exists</span> <span class="id">N;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">t</span> <span class="id">/=</span> <span class="id">h</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">XYN</span> <span class="id">=&gt;</span> <span class="id">/=;</span> <span class="id">apply:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#contra_not">contra_not</a></span> <span class="id">h;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectationD">expectationD</a></span> (<span class="id"><a name="X:65">X</a></span> <span class="id"><a name="Y:66">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:65">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:66">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X</a></span> <span class="id">\+</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:66">Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'+'_x">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integralD_EFin">integralD_EFin</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectationB">expectationB</a></span> (<span class="id"><a name="X:67">X</a></span> <span class="id"><a name="Y:68">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:67">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:68">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X</a></span> <span class="id">\-</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:68">Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integralB_EFin">integralB_EFin</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectation_sum">expectation_sum</a></span> (<span class="id"><a name="X:69">X</a></span> <span class="id">:</span> <span class="id">seq</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span class="id"><a name="Xi:70">Xi,</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Xi:70">Xi</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\in'_x">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:69">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Xi:70">Xi</a></span>)) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[\sum_</a></span>(<span class="id"><a name="Xi:71">Xi</a></span> <span class="id">&lt;-</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:69">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#Xi:71">Xi]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'\sum_'_'('_x_'<-'_x_')'_x">\sum_</a></span>(<span class="id"><a name="Xi:74">Xi</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'\sum_'_'('_x_'<-'_x_')'_x">&lt;-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:69">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Xi]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="id">elim:</span> <span class="id">X</span> <span class="id">=&gt;</span> <span class="id">[|X0</span> <span class="id">X</span> <span class="id">IHX]</span> <span class="id">intX;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!big_nil</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst</a></span>.<br/>
<span class="id">have</span> <span class="id">intX0</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id">X0</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">intX;</span> <span class="id">rewrite</span> <span class="id">in_cons</span> <span class="id">eqxx</span>.<br/>
<span class="id">have</span> <span class="id">{}intX</span> <span class="id">Xi</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#Xi:77">Xi</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\in'_x">\in</a></span> <span class="id">X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Xi:77">Xi</a></span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">XiX;</span> <span class="id">apply:</span> <span class="id">intX;</span> <span class="id">rewrite</span> <span class="id">in_cons</span> <span class="id">XiX</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orbT">orbT</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">!big_cons</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectationD">expectationD</a></span> <span class="id">?IHX//</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="gallina-kwd">fun</span> <span class="id"><a name="x:78">x</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'\sum_'_'('_x_'<-'_x_')'_x">\sum_</a></span>(<span class="id"><a name="f:80">f</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'\sum_'_'('_x_'<-'_x_')'_x">&lt;-</a></span> <span class="id">map</span> (<span class="gallina-kwd">fun</span> <span class="id"><a name="x:79">x</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas.R">R}</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:79">x</a></span>) <span class="id">X</span>) <span class="id"><a href="mathcomp.analysis.probability.html#f:80">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:78">x</a></span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrable_sum">integrable_sum</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">_</span> <span class="id">/mapP[h</span> <span class="id">hX</span> <span class="id">-&gt;];</span> <span class="id">exact:</span> <span class="id">intX</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/funext</span> <span class="id">=&gt;</span> <span class="id">t/=;</span> <span class="id">rewrite</span> <span class="id">big_map</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sumEFin">sumEFin</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#mfun_sum">mfun_sum</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_lemmas">expectation_lemmas</a></span>.<br/>
<br/>
<span class="id"><a name="covarianceLocked">HB.lock</a></span> <span class="vernacular">Definition</span> <span class="id">covariance</span> <span class="id">{d}</span> <span class="id">{T</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:93">d}</a></span> <span class="id">{R</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType}</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="P:96">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:94">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:95">R</a></span>) (<span class="id"><a name="X:97">X</a></span> <span class="id"><a name="Y:98">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:94">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:95">R</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#X:97">X</a></span> <span class="id">\-</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span>)) <span class="id">*</span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:98">Y</a></span> <span class="id">\-</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y]</a></span>))<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">]%E</a></span>.<br/>
<span class="vernacular">Canonical</span> <span class="id"><a name="covariance_unlockable">covariance_unlockable</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#Unlockable">Unlockable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#unlock">covariance.unlock</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="mathcomp.analysis.probability.html#body">covariance</a></span> <span class="id">{d</span> <span class="id">T</span> <span class="id">R}</span> <span class="id">P</span> <span class="id">_%R</span> <span class="id">_%R</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a name="covariance_lemmas">covariance_lemmas</a></span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span class="id"><a name="d:99">d</a></span> (<span class="id"><a name="T:100">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:99">d</a></span>) (<span class="id"><a name="R:101">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:102">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:100">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:101">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceE">covarianceE</a></span> (<span class="id"><a name="X:103">X</a></span> <span class="id"><a name="Y:104">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:103">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:104">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:103">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:104">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:103">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:104">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:104">Y]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\is'_'a'_x">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num_abs">fin_num_abs//</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#integrable_expectation">integrable_expectation</a></span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\is'_'a'_x">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num_abs">fin_num_abs//</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#integrable_expectation">integrable_expectation</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> (<span class="id">X</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:x_'\*'_x">\*</a></span> <span class="id">Y</span> <span class="id">\-</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id">\o*</span> <span class="id">Y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\-</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y]</a></span> <span class="id">\o*</span> <span class="id">X</span> <span class="id">\+</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y]</a></span>) <span class="id">\o*</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">1</span>)<span class="id">%R</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">mulrDr</span> <span class="id">!mulrDl/=</span> <span class="id">mul1r</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineM">fineM//</a></span> <span class="id">mulrNN</span> <span class="id">addrA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrN</span> <span class="id">mulNr</span> <span class="id">[Z</span> <span class="gallina-kwd">in</span> (<span class="id">X</span> <span class="id">x</span> <span class="id">*</span> <span class="id">Y</span> <span class="id">x</span> <span class="id">-</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:106">Z</a></span>)<span class="id">%R]mulrC</span>.<br/>
<span class="id">have</span> <span class="id">?</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id">X</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:x_'\*'_x">\*</a></span> <span class="id">Y</span> <span class="id">\-</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id">\o*</span> <span class="id">Y</span>)<span class="id">%R</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreBr">compreBr</a></span> <span class="id">?integrableB//</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectationD">expectationD/=;</a></span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreBr">compreBr//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableB">integrableB//</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">2?expectationB//=</span> <span class="id">?compre_scale//</span> <span class="id">?integrableZl//</span>.<br/>
<span class="id">rewrite</span> <span class="id">3?expectationM//=</span> <span class="id">?finite_measure_integrable_cst//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineM">fineM//</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span> <span class="id">!fineK//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#subeK">subeK</a></span> <span class="id">?fin_numM</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceC">covarianceC</a></span> (<span class="id"><a name="X:107">X</a></span> <span class="id"><a name="Y:108">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:107">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:108">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:108">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:107">X</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock;</a></span> <span class="id">congr</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation">expectation;</a></span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">mulrC</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covariance_fin_num">covariance_fin_num</a></span> (<span class="id"><a name="X:109">X</a></span> <span class="id"><a name="Y:110">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:109">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:110">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:109">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:110">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:109">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:110">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\is'_'a'_x">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceE">covarianceE//</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_numB">fin_numB</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_numM">fin_numM</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_fin_num">expectation_fin_num</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covariance_cst_l">covariance_cst_l</a></span> <span class="id"><a name="c:111">c</a></span> (<span class="id"><a name="X:112">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:111">c</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#X:112">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst/=</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">0%R</span>) <span class="id">?expectation_cst//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id">/GRing</span>.<span class="id">mul/=</span> <span class="id">subrr</span> <span class="id">mul0r</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covariance_cst_r">covariance_cst_r</a></span> (<span class="id"><a name="X:114">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id"><a name="c:115">c</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:114">X</a></span> (<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:115">c</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">0</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_cst_l">covariance_cst_l</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceZl">covarianceZl</a></span> <span class="id"><a name="a:116">a</a></span> (<span class="id"><a name="X:117">X</a></span> <span class="id"><a name="Y:118">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:117">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:118">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:117">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:118">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#a:116">a</a></span> <span class="id">\o*</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:117">X</a></span>)<span class="id">%R</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:118">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#a:116">a%:E</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:117">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:118">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="id">have</span> <span class="id">aXY</span> <span class="id">:</span> (<span class="id">a</span> <span class="id">\o*</span> <span class="id">X</span> <span class="id">*</span> <span class="id">Y</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">a</span> <span class="id">\o*</span> (<span class="id">X</span> <span class="id">*</span> <span class="id">Y</span>))<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id">mulrAC</span>.<br/>
<span class="id">rewrite</span> <span class="id">[LHS]covarianceE</span> <span class="id">=&gt;</span> <span class="id">[||//|]</span> <span class="id">/=;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">aXY</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceE">covarianceE//</a></span> <span class="id">aXY</span> <span class="id">!expectationM//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-muleA</span> <span class="id">-muleBr//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num_adde_defr">fin_num_adde_defr//</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_fin_num">expectation_fin_num</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceZr">covarianceZr</a></span> <span class="id"><a name="a:119">a</a></span> (<span class="id"><a name="X:120">X</a></span> <span class="id"><a name="Y:121">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:120">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:121">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:120">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:121">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:120">X</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#a:119">a</a></span> <span class="id">\o*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:121">Y</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#a:119">a%:E</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:120">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:121">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceZl">covarianceZl;</a></span> <span class="id">last</span> <span class="id">rewrite</span> <span class="id">mulrC</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceNl">covarianceNl</a></span> (<span class="id"><a name="X:122">X</a></span> <span class="id"><a name="Y:123">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:122">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:123">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:122">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:123">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:122">X</a></span>)<span class="id">%R</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:123">Y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:122">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:123">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id">X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">-1</span> <span class="id">\o*</span> <span class="id">X</span>)<span class="id">%R</span> <span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">mulrN</span> <span class="id">mulr1</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceZl">covarianceZl//</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinN">EFinN</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mulNe">mulNe</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul1e">mul1e</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceNr">covarianceNr</a></span> (<span class="id"><a name="X:124">X</a></span> <span class="id"><a name="Y:125">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:124">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:125">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:124">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:125">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:124">X</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:125">Y</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:124">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:125">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1;</span> <span class="id">rewrite</span> <span class="id">!</span>(<span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id">X</span>) <span class="id"><a href="mathcomp.analysis.probability.html#covarianceNl">covarianceNl</a></span> <span class="id">1?mulrC</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceNN">covarianceNN</a></span> (<span class="id"><a name="X:126">X</a></span> <span class="id"><a name="Y:127">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:126">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:127">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:126">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:127">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:126">X</a></span>)<span class="id">%R</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:127">Y</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:126">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:127">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>.<br/>
<span class="id">have</span> <span class="id">NY</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id">Y</span>)<span class="id">%R</span>) <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceNl">covarianceNl</a></span> <span class="id">?covarianceNr</span> <span class="id">?oppeK//=</span> <span class="id">mulrN</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceDl">covarianceDl</a></span> (<span class="id"><a name="X:128">X</a></span> <span class="id"><a name="Y:129">Y</a></span> <span class="id"><a name="Z:130">Z</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:128">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:128">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:129">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:129">Y</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:130">Z</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Z:130">Z</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:128">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:130">Z</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:129">Y</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:130">Z</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:128">X</a></span> <span class="id">\+</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:129">Y</a></span>)<span class="id">%R</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:130">Z</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:128">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:130">Z</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'+'_x">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:129">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:130">Z</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">Z1</span> <span class="id">Z2</span> <span class="id">XZ1</span> <span class="id">YZ1</span>.<br/>
<span class="id">rewrite</span> <span class="id">[LHS]covarianceE//=</span> <span class="id">?mulrDl</span> <span class="id">?compreDr//</span> <span class="id">?integrableD//</span>.<br/>
<span class="id">rewrite</span> <span class="id">2?expectationD//=</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleDl">muleDl</a></span> <span class="id">?fin_num_adde_defr</span> <span class="id">?expectation_fin_num//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#oppeD">oppeD</a></span> <span class="id">?fin_num_adde_defr</span> <span class="id">?fin_numM</span> <span class="id">?expectation_fin_num//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#addeACA">addeACA</a></span> <span class="id">2?covarianceE</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceDr">covarianceDr</a></span> (<span class="id"><a name="X:131">X</a></span> <span class="id"><a name="Y:132">Y</a></span> <span class="id"><a name="Z:133">Z</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:132">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:132">Y</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:133">Z</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Z:133">Z</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:132">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:133">Z</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:132">Y</a></span> <span class="id">\+</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:133">Z</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:132">Y</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'+'_x">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:131">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:133">Z</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">Z1</span> <span class="id">Z2</span> <span class="id">XY1</span> <span class="id">XZ1</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDl">covarianceDl</a></span> <span class="id">?</span>(<span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id">X</span>) <span class="id">1?mulrC</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceBl">covarianceBl</a></span> (<span class="id"><a name="X:134">X</a></span> <span class="id"><a name="Y:135">Y</a></span> <span class="id"><a name="Z:136">Z</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:134">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:134">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:135">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:135">Y</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:136">Z</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Z:136">Z</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:134">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:136">Z</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:135">Y</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:136">Z</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:134">X</a></span> <span class="id">\-</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:135">Y</a></span>)<span class="id">%R</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:136">Z</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:134">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:136">Z</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:135">Y</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:136">Z</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">Z1</span> <span class="id">Z2</span> <span class="id">XZ1</span> <span class="id">YZ1</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">X</span> <span class="id">\-</span> <span class="id">Y</span>)<span class="id">%R]/</span>(<span class="id">X</span> <span class="id">\+</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id">Y</span>))<span class="id">%R</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDl">covarianceDl</a></span> <span class="id">?covarianceNl//=</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableN">integrableN</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrNN</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulNr</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableN">integrableN</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covarianceBr">covarianceBr</a></span> (<span class="id"><a name="X:137">X</a></span> <span class="id"><a name="Y:138">Y</a></span> <span class="id"><a name="Z:139">Z</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:138">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:138">Y</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:139">Z</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Z:139">Z</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:138">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:139">Z</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:138">Y</a></span> <span class="id">\-</span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:139">Z</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:138">Y</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:137">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Z:139">Z</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">Z1</span> <span class="id">Z2</span> <span class="id">XY1</span> <span class="id">XZ1</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!</span>(<span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id">X</span>) <span class="id"><a href="mathcomp.analysis.probability.html#covarianceBl">covarianceBl</a></span> <span class="id">1?</span>(<span class="id">mulrC</span> <span class="id">_</span> <span class="id">X</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_lemmas">covariance_lemmas</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a name="variance">variance</a></span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span class="id"><a name="d:140">d</a></span> (<span class="id"><a name="T:141">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:140">d</a></span>) (<span class="id"><a name="R:142">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:143">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:141">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:142">R</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="variance">variance</a></span> (<span class="id"><a name="X:144">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.T">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R</a></span>) <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:144">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:144">X</a></span>.<br/>
<span class="id">Local</span> <span class="vernacular">Notation</span> <span class="id"><a name="variance.:::'''V_'_x_'['_x_']'">"''V_' P [ X ]"</a></span> <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.probability.html#variance">variance</a></span> <span class="id">X</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="varianceE">varianceE</a></span> (<span class="id"><a name="X:145">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:145">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:145">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X</a></span> <span class="id">^+</span> <span class="id">2]</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span>) <span class="id">^+</span> <span class="id">2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2;</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceE">covarianceE</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="variance_fin_num">variance_fin_num</a></span> (<span class="id"><a name="X:146">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:146">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:146">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\is'_'a'_x">\is</a></span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_num">fin_num</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">/[dup];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_fin_num">covariance_fin_num</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="variance_ge0">variance_ge0</a></span> (<span class="id"><a name="X:147">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span>)<span class="id">%E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_ge0">expectation_ge0</a></span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">apply:</span> <span class="id">sqr_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="variance_cst">variance_cst</a></span> <span class="id"><a name="r:148">r</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:148">r]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">0%E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
<span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst/=</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">0%R</span>) <span class="id">?expectation_cst//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply/funext</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id">/GRing</span>.<span class="id">exp/GRing</span>.<span class="id">mul/=</span> <span class="id">subrr</span> <span class="id">mulr0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="varianceZ">varianceZ</a></span> <span class="id"><a name="a:150">a</a></span> (<span class="id"><a name="X:151">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:151">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:151">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#a:150">a</a></span> <span class="id">\o*</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:151">X</a></span>)<span class="id">%R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#a:150">a</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2;</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceZl">covarianceZl//=</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceZr">covarianceZr//</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleA">muleA</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:152">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> (<span class="id">a</span> <span class="id">\o*</span> <span class="id">X</span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id">mulrA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="varianceN">varianceN</a></span> (<span class="id"><a name="X:153">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:153">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:153">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[</a></span>(<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:153">X</a></span>)<span class="id">%R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2;</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceNN">covarianceNN</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="varianceD">varianceD</a></span> (<span class="id"><a name="X:154">X</a></span> <span class="id"><a name="Y:155">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:154">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:154">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:155">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:155">Y</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:154">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:155">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X</a></span> <span class="id">\+</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:155">Y]%R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'+'_x">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[Y]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'+'_x">+</a></span> <span class="id">2%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:154">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:155">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">XY1</span>.<br/>
<span class="id">rewrite</span> <span class="id">-['V_P[_]]/</span>(<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> (<span class="id">X</span> <span class="id">\+</span> <span class="id">Y</span>)<span class="id">%R</span> (<span class="id">X</span> <span class="id">\+</span> <span class="id">Y</span>)<span class="id">%R</span>).<br/>
<span class="id">have</span> <span class="id">XY</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id">X</span> <span class="id">\+</span> <span class="id">Y</span>)<span class="id">%R</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDl">covarianceDl//=;</a></span> <span class="id">last</span> <span class="id">3</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-expr2</span> <span class="id">sqrrD</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">?integrableD//</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD//</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-mulr_natr</span> <span class="id">-[</span>(<span class="id">_</span> <span class="id">*</span> <span class="id">2</span>)<span class="id">%R]/</span>(<span class="id">2</span> <span class="id">\o*</span> (<span class="id">X</span> <span class="id">*</span> <span class="id">Y</span>))<span class="id">%R</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrDr</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">?integrableD</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrDr</span> <span class="id">mulrC</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">?integrableD</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDr">covarianceDr//</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covarianceDr">covarianceDr</a></span> <span class="id">?</span>(<span class="id">mulrC</span> <span class="id">Y</span> <span class="id">X</span>)<span class="id">//</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.probability.html#covarianceC">covarianceC</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id">Y</span> <span class="id">X</span>) <span class="id">[LHS]addeA</span> <span class="id">[LHS]</span>(<span class="id">ACl</span> (<span class="id">1*4*</span>(<span class="id">2*3</span>)))<span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-[2%R]/</span>(<span class="id">1</span> <span class="id">+</span> <span class="id">1</span>)<span class="id">%R</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinD">EFinD</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleDl">muleDl</a></span> <span class="id">?mul1e//</span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_fin_num">covariance_fin_num</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="varianceB">varianceB</a></span> (<span class="id"><a name="X:156">X</a></span> <span class="id"><a name="Y:157">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:156">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:156">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:157">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:157">Y</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:156">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:157">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#X:156">X</a></span> <span class="id">\-</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:157">Y</a></span>)<span class="id">%R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'+'_x">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[Y]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id">2%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:156">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:157">Y</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">XY1</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">X</span> <span class="id">\-</span> <span class="id">Y</span>)<span class="id">%R]/</span>(<span class="id">X</span> <span class="id">\+</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id">Y</span>))<span class="id">%R</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD">varianceD/=</a></span> <span class="id">?varianceN</span> <span class="id">?covarianceNr</span> <span class="id">?muleN//</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrNN</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrN</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="varianceD_cst_l">varianceD_cst_l</a></span> <span class="id"><a name="c:158">c</a></span> (<span class="id"><a name="X:159">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:159">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:159">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[</a></span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:158">c</a></span> <span class="id">\+</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:159">X</a></span>)<span class="id">%R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD">varianceD//=;</a></span> <span class="id">last</span> <span class="id">3</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrC</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance_cst">variance_cst</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#add0e">add0e</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#covariance_cst_l">covariance_cst_l</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#adde0">adde0</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="varianceD_cst_r">varianceD_cst_r</a></span> (<span class="id"><a name="X:160">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id"><a name="c:161">c</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:160">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:160">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#X:160">X</a></span> <span class="id">\+</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:161">c</a></span>)<span class="id">%R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> (<span class="id">X</span> <span class="id">\+</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span> <span class="id">\+</span> <span class="id">X</span>)<span class="id">%R</span> <span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">addrC</span>.<br/>
<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD_cst_l">varianceD_cst_l</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="varianceB_cst_l">varianceB_cst_l</a></span> <span class="id"><a name="c:162">c</a></span> (<span class="id"><a name="X:163">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:163">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:163">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[</a></span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:162">c</a></span> <span class="id">\-</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:163">X</a></span>)<span class="id">%R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span> <span class="id">\-</span> <span class="id">X</span>)<span class="id">%R]/</span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span> <span class="id">\+</span> (<span class="id"><a href="mathcomp.classical.mathcomp_extra.html#::ring_scope:'\-'_x">\-</a></span> <span class="id">X</span>))<span class="id">%R</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD_cst_l">varianceD_cst_l/=;</a></span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreN">compreN</a></span> <span class="id">?integrableN</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrNN;</span> <span class="id">apply:</span> <span class="id">X2</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceN">varianceN</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="varianceB_cst_r">varianceB_cst_r</a></span> (<span class="id"><a name="X:164">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id"><a name="c:165">c</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:164">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:164">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[</a></span>(<span class="id"><a href="mathcomp.analysis.probability.html#X:164">X</a></span> <span class="id">\-</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#c:165">c</a></span>)<span class="id">%R]</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2;</span> <span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">X</span> <span class="id">\-</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">c</span>)<span class="id">%R]/</span>(<span class="id">X</span> <span class="id">\+</span> (<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id">-</span> <span class="id">c</span>)))<span class="id">%R</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceD_cst_r">varianceD_cst_r</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="covariance_le">covariance_le</a></span> (<span class="id"><a name="X:166">X</a></span> <span class="id"><a name="Y:167">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:166">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:166">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:167">Y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#Y:167">Y</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:166">X</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:167">Y</a></span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#covariance">covariance</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:166">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#Y:167">Y</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sqrte">sqrte</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sqrte">sqrte</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#variance.:::'''V_'_x_'['_x_']'">'V_P[Y]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">Y1</span> <span class="id">Y2</span> <span class="id">XY1</span>.<br/>
<span class="id">rewrite</span> <span class="id">-sqrteM</span> <span class="id">?variance_ge0//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_sqrE">lee_sqrE</a></span> <span class="id">?sqrte_ge0//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#sqr_sqrte">sqr_sqrte</a></span> <span class="id">?mule_ge0</span> <span class="id">?variance_ge0//</span>.<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#variance_fin_num">variance_fin_num</a></span> <span class="id">X1</span> <span class="id">X2</span>)) <span class="id">-</span>(<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#variance_fin_num">variance_fin_num</a></span> <span class="id">Y1</span> <span class="id">Y2</span>)).<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#covariance_fin_num">covariance_fin_num</a></span> <span class="id">X1</span> <span class="id">Y1</span> <span class="id">XY1</span>)).<br/>
<span class="id">rewrite</span> <span class="id">-EFin_expe</span> <span class="id">-EFinM</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id">-</span>(<span class="id">@ler_pmul2l</span> <span class="id">_</span> <span class="id">4%:R</span>) <span class="id">?ltr0n//</span> <span class="id">[leRHS]mulrA</span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leLHS">leLHS]</a></span>(<span class="id">natrM</span> <span class="id">_</span> <span class="id">2</span> <span class="id">2</span>) <span class="id">mulrACA</span> <span class="id">-expr2</span> <span class="id">-subr_le0</span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#deg_le2_ge0">deg_le2_ge0</a></span> <span class="id">=&gt;</span> <span class="id">r;</span> <span class="id">rewrite</span> <span class="id">-lee_fin</span> <span class="id">!EFinD</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> <span class="id">?variance_fin_num//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span> <span class="id">-varianceZ//</span>.<br/>
<span class="id">rewrite</span> <span class="id">-mulrA</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span> <span class="id">mulrC</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span> <span class="id">?fineK</span> <span class="id">?covariance_fin_num//</span> <span class="id">-covarianceZl//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#addeAC">addeAC</a></span> <span class="id">-varianceD</span> <span class="id">?variance_ge0//=</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:168">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">r</span> <span class="id">^+2</span> <span class="id">\o*</span> <span class="id">X</span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span> <span class="id">1?mulrACA//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">?integrableZl</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulrAC</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale//</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance">variance</a></span>.<br/>
<span class="vernacular">Notation</span> <span class="id"><a name=":::'''V_'_x_'['_x_']'">"'V_ P [ X ]"</a></span> <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.probability.html#variance">variance</a></span> <span class="id">P</span> <span class="id">X</span>).<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a name="markov_chebyshev_cantelli">markov_chebyshev_cantelli</a></span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span class="id"><a name="d:169">d</a></span> (<span class="id"><a name="T:170">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:169">d</a></span>) (<span class="id"><a name="R:171">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:172">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:170">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:171">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="markov">markov</a></span> (<span class="id"><a name="X:173">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span class="id"><a name="f:174">f</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) (<span class="id"><a name="eps:175">eps</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">0</span> <span class="id">&lt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#eps:175">eps</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R]</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:174">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> (<span class="gallina-kwd">forall</span> <span class="id"><a name="r:176">r,</a></span> <span class="id">0</span> <span class="id">&lt;=</span> <span class="id"><a href="mathcomp.analysis.probability.html#f:174">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:176">r</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::type_scope:'{'_'in'_x_'&'_','_x_'}'">{in</a></span> <span class="id">Num.nneg</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::type_scope:'{'_'in'_x_'&'_','_x_'}'">&amp;,</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::type_scope:'{'_'homo'_x_':'_x_x_'/'_x_'}'">{homo</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#f:174">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::type_scope:'{'_'homo'_x_':'_x_x_'/'_x_'}'">:</a></span> <span class="id"><a name="x:177">x</a></span> <span class="id"><a name="y:178">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::type_scope:'{'_'homo'_x_':'_x_x_'/'_x_'}'">/</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:177">x</a></span> <span class="id">&lt;=</span> <span class="id"><a href="mathcomp.analysis.probability.html#y:178">y}}%R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.probability.html#f:174">f</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#eps:175">eps</a></span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:181">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#eps:175">eps%:E</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'`|'_x_'|'">`|</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:173">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:181">x</a></span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'`|'_x_'|'">|</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="gallina-kwd">fun</span> <span class="id"><a name="x:182">x</a></span> <span class="id">=&gt;</span> <span class="id">`|</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:182">x</a></span> <span class="id">|%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:173">X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
<span class="id">move=&gt;</span> <span class="id">e0</span> <span class="id">mf</span> <span class="id">f0</span> <span class="id">f_nd;</span> <span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="mathcomp.classical.classical_sets.html#setTI">setTI</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id">_]</span>).<br/>
<span class="id">apply:</span> (<span class="id">le_trans</span> (<span class="id">@le_integral_comp_abse</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;<span class="id">eps</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#er_map">er_map</a></span> <span class="id">f</span>) <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">e0</span>)) <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_er_map">measurable_er_map</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">case</span> <span class="id">=&gt;</span> <span class="id">//=</span> <span class="id">r</span> <span class="id">_;</span> <span class="id">exact:</span> <span class="id">f0</span>.<br/>
<span class="id">-</span> <span class="id">move=&gt;</span> <span class="id">[x|</span> <span class="id">|]</span> <span class="id">[y|</span> <span class="id">|];</span> <span class="id">rewrite</span> <span class="id">!inE/=</span> <span class="id">!in_itv/=</span> <span class="id">?andbT</span> <span class="id">?lee_fin</span> <span class="id">?leey//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">rewrite</span> <span class="id">f_nd</span>.<br/>
<span class="id">-</span> <span class="id">exact/EFin_measurable_fun</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="mmt_gen_fun">mmt_gen_fun</a></span> (<span class="id"><a name="X:183">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span class="id"><a name="t:184">t</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[expR</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#t:184">t</a></span> <span class="id">\o*</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:183">X]</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="chernoff">chernoff</a></span> (<span class="id"><a name="X:185">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span class="id"><a name="r:186">r</a></span> <span class="id"><a name="a:187">a</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id">&lt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#r:186">r</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:188">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:185">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:188">x</a></span> <span class="id">&gt;=</span> <span class="id"><a href="mathcomp.analysis.probability.html#a:187">a]%R</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> (<span class="id"><a href="mathcomp.analysis.sequences.html#expR">expR</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#r:186">r</a></span> <span class="id">*</span> <span class="id"><a href="mathcomp.analysis.probability.html#a:187">a</a></span>))<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#mmt_gen_fun">mmt_gen_fun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:185">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:186">r</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
<span class="id">move=&gt;</span> <span class="id">t0;</span> <span class="id">rewrite</span> <span class="id">/mmt_gen_fun;</span> <span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#expR">expR</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id">r</span> <span class="id">\o*</span> <span class="id">X</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">normr</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id">normr</span>) <span class="id">\o</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::form_scope:'['_'the'_x_'of'_x_']'">[the</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.sequences.html#expR">expR</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id">r</span> <span class="id">\o*</span> <span class="id">X]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.boolp.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">t</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">normr_id</span> <span class="id">ger0_norm</span> <span class="id">?expR_ge0</span>.<br/>
<span class="id">rewrite</span> (<span class="id">le_trans</span> <span class="id">_</span> (<span class="id"><a href="mathcomp.analysis.probability.html#markov">markov</a></span> <span class="id">_</span> (<span class="id"><a href="mathcomp.analysis.exp.html#expR_gt0">expR_gt0</a></span> (<span class="id">r</span> <span class="id">*</span> <span class="id">a</span>)) <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>))<span class="id">//;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#monoW_in">monoW_in</a></span> (<span class="id">@ger0_le_norm</span> <span class="id">_</span>)).<br/>
<span class="id">rewrite</span> <span class="id">ger0_norm</span> <span class="id">?expR_ge0//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_pmul2l">lee_pmul2l//</a></span> <span class="id">?lte_fin</span> <span class="id">?expR_gt0//</span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:191">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:189">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id">a</span> <span class="id">&lt;=</span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:189">x]%R</a></span>)<span class="id">//;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#eq_set">eq_set</a></span> <span class="id">=&gt;</span> <span class="id">t/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">ger0_norm</span> <span class="id">?expR_ge0//</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id"><a href="mathcomp.analysis.exp.html#ler_expR">ler_expR</a></span>  <span class="id">mulrC</span> <span class="id">ler_pmul2r</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="chebyshev">chebyshev</a></span> (<span class="id"><a name="X:193">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span class="id"><a name="eps:194">eps</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id">&lt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#eps:194">eps</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:195">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#eps:194">eps</a></span> <span class="id">&lt;=</span> <span class="id">`|</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:193">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:195">x</a></span> <span class="id">-</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span>)<span class="id">|</span>)<span class="id">%R</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#eps:194">eps</a></span> <span class="id">^-</span> <span class="id">2</span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">heps;</span> <span class="id">have</span> <span class="id">[-&gt;|hv]</span> <span class="id">:=</span> <span class="id">eqVneq</span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:'+oo'">+oo</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mulr_infty">mulr_infty</a></span> <span class="id">gtr0_sg</span> <span class="id">?mul1e//</span> <span class="id">?leey//</span> <span class="id">invr_gt0//</span> <span class="id">exprn_gt0</span>.<br/>
<span class="id">have</span> <span class="id">h</span> (<span class="id"><a name="Y:196">Y</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:197">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> (<span class="id">eps</span> <span class="id">&lt;=</span> <span class="id">`|Y</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:197">x|</a></span>)<span class="id">%R]</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> (<span class="id">eps</span> <span class="id">^-</span> <span class="id">2</span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y</a></span> <span class="id">^+</span> <span class="id">2]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-lee_pdivr_mull;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">invr_gt0//</span> <span class="id">exprn_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">exprnN</span> <span class="id">expfV</span> <span class="id">exprz_inv</span> <span class="id">opprK</span> <span class="id">-exprnP</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">@le_trans</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[</a></span>(<span class="id">@GRing</span>.<span class="id">exp</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'^~'_x">^~</a></span> <span class="id">2%N</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id">normr</span>) <span class="id">\o</span> <span class="id">Y]</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">@markov</span> <span class="id">Y</span> (<span class="id">@GRing</span>.<span class="id">exp</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'^~'_x">^~</a></span> <span class="id">2%N</span>)) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">r;</span> <span class="id">apply:</span> <span class="id">sqr_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">y;</span> <span class="id">rewrite</span> <span class="id">!nnegrE</span> <span class="id">=&gt;</span> <span class="id">x0</span> <span class="id">y0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_sqr</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_le">expectation_le</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">measurableT_comp</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">measurableT_comp</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">apply:</span> <span class="id">sqr_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">apply:</span> <span class="id">sqr_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/aeW</span> <span class="id">=&gt;</span> <span class="id">t</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">real_normK//</span> <span class="id">num_real</span>.<br/>
<span class="id">have</span> <span class="id">:=</span> <span class="id">h</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::form_scope:'['_'the'_x_'of'_x_']'">[the</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">{mfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::form_scope:'{'_'mfun'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span> <span class="id">of</span> (<span class="id">X</span> <span class="id">\-</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span>)))<span class="id">%R]</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">/le_trans;</span> <span class="id">apply;</span> <span class="id">rewrite</span> <span class="id">/variance</span> <span class="id">[in</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leRHS">leRHS]unlock</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="cantelli">cantelli</a></span> (<span class="id"><a name="X:198">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R}</a></span>) (<span class="id"><a name="lambda:199">lambda</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:198">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:198">X</a></span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">0</span> <span class="id">&lt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#lambda:199">lambda</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:200">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#lambda:199">lambda%:E</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:198">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#x:200">x</a></span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]]</a></span><br/>
&nbsp;&nbsp;<span class="id">&lt;=</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id">/</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id">+</span> <span class="id"><a href="mathcomp.analysis.probability.html#lambda:199">lambda^2</a></span>))<span class="id">%:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
<span class="id">move=&gt;</span> <span class="id">X1</span> <span class="id">X2</span> <span class="id">lambda_gt0</span>.<br/>
<span class="id">have</span> <span class="id">finEK</span> <span class="id">:</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span>)<span class="id">%:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> <span class="id">?unlock</span> <span class="id">?integral_fune_fin_num</span>.<br/>
<span class="id">have</span> <span class="id">finVK</span> <span class="id">:</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span>)<span class="id">%:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> <span class="id">?variance_fin_num</span>.<br/>
<span class="id">pose</span> <span class="id">Y</span> <span class="id">:=</span> (<span class="id">X</span> <span class="id">\-</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span>))<span class="id">%R</span>.<br/>
<span class="id">have</span> <span class="id">Y1</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id">Y</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreBr">compreBr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableB">integrableB</a></span> <span class="id">X1</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
<span class="id">have</span> <span class="id">Y2</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id">Y</span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sqrrD/=</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">=&gt;</span> <span class="id">[//||];</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">_</span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R]/</span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> ((<span class="id">-</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span>) <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">X2</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:201">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> (<span class="id">-</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id">*</span> <span class="id">2</span>) <span class="id">\o*</span> <span class="id">X</span>)<span class="id">%R;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">-mulr_natl</span> <span class="id">mulrC</span> <span class="id">mulrA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span> <span class="id">X1</span>.<br/>
<span class="id">have</span> <span class="id">EY</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectationB">expectationB/=</a></span> <span class="id">?finite_measure_integrable_cst//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation_cst">expectation_cst</a></span> <span class="id">finEK</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#subee">subee//</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_fune_fin_num">integral_fune_fin_num</a></span> <span class="id">X1</span>.<br/>
<span class="id">have</span> <span class="id">VY</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[Y]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#varianceB_cst_r">varianceB_cst_r</a></span>.<br/>
<span class="id">have</span> <span class="id">le</span> (<span class="id"><a name="u:202">u</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.R">R</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id">&lt;=</span> <span class="id"><a href="mathcomp.analysis.probability.html#u:202">u</a></span>)<span class="id">%R</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:203">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id">lambda%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> (<span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:203">x</a></span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]]</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&lt;=</span> ((<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id">+</span> <span class="id"><a href="mathcomp.analysis.probability.html#u:202">u^2</a></span>) <span class="id">/</span> (<span class="id">lambda</span> <span class="id">+</span> <span class="id"><a href="mathcomp.analysis.probability.html#u:202">u</a></span>)<span class="id">^2</span>)<span class="id">%:E</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">uge0;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinM">EFinM</a></span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">YU1</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> (<span class="id">Y</span> <span class="id">\+</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>)<span class="id">%R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">Y1</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">YU2</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> ((<span class="id">Y</span> <span class="id">\+</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>) <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sqrrD/=</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">=&gt;</span> <span class="id">[//||];</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">_</span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R]/</span>(<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> (<span class="id">u</span> <span class="id">^+</span> <span class="id">2</span>))<span class="id">%R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreDr">compreDr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableD">integrableD</a></span> <span class="id">Y2</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:204">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> (<span class="id">2</span> <span class="id">*</span> <span class="id">u</span>) <span class="id">\o*</span> <span class="id">Y</span>)<span class="id">%R;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">-mulr_natl</span> <span class="id">mulrCA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compre_scale">compre_scale</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableZl">integrableZl</a></span> <span class="id">Y1</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id">+</span> <span class="id">u^2</span>)<span class="id">%:E</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[</a></span>(<span class="id">Y</span> <span class="id">\+</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>)<span class="id">^+2]%R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-VY</span> <span class="id">-[RHS]</span>(<span class="id">@subeK</span> <span class="id">_</span> <span class="id">_</span> ((<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[</a></span>(<span class="id">Y</span> <span class="id">\+</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>)<span class="id">%R]</span>)<span class="id">^+2</span>))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fin_numX">fin_numX</a></span> <span class="id">?unlock</span> <span class="id">?integral_fune_fin_num</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-varianceE/=</span> <span class="id">-/Y</span> <span class="id">-?expe2//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectationD">expectationD/=</a></span> <span class="id">?EY</span> <span class="id">?add0e</span> <span class="id">?expectation_cst</span> <span class="id">-?EFinM;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.ereal.html#compreBr">compreBr</a></span> <span class="id">=&gt;</span> <span class="id">[|//];</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableB">integrableB</a></span> <span class="id">X1</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#finite_measure_integrable_cst">finite_measure_integrable_cst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.probability.html#varianceD_cst_r">varianceD_cst_r</a></span> <span class="id">_</span> <span class="id">Y1</span> <span class="id">Y2</span>) <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinD">EFinD</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK</a></span> <span class="id">?</span>(<span class="id"><a href="mathcomp.analysis.probability.html#variance_fin_num">variance_fin_num</a></span> <span class="id">Y1</span> <span class="id">Y2</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">le</span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:205">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id">lambda%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> (<span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:205">x</a></span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'-'_x">-</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]]</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`&lt;=`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">[set</a></span> <span class="id"><a name="x:206">x</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> ((<span class="id">lambda</span> <span class="id">+</span> <span class="id">u</span>)<span class="id">^2</span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'<='_x">&lt;=</a></span> ((<span class="id">Y</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:206">x</a></span> <span class="id">+</span> <span class="id">u</span>)<span class="id">^+2</span>)<span class="id">%:E]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">/=</span> <span class="id">le;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin;</a></span> <span class="id">apply:</span> <span class="id">ler_expn2r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">exact:</span> <span class="id">addr_ge0</span> (<span class="id">ltW</span> <span class="id">lambda_gt0</span>) <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply/</span>(<span class="id">addr_ge0</span> <span class="id">_</span> <span class="id">uge0</span>)<span class="id">/</span>(<span class="id">le_trans</span> (<span class="id">ltW</span> <span class="id">lambda_gt0</span>) <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-lee_fin</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinB">EFinB</a></span> <span class="id">finEK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_add2r</span> <span class="id">-lee_fin</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFinB">EFinB</a></span> <span class="id">finEK</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">le_trans</span> (<span class="id"><a href="mathcomp.analysis.measure.html#le_measure">le_measure</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">le</span>)).<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-[[set</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id">_]]setTI</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#emeasurable_fun_c_infty">emeasurable_fun_c_infty</a></span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#emeasurable_funB">emeasurable_funB</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_int">measurable_int</a></span> <span class="id">X1</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-[[set</span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_'|'_x_']'">|</a></span> <span class="id">_]]setTI</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#emeasurable_fun_c_infty">emeasurable_fun_c_infty</a></span> <span class="id">=&gt;</span> <span class="id">[//|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#EFin_measurable_fun">EFin_measurable_fun</a></span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable_fun">measurable_fun</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:211">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span class="id"><a name="x:207">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:207">x</a></span> <span class="id">^+</span> <span class="id">2</span>) <span class="id">\o</span> (<span class="gallina-kwd">fun</span> <span class="id"><a name="x:208">x</a></span> <span class="id">=&gt;</span> <span class="id">Y</span> <span class="id"><a href="mathcomp.analysis.probability.html#x:208">x</a></span> <span class="id">+</span> <span class="id">u</span>))<span class="id">%R//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/measurableT_comp</span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="id">apply/measurable_funD</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-EFin_measurable_fun;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_int">measurable_int</a></span> <span class="id">Y1</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> <span class="id">eps</span> <span class="id">:=</span> ((<span class="id">lambda</span> <span class="id">+</span> <span class="id">u</span>) <span class="id">^</span> <span class="id">2</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">peps</span> <span class="id">:</span> (<span class="id">0</span> <span class="id">&lt;</span> <span class="id">eps</span>)<span class="id">%R</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">exprz_gt0</span> <span class="id">?ltr_paddr</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_pdivl_mulr">lee_pdivl_mulr</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">peps</span>) <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#eq_set">eq_set</a></span> <span class="id">=&gt;</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[leRHS]gee0_abs</span> <span class="id">?lee_fin</span> <span class="id">?sqr_ge0</span> <span class="id">-?lee_fin</span> <span class="id">=&gt;</span> <span class="id">[|//]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[</span>(<span class="id">_</span> <span class="id">^+</span> <span class="id">2</span>)<span class="id">%R]/</span>(((<span class="id">Y</span> <span class="id">\+</span> <span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">u</span>) <span class="id">^+</span> <span class="id">2</span>) <span class="id">x</span>)<span class="id">%R;</span> <span class="id">over</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#X:214">X%:E</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id">_]gtr0_norm</span> <span class="id">=&gt;</span> <span class="id">[|//]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">le_trans</span> (<span class="id"><a href="mathcomp.analysis.probability.html#markov">markov</a></span> <span class="id">_</span> <span class="id">peps</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">=&gt;</span> <span class="id">//=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">y</span> <span class="id">/[!nnegrE]</span> <span class="id">/ger0_norm-&gt;</span> <span class="id">/ger0_norm-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-/Y</span> <span class="id">le_eqVlt;</span> <span class="id">apply/orP;</span> <span class="id">left;</span> <span class="id">apply/eqP;</span> <span class="id">congr</span> <span class="id"><a href="mathcomp.analysis.probability.html#expectation">expectation</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/funeqP</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">-expr2</span> <span class="id">normr_id</span> <span class="id">ger0_norm</span> <span class="id">?sqr_ge0</span>.<br/>
<span class="id">pose</span> <span class="id">u0</span> <span class="id">:=</span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id">/</span> <span class="id">lambda</span>)<span class="id">%R</span>.<br/>
<span class="id">have</span> <span class="id">u0ge0</span> <span class="id">:</span> (<span class="id">0</span> <span class="id">&lt;=</span> <span class="id">u0</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">divr_ge0</span> (<span class="id">ltW</span> <span class="id">lambda_gt0</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id">-lee_fin</span> <span class="id">finVK</span> <span class="id"><a href="mathcomp.analysis.probability.html#variance_ge0">variance_ge0</a></span>.<br/>
<span class="id">apply:</span> <span class="id">le_trans</span> (<span class="id">le</span> <span class="id">_</span> <span class="id">u0ge0</span>) <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">lee_fin</a></span> <span class="id">le_eqVlt;</span> <span class="id">apply/orP;</span> <span class="id">left</span>.<br/>
<span class="id">rewrite</span> <span class="id">GRing.eqr_div</span><span class="id">;</span> <span class="id">[|apply:</span> <span class="id">lt0r_neq0</span>..<span class="id">];</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">exprz_gt0</span> <span class="id">-1?[ltLHS]addr0</span> <span class="id">?ltr_le_add</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">ltr_paddl</span> <span class="id">?fine_ge0</span> <span class="id">?variance_ge0</span> <span class="id">?exprz_gt0</span>.<br/>
<span class="id">apply/eqP;</span> <span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#:::'''V_'_x_'['_x_']'">'V_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> (<span class="id">u0</span> <span class="id">*</span> <span class="id">lambda</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/u0</span> <span class="id">-mulrA</span> <span class="id">mulVr</span> <span class="id">?mulr1</span> <span class="id">?unitfE</span> <span class="id">?gt_eqF</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-mulrDl</span> <span class="id">-mulrDr</span> (<span class="id">addrC</span> <span class="id">u0</span>) <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]</a></span>(<span class="id">mulrAC</span> <span class="id">u0</span>) <span class="id">-exprnP</span> <span class="id">expr2</span> <span class="id">!mulrA</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#markov_chebyshev_cantelli">markov_chebyshev_cantelli</a></span>.<br/>
<br/>
<span class="hierarchy-builder">HB.mixin</span> <span class="vernacular">Record</span> <span class="id">MeasurableFun_isDiscrete</span> <span class="id"><a name="d:215">d</a></span> (<span class="id"><a name="T:216">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:215">d</a></span>) (<span class="id"><a name="R:217">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="X:218">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#T:216">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:217">R</a></span>) <span class="id">of</span> <span class="id">@MeasurableFun</span> <span class="id"><a href="mathcomp.analysis.probability.html#d:215">d</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:216">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:217">R</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:218">X</a></span> <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id"><a name="countable_range:219">countable_range</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.cardinality.html#countable">countable</a></span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:218">X</a></span>)<br/>
<span class="id">}</span>.<br/>
<br/>
<span class="hierarchy-builder">HB.structure</span> <span class="vernacular">Definition</span> <span class="id">discreteMeasurableFun</span> <span class="id"><a name="d:224">d</a></span> (<span class="id"><a name="T:225">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:224">d</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a name="R:226">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id"><a name="X:227">X</a></span> <span class="id">of</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#isMeasurableFun">isMeasurableFun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:224">d</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:225">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:226">R</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:227">X</a></span> <span class="id">&amp;</span> <span class="id"><a href="mathcomp.analysis.probability.html#MeasurableFun_isDiscrete">MeasurableFun_isDiscrete</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:224">d</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:225">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:226">R</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:227">X</a></span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id"><a name="::form_scope:'{'_'dmfun'_x_'>->'_x_'}'">"{ 'dmfun' aT &gt;-&gt; T }"</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;(<span class="id">@discreteMeasurableFun</span>.<span class="id">type</span> <span class="id">_</span> <span class="id">aT</span> <span class="id">T</span>) <span class="id">:</span> <span class="id">form_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="discrete_random_variable">discrete_random_variable</a></span> (<span class="id"><a name="d:230">d</a></span> <span class="id">:</span> <span class="id">_</span>) (<span class="id"><a name="T:231">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:230">d</a></span>)<br/>
&nbsp;&nbsp;(<span class="id"><a name="R:232">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:233">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:231">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:232">R</a></span>) <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dmfun'_x_'>->'_x_'}'">{dmfun</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:231">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dmfun'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:232">R}</a></span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id"><a name="::form_scope:'{'_'dRV'_x_'>->'_x_'}'">"{ 'dRV' P &gt;-&gt; R }"</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;(<span class="id">@discrete_random_variable</span> <span class="id">_</span> <span class="id">_</span> <span class="id">R</span> <span class="id">P</span>) <span class="id">:</span> <span class="id">form_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a name="dRV_definitions">dRV_definitions</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id"><a name="d:234">d</a></span> (<span class="id"><a name="T:235">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:234">d</a></span>) (<span class="id"><a name="R:236">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:237">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:235">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:236">R</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="dRV_dom_enum">dRV_dom_enum</a></span> (<span class="id"><a name="X:238">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#::type_scope:'{'_x_':'_x_'&'_x_'}'">{</a></span> <span class="id"><a name="B:239">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#::type_scope:'{'_x_':'_x_'&'_x_'}'">:</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#::type_scope:'{'_x_':'_x_'&'_x_'}'">&amp;</a></span> <span class="id"><a href="mathcomp.classical.functions.html#::type_scope:'{'_'splitbij'_x_'>->'_x_'}'">{splitbij</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#B:239">B</a></span> <span class="id"><a href="mathcomp.classical.functions.html#::type_scope:'{'_'splitbij'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:238">X}}</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
<span class="id">have</span> <span class="id">/countable_bijP/cid[B]</span> <span class="id">:=</span> <span class="id">@countable_range</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">X</span>.<br/>
<span class="id">move/card_esym/ppcard_eqP/unsquash</span> <span class="id">=&gt;</span> <span class="id">f</span>.<br/>
<span class="gallina-kwd">exists</span> <span class="id">B;</span> <span class="id">exact:</span> <span class="id">f</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="dRV_dom">dRV_dom</a></span> (<span class="id"><a name="X:240">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set">set</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#projT1">projT1</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom_enum">dRV_dom_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:240">X</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="dRV_enum">dRV_enum</a></span> (<span class="id"><a name="X:241">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.R">R}</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.classical.functions.html#::type_scope:'{'_'splitbij'_x_'>->'_x_'}'">{splitbij</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:241">X</a></span>) <span class="id">&gt;-&gt;</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#range">range</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:241">X}</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#projT2">projT2</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom_enum">dRV_dom_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:241">X</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="enum_prob">enum_prob</a></span> (<span class="id"><a name="X:242">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.R">R}</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span class="id"><a name="k:243">k</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:242">X</a></span> <span class="id">@^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:242">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:243">k]</a></span>)) <span class="id">\_</span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:242">X</a></span>).<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_definitions">dRV_definitions</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a name="distribution_dRV">distribution_dRV</a></span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span class="id"><a name="d:244">d</a></span> (<span class="id"><a name="T:245">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:244">d</a></span>) (<span class="id"><a name="R:246">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:247">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:245">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:246">R</a></span>).<br/>
<span class="vernacular">Variable</span> <span class="id"><a name="distribution_dRV.X">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.R">R}</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="distribution_dRV_enum">distribution_dRV_enum</a></span> (<span class="id"><a name="n:249">n</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#n:249">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\in'_x">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:249">n]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#enum_prob">enum_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:249">n</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">nX;</span> <span class="id">rewrite</span> <span class="id">/distribution/=</span> <span class="id">/enum_prob/=</span> <span class="id"><a href="mathcomp.classical.functions.html#patchE">patchE</a></span> <span class="id">nX</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="distribution_dRV">distribution_dRV</a></span> <span class="id"><a name="A:250">A</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:250">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#distribution">distribution</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#A:250">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">\sum_</a></span>(<span class="id"><a name="k:251">k</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">&lt;oo</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#enum_prob">enum_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:251">k</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#::ring_scope:'\d_'_x">\d_</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:251">k</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#A:250">A</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
<span class="id">move=&gt;</span> <span class="id">mA;</span> <span class="id">rewrite</span> <span class="id">/distribution</span> <span class="id">/pushforward</span>.<br/>
<span class="id">have</span> <span class="id">mAX</span> <span class="id">i</span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#i:257">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurable">measurable</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id">@^-1`</span> (<span class="id">A</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:x_'`&`'_x">`&amp;`</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#i:257">i]</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setI">preimage_setI;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/measurable_sfunP</span>.<br/>
<span class="id">have</span> <span class="id">tAX</span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset">trivIset</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span>) (<span class="gallina-kwd">fun</span> <span class="id"><a name="k:258">k</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id">@^-1`</span> (<span class="id">A</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:x_'`&`'_x">`&amp;`</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:258">k]</a></span>)).<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="mathcomp.classical.boolp.html#eq_fun">eq_fun</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setI">preimage_setI;</a></span> <span class="id">rewrite</span> <span class="id">-/</span>(<span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset">trivIset</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset_setIl">trivIset_setIl;</a></span> <span class="id">apply/trivIsetP</span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">j</span> <span class="id">iX</span> <span class="id">jX</span> <span class="id">/eqP</span> <span class="id">ij</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-preimage_setI</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:x_'`&`'_x">`&amp;`</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/seteqP;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//=</span> <span class="id">x</span> <span class="id">[]</span> <span class="id">-&gt;</span> <span class="id">{x}</span> <span class="id">/inj;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span> <span class="id">=&gt;</span> <span class="id">/</span>(<span class="id">_</span> <span class="id">iX</span> <span class="id">jX</span>).<br/>
<span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.measure.html#measure_bigcup">measure_bigcup</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.P">P</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span class="id"><a name="k:259">k</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id">@^-1`</span> (<span class="id">A</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:x_'`&`'_x">`&amp;`</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#k:259">k]</a></span>)) <span class="id">mAX</span> <span class="id">tAX</span>.<br/>
<span class="id">rewrite</span> <span class="id">-preimage_bigcup</span> <span class="id">=&gt;</span> <span class="id">{mAX</span> <span class="id">tAX}PXU</span>.<br/>
<span class="id">rewrite</span> <span class="id">-{1}</span>(<span class="id"><a href="mathcomp.classical.classical_sets.html#setIT">setIT</a></span> <span class="id">A</span>) <span class="id">-</span>(<span class="id"><a href="mathcomp.classical.classical_sets.html#setUv">setUv</a></span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'\bigcup_'_'('_x_'in'_x_')'_x">\bigcup_</a></span>(<span class="id"><a name="i:260">i</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span>) <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#i:260">i]</a></span>)).<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIUr">setIUr</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setU">preimage_setU</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measureU">measureU;</a></span> <span class="id">last</span> <span class="id">3</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_setI">preimage_setI;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_sfunP">measurable_sfunP</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_sfunP">measurable_sfunP;</a></span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#bigcup_measurable">bigcup_measurable</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#measurable_sfunP">measurable_sfunP;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableI">measurableI</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableC">measurableC;</a></span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#bigcup_measurable">bigcup_measurable</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">2!preimage_setI</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIACA">setIACA</a></span> <span class="id">-!setIA</span> <span class="id">-preimage_setI</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setICr">setICr</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#preimage_set0">preimage_set0</a></span> <span class="id">2!setI0</span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'+'_x">+</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">_]</span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">0</span>) <span class="id">?adde0;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id">@^-1`</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>) <span class="id">?measure0//;</span> <span class="id">apply/disjoints_subset</span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">AXx</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setCK">setCK</a></span> <span class="id">/bigcup</span> <span class="id">/=;</span> <span class="gallina-kwd">exists</span> ((<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span>)<span class="id">^-1</span> (<span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span> <span class="id">x</span>))<span class="id">%function</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="mathcomp.classical.functions.html#funS">funS</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.functions.html#invK">invK//</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setI_bigcupr">setI_bigcupr;</a></span> <span class="id">etransitivity;</span> <span class="id">first</span> <span class="id">exact:</span> <span class="id">PXU</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eseries_mkcond">eseries_mkcond;</a></span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> <span class="id">/enum_prob</span> <span class="id"><a href="mathcomp.classical.functions.html#patchE">patchE;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">nX;</span> <span class="id">rewrite</span> <span class="id">?mul0e//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#diracE">diracE;</a></span> <span class="id">have</span> <span class="id">[kA|]</span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#boolP">boolP</a></span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\in'_x">\in</a></span> <span class="id">A</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setIidr">setIidr//</a></span> <span class="id">=&gt;</span> <span class="id">_</span> <span class="id">/=</span> <span class="id">-&gt;;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set_mem">set_mem</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_set">notin_set</a></span> <span class="id">=&gt;</span> <span class="id">kA</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span> (<span class="id"><a href="mathcomp.classical.classical_sets.html#disjoints_subset">disjoints_subset</a></span> <span class="id">_</span> <span class="id">_</span>).<span class="id">2</span> <span class="id">?preimage_set0</span> <span class="id">?measure0//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#subsetCr">subsetCr;</a></span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#sub1set">sub1set</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="sum_enum_prob">sum_enum_prob</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">\sum_</a></span>(<span class="id"><a name="n:264">n</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">&lt;oo</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#enum_prob">enum_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV.X">X</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#n:264">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id">1</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
<span class="id">have</span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV">distribution_dRV</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_setT">probability_setT/=</a></span> <span class="id">=&gt;</span> <span class="id">/esym;</span> <span class="id">apply:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#eq_trans">eq_trans</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[RHS]eseries_mkcond;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.measure.html#diracT">diracT</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV">distribution_dRV</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id"><a name="discrete_distribution">discrete_distribution</a></span>.<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="vernacular">Context</span> <span class="id"><a name="d:270">d</a></span> (<span class="id"><a name="T:271">T</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Measurable.Exports.measurableType">measurableType</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#d:270">d</a></span>) (<span class="id"><a name="R:272">R</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">realType</a></span>) (<span class="id"><a name="P:273">P</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.measure.html#Probability.Exports.probability">probability</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#T:271">T</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#R:272">R</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="dRV_expectation">dRV_expectation</a></span> (<span class="id"><a name="X:274">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:274">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">\sum_</a></span>(<span class="id"><a name="n:275">n</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">&lt;oo</a></span>) <span class="id"><a href="mathcomp.analysis.probability.html#enum_prob">enum_prob</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:274">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:275">n</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:274">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:275">n</a></span>)<span class="id">%:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
<span class="id">move=&gt;</span> <span class="id">ix;</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#unlock">unlock</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'\bigcup_'_x_x">\bigcup_k</a></span> (<span class="gallina-kwd">if</span> <span class="id"><a href="mathcomp.analysis.probability.html#k:281">k</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\in'_x">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span> <span class="gallina-kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">X</span> <span class="id">@^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#k:281">k]</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#setT">setT</a></span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/seteqP;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">t</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> ((<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span>)<span class="id">^-1%function</span> (<span class="id">X</span> <span class="id">t</span>)) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn=&gt;</a></span> <span class="id">[_|]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.functions.html#invK">invK//</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html#inE">inE</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#notin_set">notin_set/=;</a></span> <span class="id">apply;</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.classical.functions.html#funS">funS</a></span>.<br/>
<span class="id">have</span> <span class="id">tA</span> <span class="id">:</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset">trivIset</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span>) (<span class="gallina-kwd">fun</span> <span class="id"><a name="k:284">k</a></span> <span class="id">=&gt;</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#k:284">k]</a></span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">i</span> <span class="id">j</span> <span class="id">iX</span> <span class="id">jX</span> <span class="id">[r</span> <span class="id">[/=</span> <span class="id">-&gt;{r}]]</span> <span class="id">/inj;</span> <span class="id">rewrite</span> <span class="id">!inE;</span> <span class="id">exact</span>.<br/>
<span class="id">have</span> <span class="id">{tA}/trivIset_mkcond</span> <span class="id">tXA</span> <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.classical.classical_sets.html#trivIset">trivIset</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span>) (<span class="gallina-kwd">fun</span> <span class="id"><a name="k:285">k</a></span> <span class="id">=&gt;</span> <span class="id">X</span> <span class="id">@^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#k:285">k]</a></span>).<br/>
&nbsp;&nbsp;<span class="id">apply/trivIsetP</span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">i</span> <span class="id">j</span> <span class="id">iX</span> <span class="id">jX</span> <span class="id">ij</span>.<br/>
&nbsp;&nbsp;<span class="id">move/trivIsetP</span> <span class="id">:</span> <span class="id">tA</span> <span class="id">=&gt;</span> <span class="id">/</span>(<span class="id">_</span> <span class="id">i</span> <span class="id">j</span> <span class="id">iX</span> <span class="id">jX</span>) <span class="id">Aij</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-preimage_setI</span> <span class="id">Aij</span> <span class="id">?preimage_set0</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_bigcup">integral_bigcup</a></span> <span class="id">//;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">k;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply:</span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integrableS">integrableS</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT">measurableT</a></span>) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-bigcup_mkcond;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#bigcup_measurable">bigcup_measurable</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">\sum_</a></span>(<span class="id"><a name="i:286">i</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">&lt;oo</a></span>)<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::ereal_scope:'\int'_'['_x_']_'_'('_x_'in'_x_')'_x">\int[P]_</a></span>(<span class="id"><a name="x:289">x</a></span> <span class="gallina-kwd">in</span> (<span class="gallina-kwd">if</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:286">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\in'_x">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span> <span class="gallina-kwd">then</span> <span class="id">X</span> <span class="id">@^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:286">i]</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:286">i</a></span>)<span class="id">%:E</span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">iX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">=&gt;</span> <span class="id">t;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#in_setE">in_setE/=</a></span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!integral_set0</span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">\sum_</a></span>(<span class="id"><a name="i:302">i</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_')'_x">&lt;oo</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:302">i</a></span>)<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#::ereal_scope:'\int'_'['_x_']_'_'('_x_'in'_x_')'_x">\int[P]_</a></span>(<span class="id"><a name="x:305">x</a></span> <span class="gallina-kwd">in</span> (<span class="gallina-kwd">if</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:302">i</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\in'_x">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id">X</span> <span class="gallina-kwd">then</span> <span class="id">X</span> <span class="id">@^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.probability.html#i:302">i]</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#set0">set0</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">1</span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">i</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">-integralZl//;</span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">-</span> <span class="id">apply/integrableP;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> (<span class="id"><a href="mathcomp.classical.functions.html#cst">cst</a></span> <span class="id">1%E</span>))<span class="id">;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">x</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#abse1">abse1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_cst">integral_cst//;</a></span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul1e">mul1e</a></span> (<span class="id">@le_lt_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">1%E</span>) <span class="id">?ltey//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">_;</span> <span class="id">exact:</span> <span class="id"><a href="mathcomp.analysis.measure.html#probability_le1">probability_le1</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">eq_integral</a></span> <span class="id">=&gt;</span> <span class="id">y</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">mule1</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">_;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">kX</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_cst">integral_cst//=</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul1e">mul1e</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#probability_distribution">probability_distribution</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">muleC</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#distribution_dRV_enum">distribution_dRV_enum</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#integral_set0">integral_set0</a></span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule0">mule0</a></span> <span class="id">/enum_prob</span> <span class="id"><a href="mathcomp.classical.functions.html#patchE">patchE</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">kX</span>) <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul0e">mul0e</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span class="id"><a name="pmf">pmf</a></span> (<span class="id"><a name="X:318">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">{RV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'RV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R}</a></span>) (<span class="id"><a name="r:319">r</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R</a></span>) <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R</a></span> <span class="id">:=</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine">fine</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#X:318">X</a></span> <span class="id">@^-1`</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_x_']'">[set</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#r:319">r]</a></span>)).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id"><a name="expectation_pmf">expectation_pmf</a></span> (<span class="id"><a name="X:320">X</a></span> <span class="id">:</span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">{dRV</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::form_scope:'{'_'dRV'_x_'>->'_x_'}'">&gt;-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.R">R}</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.P">P</a></span>.<span class="id">-integrable</span> <span class="id"><a href="mathcomp.classical.classical_sets.html#::classical_set_scope:'['_'set'_':'_x_']'">[set:</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution.T">T]</a></span> (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#EFin">EFin</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#::fun_scope:x_'\o'_x">\o</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:320">X</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'->'_x">-&gt;</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#::ereal_scope:'''E_'_x_'['_x_']'">'E_P[X]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'='_x">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_'|'_x_')'_x">\sum_</a></span>(<span class="id"><a name="n:321">n</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#::ereal_scope:'\sum_'_'('_x_'<oo'_'|'_x_')'_x">&lt;oo</a></span> <span class="id">|</span> <span class="id"><a href="mathcomp.analysis.probability.html#n:321">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#::bool_scope:x_'\in'_x">\in</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_dom">dRV_dom</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:320">X</a></span>) (<span class="id"><a href="mathcomp.analysis.probability.html#pmf">pmf</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:320">X</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:320">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:321">n</a></span>))<span class="id">%:E</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#::ereal_scope:x_'*'_x">*</a></span> (<span class="id"><a href="mathcomp.analysis.probability.html#dRV_enum">dRV_enum</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#X:320">X</a></span> <span class="id"><a href="mathcomp.analysis.probability.html#n:321">n</a></span>)<span class="id">%:E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
<span class="id">move=&gt;</span> <span class="id">iX;</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.probability.html#dRV_expectation">dRV_expectation//</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eseries_mkcond</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="mathcomp.analysis.sequences.html#eq_eseriesr">eq_eseriesr</a></span> <span class="id">=&gt;</span> <span class="id">k</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> <span class="id">/enum_prob</span> <span class="id"><a href="mathcomp.classical.functions.html#patchE">patchE;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">kX;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul0e">mul0e</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/pmf</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fineK">fineK//</a></span> <span class="id"><a href="mathcomp.analysis.measure.html#fin_num_measure">fin_num_measure</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="mathcomp.analysis.probability.html#discrete_distribution">discrete_distribution</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
</body>
</html>
