
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module monaeImpredicativeSet.istate_lib</title>
<meta name="description" content="Documentation of Coq module monaeImpredicativeSet.istate_lib" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="monae"><summary>monae</summary>
          <ul>
          <li><a href="monae.altprob_model.html">altprob_model</a></li>
<li><a href="monae.array_lib.html">array_lib</a></li>
<li><a href="monae.category.html">category</a></li>
<li><a href="monae.category_ext.html">category_ext</a></li>
<li><a href="monae.example_iquicksort.html">example_iquicksort</a></li>
<li><a href="monae.example_monty.html">example_monty</a></li>
<li><a href="monae.example_nqueens.html">example_nqueens</a></li>
<li><a href="monae.example_quicksort.html">example_quicksort</a></li>
<li><a href="monae.example_relabeling.html">example_relabeling</a></li>
<li><a href="monae.example_spark.html">example_spark</a></li>
<li><a href="monae.example_transformer.html">example_transformer</a></li>
<li><a href="monae.example_typed_store.html">example_typed_store</a></li>
<li><a href="monae.fail_lib.html">fail_lib</a></li>
<li><a href="monae.gcm_model.html">gcm_model</a></li>
<li><a href="monae.hierarchy.html">hierarchy</a></li>
<li><a href="monae.monad_composition.html">monad_composition</a></li>
<li><a href="monae.monad_lib.html">monad_lib</a></li>
<li><a href="monae.monad_model.html">monad_model</a></li>
<li><a href="monae.monad_transformer.html">monad_transformer</a></li>
<li><a href="monae.monae_lib.html">monae_lib</a></li>
<li><a href="monae.proba_lib.html">proba_lib</a></li>
<li><a href="monae.proba_monad_model.html">proba_monad_model</a></li>
<li><a href="monae.smallstep.html">smallstep</a></li>
<li><a href="monae.state_lib.html">state_lib</a></li>
<li><a href="monae.trace_lib.html">trace_lib</a></li>
<li><a href="monae.typed_store_lib.html">typed_store_lib</a></li>
<li><a href="monae.typed_store_model.html">typed_store_model</a></li>
          </ul>
          </details>
          </li>
<li><details id="monaeImpredicativeSet"><summary>monaeImpredicativeSet</summary>
          <ul>
          <li><a href="monaeImpredicativeSet.iexample_transformer.html">iexample_transformer</a></li>
<li><a href="monaeImpredicativeSet.ifail_lib.html">ifail_lib</a></li>
<li><a href="monaeImpredicativeSet.ifmt_lifting.html">ifmt_lifting</a></li>
<li><a href="monaeImpredicativeSet.ihierarchy.html">ihierarchy</a></li>
<li><a href="monaeImpredicativeSet.imonad_composition.html">imonad_composition</a></li>
<li><a href="monaeImpredicativeSet.imonad_lib.html">imonad_lib</a></li>
<li><a href="monaeImpredicativeSet.imonad_model.html">imonad_model</a></li>
<li><a href="monaeImpredicativeSet.imonad_transformer.html">imonad_transformer</a></li>
<li><a href="monaeImpredicativeSet.imonae_lib.html">imonae_lib</a></li>
<li><a href="monaeImpredicativeSet.iparametricity_codensity.html">iparametricity_codensity</a></li>
<li><a href="monaeImpredicativeSet.istate_lib.html">istate_lib</a></li>
<li><a href="monaeImpredicativeSet.itrace_lib.html">itrace_lib</a></li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module monaeImpredicativeSet.istate_lib</h1>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html">imonae_lib</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">HB</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for HB.structures">structures</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html">ihierarchy</a></span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html">imonad_lib</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html">ifail_lib</a></span>.<br/>
<br/>
<pre class="ssrdoc">
             Definitions and lemmas about state monads                     
                                                                           
         overwrite s a := put s &gt;&gt; Ret s                                   
             protect n := get &gt;&gt;= (fun x =&gt; n &gt;&gt;= overwrite x)             
                scanlM == see section 4.1, mu2019tr3                       
       scanlM_of_scanl == see theorem 4.1, mu2019tr3                       
             theorem44 == see mu2019tr3                                    
                                                                           
</pre>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Printing</span> <span class="vernacular">Implicit</span> <span class="vernacular">Defensive</span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">monae_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="putgetput" class="id"><a name="putgetput" class="">putgetput</a></span> (<span id="S:1" class="id"><a name="S:1" class="">S</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadState.Exports.stateMonad">stateMonad</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:1">S}</a></span> <span id="x:3" class="id"><a name="x:3" class="">x</a></span> <span class="id">{B}</span> (<span id="k:5" class="id"><a name="k:5" class="">k</a></span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:2">M</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#B:4">B</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:3">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x':6" class="id"><a name="x':6" class="">x'</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#k:5">k</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x':6">x'</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:3">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#k:5">k</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:3">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:2">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#putget">putget</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="overwrite" class="id"><a name="overwrite" class="">overwrite</a></span> <span class="id">{A</span> <span id="S:8" class="id"><a name="S:8" class="">S}</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadState.Exports.stateMonad">stateMonad</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:8">S}</a></span> <span id="s:10" class="id"><a name="s:10" class="">s</a></span> <span id="a:11" class="id"><a name="a:11" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:9">M</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:7">A</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:10">s</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#a:11">a</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="protect" class="id"><a name="protect" class="">protect</a></span> <span class="id">{A</span> <span id="S:13" class="id"><a name="S:13" class="">S}</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadState.Exports.stateMonad">stateMonad</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:13">S}</a></span> (<span id="n:15" class="id"><a name="n:15" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:14">M</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:12">A</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="ini:16" class="id"><a name="ini:16" class="">ini</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#n:15">n</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#overwrite">overwrite</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ini:16">ini</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="protect_put_ret" class="id"><a name="protect_put_ret" class="">protect_put_ret</a></span> <span class="id">{A</span> <span id="S:18" class="id"><a name="S:18" class="">S</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0}</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadState.Exports.stateMonad">stateMonad</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:18">S}</a></span> (<span id="s:20" class="id"><a name="s:20" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:18">S</a></span>) (<span id="a:21" class="id"><a name="a:21" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:17">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#protect">protect</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:20">s</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#a:21">a</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#a:21">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:19">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">rewrite</span> <span class="id">/protect</span>.<br/>
<span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/overwrite</span>.<br/>
<span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">-bindA</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#putput">putput</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-bindA</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#getputskip">getputskip</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindskipf">bindskipf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Example</span> <span id="test_nonce0" class="id"><a name="test_nonce0" class="">test_nonce0</a></span> (<span id="M:22" class="id"><a name="M:22" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadState.Exports.stateMonad">stateMonad</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:22">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="s:23" class="id"><a name="s:23" class="">s</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:23">s</a></span>.<span class="id">+1</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:23">s</a></span>).<br/>
<br/>
<span class="vernacular">Section</span> <span id="stateloop_examples" class="id"><a name="stateloop_examples" class="">stateloop_examples</a></span>.<br/>
<span class="vernacular">Variable</span> (<span id="stateloop_examples.M" class="id"><a name="stateloop_examples.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadStateLoop.Exports.loopStateMonad">loopStateMonad</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>).<br/>
<span class="vernacular">Let</span> <span id="stateloop_examples.example" class="id"><a name="stateloop_examples.example" class="">example</a></span> <span id="min:25" class="id"><a name="min:25" class="">min</a></span> <span id="max:26" class="id"><a name="max:26" class="">max</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#stateloop_examples.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#foreach">foreach</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#max:26">max</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#min:25">min</a></span> (<span class="gallina-kwd">fun</span> <span id="i:27" class="id"><a name="i:27" class="">i</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#tt">tt</a></span>).<br/>
<span class="vernacular">Let</span> <span id="stateloop_examples.sum" class="id"><a name="stateloop_examples.sum" class="">sum</a></span> <span id="n:28" class="id"><a name="n:28" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#stateloop_examples.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#foreach">foreach</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#n:28">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="i:29" class="id"><a name="i:29" class="">i</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="z:30" class="id"><a name="z:30" class="">z</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#z:30">z</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#i:29">i</a></span>))).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="sum_test" class="id"><a name="sum_test" class="">sum_test</a></span> <span id="n:31" class="id"><a name="n:31" class="">n</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#stateloop_examples.sum">sum</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#n:31">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="m:32" class="id"><a name="m:32" class="">m</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#m:32">m</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#sumn">sumn</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#iota">iota</a></span> <span class="id">0</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#n:31">n</a></span>))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
<span class="id">elim:</span> <span class="id">n</span> <span class="id">=&gt;</span> <span class="id">[|n</span> <span class="id">ih]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/sum</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#loop0">loop0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#sumn">sumn</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#iota">iota</a></span> <span class="id">0</span> <span class="id">0</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">0</span>) <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[LHS]bindskipf</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-getputskip</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addn0">addn0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[RHS]bindmret</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">case</span>.<br/>
<span class="id">rewrite</span> <span class="id">{1}/sum</span> <span class="id">-add1n</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#loop1">loop1</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">m</span>.<br/>
<span class="id">rewrite</span> <span class="id">-/</span>(<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#stateloop_examples.sum">sum</a></span> <span class="id">n</span>) <span class="id">{}ih</span> <span class="id">-bindA</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#putget">putget</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#putput">putput</a></span>.<br/>
<span class="id">congr</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#add0n">add0n</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addnC">addnC</a></span> <span class="id">1</span>) <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#iotaD">iotaD</a></span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#sumn_cat">sumn_cat</a></span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#add0n">add0n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addn0">addn0</a></span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addnAC">addnAC</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addnA">addnA</a></span>.<br/>
Qed.</div>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#stateloop_examples">stateloop_examples</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="getput_prepend" class="id"><a name="getput_prepend" class="">getput_prepend</a></span> (<span id="S:33" class="id"><a name="S:33" class="">S</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="M:34" class="id"><a name="M:34" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadNondetState.Exports.nondetStateMonad">nondetStateMonad</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:33">S</a></span>) <span id="A:35" class="id"><a name="A:35" class="">A</a></span> (<span id="m:36" class="id"><a name="m:36" class="">m</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:34">M</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:35">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#m:36">m</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x:37" class="id"><a name="x:37" class="">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:37">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#m:36">m</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-{2}</span>(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindskipf">bindskipf</a></span> <span class="id">m</span>) <span class="id">-bindA</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#getputskip">getputskip</a></span> <span class="id">2!bindskipf</span>. Qed.</div>
<br/>
<br/>
<span class="vernacular">Section</span> <span id="loop" class="id"><a name="loop" class="">loop</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="loop.A" class="id"><a name="loop.A" class="">A</a></span> <span id="loop.S" class="id"><a name="loop.S" class="">S</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="loop.M" class="id"><a name="loop.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadState.Exports.stateMonad">stateMonad</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:38">S</a></span>) (<span id="loop.op" class="id"><a name="loop.op" class="">op</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:38">S</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:39">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:38">S</a></span>).<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="opmul" class="id"><a name="opmul" class="">opmul</a></span> <span id="x:42" class="id"><a name="x:42" class="">x</a></span> <span id="m:43" class="id"><a name="m:43" class="">m</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.M">M</a></span> <span class="id">_</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="gallina-kwd">fun</span> <span id="st:44" class="id"><a name="st:44" class="">st</a></span> <span class="id">=&gt;</span> <span class="gallina-kwd">let</span> <span id="st':45" class="id"><a name="st':45" class="">st'</a></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:44">st</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:42">x</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st':45">st'</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st':45">st'</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#m:43">m</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="scanlM" class="id"><a name="scanlM" class="">scanlM</a></span> <span id="s:46" class="id"><a name="s:46" class="">s</a></span> <span id="xs:47" class="id"><a name="xs:47" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.S">S</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="mul:50" class="id"><a name="mul:50" class="">mul</a></span> <span id="x:48" class="id"><a name="x:48" class="">x</a></span> <span id="m:49" class="id"><a name="m:49" class="">m</a></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opmul">opmul</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:48">x</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#m:49">m</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:46">s</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#mul:50">mul</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:47">xs</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="scanlM_nil" class="id"><a name="scanlM_nil" class="">scanlM_nil</a></span> <span id="s:51" class="id"><a name="s:51" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#scanlM">scanlM</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:51">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:51">s</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="loop.scanlM_of_scanl_helper" class="id"><a name="loop.scanlM_of_scanl_helper" class="">scanlM_of_scanl_helper</a></span> <span id="s:52" class="id"><a name="s:52" class="">s</a></span><br/>
&nbsp;&nbsp;(<span id="ms:53" class="id"><a name="ms:53" class="">ms</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.S">S</a></span>) (<span id="mu:54" class="id"><a name="mu:54" class="">mu</a></span> <span id="mu':55" class="id"><a name="mu':55" class="">mu'</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="m:56" class="id"><a name="m:56" class="">m</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.S">S</a></span>)) (<span id="f:57" class="id"><a name="f:57" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.S">S</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:58" class="id"><a name="x:58" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ms:53">ms;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#mu:54">mu</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="xs:59" class="id"><a name="xs:59" class="">xs</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:52">s</a></span>) (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#mu':55">mu'</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#m:56">m</a></span>)<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#f:57">f</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:58">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:59">xs</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:52">s</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:60" class="id"><a name="x:60" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ms:53">ms;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#mu:54">mu</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#mu':55">mu'</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="xs:61" class="id"><a name="xs:61" class="">xs</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#m:56">m;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#f:57">f</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:60">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:61">xs</a></span>)))%<span class="id">Do</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]fmapE</a></span> <span class="id">!bindA</span>.<br/>
<span class="id">under</span> <span class="id">[RHS]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s'</span>.<br/>
<span class="id">rewrite</span> <span class="id">!bindA;</span> <span class="id">bind_ext;</span> <span class="id">case</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bind_fmap">bind_fmap</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA;</a></span> <span class="id">bind_ext;</span> <span class="id">case</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id">[RHS]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="scanlM_of_scanl" class="id"><a name="scanlM_of_scanl" class="">scanlM_of_scanl</a></span> <span id="s:62" class="id"><a name="s:62" class="">s</a></span> <span id="xs:63" class="id"><a name="xs:63" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#scanl">scanl</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:62">s</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:63">xs</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#protect">protect</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#scanlM">scanlM</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:62">s</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:63">xs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">elim:</span> <span class="id">xs</span> <span class="id">s</span> <span class="id">=&gt;</span> <span class="id">[/=|x</span> <span class="id">xs</span> <span class="id">IH]</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#scanlM_nil">scanlM_nil</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#protect_put_ret">protect_put_ret</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/scanlM</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]/=</a></span>.<br/>
<span class="id">set</span> <span class="id">mul</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> (<span id="a:68" class="id"><span id="a:66" class="id"><span id="a:64" class="id"><a name="a:68" class="">a</a></span></span></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.A">A</a></span>) <span id="m:69" class="id"><span id="m:67" class="id"><span id="m:65" class="id"><a name="m:69" class="">m</a></span></span></span> <span class="id">=&gt;</span> <span class="id">_</span>.<br/>
<span class="id">under</span> <span class="id">[RHS]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">-!bindA</span>.<br/>
<span class="comment">(*&nbsp;TODO(rei):&nbsp;tactic&nbsp;for&nbsp;nested&nbsp;function&nbsp;bodies?&nbsp;*)</span><br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="y:73" class="id"><span id="y:70" class="id"><a name="y:73" class="">y</a></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get;</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id">s</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span>) <span class="id">&gt;&gt;=</span> <span class="gallina-kwd">fun</span> <span id="z:74" class="id"><span id="z:71" class="id"><a name="z:74" class="">z</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="a:75" class="id"><span id="a:72" class="id"><a name="a:75" class="">a</a></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#z:71">z</a></span> <span class="id">x</span>)) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#z:71">z</a></span> <span class="id">x</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> <span class="id">mul</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id">xs</span>)<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#y:70">y</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#a:72">a</a></span>)%<span class="id">Do;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id">[LHS]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">-!bindA</span>.<br/>
<span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#putget">putget</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.scanlM_of_scanl_helper">scanlM_of_scanl_helper</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.op">op</a></span> <span class="id">s</span> <span class="id">x</span>)) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="y:78" class="id"><span id="y:76" class="id"><a name="y:78" class="">y</a></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.op">op</a></span> <span class="id">s</span> <span class="id">x</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="a:79" class="id"><span id="a:77" class="id"><a name="a:79" class="">a</a></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> <span class="id">mul</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id">xs;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#y:76">y</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#a:77">a</a></span>)))%<span class="id">Do;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">congr</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">_</a></span>)<span class="id">;</span> <span class="id">under</span> <span class="id">[RHS]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#putput">putput</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.op">op</a></span> <span class="id">s</span> <span class="id">x</span>)) (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#protect">protect</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#scanlM">scanlM</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop.op">op</a></span> <span class="id">s</span> <span class="id">x</span>) <span class="id">xs</span>)))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">congr</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">_</a></span>)<span class="id">;</span> <span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">-bindA</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-IH</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#loop">loop</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#scanlM">scanlM</a></span> <span class="id">{A</span> <span class="id">S</span> <span class="id">M}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="section43" class="id"><a name="section43" class="">section43</a></span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span id="section43.S" class="id"><a name="section43.S" class="">S</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="section43.M" class="id"><a name="section43.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadNondetState.Exports.nondetStateMonad">nondetStateMonad</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:80">S</a></span>).<br/>
<span class="vernacular">Variables</span> (<span id="section43.A" class="id"><a name="section43.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="section43.op" class="id"><a name="section43.op" class="">op</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.S">S</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:82">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.S">S</a></span>) (<span id="section43.ok" class="id"><a name="section43.ok" class="">ok</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.S">S</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="assert_all_scanl" class="id"><a name="assert_all_scanl" class="">assert_all_scanl</a></span> <span id="s:85" class="id"><a name="s:85" class="">s</a></span> (<span id="xs:86" class="id"><a name="xs:86" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.A">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#assert">assert</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#scanl">scanl</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:85">s</a></span>) <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:86">xs</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#protect">protect</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#scanlM">scanlM</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:85">s</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:86">xs</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="ys:87" class="id"><a name="ys:87" class="">ys</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ys:87">ys</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:86">xs</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#assertE">assertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardsC">guardsC;</a></span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindmfail">bindmfail</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#protect">protect</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#scanlM">scanlM</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id">s</span> <span class="id">xs</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="ys:89" class="id"><span id="ys:88" class="id"><a name="ys:89" class="">ys</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ys:88">ys</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">xs</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-!bindA</span> <span class="id">-scanlM_of_scanl</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id">!bindretf</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#assertE">assertE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]/protect</a></span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">st</span>.<br/>
<span class="id">rewrite</span> <span class="id">2!bindA;</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">xs'</span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]bindA</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]guardsC;</a></span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindmfail">bindmfail</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/overwrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA;</a></span> <span class="id">bind_ext;</span> <span class="id">case</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#assertE">assertE</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="put_foldr" class="id"><a name="put_foldr" class="">put_foldr</a></span> <span id="st:90" class="id"><a name="st:90" class="">st</a></span> <span id="x:91" class="id"><a name="x:91" class="">x</a></span> <span id="xs:92" class="id"><a name="xs:92" class="">xs</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:90">st</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:91">x</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x1:93" class="id"><a name="x1:93" class="">x1</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opmul">opmul</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:92">xs;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x1:93">x1</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:90">st</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:91">x</a></span>)))%<span class="id">Do</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:90">st</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:91">x</a></span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:90">st</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:91">x</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="ys:94" class="id"><a name="ys:94" class="">ys</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opmul">opmul</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:92">xs;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ys:94">ys</a></span>))%<span class="id">Do</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
<span class="id">elim:</span> <span class="id">xs</span> <span class="id">x</span> <span class="id">=&gt;</span> <span class="id">[x|h</span> <span class="id">t</span> <span class="id">_</span> <span class="id">x]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardT">guardT</a></span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindskipf">bindskipf</a></span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#skip">skip</a></span>) <span class="id">//=</span> <span class="id">?guardT</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindmskip">bindmskip;</a></span> <span class="id">case:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardPn">guardPn</a></span> <span class="id">=&gt;</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindskipf">bindskipf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindmskip">bindmskip</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindmfail">bindmfail</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindfailf">bindfailf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/=</span> <span class="id">!bindA</span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id">st</span> <span class="id">x</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x0:98" class="id"><span id="x0:95" class="id"><a name="x0:98" class="">x0</a></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x1:100" class="id"><span id="x1:97" class="id"><a name="x1:100" class="">x1</a></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="gallina-kwd">let</span> <span id="st':99" class="id"><span id="st':96" class="id"><a name="st':99" class="">st'</a></span></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x0:95">x0</a></span> <span class="id">h</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st':96">st'</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st':96">st'</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opmul">opmul</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id">t</span>)<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id">st</span> <span class="id">x</span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x1:97">x1</a></span>))%<span class="id">Do</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">bind_ext;</span> <span class="id">case</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">st'</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-guard_and</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard_and">guard_and</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardsC">guardsC;</a></span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindmfail">bindmfail</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
<span class="id">bind_ext;</span> <span class="id">case</span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">st'</span>.<br/>
<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardsC">guardsC</a></span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindmfail">bindmfail</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="section43.B" class="id"><a name="section43.B" class="">B</a></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.A">A</a></span>.<br/>
<span class="vernacular">Let</span> <span id="section43.res" class="id"><a name="section43.res" class="">res</a></span> <span class="id">:=</span> @<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.A">A</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="opdot" class="id"><a name="opdot" class="">opdot</a></span> (<span id="a:101" class="id"><a name="a:101" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.A">A</a></span>) (<span id="m:102" class="id"><a name="m:102" class="">m</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.B">B</a></span>)) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.B">B</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="st:103" class="id"><a name="st:103" class="">st</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:103">st</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#a:101">a</a></span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:103">st</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#a:101">a</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.res">res</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#a:101">a</a></span>) <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#m:102">m</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="theorem44" class="id"><a name="theorem44" class="">theorem44</a></span> (<span id="xs:104" class="id"><a name="xs:104" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.A">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opmul">opmul</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:104">xs</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="ys:105" class="id"><a name="ys:105" class="">ys</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ys:105">ys</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:104">xs</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opdot">opdot</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:104">xs</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">elim:</span> <span class="id">xs</span> <span class="id">=&gt;</span> <span class="id">[|x</span> <span class="id">xs</span> <span class="id">IH];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardT">guardT</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindskipf">bindskipf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]/=</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">{1}/opmul</span>.<br/>
<span class="id">rewrite</span> <span class="id">{1}bindA</span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x0:108" class="id"><span id="x0:106" class="id"><a name="x0:108" class="">x0</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x0:106">x0</a></span> <span class="id">x</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opmul">opmul</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id">xs</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="ys:109" class="id"><span id="ys:107" class="id"><a name="ys:109" class="">ys</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x0:106">x0</a></span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ys:107">ys</a></span>))) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">st</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bind_fmap">bind_fmap</a></span> <span class="id">!bindA</span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x0:112" class="id"><span id="x0:110" class="id"><a name="x0:112" class="">x0</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x0:110">x0</a></span> <span class="id">x</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opmul">opmul</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id">xs</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="ys:113" class="id"><span id="ys:111" class="id"><a name="ys:113" class="">ys</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ys:111">ys</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x0:110">x0</a></span> <span class="id">x</span>))) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">st</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext;</span> <span class="id">case</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-guard_and</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-cat1s</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all_cat">all_cat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">andbC</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all_seq1">all_seq1</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="st:116" class="id"><span id="st:114" class="id"><a name="st:116" class="">st</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:114">st</a></span> <span class="id">x</span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:114">st</a></span> <span class="id">x</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opmul">opmul</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id">xs</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="ys:117" class="id"><span id="ys:115" class="id"><a name="ys:117" class="">ys</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ys:115">ys</a></span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">st</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-!bindA</span>.<br/>
&nbsp;&nbsp;<span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#put_foldr">put_foldr</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="st:120" class="id"><span id="st:118" class="id"><a name="st:120" class="">st</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:118">st</a></span> <span class="id">x</span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#st:118">st</a></span> <span class="id">x</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">x</span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#opmul">opmul</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.op">op</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id">xs</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="ys:121" class="id"><span id="ys:119" class="id"><a name="ys:121" class="">ys</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#all">all</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.ok">ok</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#ys:119">ys</a></span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">xs</span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43.M">M</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">st</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext;</span> <span class="id">case</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext;</span> <span class="id">case</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!fmap_bind</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmap_bind">fmap_bind</a></span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext;</span> <span class="id">case</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]/=</a></span> <span class="id">-IH</span> <span class="id">/opdot</span> <span class="id">!bindA</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#section43">section43</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="promotable" class="id"><a name="promotable" class="">promotable</a></span> (<span id="A:122" class="id"><a name="A:122" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="p:123" class="id"><a name="p:123" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:122">A</a></span>)) (<span id="q:124" class="id"><a name="q:124" class="">q</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:122">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:122">A</a></span>)) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="s:125" class="id"><a name="s:125" class="">s</a></span> <span id="t:126" class="id"><a name="t:126" class="">t,</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:123">p</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:125">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:123">p</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#t:126">t</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:123">p</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:125">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#t:126">t</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#q:124">q</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:125">s,</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#t:126">t</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="segment_closed_suffix" class="id"><a name="segment_closed_suffix" class="">segment_closed_suffix</a></span> (<span id="A:127" class="id"><a name="A:127" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="p:128" class="id"><a name="p:128" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#segment_closed.t">segment_closed.t</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:127">A</a></span>) <span id="s:129" class="id"><a name="s:129" class="">s</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b3ebd0deddd84fd60e149cb5ef719351">~~</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:128">p</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:129">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">forall</span> <span id="t:130" class="id"><a name="t:130" class="">t,</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b3ebd0deddd84fd60e149cb5ef719351">~~</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:128">p</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:129">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#t:130">t</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="id">move=&gt;</span> <span class="id">ps</span> <span class="id">t;</span> <span class="id">apply:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#contra">contra</a></span> <span class="id">ps;</span> <span class="gallina-kwd">by</span> <span class="id">case/segment_closed</span>.<span class="id">H</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="segment_closed_prefix" class="id"><a name="segment_closed_prefix" class="">segment_closed_prefix</a></span> (<span id="A:131" class="id"><a name="A:131" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="p:132" class="id"><a name="p:132" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#segment_closed.t">segment_closed.t</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:131">A</a></span>) <span id="s:133" class="id"><a name="s:133" class="">s</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b3ebd0deddd84fd60e149cb5ef719351">~~</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:132">p</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:133">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="gallina-kwd">forall</span> <span id="t:134" class="id"><a name="t:134" class="">t,</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b3ebd0deddd84fd60e149cb5ef719351">~~</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:132">p</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#t:134">t</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:133">s</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
 <span class="id">move=&gt;</span> <span class="id">ps</span> <span class="id">t;</span> <span class="id">apply:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#contra">contra</a></span> <span class="id">ps;</span> <span class="gallina-kwd">by</span> <span class="id">case/segment_closed</span>.<span class="id">H</span>. Qed.</div>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<span class="vernacular">Definition</span> <span id="promote_assert" class="id"><a name="promote_assert" class="">promote_assert</a></span> (<span id="M:135" class="id"><a name="M:135" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFail.Exports.failMonad">failMonad</a></span>) (<span id="A:136" class="id"><a name="A:136" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>)<br/>
&nbsp;&nbsp;(<span id="p:137" class="id"><a name="p:137" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:136">A</a></span>)) (<span id="q:138" class="id"><a name="q:138" class="">q</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:136">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:136">A</a></span>)) <span class="id">:=</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bassert">bassert</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:137">p</a></span>) <span class="id">\o</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#ucat">ucat</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#mpair">mpair</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#ucat">ucat</a></span>) <span class="id">\o</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bassert">bassert</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#q:138">q</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#mpair">mpair</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bassert">bassert</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:137">p</a></span>)<span class="id">^`2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:135">M</a></span> <span class="id">_</span>).<br/>
<span class="vernacular">Local</span> <span class="vernacular">Close</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="promote_assert_sufficient_condition" class="id"><a name="promote_assert_sufficient_condition" class="">promote_assert_sufficient_condition</a></span> (<span id="M:139" class="id"><a name="M:139" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFail.Exports.failMonad">failMonad</a></span>) (<span id="A:140" class="id"><a name="A:140" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#BindLaws.right_zero">BindLaws.right_zero</a></span> (@<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bind">bind</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:139">M</a></span>) (@<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail</a></span> <span class="id">_</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span id="p:141" class="id"><a name="p:141" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#segment_closed.t">segment_closed.t</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:140">A</a></span>) <span id="q:142" class="id"><a name="q:142" class="">q,</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#promotable">promotable</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:141">p</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#q:142">q</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#promote_assert">promote_assert</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:139">M</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#p:141">p</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#q:142">q</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">move=&gt;</span> <span class="id">right_z</span> <span class="id">p</span> <span class="id">q</span> <span class="id">promotable_pq</span>.<br/>
<span class="id">rewrite</span> <span class="id">/promote_assert;</span> <span class="id">apply:</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">-[x1</span> <span class="id">x2]</span>.<br/>
<span class="id">rewrite</span> <span class="id">3![in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]compE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]fmapE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">2![in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]compE</a></span> <span class="id">{1}/bassert</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]bind_fmap</a></span> <span class="id">!bindA</span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA;</a></span> <span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">case:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#assertPn">assertPn</a></span> <span class="id">=&gt;</span> <span class="id">ps;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindfailf">bindfailf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">With</span> (<span class="id">idtac</span>) <span class="vernacular">Open</span> (<span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#X:143">X</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/assert;</span> <span class="id">unlock</span> <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#segment_closed_suffix">segment_closed_suffix</a></span> <span class="id">ps</span> <span class="id">x</span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardF">guardF</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindfailf">bindfailf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">right_z</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id">/=</span>.<br/>
<span class="id">under</span> <span class="id">[RHS]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">t</span>.<br/>
<span class="id">case:</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#assertPn">assertPn</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">t</span>) <span class="id">=&gt;</span> <span class="id">pt;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindfailf">bindfailf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#assertE">assertE</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#segment_closed_prefix">segment_closed_prefix</a></span> <span class="id">pt</span> <span class="id">s</span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardF">guardF</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindfailf">bindfailf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">/=</span>  <span class="id">2!assertE</span> <span class="id">promotable_pq</span> <span class="id">//=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Section</span> <span id="examples_promotable_segment_closed" class="id"><a name="examples_promotable_segment_closed" class="">examples_promotable_segment_closed</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="is_iota" class="id"><a name="is_iota" class="">is_iota</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#27dabc72ea2c2c768f2db80a79f42524">[pred</a></span> <span id="x:144" class="id"><a name="x:144" class="">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#27dabc72ea2c2c768f2db80a79f42524">|</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:144">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#iota">iota</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#head">head</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:144">x</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:144">x</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#27dabc72ea2c2c768f2db80a79f42524">]</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="is_iota_head_last" class="id"><a name="is_iota_head_last" class="">is_iota_head_last</a></span> <span id="s:145" class="id"><a name="s:145" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#is_iota">is_iota</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:145">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:145">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#head">head</a></span> <span class="id">0</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:145">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:145">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#last">last</a></span> <span class="id">0</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#s:145">s</a></span>).<span class="id">+1</span>.<br/>
<span class="id">elim:</span> <span class="id">s</span> <span class="id">=&gt;</span> <span class="id">//=</span> <span class="id">a</span> <span class="id">[_</span> <span class="id">/=|c</span> <span class="id">d</span> <span class="id">IH]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addn1">addn1</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/is_iota</span> <span class="id">/=</span> <span class="id">=&gt;</span> <span class="id">/eqP[]</span> <span class="id">?;</span> <span class="id">subst</span> <span class="id">c</span> <span class="id">=&gt;</span> <span class="id">Hd</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> <span class="id">/=</span> <span class="gallina-kwd">in</span> <span class="id">IH</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-IH</span> <span class="id">//</span> <span class="id">-?addSnnS</span> <span class="id">//</span> <span class="id">/is_iota</span> <span class="id">/=</span> <span class="id">-Hd</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="are_adjacent" class="id"><a name="are_adjacent" class="">are_adjacent</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>)%<span class="id">type</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#27dabc72ea2c2c768f2db80a79f42524">[pred</a></span> <span id="xy:146" class="id"><a name="xy:146" class="">xy</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#27dabc72ea2c2c768f2db80a79f42524">|</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#6e3f5b731a46299b833a2834f381d536">[||</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xy:146">xy</a></span>.<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#6e3f5b731a46299b833a2834f381d536">,</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xy:146">xy</a></span>.<span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#6e3f5b731a46299b833a2834f381d536">|</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#last">last</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xy:146">xy</a></span>.<span class="id">1</span>).<span class="id">+1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#head">head</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xy:146">xy</a></span>.<span class="id">2]]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="promotable_enum" class="id"><a name="promotable_enum" class="">promotable_enum</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#promotable">promotable</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#is_iota">is_iota</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#are_adjacent">are_adjacent</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">move=&gt;</span> <span class="id">s</span> <span class="id">t</span> <span class="id">Hs</span> <span class="id">Ht</span>.<br/>
<span class="id">rewrite</span> <span class="id">/is_iota</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_cat">size_cat</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#iotaD">iotaD</a></span>.<br/>
<span class="id">case/boolP</span> <span class="id">:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nilp">nilp</a></span> <span class="id">s</span>) <span class="id">=&gt;</span> <span class="id">[/nilP</span> <span class="id">-&gt;{Hs</span> <span class="id">s}</span> <span class="id">/=|s0];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addn0">addn0</a></span> <span class="id">/are_adjacent</span>.<br/>
<span class="id">rewrite</span> <span class="id">/nilp</span> <span class="id">-lt0n</span> <span class="gallina-kwd">in</span> <span class="id">s0</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#head">head</a></span> <span class="id">0</span> (<span class="id">s</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">t</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#head">head</a></span> <span class="id">0</span> <span class="id">s</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-nth0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nth_cat">nth_cat</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#sub0n">sub0n</a></span> <span class="id">s0</span>.<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#eqP">eqP</a></span> <span class="id">Hs</span>) <span class="id">/are_adjacent</span> <span class="id">/=</span> <span class="id">-size_eq0</span> <span class="id">-</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbK">negbK</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">s</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id">_</span>)) <span class="id">-lt0n</span> <span class="id">s0</span> <span class="id">/=</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#eqseq_cat">eqseq_cat</a></span> <span class="id">//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#eqxx">eqxx</a></span> <span class="id">/=</span>.<br/>
<span class="id">case/boolP</span> <span class="id">:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nilp">nilp</a></span> <span class="id">t</span>) <span class="id">=&gt;</span> <span class="id">[/nilP</span> <span class="id">{Ht}</span> <span class="id">-&gt;{t}</span> <span class="id">//|t0]</span>.<br/>
<span class="id">rewrite</span> <span class="id">/nilp</span> <span class="id">-lt0n</span> <span class="gallina-kwd">in</span> <span class="id">t0</span>.<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_eq0">size_eq0</a></span> <span class="id">t</span>) <span class="id">-</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbK">negbK</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">t</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id">_</span>)) <span class="id">-lt0n</span> <span class="id">t0</span> <span class="id">/=</span>.<br/>
<span class="id">case:</span> <span class="id">t</span> <span class="id">Ht</span> <span class="id">t0</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">a</span> <span class="id">b</span> <span class="id">Hab</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> <span class="id">[head</span> <span class="id">_</span> (<span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">_</span>)<span class="id">]/=</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#is_iota_head_last">is_iota_head_last</a></span> <span class="id">//=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#eqseq_cons">eqseq_cons</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#eq_sym">eq_sym</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andb_idr">andb_idr</a></span> <span class="id">//</span> <span class="id">=&gt;</span> <span class="id">/eqP</span> <span class="id">Ha</span>.<br/>
<span class="id">move:</span> <span class="id">Hab</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/is_iota</span> <span class="id">/=</span> <span class="id">=&gt;</span> <span class="id">/eqP[]</span> <span class="id">{1}-&gt;;</span> <span class="id">rewrite</span> <span class="id">-Ha</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Obligation</span> <span class="vernacular">Tactic</span> <span class="id">:=</span> <span class="id">idtac</span>.<br/>
<span class="id">Program</span> <span class="vernacular">Definition</span> <span id="is_iota_is_segment_closed" class="id"><a name="is_iota_is_segment_closed" class="">is_iota_is_segment_closed</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#segment_closed.t">segment_closed.t</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;@<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#segment_closed.mk">segment_closed.mk</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#is_iota">is_iota</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Next Obligation.</span></div>
<div class="proofscript" id="proof15">
<span class="id">move=&gt;</span> <span class="id">a</span> <span class="id">b</span>.<br/>
<span class="id">rewrite</span> <span class="id">/is_iota</span> <span class="id">/=</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_cat">size_cat</a></span> <span class="id">=&gt;</span> <span class="id">/eqP</span> <span class="id">Hab</span>.<br/>
<span class="id">apply/andP;</span> <span class="id">rewrite</span> <span class="id">-eqseq_cat</span> <span class="id">?size_iota</span> <span class="id">//;</span> <span class="id">apply/eqP</span>.<br/>
<span class="id">case/boolP</span> <span class="id">:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nilp">nilp</a></span> <span class="id">a</span>) <span class="id">=&gt;</span> <span class="id">[/nilP</span> <span class="id">a0|a0];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">Hab;</span> <span class="id">rewrite</span> <span class="id">a0</span>.<br/>
<span class="id">case/boolP</span> <span class="id">:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nilp">nilp</a></span> <span class="id">b</span>) <span class="id">=&gt;</span> <span class="id">[/nilP</span> <span class="id">b0|b0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">Hab;</span> <span class="id">rewrite</span> <span class="id">b0</span> <span class="id">/=</span> <span class="id">!cats0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addn0">addn0</a></span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#head">head</a></span> <span class="id">0</span> <span class="id">b</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#head">head</a></span> <span class="id">0</span> <span class="id">a</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="id">move/</span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#congr1">congr1</a></span> (<span class="gallina-kwd">fun</span> <span id="x:147" class="id"><a name="x:147" class="">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nth">nth</a></span> <span class="id">0</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:147">x</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">a</span>))) <span class="id">:</span> <span class="id">Hab</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nth_cat">nth_cat</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltnn">ltnn</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#subnn">subnn</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nth0">nth0</a></span> <span class="id">=&gt;</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id">-nth0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nth_cat">nth_cat</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#lt0n">lt0n</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">a0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nth0">nth0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nth_iota">nth_iota</a></span> <span class="id">//</span> <span class="id">-{1}</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addn0">addn0</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">a</span>)) <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltn_add2l">ltn_add2l</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#lt0n">lt0n</a></span>.<br/>
<span class="id">suff</span> <span class="id">&lt;-</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#head">head</a></span> <span class="id">0</span> (<span class="id">a</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">b</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#head">head</a></span> <span class="id">0</span> <span class="id">a</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-iotaD</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-nth0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nth_cat">nth_cat</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#lt0n">lt0n</a></span> <span class="id">a0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#examples_promotable_segment_closed">examples_promotable_segment_closed</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="properties_of_Symbols" class="id"><a name="properties_of_Symbols" class="">properties_of_Symbols</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="properties_of_Symbols.A" class="id"><a name="properties_of_Symbols.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="properties_of_Symbols.M" class="id"><a name="properties_of_Symbols.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFailFresh.Exports.failFreshMonad">failFreshMonad</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#A:148">A</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="symbolsE" class="id"><a name="symbolsE" class="">symbolsE</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#symbols">symbols</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> (<span class="gallina-kwd">fun</span> <span id="n:150" class="id"><a name="n:150" class="">n</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#sequence">sequence</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nseq">nseq</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#n:150">n</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fresh">fresh</a></span>)) <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols.M">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
 <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols.M">M</a></span> <span class="id">=&gt;</span> <span class="id">m</span> <span class="id">[?</span> <span class="id">?</span> <span class="id">[]]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="symbols0" class="id"><a name="symbols0" class="">symbols0</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#symbols">symbols</a></span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#symbolsE">symbolsE</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="symbolsS" class="id"><a name="symbolsS" class="">symbolsS</a></span> <span id="n:151" class="id"><a name="n:151" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#symbols">symbols</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#n:151">n</a></span>.<span class="id">+1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:152" class="id"><a name="x:152" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fresh">fresh</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="xs:153" class="id"><a name="xs:153" class="">xs</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#symbols">symbols</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#n:151">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols.M">M</a></span> <span class="id">_;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:152">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#xs:153">xs</a></span>))%<span class="id">Do</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#symbolsE">symbolsE</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="symbols_prop1" class="id"><a name="symbols_prop1" class="">symbols_prop1</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#symbols">symbols</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#const">const</a></span> <span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#5ffd50877ab4fcdc0107cf881b980bc8">#</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#wrap">wrap</a></span>) <span class="id">\o</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#const">const</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fresh">fresh</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> (<span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols.M">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">apply:</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">n</span>.<br/>
<span class="id">transitivity</span> (@<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#symbols">symbols</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols.M">M</a></span> <span class="id">1</span>) <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#symbolsE">symbolsE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#sequence_cons">sequence_cons</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#sequence_nil">sequence_nil</a></span>.<br/>
<span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]fmapE</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="symbols_prop2" class="id"><a name="symbols_prop2" class="">symbols_prop2</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#symbols">symbols</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#uaddn">uaddn</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#ucat">ucat</a></span>) <span class="id">\o</span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#mpair">mpair</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#symbols">symbols</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols.M">M</a></span> <span class="id">_</span>)<span class="id">^`2</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="id">apply:</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">-[n1</span> <span class="id">n2]</span>.<br/>
<span class="id">elim:</span> <span class="id">n1</span> <span class="id">=&gt;</span> <span class="id">[|n1</span> <span class="id">IH]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]compE</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#uaddnE">uaddnE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#add0n">add0n</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#X:154">X]/=</a></span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#squaringE">squaringE</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#symbols0">symbols0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-fmapE</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmap_bind">fmap_bind</a></span>.<br/>
&nbsp;&nbsp;<span class="vernacular">Open</span> (<span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#X:155">X</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">/=;</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindmret">bindmret</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#uaddnE">uaddnE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addSn">addSn</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#symbolsS">symbolsS</a></span> <span class="id">-uaddnE</span> <span class="id">-</span>(<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#symbols">symbols</a></span>) <span class="id">{}IH</span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]compE</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#X:156">X]/=</a></span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#squaringE">squaringE</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#symbolsS">symbolsS</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]compE</a></span> <span class="id">-/</span>(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">_</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmap_bind">fmap_bind</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">a</span>.<br/>
<span class="id">rewrite</span> <span class="id">2![in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]compE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]fmap_bind</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]bindA</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]bindA</a></span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s</span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]bindretf</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]fcompE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]fmap_bind</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]fcompE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]bind_fmap</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]bindA</a></span>.<br/>
<span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id">[RHS]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#properties_of_Symbols">properties_of_Symbols</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="swap" class="id"><a name="swap" class="">swap</a></span> <span class="id">{S</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0}</a></span> <span class="id">{I</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#Equality.Exports.eqType">eqType}</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadArray.Exports.arrayMonad">arrayMonad</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#S:157">S</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#I:158">I}</a></span> (<span id="i:160" class="id"><a name="i:160" class="">i</a></span> <span id="j:161" class="id"><a name="j:161" class="">j</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#I:158">I</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#M:159">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:162" class="id"><a name="x:162" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#aget">aget</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#i:160">i</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="y:163" class="id"><a name="y:163" class="">y</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#aget">aget</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#j:161">j</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#aput">aput</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#i:160">i</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#y:163">y</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#aput">aput</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#j:161">j</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#x:162">x</a></span>)%<span class="id">Do</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="tick_fusion" class="id"><a name="tick_fusion" class="">tick_fusion</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadState.Exports.stateMonad">stateMonad</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat}</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="tick" class="id"><a name="tick" class="">tick</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#tick_fusion.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#succn">succn</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="tick_fusion" class="id"><a name="tick_fusion" class="">tick_fusion</a></span> <span id="n:165" class="id"><a name="n:165" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#rep">rep</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#n:165">n</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#tick">tick</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#get">get</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#put">put</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addn">addn</a></span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#n:165">n</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="id">elim:</span> <span class="id">n</span> <span class="id">=&gt;</span> <span class="id">[|n</span> <span class="id">ih];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id">-getputskip</span>.<br/>
<span class="id">rewrite</span> <span class="id">/=</span> <span class="id">/tick</span> <span class="id">ih</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">m</span>.<br/>
<span class="id">rewrite</span> <span class="id">-bindA</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#putget">putget</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#putput">putput</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addSnnS">addSnnS</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.istate_lib.html#tick_fusion">tick_fusion</a></span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
