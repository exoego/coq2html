
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module monae.example_typed_store</title>
<meta name="description" content="Documentation of Coq module monae.example_typed_store" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="monae"><summary>monae</summary>
          <ul>
          <li><a href="monae.altprob_model.html">altprob_model</a></li>
<li><a href="monae.array_lib.html">array_lib</a></li>
<li><a href="monae.category.html">category</a></li>
<li><a href="monae.category_ext.html">category_ext</a></li>
<li><a href="monae.example_iquicksort.html">example_iquicksort</a></li>
<li><a href="monae.example_monty.html">example_monty</a></li>
<li><a href="monae.example_nqueens.html">example_nqueens</a></li>
<li><a href="monae.example_quicksort.html">example_quicksort</a></li>
<li><a href="monae.example_relabeling.html">example_relabeling</a></li>
<li><a href="monae.example_spark.html">example_spark</a></li>
<li><a href="monae.example_transformer.html">example_transformer</a></li>
<li><a href="monae.example_typed_store.html">example_typed_store</a></li>
<li><a href="monae.fail_lib.html">fail_lib</a></li>
<li><a href="monae.gcm_model.html">gcm_model</a></li>
<li><a href="monae.hierarchy.html">hierarchy</a></li>
<li><a href="monae.monad_composition.html">monad_composition</a></li>
<li><a href="monae.monad_lib.html">monad_lib</a></li>
<li><a href="monae.monad_model.html">monad_model</a></li>
<li><a href="monae.monad_transformer.html">monad_transformer</a></li>
<li><a href="monae.monae_lib.html">monae_lib</a></li>
<li><a href="monae.proba_lib.html">proba_lib</a></li>
<li><a href="monae.proba_monad_model.html">proba_monad_model</a></li>
<li><a href="monae.smallstep.html">smallstep</a></li>
<li><a href="monae.state_lib.html">state_lib</a></li>
<li><a href="monae.trace_lib.html">trace_lib</a></li>
<li><a href="monae.typed_store_lib.html">typed_store_lib</a></li>
<li><a href="monae.typed_store_model.html">typed_store_model</a></li>
          </ul>
          </details>
          </li>
<li><details id="monaeImpredicativeSet"><summary>monaeImpredicativeSet</summary>
          <ul>
          <li><a href="monaeImpredicativeSet.iexample_transformer.html">iexample_transformer</a></li>
<li><a href="monaeImpredicativeSet.ifail_lib.html">ifail_lib</a></li>
<li><a href="monaeImpredicativeSet.ifmt_lifting.html">ifmt_lifting</a></li>
<li><a href="monaeImpredicativeSet.ihierarchy.html">ihierarchy</a></li>
<li><a href="monaeImpredicativeSet.imonad_composition.html">imonad_composition</a></li>
<li><a href="monaeImpredicativeSet.imonad_lib.html">imonad_lib</a></li>
<li><a href="monaeImpredicativeSet.imonad_model.html">imonad_model</a></li>
<li><a href="monaeImpredicativeSet.imonad_transformer.html">imonad_transformer</a></li>
<li><a href="monaeImpredicativeSet.imonae_lib.html">imonae_lib</a></li>
<li><a href="monaeImpredicativeSet.iparametricity_codensity.html">iparametricity_codensity</a></li>
<li><a href="monaeImpredicativeSet.istate_lib.html">istate_lib</a></li>
<li><a href="monaeImpredicativeSet.itrace_lib.html">itrace_lib</a></li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module monae.example_typed_store</h1>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.ZArith.html">ZArith</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.classical.boolp">boolp</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">infotheo</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrZ">ssrZ</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monae.monad_model.html">monad_model</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">HB</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for HB.structures">structures</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monae.monae_lib.html">monae_lib</a></span> <span class="id"><a href="monae.hierarchy.html">hierarchy</a></span> <span class="id"><a href="monae.monad_lib.html">monad_lib</a></span> <span class="id"><a href="monae.typed_store_lib.html">typed_store_lib</a></span>.<br/>
<br/>
<pre class="ssrdoc">
                        Typed store examples                               
                                                                           
 Inductive ml_type == generated by coqgen                                  
                                                                           
 Module MLTypesNat                                                         
   coq_type_nat          == adapted from code generated by coqgen          
   coq_type_nat0         == coq_type_nat with identity monad               
   Definition cycle                                                        
   Fixpoint fact_ref                                                       
   Definition fact_for                                                     
   Fixpoint fibo_ref                                                       
                                                                           
 Module MLtypes63                                                          
   Fixpoint coq_type63   == generated type translation function            
   Definition fact_for63                                                   
</pre>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">monae_scope</span>.<br/>
<br/>
<pre class="ssrdoc">
                            generated by coqgen                            
</pre>
<span class="vernacular">Module</span> <span id="MLTypes" class="id"><a name="MLTypes" class="">MLTypes</a></span>.<br/>
<span class="vernacular">Inductive</span> <span id="MLTypes.ml_type" class="id"><a name="MLTypes.ml_type" class="">ml_type</a></span> <span class="id">:</span> <span class="gallina-kwd">Set</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="MLTypes.ml_int" class="id"><a name="MLTypes.ml_int" class="">ml_int</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="MLTypes.ml_bool" class="id"><a name="MLTypes.ml_bool" class="">ml_bool</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="MLTypes.ml_unit" class="id"><a name="MLTypes.ml_unit" class="">ml_unit</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="MLTypes.ml_ref" class="id"><a name="MLTypes.ml_ref" class="">ml_ref</a></span> (<span class="id">_</span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#ml_type:1">ml_type</a></span>)<br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="MLTypes.ml_arrow" class="id"><a name="MLTypes.ml_arrow" class="">ml_arrow</a></span> (<span class="id">_</span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#ml_type:1">ml_type</a></span>) (<span class="id">_</span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#ml_type:1">ml_type</a></span>)<br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="MLTypes.ml_rlist" class="id"><a name="MLTypes.ml_rlist" class="">ml_rlist</a></span> (<span class="id">_</span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#ml_type:1">ml_type</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="MLTypes.ml_type_eq_dec" class="id"><a name="MLTypes.ml_type_eq_dec" class="">ml_type_eq_dec</a></span> (<span id="T1:3" class="id"><a name="T1:3" class="">T1</a></span> <span id="T2:4" class="id"><a name="T2:4" class="">T2</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type">ml_type</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#87727981cdc1579fef00b9d9c1d3b9da">{T1=T2}+{T1&lt;&gt;T2}</a></span>.<br/>
<span class="id">revert</span> <span class="id">T2;</span> <span class="id">induction</span> <span class="id">T1;</span> <span class="id">destruct</span> <span class="id">T2;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> (<span class="id">right;</span> <span class="id">intro;</span> <span class="id">discriminate</span>)<span class="id">;</span> <span class="id">try</span> (<span class="id">now</span> <span class="id">left</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> (<span class="id">case</span> (<span class="id">IHT1_5</span> <span class="id">T2_5</span>)<span class="id">;</span> <span class="id">[|right;</span> <span class="id">injection;</span> <span class="id">intros;</span> <span class="id">contradiction]</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> (<span class="id">case</span> (<span class="id">IHT1_4</span> <span class="id">T2_4</span>)<span class="id">;</span> <span class="id">[|right;</span> <span class="id">injection;</span> <span class="id">intros;</span> <span class="id">contradiction]</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> (<span class="id">case</span> (<span class="id">IHT1_3</span> <span class="id">T2_3</span>)<span class="id">;</span> <span class="id">[|right;</span> <span class="id">injection;</span> <span class="id">intros;</span> <span class="id">contradiction]</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">try</span> (<span class="id">case</span> (<span class="id">IHT1_2</span> <span class="id">T2_2</span>)<span class="id">;</span> <span class="id">[|right;</span> <span class="id">injection;</span> <span class="id">intros;</span> <span class="id">contradiction]</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;(<span class="id">case</span> (<span class="id">IHT1</span> <span class="id">T2</span>) <span class="id">||</span> <span class="id">case</span> (<span class="id">IHT1_1</span> <span class="id">T2_1</span>))<span class="id">;</span> <span class="id">try</span> (<span class="id">left;</span> <span class="id">now</span> <span class="id">subst</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right;</span> <span class="id">injection;</span> <span class="id">intros;</span> <span class="id">contradiction</span>.<br/>
Defined.</div>
<br/>
<span class="vernacular">Definition</span> <span id="MLTypes.val_nonempty" class="id"><a name="MLTypes.val_nonempty" class="">val_nonempty</a></span> (<span id="M:5" class="id"><a name="M:5" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#UU0">UU0</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.hierarchy.html#UU0">UU0</a></span>) <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#tt">tt</a></span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span id="MLTypes.loc" class="id"><a name="MLTypes.loc" class="">loc</a></span> <span class="id">:=</span> (@<span class="id"><a href="monae.hierarchy.html#loc">loc</a></span> <span class="id">_</span> <span class="id"><a href="monae.monad_model.html#locT_nat">monad_model.locT_nat</a></span>).<br/>
<br/>
<span class="vernacular">Inductive</span> <span id="MLTypes.rlist" class="id"><a name="MLTypes.rlist" class="">rlist</a></span> (<span id="a:6" class="id"><a name="a:6" class="">a</a></span> <span class="id">:</span> <span class="gallina-kwd">Type</span>) (<span id="a_1:7" class="id"><a name="a_1:7" class="">a_1</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type">ml_type</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="MLTypes.Nil" class="id"><a name="MLTypes.Nil" class="">Nil</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span id="MLTypes.Cons" class="id"><a name="MLTypes.Cons" class="">Cons</a></span> (<span class="id">_</span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#a:6">a</a></span>) (<span class="id">_</span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.loc">loc</a></span> (<span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_rlist">ml_rlist</a></span> <span class="id"><a href="monae.example_typed_store.html#a_1:7">a_1</a></span>)).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="MLTypes.ml_type_eq_mixin" class="id"><a name="MLTypes.ml_type_eq_mixin" class="">ml_type_eq_mixin</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#Equality.Exports.EqMixin">EqMixin</a></span> (<span class="id"><a href="monae.monae_lib.html#comparePc">comparePc</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type_eq_dec">MLTypes.ml_type_eq_dec</a></span>).<br/>
<span class="vernacular">Canonical</span> <span id="MLTypes.ml_type_eqType" class="id"><a name="MLTypes.ml_type_eqType" class="">ml_type_eqType</a></span> <span class="id">:=</span> <span class="vernacular">Eval</span> <span class="id">hnf</span> <span class="gallina-kwd">in</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#Equality.Exports.EqType">EqType</a></span> <span class="id">_</span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type_eq_mixin">ml_type_eq_mixin</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_typed_store.html#MLTypes">MLTypes</a></span>.<br/>
<pre class="ssrdoc">
Module CoqTypeNat.
Import MLTypes.
Section with_monad.
Context [M : Type -&gt; Type].
Fixpoint coq_type_nat (T : ml_type) : Type :=
  match T with
  | ml_int =&gt; nat
  | ml_bool =&gt; bool
  | ml_unit =&gt; unit
  | ml_arrow T1 T2 =&gt; coq_type_nat T1 -&gt; M (coq_type_nat T2)
  | ml_ref T1 =&gt; loc T1
  | ml_rlist T1 =&gt; rlist (coq_type_nat T1) T1
  end.
End with_monad.
HB.instance Definition _ := @isML_universe.Build ml_type
  (Equality.class ml_type_eqType) coq_type_nat ml_unit val_nonempty.
Definition typedStoreMonad (N : monad) :=
  typedStoreMonad ml_type N monad_model.locT_nat.
Section cyclic.
Variables (N : monad) (M : typedStoreMonad N).
Local Notation coq_type := hierarchy.coq_type.
Local Open Scope do_notation.
Definition cycle (T : ml_type) (a b : coq_type N T)
  : M (loc (ml_rlist T)) :=
  do r &lt;- cnew (ml_rlist T) (Nil (coq_type N T) T);
  do l &lt;-
  (do v &lt;- cnew (ml_rlist T) (Cons (coq_type N T) T b r);
   Ret (Cons (coq_type N T) T a v));
  do _ &lt;- cput r l; Ret r.
Definition rhd (T : ml_type) (def : coq_type N T)
  (param : loc (ml_rlist T)) : M (coq_type N T) :=
  do v &lt;- cget param; Ret (match v with Nil =&gt; def | Cons a _ =&gt; a end).
Lemma rhd_is_true :
  crun (do l &lt;- cycle ml_bool true false; rhd ml_bool false l) = Some true.
Proof.
rewrite bindA.
under eq_bind do rewrite !bindA.
under eq_bind do under eq_bind do
 rewrite !bindA bindretf !bindA bindretf cputget.
rewrite -bindA_uncurry -bindA crunret // crunchkput // bindA.
under eq_bind do rewrite !bindA.
under eq_bind do under eq_bind do rewrite bindretf /=.
by rewrite crunnewchkC // crunnewchk0.
Qed.
Definition rtl (T : ml_type) (param : loc (ml_rlist T))
  : M (loc (ml_rlist T)) :=
  do v &lt;- cget param; Ret (match v with Nil =&gt; param | Cons _ t =&gt; t end).
Arguments cnew {ml_type N locT s T}.
Arguments cput {ml_type N locT s T}.
Arguments cget {ml_type N locT s T}.
Arguments Nil {a a_1}.
Arguments Cons {a a_1}.
Arguments rtl {T}.
Lemma rtl_tl_self T (a b : coq_type N T) :
  do l &lt;- cycle T a b; do l1 &lt;- rtl l; rtl l1 = cycle T a b.
Proof.
rewrite /cycle.
rewrite bindA.
rewrite -[LHS]cnewchk.
under eq_bind =&gt; r1.
  rewrite bindA; under eq_bind do rewrite !bindA.
  under cchknewE =&gt; r2 r1r2.
    rewrite bindretf bindA bindretf.
    rewrite bindA cputget.
    rewrite bindretf.
    rewrite -bindA.
    rewrite cputgetC //.
    over.
  rewrite cnewget.
  over.
rewrite cnewchk.
(*
under eq_bind do under eq_bind =&gt; v do rewrite -(bindretf (Cons true v)) bindA.
under eq_bind do rewrite -bindA.
done.

under [RHS]eq_bind do (rewrite bindA; under eq_bind do rewrite bindretf).
done.
Qed.
Lemma _rtl_tl_self T (a b : coq_type N T) :
  do l &lt;- cycle T a b; do l1 &lt;- rtl l; rtl l1 = cycle T a b.
Proof.
rewrite /cycle bindA -[LHS]cnewchk.
under eq_bind =&gt; r1.
  rewrite bindA; under eq_bind do rewrite !bindA.
  under cchknewE do
    rewrite bindretf bindA bindretf bindA cputget bindretf -bindA cputgetC //.
  rewrite cnewget; over.
rewrite cnewchk.
by under [RHS]eq_bind do (rewrite bindA; under eq_bind do rewrite bindretf).
Qed.
Lemma rhd_tl_tl_is_true :
  crun (do l &lt;- cycle ml_bool true false; do l1 &lt;- rtl l; do l2 &lt;- rtl l1;
        rhd ml_bool false l2) = Some true.
Proof.
rewrite -rhd_is_true -[in RHS]rtl_tl_self [in RHS]bindA.
under [in RHS]eq_bind do rewrite bindA.
done.
Qed.
Lemma perm3 T (s1 s2 s3 s4 : coq_type N T) :
  do r1 &lt;- cnew s1; do r2 &lt;- cnew s2; do r3 &lt;- cnew s3; cput r1 s4 =
  do r1 &lt;- cnew s4; do r2 &lt;- cnew s2; do r3 &lt;- cnew s3; skip :&gt; M _.
Proof.
rewrite -cnewchk.
under eq_bind do rewrite -cchknewC -[cput _ _]bindmskip 2!cchknewput.
by rewrite cnewput.
Qed.
Fixpoint mkrlist (T : ml_type) (l : list (coq_type N T))
  (r : loc (ml_rlist T)) : M (loc (ml_rlist T)) :=
  if l is a :: l then
    do v &lt;- mkrlist T l r;
    cnew (T:=ml_rlist T) (Cons a v)
  else Ret r.
Definition cyclel (T : ml_type) (a : coq_type N T) (l : list (coq_type N T))
  : M (loc (ml_rlist T)) :=
  do r &lt;- cnew (T:=ml_rlist T) Nil;
  do v &lt;- mkrlist T l r;
  do _ &lt;- cput r (Cons a v); Ret r.
Fixpoint rdrop {T} n (l : loc (ml_rlist T)) : M (loc (ml_rlist T)) :=
  if n is n.+1 then rtl l &gt;&gt;= rdrop n else Ret l.
Definition rnth T x n l := do l' &lt;- rdrop n l; rhd T x l'.
Lemma rdrop_add T m n (l : loc (ml_rlist T)) :
  rdrop (m+n) l = rdrop m l &gt;&gt;= rdrop n.
Proof.
elim: m l =&gt; /= [|m IH] l; first by rewrite bindretf.
by rewrite bindA; apply eq_bind =&gt; l'.
Qed.
Lemma mkrlist_cat T l1 l2 r :
  mkrlist T (l1++l2) r = mkrlist T l2 r &gt;&gt;= mkrlist T l1.
Proof.
elim: l1 =&gt; [|a l1 IH]; by [rewrite cat0s bindmret | rewrite /= IH bindA].
Qed.
Lemma cchkmkrlistC A T T1 l (r : loc T) r1 k :
  cchk r &gt;&gt; (mkrlist T1 l r1 &gt;&gt;= (fun r' =&gt; cchk r &gt;&gt; k r'))
  = cchk r &gt;&gt; (mkrlist T1 l r1 &gt;&gt;= k) :&gt; M A.
Proof.
elim: l k =&gt; [|a l IH] k /=.
  by rewrite !bindretf -bindA cchkget.
symmetry.
rewrite bindA -IH.
under eq_bind do under eq_bind do rewrite -cchknewC.
by rewrite IH bindA.
Qed.
Lemma cgetmkrlistC A T T1 (r : loc T) r1 l k :
  cchk r &gt;&gt; (mkrlist T1 l r1 &gt;&gt;= (fun r' =&gt; cget r &gt;&gt;= k r'))
  = cget r &gt;&gt;= (fun v =&gt; mkrlist T1 l r1 &gt;&gt;= k ^~ v) :&gt; M A.
Proof.
elim: l k =&gt; [|a l IH] k /=.
  under [in RHS]eq_bind do rewrite bindretf.
  by rewrite !bindretf cchkget.
symmetry.
under eq_bind do rewrite bindA.
rewrite -IH.
under [mkrlist _ _ _ &gt;&gt;= _]eq_bind do rewrite -cchknewget.
by rewrite cchkmkrlistC bindA.
Qed.
Lemma mkrlist_drop A T l r k :
  (mkrlist T l r &gt;&gt;= fun r' =&gt; rdrop (size l) r' &gt;&gt;= k r') =
  (mkrlist T l r &gt;&gt;= k ^~ r) :&gt; M A.
Proof.
elim/last_ind: l r k =&gt; [|a l IH] r k.
  by rewrite !bindretf.
rewrite -cats1 mkrlist_cat size_cat bindA /= bindretf.
under eq_bind do under eq_bind do rewrite rdrop_add -bindA bindmret bindA.
rewrite -cnewchk.
under eq_bind =&gt; r1.
  rewrite IH.
  under [mkrlist _ _ _ &gt;&gt;= _]eq_bind do rewrite bindA.
  rewrite cgetmkrlistC.
  over.
rewrite cnewget /= -[cnew _ &gt;&gt;= _]bindA.
by under eq_bind do rewrite bindretf.
Qed.
Lemma cchk_mkrlist_put_drop A T l (r r1 : loc (ml_rlist T)) f k :
  cchk r &gt;&gt; (mkrlist T l r1 &gt;&gt;= fun r' =&gt; cput r (f r') &gt;&gt;
                                 (rdrop (size l) r' &gt;&gt;= k r')) =
  cchk r &gt;&gt; (mkrlist T l r1 &gt;&gt;= fun r' =&gt; rdrop (size l) r' &gt;&gt;=
                                 (fun r'' =&gt; cput r (f r') &gt;&gt; k r' r'')) :&gt; M A.
Proof.
elim/last_ind: l r1 k =&gt; [|a l IH] r1 k.
  by rewrite !bindretf.
rewrite -cats1 mkrlist_cat size_cat /=.
under eq_bind do rewrite bindretf bindA.
rewrite -cchknewC.
under cchknewE =&gt; r2 rr2.
  under [mkrlist _ _ _ &gt;&gt;= _]eq_bind do rewrite rdrop_add bindA.
  rewrite IH mkrlist_drop /=.
  under [mkrlist _ _ _ &gt;&gt;= _]eq_bind do
    rewrite !bindA -[cput _ _ &gt;&gt; _]bindA cputgetC //.
  under eq_bind do under eq_bind do under eq_bind do rewrite !bindretf.
  over.
rewrite cchknewC.
symmetry.
under eq_bind do rewrite bindretf bindA.
under [LHS]cchknewE =&gt; r2 rr2.
  under eq_bind do rewrite rdrop_add bindA.
  rewrite mkrlist_drop /=.
  under eq_bind do rewrite /rtl bindmret /= bindA.
  under eq_bind do under eq_bind do rewrite bindretf.
  over.
done.
Qed.
Lemma rnth_is_true n :
  crun (do l &lt;- cyclel ml_bool true (nseq n false); rnth ml_bool false n.+1 l)
  = Some true.
Proof.
rewrite /cyclel !bindA -cnewchk.
under eq_bind =&gt; r.
  rewrite [(mkrlist _ _ _ &gt;&gt;= _) &gt;&gt;= _]bindA -add1n /rnth.
  under [mkrlist _ _ _ &gt;&gt;= _]eq_bind do
    rewrite bindA bindretf rdrop_add /= bindA bindmret bindA cputget bindretf.
  rewrite -{2}(size_nseq n false).
  rewrite cchk_mkrlist_put_drop mkrlist_drop.
  under [mkrlist _ _ _ &gt;&gt;= _]eq_bind do rewrite cputget.
  rewrite -!bindA.
  over.
rewrite -bindA crunret // -bindA_uncurry crunchkput // bindA.
under eq_bind =&gt; r.
  rewrite bindA.
  under eq_bind do rewrite bindretf /= -[cchk _]bindmskip.
  rewrite bindA cchkmkrlistC.
  over.
rewrite cnewchk -bindA crunmskip.
elim: n =&gt; /= [|n IH]. by rewrite bindmret crunnew0.
by rewrite -bindA crunnew.
Qed.
Fixpoint iappend (h : nat) (l1 l2 : coq_type N (ml_rlist ml_int))
  : M (coq_type N (ml_rlist ml_int)) :=
  if h is h.+1 then
    match l1 with
    | Nil =&gt; Ret l2
    | Cons a l1' =&gt;
      do _ &lt;-
      (do v &lt;- (do v &lt;- cget l1'; iappend h v l2);
       cput l1' v);
      Ret l1
    end
  else Ret (@Nil nat ml_int).
Fixpoint is_int_list (l : list nat) (rl : rlist nat ml_int) : M bool :=
  match l, rl with
  | [::], Nil =&gt; Ret true
  | (a :: t), (Cons b r) =&gt;
      if a != b then Ret false else
      do rl' &lt;- cget r; is_int_list t rl'
  | _, _ =&gt; Ret false
  end.
Fixpoint loc_ids_rlist (l : list nat) (rl : rlist nat ml_int)
  : M (list nat) :=
  match l with
  | [::] =&gt; Ret [::]
  | (_ :: t) =&gt;
      match rl with
      | Nil =&gt; Ret [::]
      | Cons _ r =&gt;
          do rl' &lt;- cget r; do rs &lt;- loc_ids_rlist t rl'; Ret (loc_id r :: rs)
      end
  end.
Lemma iappend_correct m l1 l2 :
  crun (do p : rlist nat ml_int * rlist nat ml_int &lt;- m; let (rl1, rl2) := p in
        do a &lt;- is_int_list l1 rl1; do b &lt;- is_int_list l2 rl2;
        do rs1 &lt;- loc_ids_rlist l1 rl1; do rs2 &lt;- loc_ids_rlist l2 rl2;
        Ret (a &amp;&amp; b &amp;&amp; (allrel (fun r1 r2 =&gt; r1 != r2) rs1 rs2)))
       = Some true-&gt;
  crun (do p : rlist nat ml_int * rlist nat ml_int &lt;- m; let (rl1, rl2) := p in
        do rl &lt;- iappend (size l1).+1 rl1 rl2; is_int_list (l1 ++ l2) rl)
       = Some true.
Proof.
need more abstractions 
Abort.
End cyclic.
Module eval_cyclic.
Section eval.
Import monad_model.ModelTypedStore.
                
Definition M :=
  [the typedStoreMonad idfun of @acto ml_type idfun].
Definition Env := Env ml_type idfun.
Definition empty_env : Env := [::].
copied from typed_store_model.v 
Definition W (A : UU0) : UU0 := monad_model.option_monad (A * Env).
Definition Restart [A B] (r : W A) (f : M B) : W B :=
  if r is inr (_, env) then f env else inl tt.
Definition FromW [A] (r : W A) : M A :=
  fun env =&gt; if r is inr (a, _) then inr (a, env) else inl tt.
Definition it0 : W unit := inr (tt, empty_env).
Local Open Scope do_notation.
Local Notation mkloc := (mkloc (locT:=monad_model.locT_nat)).
Local Notation coq_type := (coq_type _).
Definition incr (l : loc ml_int) : M nat :=
  do x &lt;- cget l; do _ &lt;- cput l (succn x); Ret (succn x).
Definition l : W (loc ml_int) := Restart it0 (cnew ml_int 3).
Eval vm_compute in l.
Definition it1 := Restart l (do l &lt;- FromW l; incr l).
Eval vm_compute in it1.
Definition it2 := Restart it1 (do l &lt;- FromW l; incr l).
Eval vm_compute in it2.
Local Notation cycle := (cycle idfun M).
Local Notation rhd := (rhd idfun M).
Local Notation rtl := (rtl idfun M).
Definition it3 := Restart it2 (cycle ml_bool true false).
Eval vm_compute in crun (FromW it3).
Definition it4 := Restart it3 (do l &lt;- FromW it3; Ret (rhd ml_bool false l)).
Definition it5 := Restart it4
                    (do l0 &lt;- FromW it3;
                     do l1 &lt;- rtl _ l0;
                     do l2 &lt;- rtl _ l1;
                     Ret (rhd ml_bool false l2)).
End eval.
End eval_cyclic.
Section factorial.
Variable (N : monad) (M : typedStoreMonad N).
Fixpoint fact_ref (r : loc ml_int) (n : nat) : M unit :=
  if n is m.+1 then cget r &gt;&gt;= fun p =&gt; cput r (n * p) &gt;&gt; fact_ref r m
  else skip.
Theorem fact_ref_ok n :
  crun (cnew ml_int 1 &gt;&gt;= fun r =&gt; fact_ref r n &gt;&gt; cget r) = Some (fact_rec n).
Proof.
set fn := fact_rec n.
set m := n.
set s := 1.
have smn : s * fact_rec m = fn by rewrite mul1n.
elim: m s smn =&gt; [|m IH] s /= smn.
  rewrite /fact_ref -smn muln1.
  under eq_bind do rewrite bindskipf.
  by rewrite cnewgetret crunret // crunnew0.
under eq_bind do rewrite bindA.
rewrite cnewget.
under eq_bind do rewrite bindA.
by rewrite cnewput IH // (mulnC m.+1) -mulnA.
Qed.
End factorial.
Section fact_for.
Variable (N : monad) (M : typedStoreMonad N).
Local Notation coq_type := (hierarchy.coq_type N).
Local Open Scope do_notation.
Definition fact_for (n : coq_type ml_int) : M (coq_type ml_int) :=
  do v &lt;- cnew ml_int 1;
  do _ &lt;-
  (do u &lt;- Ret 1;
   do v_1 &lt;- Ret n;
   forloop u v_1
     (fun i =&gt;
        do v_1 &lt;- (do v_1 &lt;- cget v; Ret (v_1 * i));
        cput v v_1));
  cget v.
Theorem fact_for_ok n : crun (fact_for n) = Some (fact_rec n).
Proof.
rewrite /fact_for.
under eq_bind do rewrite !bindA !bindretf.
transitivity (crun (cnew ml_int (fact_rec n) &gt;&gt; Ret (fact_rec n) : M _));
  last by rewrite crunret // crunnew0.
congr crun.
rewrite -{1}/(fact_rec 0).
pose m := n.
have -&gt; : 0 = n - m by rewrite subnn.
have : m &lt;= n by [].
elim: m =&gt; [|m IH] mn.
  rewrite subn0.
  under eq_bind do rewrite forloop0 ?leqnn // bindretf -cgetret.
  by rewrite cnewget.
rewrite subnSK //.
under eq_bind do (rewrite forloopS; last by apply leq_subr).
under eq_bind do rewrite !bindA.
rewrite cnewget.
under eq_bind do rewrite bindretf.
rewrite cnewput -IH; last by apply ltnW.
by rewrite subnS mulnC -(@prednK (n-m)) // lt0n subn_eq0 -ltnNge.
Qed.
End fact_for.
Section fibonacci.
Variables (N : monad) (M : typedStoreMonad N).
Fixpoint fibo_rec n :=
  if n is m.+1 then
    if m is k.+1 then fibo_rec k + fibo_rec m else 1
  else 1.
Fixpoint fibo_ref n (a b : loc ml_int) : M unit :=
  if n is n.+1 then
    cget a &gt;&gt;= (fun x =&gt; cget b &gt;&gt;= fun y =&gt; cput a y &gt;&gt; cput b (x + y))
           &gt;&gt; fibo_ref n a b
  else skip.
Theorem fibo_ref_ok n :
  crun (cnew ml_int 1 &gt;&gt;=
             (fun a =&gt; cnew ml_int 1 &gt;&gt;= fun b =&gt; fibo_ref n a b &gt;&gt; cget a))
  = Some (fibo_rec n).
Proof.
set x := 1.
pose y := x.
rewrite -{2}/y.
pose i := n.
rewrite -[in LHS]/i.
have : (x, y) = (fibo_rec (n - i), fibo_rec (n.+1 - i)).
  by rewrite subnn -addn1 addKn.
have : i &lt;= n by [].
elim: i x y =&gt; [|i IH] x y Hi.
  rewrite !subn0 =&gt; -[-&gt; -&gt;].
  rewrite -/(fibo_rec n.+1).
  under eq_bind do under eq_bind do rewrite /= bindskipf.
  rewrite -cnewchk.
  under eq_bind do rewrite -cgetret cchknewget.
  by rewrite cnewget -bindA crunret // crunnew // crunnew0.
rewrite subSS =&gt; -[] Hx Hy.
rewrite -(IH y (x + y) (ltnW Hi)); last first.
  rewrite {}Hx {}Hy; congr pair.
  rewrite subSn 1?ltnW//.
  case: n {IH} =&gt; // n in Hi *.
  by rewrite [in RHS]subSn -1?ltnS// subSS subSn -1?ltnS.
rewrite /=.
under eq_bind do under eq_bind do rewrite !bindA.
rewrite -cnewchk.
under eq_bind do rewrite cchknewget.
rewrite cnewget.
under eq_bind do under eq_bind do rewrite !bindA.
under eq_bind do rewrite cnewget.
under eq_bind do under eq_bind do rewrite !bindA.
rewrite -[in LHS]cnewchk.
under eq_bind do rewrite cchknewput.
rewrite cnewput.
by under eq_bind do rewrite cnewput.
Qed.
End fibonacci.
End CoqTypeNat.
Require Import PrimInt63.
Require Sint63.
Section Int63.
Definition uint2N (n : int) : nat :=
  if Uint63.to_Z n is Zpos pos then Pos.to_nat pos else 0.
Definition N2int n := Uint63.of_Z (Z.of_nat n).
Lemma ltsbNlesb m n : ltsb m n = ~~ lesb n m.
Proof.
case/boolP: (lesb n m) =&gt; /Sint63.lebP nm; apply/Sint63.ltbP =&gt; /=;
  by [apply Z.le_ngt | apply Z.nle_gt].
Qed.
Lemma ltsbW m n : ltsb m n -&gt; lesb m n.
Proof. move/Sint63.ltbP/Z.lt_le_incl =&gt; mn; by apply/Sint63.lebP. Qed.
Lemma lesb_ltsbS_eq m n : lesb m n -&gt; ltsb n (Uint63.succ m) -&gt; m = n.
Proof.
move/Sint63.lebP =&gt; mn /Sint63.ltbP nSm.
move: (nSm).
rewrite Sint63.succ_of_Z -Sint63.is_int; last first.
  split.
    apply Z.le_le_succ_r.
    by case: (Sint63.to_Z_bounded m).
  apply Zlt_le_succ, (Z.le_lt_trans _ _ _ mn), (Z.lt_le_trans _ _ _ nSm).
  by case: (Sint63.to_Z_bounded (Uint63.succ m)).
move/Zlt_le_succ/Zsucc_le_reg =&gt; nm.
by apply Sint63.to_Z_inj, Zle_antisym.
Qed.
The opposite is not true ! (n = max_int) 
Lemma ltsbS_lesb m n : ltsb m (Uint63.succ n) -&gt; lesb m n.
Proof.
rewrite -[lesb _ _]negbK -ltsbNlesb =&gt; nSm; apply/negP =&gt; /[dup] /ltsbW nm.
by rewrite (lesb_ltsbS_eq n m) // =&gt; /Sint63.ltbP /Z.lt_irrefl.
Qed.
Lemma uint63_min n : (0 &lt;= Uint63.to_Z n)%Z.
Proof. by case: (Uint63.to_Z_bounded n). Qed.
Lemma uint63_max n : (Uint63.to_Z n &lt; Uint63.wB)%Z.
Proof. by case: (Uint63.to_Z_bounded n). Qed.
Lemma uint2N_pred n : n &lt;&gt; 0%int63 -&gt; uint2N n = (uint2N (Uint63.pred n)).+1.
Proof.
move=&gt; Hn.
rewrite /uint2N Uint63.pred_spec.
case HnZ: (Uint63.to_Z n) =&gt; [|m|m].
- rewrite (_ : 0 = Uint63.to_Z 0)%Z // in HnZ.
  move/Uint63.to_Z_inj in HnZ.
  by elim Hn.
- have Hm1 : (0 &lt;= Z.pos m - 1 &lt; Uint63.wB)%Z.
    split. by apply leZsub1, Pos2Z.is_pos.
    apply (Z.lt_trans _ (Z.pos m)).
      by apply leZsub1, Z.le_refl.
    rewrite -HnZ; by apply uint63_max.
  rewrite Zmod_small //.
  case HmZ: (Z.pos m - 1)%Z =&gt; [|p|p].
  + by move/Z.sub_move_r: HmZ =&gt; /= [] -&gt;.
  + apply Nat2Z.inj =&gt; /=.
    rewrite positive_nat_Z Pos2SuccNat.id_succ Pos2Z.inj_succ -HmZ.
    by rewrite (Z.succ_pred (Z.pos m)).
  + by destruct m.
- move: (uint63_min n).
  rewrite HnZ =&gt; /Zle_not_lt; elim.
  by apply Zlt_neg_0.
Qed.
Lemma lesb_sub_bounded m n :
  lesb m n -&gt; (0 &lt;= Sint63.to_Z n - Sint63.to_Z m &lt; Uint63.wB)%Z.
Proof.
move/Sint63.lebP =&gt; mn.
split. by apply Zle_minus_le_0.
apply
 (Z.le_lt_trans _ (Sint63.to_Z Sint63.max_int - Sint63.to_Z Sint63.min_int))%Z.
  apply leZ_sub.
    by case: (Sint63.to_Z_bounded n).
  by case: (Sint63.to_Z_bounded m).
done.
Qed.
Lemma ltsb_neq m n : ltsb m n -&gt; m &lt;&gt; n.
Proof. by move/Sint63.ltbP/[swap]/(f_equal Sint63.to_Z)-&gt; =&gt;/Z.lt_irrefl. Qed.
(*
Lemma sub0_eq m n : sub m n = 0%int63 -&gt; m = n.
Proof.
rewrite Sint63.sub_of_Z =&gt; /(f_equal Uint63.to_Z).
rewrite Uint63.of_Z_spec.
move/Sint63.ltbP in mn.
rewrite Zmod_small.
  rewrite Z.sub_move_r /= =&gt; nm.
  rewrite nm in mn.
  by move/Z.lt_irrefl in mn.
by apply /lesb_sub_bounded /Sint63.lebP /Z.lt_le_incl.
Qed.

Lemma ltsb_sub_neq0 m n : ltsb m n -&gt; sub n m &lt;&gt; 0%int63.
Proof.
move=&gt; mn.
rewrite Sint63.sub_of_Z =&gt; /(f_equal Uint63.to_Z).
rewrite Uint63.of_Z_spec.
move/Sint63.ltbP in mn.
rewrite Zmod_small.
  rewrite Z.sub_move_r /= =&gt; nm.
  rewrite nm in mn.
  by move/Z.lt_irrefl in mn.
by apply /lesb_sub_bounded /Sint63.lebP /Z.lt_le_incl.
Qed.
Lemma sub_succ_pred m n : sub n (Uint63.succ m) = Uint63.pred (sub n m).
Proof.
apply Uint63.to_Z_inj.
rewrite Uint63.sub_spec Uint63.succ_spec Uint63.pred_spec Uint63.sub_spec.
rewrite Zminus_mod Zmod_mod -Zminus_mod Z.sub_add_distr.
apply/esym.
by rewrite Zminus_mod Zmod_mod -Zminus_mod.
Qed.
Lemma uint2N_sub_succ m n : ltsb m n -&gt;
  uint2N (sub n m) = (uint2N (sub n (Uint63.succ m))).+1.
Proof. move/ltsb_sub_neq0 =&gt; mn. by rewrite sub_succ_pred uint2N_pred. Qed.
Lemma N2int_succ : {morph N2int : x / x.+1 &gt;-&gt; Uint63.succ x}.
Proof.
move=&gt; x; apply Uint63.to_Z_inj; rewrite Uint63.succ_spec !Uint63.of_Z_spec.
by rewrite Zplus_mod /= Zpos_P_of_succ_nat /Z.succ Zplus_mod Zmod_mod.
Qed.
Lemma N2int_mul : {morph N2int : x y / x * y &gt;-&gt; mul x y}.
Proof.
move=&gt; x y; apply Uint63.to_Z_inj.
by rewrite Uint63.mul_spec !Uint63.of_Z_spec Nat2Z.inj_mul Zmult_mod.
Qed.
Lemma N2int_bounded n :
  (Z.of_nat n &lt;= Sint63.to_Z Sint63.max_int)%Z -&gt;
  (Sint63.to_Z Sint63.min_int &lt;= Z.of_nat n &lt;= Sint63.to_Z Sint63.max_int)%Z.
Proof.
split =&gt; //.
apply (Z.le_trans _ 0).
  rewrite -[0%Z]/(Sint63.to_Z 0).
  by case: (Sint63.to_Z_bounded 0).
by apply Zle_0_nat.
Qed.
End Int63.
Module CoqTypeInt63.
Import MLTypes.
</pre>
<pre class="ssrdoc">
Section with_monad.
Context [M : Type -&gt; Type].
Fixpoint coq_type63 (T : ml_type) : Type :=
  match T with
  | ml_int =&gt; int
  | ml_bool =&gt; bool
  | ml_unit =&gt; unit
  | ml_arrow T1 T2 =&gt; coq_type63 T1 -&gt; M (coq_type63 T2)
  | ml_ref T1 =&gt; loc T1
  | ml_rlist T1 =&gt; rlist (coq_type63 T1) T1
  end.
End with_monad.
</pre>
<br/>
<span id="CoqTypeInt63.MLTypes_ml_type__canonical__hierarchy_ML_UNIVERSE" class="id"><span id="CoqTypeInt63.HB_unnamed_factory_3" class="id"><a name="CoqTypeInt63.MLTypes_ml_type__canonical__hierarchy_ML_UNIVERSE" class="hierarchy-builder">HB.instance</a></span></span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> @<span class="id"><a href="monae.hierarchy.html#isML_universe.Build">isML_universe.Build</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type">ml_type</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#Equality.class">Equality.class</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type_eqType">ml_type_eqType</a></span>) <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.coq_type63">coq_type63</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_unit">ml_unit</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.val_nonempty">val_nonempty</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="CoqTypeInt63.fact_for_int63" class="id"><a name="CoqTypeInt63.fact_for_int63" class="">fact_for_int63</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="CoqTypeInt63.fact_for_int63.N" class="id"><a name="CoqTypeInt63.fact_for_int63.N" class="">N</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#Monad.Exports.monad">monad</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="CoqTypeInt63.fact_for_int63.M" class="id"><a name="CoqTypeInt63.fact_for_int63.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadTypedStore.Exports.typedStoreMonad">typedStoreMonad</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type">ml_type</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.N">N</a></span> <span class="id"><a href="monae.monad_model.html#locT_nat">monad_model.locT_nat</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span id="CoqTypeInt63.coq_type" class="id"><a name="CoqTypeInt63.coq_type" class="">coq_type</a></span> <span class="id">:=</span> (<span class="id"><a href="monae.hierarchy.html#coq_type">hierarchy.coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.N">N</a></span>).<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">do_notation</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="CoqTypeInt63.fact_for_int63.forloop63" class="id"><a name="CoqTypeInt63.fact_for_int63.forloop63" class="">forloop63</a></span>.<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.forloop63" class="id"><a name="CoqTypeInt63.forloop63" class="">forloop63</a></span> (<span id="n_1:247" class="id"><a name="n_1:247" class="">n_1</a></span> <span id="n_2:248" class="id"><a name="n_2:248" class="">n_2</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#int">int</a></span>) (<span id="b:249" class="id"><a name="b:249" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#int">int</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#ltb">Sint63.ltb</a></span> <span class="id"><a href="monae.example_typed_store.html#n_2:248">n_2</a></span> <span class="id"><a href="monae.example_typed_store.html#n_1:247">n_1</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#iter">iter</a></span> (<span class="id"><a href="monae.example_typed_store.html#uint2N">uint2N</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#sub">sub</a></span> <span class="id"><a href="monae.example_typed_store.html#n_2:248">n_2</a></span> <span class="id"><a href="monae.example_typed_store.html#n_1:247">n_1</a></span>)).<span class="id">+1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> (<span id="m:250" class="id"><a name="m:250" class="">m</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#int">int</a></span>) <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="i:251" class="id"><a name="i:251" class="">i</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.example_typed_store.html#m:250">m;</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span class="id">_</span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.example_typed_store.html#b:249">b</a></span> <span class="id"><a href="monae.example_typed_store.html#i:251">i;</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Uint63.html#succ">Uint63.succ</a></span> <span class="id"><a href="monae.example_typed_store.html#i:251">i</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monae.example_typed_store.html#n_1:247">n_1</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#tt">tt</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="CoqTypeInt63.forloop63S" class="id"><a name="CoqTypeInt63.forloop63S" class="">forloop63S</a></span> <span id="m:252" class="id"><a name="m:252" class="">m</a></span> <span id="n:253" class="id"><a name="n:253" class="">n</a></span> (<span id="f:254" class="id"><a name="f:254" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#int">int</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#ltsb">ltsb</a></span> <span class="id"><a href="monae.example_typed_store.html#m:252">m</a></span> <span class="id"><a href="monae.example_typed_store.html#n:253">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.forloop63">forloop63</a></span> <span class="id"><a href="monae.example_typed_store.html#m:252">m</a></span> <span class="id"><a href="monae.example_typed_store.html#n:253">n</a></span> <span class="id"><a href="monae.example_typed_store.html#f:254">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.example_typed_store.html#f:254">f</a></span> <span class="id"><a href="monae.example_typed_store.html#m:252">m</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.forloop63">forloop63</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Uint63.html#succ">Uint63.succ</a></span> <span class="id"><a href="monae.example_typed_store.html#m:252">m</a></span>) <span class="id"><a href="monae.example_typed_store.html#n:253">n</a></span> <span class="id"><a href="monae.example_typed_store.html#f:254">f</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">rewrite</span> <span class="id">/forloop63</span> <span class="id">=&gt;</span> <span class="id">mn</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.example_typed_store.html#ltsbNlesb">ltsbNlesb</a></span> (<span class="id"><a href="monae.example_typed_store.html#ltsbW">ltsbW</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">mn</span>) <span class="id">/=</span>.<br/>
<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">nSm</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">mn;</span> <span class="id">rewrite</span> <span class="id"><a href="monae.example_typed_store.html#ltsbNlesb">ltsbNlesb</a></span> <span class="id">=&gt;</span> <span class="id">/negP;</span> <span class="id">elim;</span> <span class="id">apply</span> <span class="id"><a href="monae.example_typed_store.html#ltsbS_lesb">ltsbS_lesb</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.example_typed_store.html#ltsbNlesb">ltsbNlesb</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbK">negbK</a></span> <span class="gallina-kwd">in</span> <span class="id">nSm</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.example_typed_store.html#uint2N_sub_succ">uint2N_sub_succ</a></span> <span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#iterSr">iterSr</a></span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id">!bindA</span> <span class="id"><a href="monae.monad_lib.html#iter_bind">iter_bind</a></span> <span class="id">!bindA</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="CoqTypeInt63.forloop631" class="id"><a name="CoqTypeInt63.forloop631" class="">forloop631</a></span> <span id="m:255" class="id"><a name="m:255" class="">m</a></span> (<span id="f:256" class="id"><a name="f:256" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#int">int</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.forloop63">forloop63</a></span> <span class="id"><a href="monae.example_typed_store.html#m:255">m</a></span> <span class="id"><a href="monae.example_typed_store.html#m:255">m</a></span> <span class="id"><a href="monae.example_typed_store.html#f:256">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.example_typed_store.html#f:256">f</a></span> <span class="id"><a href="monae.example_typed_store.html#m:255">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
 <span class="id">rewrite</span> <span class="id">/forloop63</span>.<br/>
<span class="id">case:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#ltbP">Sint63.ltbP</a></span> <span class="id">m</span> <span class="id">m</span>) <span class="id">=&gt;</span> <span class="id">[/Z</span>.<span class="id">lt_irrefl</span> <span class="id">//</span> <span class="id">|</span> <span class="id">_]</span>.<br/>
<span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/uint2N</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Uint63.html#sub_spec">Uint63.sub_spec</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#Z.sub_diag">Z.sub_diag</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.Zdiv.html#Zmod_0_l">Zmod_0_l</a></span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!</span>(<span class="id"><a href="monae.hierarchy.html#bindretf">bindretf,bindA</a></span>) <span class="id"><a href="monae.hierarchy.html#bindmskip">bindmskip</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="CoqTypeInt63.forloop630" class="id"><a name="CoqTypeInt63.forloop630" class="">forloop630</a></span> <span id="m:257" class="id"><a name="m:257" class="">m</a></span> <span id="n:258" class="id"><a name="n:258" class="">n</a></span> (<span id="f:259" class="id"><a name="f:259" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#int">int</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#ltsb">ltsb</a></span> <span class="id"><a href="monae.example_typed_store.html#n:258">n</a></span> <span class="id"><a href="monae.example_typed_store.html#m:257">m</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.forloop63">forloop63</a></span> <span class="id"><a href="monae.example_typed_store.html#m:257">m</a></span> <span class="id"><a href="monae.example_typed_store.html#n:258">n</a></span> <span class="id"><a href="monae.example_typed_store.html#f:259">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.hierarchy.html#skip">skip</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/forloop63</span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.forloop63">forloop63</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.fact_for63" class="id"><a name="CoqTypeInt63.fact_for63" class="">fact_for63</a></span> (<span id="n:260" class="id"><a name="n:260" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.coq_type">coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_int">ml_int</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.M">M</a></span> (<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.coq_type">coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_int">ml_int</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="v:261" class="id"><a name="v:261" class="">v</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.hierarchy.html#cnew">cnew</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_int">ml_int</a></span> <span class="id">1</span>%<span class="id">int63;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span class="id">_</span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="u:262" class="id"><a name="u:262" class="">u</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id">1</span>%<span class="id">int63;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="v_1:263" class="id"><a name="v_1:263" class="">v_1</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monae.example_typed_store.html#n:260">n;</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.forloop63">forloop63</a></span> <span class="id"><a href="monae.example_typed_store.html#u:262">u</a></span> <span class="id"><a href="monae.example_typed_store.html#v_1:263">v_1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="i:264" class="id"><a name="i:264" class="">i</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="v_1:266" class="id"><a name="v_1:266" class="">v_1</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> (<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="v_1:265" class="id"><a name="v_1:265" class="">v_1</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.hierarchy.html#cget">cget</a></span> <span class="id"><a href="monae.example_typed_store.html#v:261">v;</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#mul">mul</a></span> <span class="id"><a href="monae.example_typed_store.html#v_1:265">v_1</a></span> <span class="id"><a href="monae.example_typed_store.html#i:264">i</a></span>))<span class="id">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#cput">cput</a></span> <span class="id"><a href="monae.example_typed_store.html#v:261">v</a></span> <span class="id"><a href="monae.example_typed_store.html#v_1:266">v_1</a></span>))<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#cget">cget</a></span> <span class="id"><a href="monae.example_typed_store.html#v:261">v</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="CoqTypeInt63.fact_for_int63.fact_for63_ok" class="id"><a name="CoqTypeInt63.fact_for_int63.fact_for63_ok" class="">fact_for63_ok</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="CoqTypeInt63.fact_for_int63.fact_for63_ok.n" class="id"><a name="CoqTypeInt63.fact_for_int63.fact_for63_ok.n" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>.<br/>
<span class="vernacular">Hypothesis</span> <span id="CoqTypeInt63.fact_for_int63.fact_for63_ok.Hn" class="id"><a name="CoqTypeInt63.fact_for_int63.fact_for63_ok.Hn" class="">Hn</a></span> <span class="id">:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#to_Z">Sint63.to_Z</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#max_int">Sint63.max_int</a></span>)%<span class="id">Z</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="CoqTypeInt63.fact_for_int63.fact_for63_ok.n_bounded" class="id"><a name="CoqTypeInt63.fact_for_int63.fact_for63_ok.n_bounded" class="">n_bounded</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#to_Z">Sint63.to_Z</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#min_int">Sint63.min_int</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#6f909ea2391c6073ff1047e870dd64e2">&lt;=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#to_Z">Sint63.to_Z</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#max_int">Sint63.max_int</a></span>)%<span class="id">Z</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="monae.example_typed_store.html#N2int_bounded">N2int_bounded,</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#Z.lt_le_incl">Z.lt_le_incl</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="CoqTypeInt63.ltsb_succ" class="id"><a name="CoqTypeInt63.ltsb_succ" class="">ltsb_succ</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#ltsb">ltsb</a></span> (<span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Uint63.html#succ">Uint63.succ</a></span> (<span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">apply/Sint63</span>.<span class="id">ltbP</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#succ_spec">Sint63.succ_spec</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#cmod_small">Sint63.cmod_small</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply/Zle_lt_succ/Z</span>.<span class="id">le_refl</span>.<br/>
<span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssrZ#leZ_addr">leZ_addr</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="gallina-kwd">by</span> <span class="id">case:</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Sint63.html#to_Z_bounded">Sint63.to_Z_bounded</a></span> (<span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>)).<br/>
<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#Z.lt_add_lt_sub_r">Z.lt_add_lt_sub_r</a></span><span class="id">;</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-Sint63</span>.<span class="id">is_int</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="CoqTypeInt63.ltsb_subr" class="id"><a name="CoqTypeInt63.ltsb_subr" class="">ltsb_subr</a></span> <span id="m:269" class="id"><a name="m:269" class="">m</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#m:269">m</a></span>.<span class="id">+1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#ltsb">ltsb</a></span> (<span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> (<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'-'_x">-</a></span> <span class="id"><a href="monae.example_typed_store.html#m:269">m</a></span>.<span class="id">+1</span>)) (<span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id">move=&gt;</span> <span class="id">Smn</span>.<br/>
<span class="id">apply/Sint63</span>.<span class="id">ltbP</span>.<br/>
<span class="id">have</span> <span class="id">Hm</span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'-'_x">-</a></span> <span class="id">m</span>.<span class="id">+1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltn_subLR">ltn_subLR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addSn">addSn</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#leq_addl">leq_addl</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltnW">ltnW</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/N2int</span> <span class="id">-!Sint63</span>.<span class="id">is_int</span> <span class="id">//</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">apply/inj_lt/ltP</span>.<br/>
<span class="id">-</span> <span class="id">move/ltP/inj_lt</span> <span class="gallina-kwd">in</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">split;</span> <span class="id">apply</span> <span class="id"><a href="monae.example_typed_store.html#N2int_bounded">N2int_bounded,</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#Z.lt_le_incl">Z.lt_le_incl</a></span><span class="id">,</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ZArith.BinInt.html#Z.lt_trans">Z.lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hm</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Theorem</span> <span id="CoqTypeInt63.fact_for63_ok" class="id"><a name="CoqTypeInt63.fact_for63_ok" class="">fact_for63_ok</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#crun">crun</a></span> (<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for63">fact_for63</a></span> (<span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#fact_rec">fact_rec</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">rewrite</span> <span class="id">/fact_for63</span>.<br/>
<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">!bindA</span> <span class="id">!bindretf</span>.<br/>
<span class="id">set</span> <span class="id">fn</span> <span class="id">:=</span> <span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#fact_rec">fact_rec</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>).<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monae.hierarchy.html#crun">crun</a></span> (<span class="id"><a href="monae.hierarchy.html#cnew">cnew</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_int">ml_int</a></span> <span class="id">fn</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id">fn</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.M">M</a></span> <span class="id">_</span>))<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#crunret">crunret</a></span> <span class="id">//</span> <span class="id"><a href="monae.typed_store_lib.html#crunnew0">crunnew0</a></span>.<br/>
<span class="id">congr</span> <span class="id"><a href="monae.hierarchy.html#crun">crun</a></span>.<br/>
<span class="id">have</span> <span class="id">{1}-&gt;</span> <span class="id">:</span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> <span class="id">1</span>)%<span class="id">int63</span> <span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
<span class="id">rewrite</span> <span class="id">-/</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#fact_rec">fact_rec</a></span> <span class="id">0</span>).<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> (<span class="id">1</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Uint63.html#succ">Uint63.succ</a></span> (<span class="id"><a href="monae.example_typed_store.html#N2int">N2int</a></span> <span class="id">0</span>))%<span class="id">int63</span> <span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
<span class="id">pose</span> <span class="id">m</span> <span class="id">:=</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'-'_x">-</a></span> <span class="id">m</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#subnn">subnn</a></span>.<br/>
<span class="id">have</span> <span class="id">:</span> <span class="id">m</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#cb53cf0ee22c036a03b4a9281c68b5a3">&lt;=</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span> <span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
<span class="id">elim:</span> <span class="id">m</span> <span class="id">=&gt;</span> <span class="id">[|m</span> <span class="id">IH]</span> <span class="id">mn</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#subn0">subn0</a></span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.forloop630">forloop630</a></span> (<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.ltsb_succ">ltsb_succ,bindretf</a></span>) <span class="id">//</span> <span class="id">-cgetret</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#cnewget">cnewget</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-N2int_succ</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#subnSK">subnSK</a></span> <span class="id">//</span>.<br/>
<span class="id">case:</span> <span class="id">m</span> <span class="id">IH</span> <span class="id">mn</span> <span class="id">=&gt;</span> <span class="id">[|m]</span> <span class="id">IH</span> <span class="id">mn</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#subn0">subn0</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.forloop631">forloop631</a></span> <span class="id">!</span>(<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.ltsb_subr">ltsb_subr,bindA</a></span>) <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#cnewget">cnewget</a></span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id">-cgetret</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#cnewput">cnewput</a></span> <span class="id">-N2int_mul</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#mulnC">mulnC</a></span> <span class="id">-{1}</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#prednK">prednK</a></span> <span class="id">mn</span>) <span class="id"><a href="monae.hierarchy.html#cnewget">cnewget</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#subn1">subn1</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-/</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#fact_rec">fact_rec</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n</a></span>.<span class="id">-1</span>.<span class="id">+1</span>) <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#prednK">prednK</a></span>.<br/>
<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.forloop63S">forloop63S</a></span> <span class="id">!</span>(<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.ltsb_subr">ltsb_subr,bindA</a></span>) <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#cnewget">cnewget</a></span>.<br/>
<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#cnewput">cnewput</a></span> <span class="id">-IH</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltnW">ltnW,subnS</a></span>) <span class="id">//</span> <span class="id">-N2int_mul</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#mulnC">mulnC</a></span> <span class="id">-</span>(@<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#prednK">prednK</a></span> (<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok.n">n-m</a></span>.<span class="id">+1</span>)) <span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#lt0n">lt0n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#subn_eq0">subn_eq0</a></span> <span class="id">-ltnNge</span>.<br/>
Qed.</div>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63.fact_for63_ok">fact_for63_ok</a></span>.<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for_int63">fact_for_int63</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="CoqTypeInt63.eval" class="id"><a name="CoqTypeInt63.eval" class="">eval</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monae.typed_store_model.html">typed_store_model</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.M" class="id"><a name="CoqTypeInt63.M" class="">M</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#dd4e793ea9d0dbe0a320346aa74c809d">[the</a></span> <span class="id"><a href="monae.hierarchy.html#MonadTypedStore.Exports.typedStoreMonad">typedStoreMonad</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type">ml_type</a></span> <span class="id">_</span> <span class="id"><a href="monae.monad_model.html#locT_nat">monad_model.locT_nat</a></span> <span class="id">of</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.typed_store_model.html#acto">acto</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type">ml_type]</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.Env" class="id"><a name="CoqTypeInt63.Env" class="">Env</a></span> <span class="id">:=</span> <span class="id"><a href="monae.typed_store_model.html#Env">typed_store_model.Env</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type">ml_type</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.empty_env" class="id"><a name="CoqTypeInt63.empty_env" class="">empty_env</a></span> <span class="id">:=</span> @<span class="id"><a href="monae.typed_store_model.html#mkEnv">typed_store_model.mkEnv</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type">ml_type</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.it0" class="id"><a name="CoqTypeInt63.it0" class="">it0</a></span> <span class="id">:</span> <span class="id"><a href="monae.typed_store_model.html#W">W</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#inr">inr</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#tt">tt,</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.empty_env">empty_env</a></span>).<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">do_notation</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span id="CoqTypeInt63.mkloc" class="id"><a name="CoqTypeInt63.mkloc" class="">mkloc</a></span> <span class="id">:=</span> (<span class="id"><a href="monae.hierarchy.html#mkloc">mkloc</a></span> (<span class="id">locT:=monad_model</span>.<span class="id">locT_nat</span>)).<br/>
<span class="vernacular">Local</span> <span class="vernacular">Notation</span> <span id="CoqTypeInt63.coq_type" class="id"><a name="CoqTypeInt63.coq_type" class="">coq_type</a></span> <span class="id">:=</span> (<span class="id"><a href="monae.hierarchy.html#coq_type">coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.M">M</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.incr" class="id"><a name="CoqTypeInt63.incr" class="">incr</a></span> (<span id="l:270" class="id"><a name="l:270" class="">l</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.loc">loc</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_int">ml_int</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.PrimInt63.html#int">int</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:271" class="id"><a name="x:271" class="">x</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.hierarchy.html#cget">cget</a></span> <span class="id"><a href="monae.example_typed_store.html#l:270">l;</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span class="id">_</span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.hierarchy.html#cput">cput</a></span> <span class="id"><a href="monae.example_typed_store.html#l:270">l</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Uint63.html#succ">Uint63.succ</a></span> <span class="id"><a href="monae.example_typed_store.html#x:271">x</a></span>)<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Numbers.Cyclic.Int63.Uint63.html#succ">Uint63.succ</a></span> <span class="id"><a href="monae.example_typed_store.html#x:271">x</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.l" class="id"><a name="CoqTypeInt63.l" class="">l</a></span> <span class="id">:</span> <span class="id"><a href="monae.typed_store_model.html#W">W</a></span> (<span class="id"><a href="monae.example_typed_store.html#MLTypes.loc">loc</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_int">ml_int</a></span>) <span class="id">:=</span> <span class="id"><a href="monae.typed_store_model.html#Restart">Restart</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.it0">it0</a></span> (<span class="id"><a href="monae.hierarchy.html#cnew">cnew</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_int">ml_int</a></span> <span class="id">3</span>)%<span class="id">int63</span>.<br/>
<span class="vernacular">Eval</span> <span class="id">vm_compute</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.l">l</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.it1" class="id"><a name="CoqTypeInt63.it1" class="">it1</a></span> <span class="id">:=</span> <span class="id"><a href="monae.typed_store_model.html#Restart">Restart</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.l">l</a></span> (<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="l:272" class="id"><a name="l:272" class="">l</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.typed_store_model.html#FromW">FromW</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.l">l;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.incr">incr</a></span> <span class="id"><a href="monae.example_typed_store.html#l:272">l</a></span>).<br/>
<span class="vernacular">Eval</span> <span class="id">vm_compute</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.it1">it1</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.it2" class="id"><a name="CoqTypeInt63.it2" class="">it2</a></span> <span class="id">:=</span> <span class="id"><a href="monae.typed_store_model.html#Restart">Restart</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.it1">it1</a></span> (<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="l:273" class="id"><a name="l:273" class="">l</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.typed_store_model.html#FromW">FromW</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.l">l;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.incr">incr</a></span> <span class="id"><a href="monae.example_typed_store.html#l:273">l</a></span>).<br/>
<span class="vernacular">Eval</span> <span class="id">vm_compute</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.it2">it2</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.it3" class="id"><a name="CoqTypeInt63.it3" class="">it3</a></span> <span class="id">:=</span> <span class="id"><a href="monae.typed_store_model.html#Restart">Restart</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.it2">it2</a></span> (<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.fact_for63">fact_for63</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.M">M</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.M">M</a></span> <span class="id">5</span>)%<span class="id">uint63</span>.<br/>
<span class="vernacular">Eval</span> <span class="id">vm_compute</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.it3">it3</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.AppM" class="id"><a name="CoqTypeInt63.AppM" class="">AppM</a></span> <span class="id">{A</span> <span id="B:275" class="id"><a name="B:275" class="">B}</a></span> (<span id="f:276" class="id"><a name="f:276" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.M">M</a></span> (<span class="id"><a href="monae.example_typed_store.html#A:274">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.M">M</a></span> <span class="id"><a href="monae.example_typed_store.html#B:275">B</a></span>)) (<span id="x:277" class="id"><a name="x:277" class="">x</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#A:274">A</a></span>) <span class="id">:=</span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="f:278" class="id"><a name="f:278" class="">f</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.example_typed_store.html#f:276">f;</a></span> <span class="id"><a href="monae.example_typed_store.html#f:278">f</a></span> <span class="id"><a href="monae.example_typed_store.html#x:277">x</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.omega" class="id"><a name="CoqTypeInt63.omega" class="">omega</a></span> (<span id="T:279" class="id"><a name="T:279" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_type">ml_type</a></span>) (<span id="n:280" class="id"><a name="n:280" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.coq_type">coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#T:279">T</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.M">M</a></span> (<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.coq_type">coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#T:279">T</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="r_1:282" class="id"><a name="r_1:282" class="">r_1</a></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.hierarchy.html#cnew">cnew</a></span> (<span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_arrow">ml_arrow</a></span> <span class="id"><a href="monae.example_typed_store.html#T:279">T</a></span> <span class="id"><a href="monae.example_typed_store.html#T:279">T</a></span>) (<span class="gallina-kwd">fun</span> <span id="x:281" class="id"><a name="x:281" class="">x</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.coq_type">coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#T:279">T</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_typed_store.html#x:281">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.coq_type">coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#T:279">T</a></span>))<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="delta:285" class="id"><a name="delta:285" class="">delta</a></span> (<span id="i:284" class="id"><span id="i:283" class="id"><a name="i:284" class="">i</a></span></span> <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.coq_type">coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#T:279">T</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.M">M</a></span> (<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.coq_type">coq_type</a></span> <span class="id"><a href="monae.example_typed_store.html#T:279">T</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.AppM">AppM</a></span> (<span class="id"><a href="monae.hierarchy.html#cget">cget</a></span> <span class="id"><a href="monae.example_typed_store.html#r_1:282">r_1</a></span>) <span class="id"><a href="monae.example_typed_store.html#i:283">i</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span class="id">_</span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.hierarchy.html#cput">cput</a></span> <span class="id"><a href="monae.example_typed_store.html#r_1:282">r_1</a></span> <span class="id"><a href="monae.example_typed_store.html#delta:285">delta;</a></span> <span class="id"><a href="monae.example_typed_store.html#delta:285">delta</a></span> <span class="id"><a href="monae.example_typed_store.html#n:280">n</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="CoqTypeInt63.it_omega" class="id"><a name="CoqTypeInt63.it_omega" class="">it_omega</a></span> <span class="id">:=</span> <span class="id"><a href="monae.typed_store_model.html#Restart">Restart</a></span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.it3">it3</a></span> (<span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.omega">omega</a></span> <span class="id"><a href="monae.example_typed_store.html#MLTypes.ml_unit">ml_unit</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#tt">tt</a></span>).<br/>
<span class="vernacular">Fail</span> <span class="id">Timeout</span> <span class="id">1</span> <span class="vernacular">Eval</span> <span class="id">vm_compute</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.it_omega">it_omega</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63.eval">eval</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_typed_store.html#CoqTypeInt63">CoqTypeInt63</a></span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
