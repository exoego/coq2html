
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module monae.example_iquicksort</title>
<meta name="description" content="Documentation of Coq module monae.example_iquicksort" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="monae"><summary>monae</summary>
          <ul>
          <li><a href="monae.altprob_model.html">altprob_model</a></li>
<li><a href="monae.array_lib.html">array_lib</a></li>
<li><a href="monae.category.html">category</a></li>
<li><a href="monae.category_ext.html">category_ext</a></li>
<li><a href="monae.example_iquicksort.html">example_iquicksort</a></li>
<li><a href="monae.example_monty.html">example_monty</a></li>
<li><a href="monae.example_nqueens.html">example_nqueens</a></li>
<li><a href="monae.example_quicksort.html">example_quicksort</a></li>
<li><a href="monae.example_relabeling.html">example_relabeling</a></li>
<li><a href="monae.example_spark.html">example_spark</a></li>
<li><a href="monae.example_transformer.html">example_transformer</a></li>
<li><a href="monae.example_typed_store.html">example_typed_store</a></li>
<li><a href="monae.fail_lib.html">fail_lib</a></li>
<li><a href="monae.gcm_model.html">gcm_model</a></li>
<li><a href="monae.hierarchy.html">hierarchy</a></li>
<li><a href="monae.monad_composition.html">monad_composition</a></li>
<li><a href="monae.monad_lib.html">monad_lib</a></li>
<li><a href="monae.monad_model.html">monad_model</a></li>
<li><a href="monae.monad_transformer.html">monad_transformer</a></li>
<li><a href="monae.monae_lib.html">monae_lib</a></li>
<li><a href="monae.proba_lib.html">proba_lib</a></li>
<li><a href="monae.proba_monad_model.html">proba_monad_model</a></li>
<li><a href="monae.smallstep.html">smallstep</a></li>
<li><a href="monae.state_lib.html">state_lib</a></li>
<li><a href="monae.trace_lib.html">trace_lib</a></li>
<li><a href="monae.typed_store_lib.html">typed_store_lib</a></li>
<li><a href="monae.typed_store_model.html">typed_store_model</a></li>
          </ul>
          </details>
          </li>
<li><details id="monaeImpredicativeSet"><summary>monaeImpredicativeSet</summary>
          <ul>
          <li><a href="monaeImpredicativeSet.iexample_transformer.html">iexample_transformer</a></li>
<li><a href="monaeImpredicativeSet.ifail_lib.html">ifail_lib</a></li>
<li><a href="monaeImpredicativeSet.ifmt_lifting.html">ifmt_lifting</a></li>
<li><a href="monaeImpredicativeSet.ihierarchy.html">ihierarchy</a></li>
<li><a href="monaeImpredicativeSet.imonad_composition.html">imonad_composition</a></li>
<li><a href="monaeImpredicativeSet.imonad_lib.html">imonad_lib</a></li>
<li><a href="monaeImpredicativeSet.imonad_model.html">imonad_model</a></li>
<li><a href="monaeImpredicativeSet.imonad_transformer.html">imonad_transformer</a></li>
<li><a href="monaeImpredicativeSet.imonae_lib.html">imonae_lib</a></li>
<li><a href="monaeImpredicativeSet.iparametricity_codensity.html">iparametricity_codensity</a></li>
<li><a href="monaeImpredicativeSet.istate_lib.html">istate_lib</a></li>
<li><a href="monaeImpredicativeSet.itrace_lib.html">itrace_lib</a></li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module monae.example_iquicksort</h1>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.classical.boolp">boolp</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monae.monae_lib.html">monae_lib</a></span> <span class="id"><a href="monae.hierarchy.html">hierarchy</a></span> <span class="id"><a href="monae.monad_lib.html">monad_lib</a></span> <span class="id"><a href="monae.fail_lib.html">fail_lib</a></span> <span class="id"><a href="monae.state_lib.html">state_lib</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monae.array_lib.html">array_lib</a></span> <span class="id"><a href="monae.example_quicksort.html">example_quicksort</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">infotheo</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for infotheo.lib.ssr_ext">ssr_ext</a></span>.<br/>
<br/>
<pre class="ssrdoc">
                     Quicksort with the Array Monad                        
                                                                           
   partl p (s, t) u == partition u into (x, y) w.r.t. pivot p and returns  
                       (s ++ x, t ++ y)                                    
           dispatch == if x &lt;= p then qperm zs &gt;&gt;= f (rcons ys x)          
                       else qperm (rcons zs x) &gt;&gt;= f ys                    
qperm_partl p s t u == fusion of qperm and partl; this is a computation    
                       of type M (seq E * seq E * seq E) where E is the    
                       type of the values in the array monad               
ipartl p i ny nz nx == partition the array stored at i w.r.t. the pivot p, 
                       the array is yz ++ zs ++ xs where the lengths of    
                       yz, zs, xs are resp. ny, nz, nx; it returns the     
                       lengths of the partitions this is a computation of  
                       of type M (nat * nat)                               
  dipartl p i y z x == same as ipartl except that it returns a dependent   
                       pair of type                                        
                       {(a, b)| a &lt;= x + y + z &amp;&amp; b &lt;= x + y +z}           
      iqsort (i, n) == quicksort the list of size n stored from address i  
                                                                           
                                                                           
Reference:                                                                 
- [1] Shin-Cheng Mu, Tsung-Ju Chiang, Declarative Pearl: Deriving Monadic  
      Quicksort, FLOPS 2020                                                
</pre>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Printing</span> <span class="vernacular">Implicit</span> <span class="vernacular">Defensive</span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">order_scope</span>.<br/>
<span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Theory">Order.Theory</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">monae_scope</span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">tuple_ext_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="partl" class="id"><a name="partl" class="">partl</a></span>.<br/>
<span class="vernacular">Variable</span> (<span id="partl.d" class="id"><a name="partl.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="partl.E" class="id"><a name="partl.E" class="">E</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:1">d</a></span>) (<span id="partl.M" class="id"><a name="partl.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#E:2">E</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>).<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">p</span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#partl.E">E</a></span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="partl" class="id"><a name="partl" class="">partl</a></span> <span id="p:4" class="id"><a name="p:4" class="">p</a></span> (<span id="s:5" class="id"><a name="s:5" class="">s</a></span> <span class="id">:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#partl.E">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#partl.E">E</a></span>)%<span class="id">type</span>) (<span id="xs:6" class="id"><a name="xs:6" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#partl.E">E</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#partl.E">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#partl.E">E</a></span>)%<span class="id">type</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_iquicksort.html#xs:6">xs</a></span> <span class="id">is</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span> <span class="gallina-kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">if</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:4">p</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monae.example_iquicksort.html#partl:7">partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:4">p</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monae.example_iquicksort.html#s:5">s</a></span>.<span class="id">1</span> <span class="id">x,</span> <span class="id"><a href="monae.example_iquicksort.html#s:5">s</a></span>.<span class="id">2</span>) <span class="id"><a href="monae.example_iquicksort.html#xs:6">xs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monae.example_iquicksort.html#partl:7">partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:4">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#s:5">s</a></span>.<span class="id">1,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monae.example_iquicksort.html#s:5">s</a></span>.<span class="id">2</span> <span class="id">x</span>) <span class="id"><a href="monae.example_iquicksort.html#xs:6">xs</a></span>)<br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monae.example_iquicksort.html#s:5">s</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="partl.partlE" class="id"><a name="partl.partlE" class="">partlE</a></span> <span id="s:9" class="id"><a name="s:9" class="">s</a></span> <span id="t:10" class="id"><a name="t:10" class="">t</a></span> <span id="p:11" class="id"><a name="p:11" class="">p</a></span> <span id="u:12" class="id"><a name="u:12" class="">u</a></span> <span class="id">:</span> <span class="gallina-kwd">let</span> <span id="x:13" class="id"><a name="x:13" class="">x</a></span> <span class="id">:=</span> <span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:11">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#u:12">u</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#partl">partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:11">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#s:9">s,</a></span> <span class="id"><a href="monae.example_iquicksort.html#t:10">t</a></span>) <span class="id"><a href="monae.example_iquicksort.html#u:12">u</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="monae.example_iquicksort.html#s:9">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:13">x</a></span>.<span class="id">1,</span> <span class="id"><a href="monae.example_iquicksort.html#t:10">t</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:13">x</a></span>.<span class="id">2</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">elim:</span> <span class="id">u</span> <span class="id">p</span> <span class="id">s</span> <span class="id">t</span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">tl</span> <span class="id">ih]</span> <span class="id">/=</span> <span class="id">p</span> <span class="id">a</span> <span class="id">b;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!cats0</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">hp;</span> <span class="id">rewrite</span> <span class="id">ih</span> <span class="id">/=</span> <span class="id">-cats1</span> <span class="id">/=</span> <span class="id">-catA</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="partition_partl" class="id"><a name="partition_partl" class="">partition_partl</a></span> <span id="p:14" class="id"><a name="p:14" class="">p</a></span> <span id="xs:15" class="id"><a name="xs:15" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:14">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:15">xs</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.example_iquicksort.html#partl">partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:14">p</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::],</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="id"><a href="monae.example_iquicksort.html#xs:15">xs</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.example_iquicksort.html#partl.partlE">partlE</a></span> <span class="id">/=;</span> <span class="id">case:</span> <span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#partl">partl</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="dispatch" class="id"><a name="dispatch" class="">dispatch</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="dispatch.d" class="id"><a name="dispatch.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="dispatch.E" class="id"><a name="dispatch.E" class="">E</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:16">d</a></span>) (<span id="dispatch.M" class="id"><a name="dispatch.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#E:17">E</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>).<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">i</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="dispatch" class="id"><a name="dispatch" class="">dispatch</a></span> (<span id="x:19" class="id"><a name="x:19" class="">x</a></span> <span id="p:20" class="id"><a name="p:20" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.E">E</a></span>) <span class="id">'</span>(<span id="ys:22" class="id"><a name="ys:22" class="">ys,</a></span> <span id="zs:21" class="id"><a name="zs:21" class="">zs</a></span>) <span id="A:24" class="id"><a name="A:24" class="">A</a></span> (<span id="f:25" class="id"><a name="f:25" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.E">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.E">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.M">M</a></span> <span class="id"><a href="monae.example_iquicksort.html#A:24">A</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.M">M</a></span> <span class="id"><a href="monae.example_iquicksort.html#A:24">A</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_iquicksort.html#x:19">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:20">p</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:21">zs</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#f:25">f</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:22">ys</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:19">x</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:21">zs</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:19">x</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#f:25">f</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:22">ys</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="dispatch_Ret" class="id"><a name="dispatch_Ret" class="">dispatch_Ret</a></span> (<span id="x:26" class="id"><a name="x:26" class="">x</a></span> <span id="p:27" class="id"><a name="p:27" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.E">E</a></span>) <span class="id">'</span>(<span id="ys:30" class="id"><a name="ys:30" class="">ys,</a></span> <span id="zs:29" class="id"><a name="zs:29" class="">zs,</a></span> <span id="xs:28" class="id"><a name="xs:28" class="">xs</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.E">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.E">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.E">E</a></span>)%<span class="id">type</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#dispatch">dispatch</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:26">x</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:27">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:30">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:29">zs</a></span>) (<span class="gallina-kwd">fun</span> <span id="ys':32" class="id"><a name="ys':32" class="">ys'</a></span> <span id="zs':33" class="id"><a name="zs':33" class="">zs'</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys':32">ys',</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':33">zs',</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:28">xs</a></span>)).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="dispatch_Ret_isNondet" class="id"><a name="dispatch_Ret_isNondet" class="">dispatch_Ret_isNondet</a></span> <span id="x:34" class="id"><a name="x:34" class="">x</a></span> <span id="p:35" class="id"><a name="p:35" class="">p</a></span> <span id="yszsxs:36" class="id"><a name="yszsxs:36" class="">yszsxs</a></span> <span class="id">:</span> <span class="id"><a href="monae.fail_lib.html#plus_isNondet">plus_isNondet</a></span> (<span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret">dispatch_Ret</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:34">x</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:35">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#yszsxs:36">yszsxs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
<span class="id">rewrite</span> <span class="id">/dispatch/=;</span> <span class="id">move:</span> <span class="id">yszsxs</span> <span class="id">=&gt;</span> <span class="id">[[ys</span> <span class="id">zs]</span> <span class="id">xs]/=;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">xp</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">[syn</span> <span class="id">syn_qperm]</span> <span class="id">:=</span> @<span class="id"><a href="monae.fail_lib.html#qperm_isNondet">qperm_isNondet</a></span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.M">M</a></span> <span class="id">_</span> <span class="id">zs</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndBind">ndBind</a></span> <span class="id">syn</span> (<span class="gallina-kwd">fun</span> <span id="s:38" class="id"><span id="s:37" class="id"><a name="s:38" class="">s</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndRet">ndRet</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">ys</span> <span class="id">x,</span> <span class="id"><a href="monae.example_iquicksort.html#s:37">s,</a></span> <span class="id">xs</span>))).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id">syn_qperm</span>.<br/>
<span class="id">have</span> <span class="id">[syn</span> <span class="id">syn_qperm]</span> <span class="id">:=</span> @<span class="id"><a href="monae.fail_lib.html#qperm_isNondet">qperm_isNondet</a></span> <span class="id"><a href="monae.example_iquicksort.html#dispatch.M">M</a></span> <span class="id">_</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">zs</span> <span class="id">x</span>).<br/>
<span class="gallina-kwd">by</span> <span class="gallina-kwd">exists</span> (<span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndBind">ndBind</a></span> <span class="id">syn</span> (<span class="gallina-kwd">fun</span> <span id="s:40" class="id"><span id="s:39" class="id"><a name="s:40" class="">s</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndRet">ndRet</a></span> (<span class="id">ys,</span> <span class="id"><a href="monae.example_iquicksort.html#s:39">s,</a></span> <span class="id">xs</span>)))<span class="id">;</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id">syn_qperm</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#dispatch">dispatch</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret">dispatch_Ret</a></span> <span class="id">{d</span> <span class="id">E</span> <span class="id">M}</span>.<br/>
<br/>
<span class="id">#[global]</span> <span class="vernacular">Hint</span> <span class="id">Extern</span> <span class="id">0</span> (<span class="id"><a href="monae.fail_lib.html#plus_isNondet">plus_isNondet</a></span> (<span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret">dispatch_Ret</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id">solve[exact:</span> <span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret_isNondet">dispatch_Ret_isNondet]</a></span> <span class="id">:</span> <span class="id">core</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="qperm_partl" class="id"><a name="qperm_partl" class="">qperm_partl</a></span>.<br/>
<span class="vernacular">Variable</span> (<span id="qperm_partl.d" class="id"><a name="qperm_partl.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="qperm_partl.E" class="id"><a name="qperm_partl.E" class="">E</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:41">d</a></span>) (<span id="qperm_partl.M" class="id"><a name="qperm_partl.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#E:42">E</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>).<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">p</span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.E">E</a></span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="qperm_partl" class="id"><a name="qperm_partl" class="">qperm_partl</a></span> <span id="p:44" class="id"><a name="p:44" class="">p</a></span> (<span id="ys:45" class="id"><a name="ys:45" class="">ys</a></span> <span id="zs:46" class="id"><a name="zs:46" class="">zs</a></span> <span id="xs:47" class="id"><a name="xs:47" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.E">E</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.E">E</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.E">E</a></span>)%<span class="id">type</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_iquicksort.html#xs:47">xs</a></span> <span class="id">is</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span> <span class="gallina-kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#dispatch">dispatch</a></span> <span class="id">x</span> <span class="id"><a href="monae.example_iquicksort.html#p:44">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:45">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:46">zs</a></span>) (<span class="gallina-kwd">fun</span> <span id="ys':50" class="id"><a name="ys':50" class="">ys'</a></span> <span id="zs':51" class="id"><a name="zs':51" class="">zs'</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl:48">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:44">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys':50">ys'</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':51">zs'</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:47">xs</a></span>)<br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:45">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:46">zs</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="qperm_partl_isNondet" class="id"><a name="qperm_partl_isNondet" class="">qperm_partl_isNondet</a></span> <span id="p:52" class="id"><a name="p:52" class="">p</a></span> (<span id="s:53" class="id"><a name="s:53" class="">s</a></span> <span id="a:54" class="id"><a name="a:54" class="">a</a></span> <span id="b:55" class="id"><a name="b:55" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.E">E</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.fail_lib.html#plus_isNondet">plus_isNondet</a></span> (<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:52">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:54">a</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:55">b</a></span> <span class="id"><a href="monae.example_iquicksort.html#s:53">s</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">p</span> <span class="id">a</span> <span class="id">b</span> <span class="id">=&gt;</span> <span class="id">[p</span> <span class="id">a</span> <span class="id">b|h</span> <span class="id">t</span> <span class="id">ih</span> <span class="id">p</span> <span class="id">a</span> <span class="id">b</span> <span class="id">/=];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="gallina-kwd">exists</span> (<span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndRet">ndRet</a></span> (<span class="id">a,</span> <span class="id">b</span>)).<br/>
<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">hp</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">[syn</span> <span class="id">synE]</span> <span class="id">:=</span> @<span class="id"><a href="monae.fail_lib.html#qperm_isNondet">qperm_isNondet</a></span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.M">M</a></span> <span class="id">_</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndBind">ndBind</a></span> <span class="id">syn</span> (<span class="gallina-kwd">fun</span> <span id="zs':57" class="id"><span id="zs':56" class="id"><a name="zs':57" class="">zs'</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrfun.html#sval">sval</a></span> (<span class="id">ih</span> <span class="id">p</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">a</span> <span class="id">h</span>) <span class="id"><a href="monae.example_iquicksort.html#zs':56">zs'</a></span>))) <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">synE</span> <span class="id">/=;</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span>  <span class="id">?</span> <span class="id">/=;</span> <span class="id">case:</span> <span class="id">ih</span>.<br/>
<span class="id">have</span> <span class="id">[syn</span> <span class="id">synE]</span> <span class="id">:=</span> @<span class="id"><a href="monae.fail_lib.html#qperm_isNondet">qperm_isNondet</a></span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.M">M</a></span> <span class="id">_</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">b</span> <span class="id">h</span>).<br/>
<span class="gallina-kwd">exists</span> (<span class="id"><a href="monae.fail_lib.html#SyntaxNondet.Exports.ndBind">ndBind</a></span> <span class="id">syn</span> (<span class="gallina-kwd">fun</span> <span id="zs':59" class="id"><span id="zs':58" class="id"><a name="zs':59" class="">zs'</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrfun.html#sval">sval</a></span> (<span class="id">ih</span> <span class="id">p</span> <span class="id">a</span> <span class="id"><a href="monae.example_iquicksort.html#zs':58">zs'</a></span>))) <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">synE</span> <span class="id">/=;</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">/=;</span> <span class="id">case:</span> <span class="id">ih</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="qperm_partl_cons" class="id"><a name="qperm_partl_cons" class="">qperm_partl_cons</a></span> (<span id="p:60" class="id"><a name="p:60" class="">p</a></span> <span id="x:61" class="id"><a name="x:61" class="">x</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.E">E</a></span>) (<span id="ys:62" class="id"><a name="ys:62" class="">ys</a></span> <span id="zs:63" class="id"><a name="zs:63" class="">zs</a></span> <span id="xs:64" class="id"><a name="xs:64" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl.E">E</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:60">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:62">ys</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:63">zs</a></span> (<span class="id"><a href="monae.example_iquicksort.html#x:61">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:64">xs</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret">dispatch_Ret</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:61">x</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:60">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:62">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:63">zs,</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:64">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.monae_lib.html#uncurry3">uncurry3</a></span> (<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:60">p</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">xp;</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span><br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">[RHS]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">{d</span> <span class="id">E</span> <span class="id">M}</span>.<br/>
<br/>
<span class="id">#[global]</span> <span class="vernacular">Hint</span> <span class="id">Extern</span> <span class="id">0</span> (<span class="id"><a href="monae.fail_lib.html#plus_isNondet">plus_isNondet</a></span> (<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id">solve[exact:</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl_isNondet">qperm_partl_isNondet]</a></span> <span class="id">:</span> <span class="id">core</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="ipartl" class="id"><a name="ipartl" class="">ipartl</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="ipartl.d" class="id"><a name="ipartl.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="ipartl.T" class="id"><a name="ipartl.T" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:65">d</a></span>).<br/>
<br/>
<span class="vernacular">Section</span> <span id="ipartl.arrayMonad" class="id"><a name="ipartl.arrayMonad" class="">arrayMonad</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="ipartl.arrayMonad.M" class="id"><a name="ipartl.arrayMonad.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadArray.Exports.arrayMonad">arrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#ipartl.T">T</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="ipartl" class="id"><a name="ipartl" class="">ipartl</a></span> <span id="p:68" class="id"><a name="p:68" class="">p</a></span> <span id="i:69" class="id"><a name="i:69" class="">i</a></span> <span id="ny:70" class="id"><a name="ny:70" class="">ny</a></span> <span id="nz:71" class="id"><a name="nz:71" class="">nz</a></span> <span id="nx:72" class="id"><a name="nx:72" class="">nx</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#ipartl.arrayMonad.M">M</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>)%<span class="id">type</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_iquicksort.html#nx:72">nx</a></span> <span class="id">is</span> <span class="id">k</span>.<span class="id">+1</span> <span class="gallina-kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#aget">aget</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:69">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ny:70">ny</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#nz:71">nz</a></span>)) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x:75" class="id"><a name="x:75" class="">x</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_iquicksort.html#x:75">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:68">p</a></span> <span class="gallina-kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#aswap">aswap</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:69">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:70">ny</a></span>) (<span class="id"><a href="monae.example_iquicksort.html#i:69">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:70">ny</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#nz:71">nz</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#ipartl:73">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:68">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:69">i</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:70">ny</a></span>.<span class="id">+1</span> <span class="id"><a href="monae.example_iquicksort.html#nz:71">nz</a></span> <span class="id">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#ipartl:73">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:68">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:69">i</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:70">ny</a></span> <span class="id"><a href="monae.example_iquicksort.html#nz:71">nz</a></span>.<span class="id">+1</span> <span class="id">k</span>)<br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ny:70">ny,</a></span> <span class="id"><a href="monae.example_iquicksort.html#nz:71">nz</a></span>).<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#ipartl.arrayMonad">arrayMonad</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id">{M}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="ipartl.plusArrayMonad" class="id"><a name="ipartl.plusArrayMonad" class="">plusArrayMonad</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="ipartl.plusArrayMonad.M" class="id"><a name="ipartl.plusArrayMonad.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#ipartl.T">T</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="ipartl_guard" class="id"><a name="ipartl_guard" class="">ipartl_guard</a></span> <span id="p:77" class="id"><a name="p:77" class="">p</a></span> <span id="i:78" class="id"><a name="i:78" class="">i</a></span> <span id="ny:79" class="id"><a name="ny:79" class="">ny</a></span> <span id="nz:80" class="id"><a name="nz:80" class="">nz</a></span> <span id="nx:81" class="id"><a name="nx:81" class="">nx</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#ipartl.plusArrayMonad.M">M</a></span>) <span class="id"><a href="monae.example_iquicksort.html#p:77">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:78">i</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:79">ny</a></span> <span class="id"><a href="monae.example_iquicksort.html#nz:80">nz</a></span> <span class="id"><a href="monae.example_iquicksort.html#nx:81">nx</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:77">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:78">i</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:79">ny</a></span> <span class="id"><a href="monae.example_iquicksort.html#nz:80">nz</a></span> <span class="id"><a href="monae.example_iquicksort.html#nx:81">nx</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="a:83" class="id"><a name="a:83" class="">a,</a></span> <span id="b:82" class="id"><a name="b:82" class="">b</a></span>) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.hierarchy.html#guard">guard</a></span> ((<span class="id"><a href="monae.example_iquicksort.html#a:83">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#cb53cf0ee22c036a03b4a9281c68b5a3">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#nx:81">nx</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:79">ny</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#nz:80">nz</a></span>) &amp;&amp; (<span class="id"><a href="monae.example_iquicksort.html#b:82">b</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#cb53cf0ee22c036a03b4a9281c68b5a3">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#nx:81">nx</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:79">ny</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#nz:80">nz</a></span>))%<span class="id">N</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monae.example_iquicksort.html#a:83">a,</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:82">b</a></span>))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id">elim:</span> <span class="id">nx</span> <span class="id">ny</span> <span class="id">nz</span> <span class="id">=&gt;</span> <span class="id">[ny</span> <span class="id">nz|n</span> <span class="id">ih</span> <span class="id">ny</span> <span class="id">nz]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#add0n">add0n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#leq_addr">leq_addr</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#leq_addl">leq_addl</a></span> <span class="id"><a href="monae.hierarchy.html#guardT">guardT</a></span> <span class="id"><a href="monae.hierarchy.html#bindskipf">bindskipf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/=</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]bindA;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">x;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">xp</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]bindA;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[];</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]ih</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">-addSnnS</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]ih</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addSnnS">addSnnS</a></span> <span class="id">-addnA</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addSnnS">addSnnS</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addnA">addnA</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#ipartl.plusArrayMonad">plusArrayMonad</a></span>.<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id">{d</span> <span class="id">T</span> <span class="id">M}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="dipartl" class="id"><a name="dipartl" class="">dipartl</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="dipartl.d" class="id"><a name="dipartl.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="dipartl.T" class="id"><a name="dipartl.T" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:85">d</a></span>) (<span id="dipartl.M" class="id"><a name="dipartl.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#T:86">T</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="dipartlT" class="id"><a name="dipartlT" class="">dipartlT</a></span> <span id="y:88" class="id"><a name="y:88" class="">y</a></span> <span id="z:89" class="id"><a name="z:89" class="">z</a></span> <span id="x:90" class="id"><a name="x:90" class="">x</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#6556914db359db999889decec6a4a562">{n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#6556914db359db999889decec6a4a562">:</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#6556914db359db999889decec6a4a562">|</a></span> (<span class="id"><a href="monae.example_iquicksort.html#n:91">n</a></span>.<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:90">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#y:88">y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#z:89">z</a></span>) &amp;&amp; (<span class="id"><a href="monae.example_iquicksort.html#n:91">n</a></span>.<span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:90">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#y:88">y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#z:89">z</a></span>)<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#6556914db359db999889decec6a4a562">}</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="dipartlT1" class="id"><a name="dipartlT1" class="">dipartlT1</a></span> <span id="y:92" class="id"><a name="y:92" class="">y</a></span> <span id="z:93" class="id"><a name="z:93" class="">z</a></span> <span id="x:94" class="id"><a name="x:94" class="">x</a></span> (<span id="a:95" class="id"><a name="a:95" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#dipartlT">dipartlT</a></span> <span class="id"><a href="monae.example_iquicksort.html#y:92">y</a></span> <span class="id"><a href="monae.example_iquicksort.html#z:93">z</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:94">x</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">:=</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrfun.html#sval">sval</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:95">a</a></span>).<span class="id">1</span>.<br/>
<span class="vernacular">Definition</span> <span id="dipartlT2" class="id"><a name="dipartlT2" class="">dipartlT2</a></span> <span id="y:96" class="id"><a name="y:96" class="">y</a></span> <span id="z:97" class="id"><a name="z:97" class="">z</a></span> <span id="x:98" class="id"><a name="x:98" class="">x</a></span> (<span id="a:99" class="id"><a name="a:99" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#dipartlT">dipartlT</a></span> <span class="id"><a href="monae.example_iquicksort.html#y:96">y</a></span> <span class="id"><a href="monae.example_iquicksort.html#z:97">z</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:98">x</a></span>) <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">:=</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrfun.html#sval">sval</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:99">a</a></span>).<span class="id">2</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="dipartl" class="id"><a name="dipartl" class="">dipartl</a></span> <span id="p:100" class="id"><a name="p:100" class="">p</a></span> <span id="i:101" class="id"><a name="i:101" class="">i</a></span> <span id="y:102" class="id"><a name="y:102" class="">y</a></span> <span id="z:103" class="id"><a name="z:103" class="">z</a></span> <span id="x:104" class="id"><a name="x:104" class="">x</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.M">M</a></span> (<span class="id"><a href="monae.example_iquicksort.html#dipartlT">dipartlT</a></span> <span class="id"><a href="monae.example_iquicksort.html#y:102">y</a></span> <span class="id"><a href="monae.example_iquicksort.html#z:103">z</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:104">x</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:100">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:101">i</a></span> <span class="id"><a href="monae.example_iquicksort.html#y:102">y</a></span> <span class="id"><a href="monae.example_iquicksort.html#z:103">z</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:104">x</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.fail_lib.html#dassert">dassert</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#27dabc72ea2c2c768f2db80a79f42524">[pred</a></span> <span id="n:105" class="id"><a name="n:105" class="">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#27dabc72ea2c2c768f2db80a79f42524">|</a></span> (<span class="id"><a href="monae.example_iquicksort.html#n:105">n</a></span>.<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:104">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#y:102">y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#z:103">z</a></span>) &amp;&amp; (<span class="id"><a href="monae.example_iquicksort.html#n:105">n</a></span>.<span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:104">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#y:102">y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#z:103">z</a></span>)<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#27dabc72ea2c2c768f2db80a79f42524">]</a></span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<span class="vernacular">Lemma</span> <span id="ipartlE" class="id"><a name="ipartlE" class="">ipartlE</a></span> <span id="p:106" class="id"><a name="p:106" class="">p</a></span> <span id="i:107" class="id"><a name="i:107" class="">i</a></span> <span id="n:108" class="id"><a name="n:108" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:106">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:107">i</a></span> <span class="id">0</span> <span class="id">0</span> <span class="id"><a href="monae.example_iquicksort.html#n:108">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="gallina-kwd">fun</span> <span id="x:109" class="id"><a name="x:109" class="">x</a></span> <span class="id">=&gt;</span> (<span class="id"><a href="monae.example_iquicksort.html#dipartlT1">dipartlT1</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:109">x,</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartlT2">dipartlT2</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:109">x</a></span>)) (<span class="id"><a href="monae.example_iquicksort.html#dipartl">dipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:106">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:107">i</a></span> <span class="id">0</span> <span class="id">0</span> <span class="id"><a href="monae.example_iquicksort.html#n:108">n</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#fmapE">fmapE</a></span> <span class="id">/dipartl</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monae.example_iquicksort.html#ipartl_guard">ipartl_guard</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[a</span> <span class="id">b]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#bind_ext_guard">bind_ext_guard</a></span> <span class="id">=&gt;</span> <span class="id">/andP[na</span> <span class="id">nb]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id">/dassert</span> <span class="id">/=</span>.<br/>
<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Bool.Bool.html#bool_dec">Bool.bool_dec</a></span> <span class="id">=&gt;</span> <span class="id">[nanb|/negP];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negb_and">negb_and</a></span> <span class="id">=&gt;</span> <span class="id">/orP[|]</span> <span class="id">/negP</span>.<br/>
Qed.</div>
<span class="vernacular">Local</span> <span class="vernacular">Close</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="dipartl.refin_dispatch_write3L_ipartl" class="id"><a name="dipartl.refin_dispatch_write3L_ipartl" class="">refin_dispatch_write3L_ipartl</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="dipartl.refin_dispatch_write3L_ipartl.i" class="id"><a name="dipartl.refin_dispatch_write3L_ipartl.i" class="">i</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span id="dipartl.refin_dispatch_write3L_ipartl.p" class="id"><a name="dipartl.refin_dispatch_write3L_ipartl.p" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.T">T</a></span>) (<span id="dipartl.refin_dispatch_write3L_ipartl.xs" class="id"><a name="dipartl.refin_dispatch_write3L_ipartl.xs" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.T">T</a></span>).<br/>
<span class="vernacular">Hypothesis</span> <span id="dipartl.refin_dispatch_write3L_ipartl.ih" class="id"><a name="dipartl.refin_dispatch_write3L_ipartl.ih" class="">ih</a></span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="ys:113" class="id"><a name="ys:113" class="">ys</a></span> <span id="zs:114" class="id"><a name="zs:114" class="">zs,</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.i">i</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:113">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:114">zs</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.xs">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.M">M</a></span>) <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.p">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.i">i</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:113">ys</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:114">zs</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.xs">xs</a></span>)<br/>
&nbsp;&nbsp;<span class="id">`&lt;=`</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.p">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:113">ys</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:114">zs</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.xs">xs</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#write2L">write2L</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.i">i</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="dipartl.refin_dispatch_write3L_ipartl.refin_write3L_ipartl" class="id"><a name="dipartl.refin_dispatch_write3L_ipartl.refin_write3L_ipartl" class="">refin_write3L_ipartl</a></span> <span id="x:116" class="id"><a name="x:116" class="">x</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#write3L">write3L</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.i">i</a></span> (<span class="id"><a href="monae.example_iquicksort.html#x:116">x,</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.xs">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.monae_lib.html#uncurry3">uncurry3</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.M">M</a></span>) <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.p">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.i">i</a></span>)<br/>
&nbsp;&nbsp;<span class="id">`&lt;=`</span> <span class="id"><a href="monae.monae_lib.html#uncurry3">uncurry3</a></span> (<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.p">p</a></span>) (<span class="id"><a href="monae.example_iquicksort.html#x:116">x,</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.xs">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#write2L">write2L</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.i">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">case:</span> <span class="id">x</span> <span class="id">=&gt;</span> <span class="id">ys</span> <span class="id">zs</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> (<span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.ih">ih</a></span> <span class="id">_</span> <span class="id">_</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_dispatch_Ret_write3L_ipartl" class="id"><a name="refin_dispatch_Ret_write3L_ipartl" class="">refin_dispatch_Ret_write3L_ipartl</a></span> <span id="x:117" class="id"><a name="x:117" class="">x</a></span> <span id="ys:118" class="id"><a name="ys:118" class="">ys</a></span> <span id="zs:119" class="id"><a name="zs:119" class="">zs</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret">dispatch_Ret</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:117">x</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.p">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:118">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:119">zs,</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.xs">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#write3L">write3L</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.i">i</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.monae_lib.html#uncurry3">uncurry3</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.M">M</a></span>) <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.p">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.i">i</a></span>)<br/>
&nbsp;&nbsp;<span class="id">`&lt;=`</span> <span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret">dispatch_Ret</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:117">x</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.p">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:118">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:119">zs,</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.xs">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.monae_lib.html#uncurry3">uncurry3</a></span> (<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.p">p</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#write2L">write2L</a></span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.i">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id">!if_bind;</span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_if">refin_if</a></span> <span class="id">=&gt;</span> <span class="id">_;</span> <span class="id">rewrite</span> <span class="id">!bindA;</span><br/>
&nbsp;&nbsp;<span class="id">apply/refin_bindl</span> <span class="id">=&gt;</span> <span class="id">zs';</span> <span class="id">rewrite</span> <span class="id">!bindretf;</span> <span class="id">exact:</span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl.refin_write3L_ipartl">refin_write3L_ipartl</a></span>.<br/>
Qed.</div>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#dipartl.refin_dispatch_write3L_ipartl">refin_dispatch_write3L_ipartl</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#dipartl">dipartl</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monae.example_iquicksort.html#dipartl">dipartl</a></span> <span class="id">{d</span> <span class="id">T</span> <span class="id">M}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="derivation_qperm_partl_ipartl" class="id"><a name="derivation_qperm_partl_ipartl" class="">derivation_qperm_partl_ipartl</a></span>.<br/>
<span class="vernacular">Variable</span> (<span id="derivation_qperm_partl_ipartl.d" class="id"><a name="derivation_qperm_partl_ipartl.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="derivation_qperm_partl_ipartl.E" class="id"><a name="derivation_qperm_partl_ipartl.E" class="">E</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:120">d</a></span>) (<span id="derivation_qperm_partl_ipartl.M" class="id"><a name="derivation_qperm_partl_ipartl.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#E:121">E</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>).<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">i</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="qperm_preserves_length" class="id"><a name="qperm_preserves_length" class="">qperm_preserves_length</a></span> <span id="i:123" class="id"><a name="i:123" class="">i</a></span> (<span id="x:124" class="id"><a name="x:124" class="">x</a></span> <span id="p:125" class="id"><a name="p:125" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#derivation_qperm_partl_ipartl.E">E</a></span>) (<span id="ys:126" class="id"><a name="ys:126" class="">ys</a></span> <span id="zs:127" class="id"><a name="zs:127" class="">zs</a></span> <span id="xs:128" class="id"><a name="xs:128" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#derivation_qperm_partl_ipartl.E">E</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span id="D:129" class="id"><a name="D:129" class="">D</a></span> (<span id="k:130" class="id"><a name="k:130" class="">k</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#derivation_qperm_partl_ipartl.M">M</a></span> <span class="id"><a href="monae.example_iquicksort.html#D:129">D</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret">dispatch_Ret</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:124">x</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:125">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:126">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:127">zs,</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:128">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#write3L">write3L</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:123">i</a></span>) <span class="id">&gt;&gt;=</span> <span class="id"><a href="monae.monae_lib.html#uncurry3">uncurry3</a></span> <span class="id"><a href="monae.example_iquicksort.html#k:130">k</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:123">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:126">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:127">zs</a></span>).<span class="id">+1</span>) <span class="id"><a href="monae.example_iquicksort.html#xs:128">xs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret">dispatch_Ret</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:124">x</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:125">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:126">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:127">zs,</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:128">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="ys':133" class="id"><a name="ys':133" class="">ys',</a></span> <span id="zs':132" class="id"><a name="zs':132" class="">zs',</a></span> <span id="xs':131" class="id"><a name="xs':131" class="">xs'</a></span>) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:123">i</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys':133">ys'</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':132">zs'</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#k:130">k</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys':133">ys'</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':132">zs'</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs':131">xs'</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#derivation_qperm_partl_ipartl.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]bindA</a></span> <span class="id">-[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]</a></span>(<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.example_iquicksort.html#dispatch_Ret">dispatch_Ret</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>))<span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id">/=;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">xp</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monae.array_lib.html#write3LE">write3LE</a></span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id">-bindA</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[RHS]</span>(<span class="id"><a href="monae.fail_lib.html#qperm_preserves_size2">qperm_preserves_size2</a></span> <span class="id">zs</span> (<span class="gallina-kwd">fun</span> <span id="a:139" class="id"><span id="a:137" class="id"><span id="a:135" class="id"><a name="a:139" class="">a</a></span></span></span> <span id="b:140" class="id"><span id="b:138" class="id"><span id="b:136" class="id"><a name="b:140" class="">b</a></span></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:136">b</a></span>).<span class="id">+1</span>) <span class="id">xs</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">ys</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:135">a</a></span>)) <span class="id">&gt;&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">k</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">ys</span> <span class="id">x</span>)) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:135">a</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">xs</span>))).<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">zs'</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-writeListC;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_cat">size_cat</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_rcons">size_rcons</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addSn">addSn</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#catA">catA</a></span> <span class="id"><a href="monae.array_lib.html#writeList_cat">writeList_cat</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cat_rcons">cat_rcons</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_cat">size_cat/=</a></span> <span class="id">-addnS</span>.<br/>
<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monae.array_lib.html#write3LE">write3LE</a></span>.<br/>
<span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id">-bindA</span>.<br/>
<span class="id">rewrite</span> <span class="id">-addnS</span> <span class="id">-</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_rcons">size_rcons</a></span> <span class="id">zs</span> <span class="id">x</span>).<br/>
<span class="id">rewrite</span> <span class="id">[RHS]</span>(<span class="id"><a href="monae.fail_lib.html#qperm_preserves_size2">qperm_preserves_size2</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">zs</span> <span class="id">x</span>) (<span class="gallina-kwd">fun</span> <span id="a:145" class="id"><span id="a:143" class="id"><span id="a:141" class="id"><a name="a:145" class="">a</a></span></span></span> <span id="b:146" class="id"><span id="b:144" class="id"><span id="b:142" class="id"><a name="b:146" class="">b</a></span></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:142">b</a></span>)) <span class="id">xs</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:141">a</a></span>)) <span class="id">&gt;&gt;</span> <span class="id">k</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:141">a</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">xs</span>))).<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">zs'</span> <span class="id">/=</span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> (<span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id">_</span>)) <span class="id">=</span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> (<span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">zs'</span>)))<span class="id">;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_cat">size_cat</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-writeListC//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#catA">catA</a></span> <span class="id"><a href="monae.array_lib.html#writeList_cat">writeList_cat</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_qperm_partl_writeList" class="id"><a name="refin_qperm_partl_writeList" class="">refin_qperm_partl_writeList</a></span> (<span id="p:147" class="id"><a name="p:147" class="">p</a></span> <span id="x:148" class="id"><a name="x:148" class="">x</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#derivation_qperm_partl_ipartl.E">E</a></span>) (<span id="ys:149" class="id"><a name="ys:149" class="">ys</a></span> <span id="zs:150" class="id"><a name="zs:150" class="">zs</a></span> <span id="xs:151" class="id"><a name="xs:151" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#derivation_qperm_partl_ipartl.E">E</a></span>) <span id="i:152" class="id"><a name="i:152" class="">i</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> <span id="ys:153" class="id"><a name="ys:153" class="">ys</a></span> <span id="zs:154" class="id"><a name="zs:154" class="">zs,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#derivation_qperm_partl_ipartl.M">M</a></span>) <span class="id"><a href="monae.example_iquicksort.html#i:152">i</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:153">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:154">zs</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:151">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:147">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:152">i</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:153">ys</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:154">zs</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:151">xs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`&lt;=`</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:147">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:153">ys</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:154">zs</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:151">xs</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#write2L">write2L</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:152">i</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#derivation_qperm_partl_ipartl.M">M</a></span>) (<span class="id"><a href="monae.example_iquicksort.html#i:152">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:149">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:150">zs</a></span>).<span class="id">+1</span>) <span class="id"><a href="monae.example_iquicksort.html#xs:151">xs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_iquicksort.html#x:148">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:147">p</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:150">zs</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="zs':155" class="id"><a name="zs':155" class="">zs'</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:152">i</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:149">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:148">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':155">zs'</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:147">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:152">i</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:149">ys</a></span>).<span class="id">+1</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':155">zs'</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:151">xs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:150">zs</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:148">x</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="zs':156" class="id"><a name="zs':156" class="">zs'</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:152">i</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:149">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':156">zs'</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:147">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:152">i</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:149">ys</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':156">zs'</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:151">xs</a></span>)))<br/>
&nbsp;&nbsp;<span class="id">`&lt;=`</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:147">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:149">ys</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:150">zs</a></span> (<span class="id"><a href="monae.example_iquicksort.html#x:148">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:151">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#write2L">write2L</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:152">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
<span class="id">move=&gt;</span> <span class="id">ih;</span> <span class="id">rewrite</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl_cons">qperm_partl_cons</a></span>.<br/>
<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans;</a></span> <span class="id">last</span> <span class="id">exact:</span> (<span class="id"><a href="monae.example_iquicksort.html#refin_dispatch_Ret_write3L_ipartl">refin_dispatch_Ret_write3L_ipartl</a></span> <span class="id">ih</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_preserves_length">qperm_preserves_length</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">apply</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[]</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.monad_lib.html#if_bind">if_bind;</a></span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_if">refin_if</a></span> <span class="id">=&gt;</span> <span class="id">_;</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">zs'</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_rcons">size_rcons</a></span> <span class="id">-cats1</span> <span class="id">-catA</span> <span class="id">/=;</span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#derivation_qperm_partl_ipartl">derivation_qperm_partl_ipartl</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="refin_qperm_partl" class="id"><a name="refin_qperm_partl" class="">refin_qperm_partl</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="refin_qperm_partl.d" class="id"><a name="refin_qperm_partl.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="refin_qperm_partl.E" class="id"><a name="refin_qperm_partl.E" class="">E</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:157">d</a></span>) (<span id="refin_qperm_partl.M" class="id"><a name="refin_qperm_partl.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#E:158">E</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="refin_qperm_partl.refin_qperm_partl_helper" class="id"><a name="refin_qperm_partl.refin_qperm_partl_helper" class="">refin_qperm_partl_helper</a></span> <span id="a:160" class="id"><a name="a:160" class="">a</a></span> <span id="b:161" class="id"><a name="b:161" class="">b</a></span> <span id="p:162" class="id"><a name="p:162" class="">p</a></span> <span id="xs:163" class="id"><a name="xs:163" class="">xs</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monae.monad_lib.html#apply_triple_snd">apply_triple_snd</a></span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id"><a href="monae.hierarchy.html#5483cabbcd988b1cb7000e5ba9f05889">&gt;=&gt;</a></span> <span class="id"><a href="monae.monae_lib.html#uncurry3">uncurry3</a></span> (<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:162">p</a></span>)) (<span class="id"><a href="monae.example_iquicksort.html#a:160">a,</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:161">b,</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:163">xs</a></span>) <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.monad_lib.html#apply_pair_snd">apply_pair_snd</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#refin_qperm_partl.M">M</a></span>) <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> (<span class="id"><a href="monae.example_iquicksort.html#partl">partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:162">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#a:160">a,</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:161">b</a></span>) <span class="id"><a href="monae.example_iquicksort.html#xs:163">xs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">elim:</span> <span class="id">xs</span> <span class="id">p</span> <span class="id">a</span> <span class="id">b</span> <span class="id">=&gt;</span> <span class="id">[/=|h</span> <span class="id">t</span> <span class="id">ih]</span> <span class="id">p</span> <span class="id">a</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#kleisliE">kleisliE</a></span> <span class="id"><a href="monae.monad_lib.html#apply_triple_sndE">apply_triple_sndE;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:164">X]/=</a></span> <span class="id">-if_arg</span> <span class="id">-fun_if</span> <span class="id"><a href="monae.monae_lib.html#if_pair">if_pair</a></span><span class="comment">(*if&nbsp;inside&nbsp;args*)</span>.<br/>
<span class="id">apply/</span>(<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> (<span class="id">ih</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>))<span class="id">/eq_refin/esym</span>.<br/>
<span class="id">rewrite</span> <span class="id">-if_pair</span> <span class="id">-[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]</a></span>(<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#if_same">if_same</a></span> (<span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id">p</span>) <span class="id">t</span>) <span class="id">-if_pair</span><span class="comment">(*if&nbsp;outside&nbsp;args*)</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#kleisliE">kleisliE</a></span> <span class="id">-[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.monad_lib.html#apply_triple_snd">apply_triple_snd</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:165">X</a></span> <span class="id">_]qperm_idempotent</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#fun_if">fun_if</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#kleisliE">kleisliE</a></span> <span class="id"><a href="monae.monad_lib.html#apply_triple_sndE">apply_triple_sndE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">2!apply_triple_snd_kleisli</span> <span class="id"><a href="monae.fail_lib.html#qperm_rcons">qperm_rcons</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">-bind_if</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">b'</span>.<br/>
<span class="id">rewrite</span> <span class="id">-apply_triple_snd_kleisli</span> <span class="id"><a href="monae.fail_lib.html#qperm_idempotent">qperm_idempotent</a></span> <span class="id"><a href="monae.monad_lib.html#if_bind">if_bind</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">!bindA</span> <span class="id">/=</span>.<br/>
<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="gallina-kwd">if</span> <span class="id">_</span> <span class="gallina-kwd">then</span> <span class="id">_</span> <span class="gallina-kwd">else</span> <span class="id"><a href="monae.example_iquicksort.html#X:166">X]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_qperm_partl" class="id"><a name="refin_qperm_partl" class="">refin_qperm_partl</a></span> <span id="a:167" class="id"><a name="a:167" class="">a</a></span> <span id="b:168" class="id"><a name="b:168" class="">b</a></span> <span id="p:169" class="id"><a name="p:169" class="">p</a></span> <span id="xs:170" class="id"><a name="xs:170" class="">xs</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#refin_qperm_partl.M">M</a></span>) <span class="id"><a href="monae.example_iquicksort.html#p:169">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:167">a</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:168">b</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:170">xs</a></span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.monad_lib.html#apply_pair_snd">apply_pair_snd</a></span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> (<span class="id"><a href="monae.example_iquicksort.html#partl">partl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:169">p</a></span> (<span class="id"><a href="monae.example_iquicksort.html#a:167">a,</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:168">b</a></span>) <span class="id"><a href="monae.example_iquicksort.html#xs:170">xs</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans;</a></span> <span class="id">last</span> <span class="id">exact:</span> <span class="id"><a href="monae.example_iquicksort.html#refin_qperm_partl.refin_qperm_partl_helper">refin_qperm_partl_helper</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#kleisliE">kleisliE</a></span> <span class="id"><a href="monae.monad_lib.html#apply_triple_sndE">apply_triple_sndE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_iquicksort.html#X:171">X</a></span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id">_]</span>(<span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id">b</span> (<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">p</span> <span class="id">a</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#d89396f990d6b54d736cfe259e498cf4">^~</a></span> <span class="id">xs</span>)).<br/>
<span class="id">exact/refin_bindr/refin_qperm_ret</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#refin_qperm_partl">refin_qperm_partl</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="refin_ipartl" class="id"><a name="refin_ipartl" class="">refin_ipartl</a></span>.<br/>
<span class="vernacular">Variable</span> (<span id="refin_ipartl.d" class="id"><a name="refin_ipartl.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="refin_ipartl.E" class="id"><a name="refin_ipartl.E" class="">E</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:172">d</a></span>) (<span id="refin_ipartl.M" class="id"><a name="refin_ipartl.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#E:173">E</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>).<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">i</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="refin_ipartl.writeList_ipartl" class="id"><a name="refin_ipartl.writeList_ipartl" class="">writeList_ipartl</a></span> (<span id="p:175" class="id"><a name="p:175" class="">p</a></span> <span id="x:176" class="id"><a name="x:176" class="">x</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.E">E</a></span>) <span id="i:177" class="id"><a name="i:177" class="">i</a></span> (<span id="s:178" class="id"><a name="s:178" class="">s</a></span> <span id="xs:179" class="id"><a name="xs:179" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.E">E</a></span>) (<span id="k1:180" class="id"><a name="k1:180" class="">k1</a></span> <span id="k2:181" class="id"><a name="k2:181" class="">k2</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.M">M</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>)%<span class="id">type</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:177">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#s:178">s</a></span>).<span class="id">+1</span>) <span class="id"><a href="monae.example_iquicksort.html#xs:179">xs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_iquicksort.html#x:176">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:175">p</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:177">i</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monae.example_iquicksort.html#s:178">s</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:176">x</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#k1:180">k1</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:177">i</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monae.example_iquicksort.html#s:178">s</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:176">x</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#k2:181">k2</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:177">i</a></span> (<span class="id"><a href="monae.example_iquicksort.html#s:178">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#x:176">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:179">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.hierarchy.html#aget">aget</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:177">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#s:178">s</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="x:182" class="id"><a name="x:182" class="">x</a></span> <span class="id">=&gt;</span> <span class="gallina-kwd">if</span> <span class="id"><a href="monae.example_iquicksort.html#x:182">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:175">p</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monae.example_iquicksort.html#k1:180">k1</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monae.example_iquicksort.html#k2:181">k2</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">transitivity</span> (<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id">s</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="gallina-kwd">if</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id">p</span> <span class="gallina-kwd">then</span> <span class="id">k1</span> <span class="gallina-kwd">else</span> <span class="id">k2</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.M">M</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">xp</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-cat1s</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#catA">catA</a></span> <span class="id"><a href="monae.array_lib.html#writeList_cat">writeList_cat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]writeListC//</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cats1">cats1</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_rcons">size_rcons</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span>.<br/>
&nbsp;&nbsp;<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]cat1s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#catA">catA</a></span> <span class="id"><a href="monae.array_lib.html#writeList_cat">writeList_cat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.array_lib.html#writeListC">writeListC//=</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cats1">cats1</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_rcons">size_rcons</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monae.array_lib.html#writeList_cat">writeList_cat</a></span> <span class="id">2!bindA;</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[]</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-bindA</span> <span class="id">-writeList_ret_aget</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_ipartl" class="id"><a name="refin_ipartl" class="">refin_ipartl</a></span> <span id="p:183" class="id"><a name="p:183" class="">p</a></span> <span id="i:184" class="id"><a name="i:184" class="">i</a></span> (<span id="xs:185" class="id"><a name="xs:185" class="">xs</a></span> <span id="zs:186" class="id"><a name="zs:186" class="">zs</a></span> <span id="ys:187" class="id"><a name="ys:187" class="">ys</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.E">E</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#write3L">write3L</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:184">i</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ys:187">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:186">zs,</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:185">xs</a></span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.monae_lib.html#uncurry3">uncurry3</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:183">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:184">i</a></span>)<br/>
&nbsp;&nbsp;<span class="id">`&lt;=`</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.M">M</a></span>) <span class="id"><a href="monae.example_iquicksort.html#p:183">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:187">ys</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:186">zs</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:185">xs</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#write2L">write2L</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:184">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">elim:</span> <span class="id">xs</span> <span class="id">i</span> <span class="id">p</span> <span class="id">zs</span> <span class="id">ys</span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">t</span> <span class="id">ih]</span> <span class="id">i</span> <span class="id">p</span> <span class="id">zs</span> <span class="id">ys</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#eq_refin">eq_refin</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cats0">cats0</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">have</span> <span class="id">:</span> (<span class="gallina-kwd">forall</span> <span id="ys:188" class="id"><a name="ys:188" class="">ys</a></span> <span id="zs:189" class="id"><a name="zs:189" class="">zs,</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id"><a href="monae.example_iquicksort.html#ys:188">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:189">zs</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">t</span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.M">M</a></span>) <span class="id">p</span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:188">ys</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:189">zs</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">t</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`&lt;=`</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">p</span> <span class="id"><a href="monae.example_iquicksort.html#ys:188">ys</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:189">zs</a></span> <span class="id">t</span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#write2L">write2L</a></span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">{}ys</span> <span class="id">{}zs;</span> <span class="id">apply:</span> (<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> (<span class="id">ih</span> <span class="id">i</span> <span class="id">p</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.array_lib.html#write3LE">write3LE;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="id">move=&gt;</span> <span class="id">/</span>(@<span class="id"><a href="monae.example_iquicksort.html#refin_qperm_partl_writeList">refin_qperm_partl_writeList</a></span> <span class="id">_</span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.E">E</a></span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.M">M</a></span> <span class="id">p</span> <span class="id">h</span> <span class="id">ys</span> <span class="id">zs</span> <span class="id">t</span> <span class="id">i</span>).<br/>
<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span>.<br/>
<span class="id">apply:</span> (@<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">zs</span>).<span class="id">+1</span>) <span class="id">t</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">if</span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id">p</span><br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">then</span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> (<span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">zs</span>) <span class="id">h</span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#aswap">aswap</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys</span>) (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> (<span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">zs</span>)) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id">p</span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys</span>).<span class="id">+1</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">zs</span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">t</span>)<br/>
&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> (<span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">zs</span>) <span class="id">h</span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id">p</span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">zs</span>).<span class="id">+1</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">t</span>))))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_if">refin_if</a></span> <span class="id">=&gt;</span> <span class="id">hp;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> (@<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">zs</span> <span class="id">h</span>) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="gallina-kwd">fun</span> <span id="zs':191" class="id"><span id="zs':190" class="id"><a name="zs':191" class="">zs'</a></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':190">zs'</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id">p</span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys</span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':190">zs'</a></span>) (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">t</span>)))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact/refin_bindr/refin_qperm_ret</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_rcons">size_rcons</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons_cat">rcons_cat;</a></span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:196">X]</a></span>(<span class="id"><a href="monae.fail_lib.html#qperm_preserves_size2">qperm_preserves_size2</a></span> <span class="id">zs</span> (<span class="gallina-kwd">fun</span> <span id="a:197" class="id"><span id="a:194" class="id"><span id="a:192" class="id"><a name="a:197" class="">a</a></span></span></span> <span id="b:198" class="id"><span id="b:195" class="id"><span id="b:193" class="id"><a name="b:198" class="">b</a></span></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id">ys</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:192">a</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id">p</span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys</span>).<span class="id">+1</span> <span class="id"><a href="monae.example_iquicksort.html#b:193">b</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">t</span>))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:199">X]bindA</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exact/refin_bindr/refin_writeList_rcons_cat_aswap</span>.<br/>
<span class="id">rewrite</span> <span class="id">-size_cat</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl.writeList_ipartl">writeList_ipartl</a></span> <span class="id"><a href="monae.array_lib.html#write3LE">write3LE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">/uncurry3</span> <span class="id">/=</span> <span class="id">-addnA</span> <span class="id">-size_cat</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">-catA;</span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#refin_ipartl">refin_ipartl</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="iqsort_def" class="id"><a name="iqsort_def" class="">iqsort_def</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="iqsort_def.d" class="id"><a name="iqsort_def.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="iqsort_def.T" class="id"><a name="iqsort_def.T" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:200">d</a></span>) (<span id="iqsort_def.M" class="id"><a name="iqsort_def.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#T:201">T</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>).<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Obligation</span> <span class="vernacular">Tactic</span> <span class="id">:=</span> <span class="id">idtac</span>.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<span class="id">Program</span> <span class="vernacular">Fixpoint</span> <span id="iqsort'" class="id"><a name="iqsort'" class="">iqsort'</a></span> <span id="ni:203" class="id"><a name="ni:203" class="">ni</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span id="f:205" class="id"><a name="f:205" class="">f</a></span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="mj:204" class="id"><a name="mj:204" class="">mj,</a></span> (<span class="id"><a href="monae.example_iquicksort.html#mj:204">mj</a></span>.<span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::coq_nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#ni:203">ni</a></span>.<span class="id">2</span>)%<span class="id">coq_nat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_def.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_def.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span> <span class="id"><a href="monae.example_iquicksort.html#ni:203">ni</a></span>.<span class="id">2</span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">0</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;<span class="id">|</span> <span class="id">n</span>.<span class="id">+1</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.hierarchy.html#aget">aget</a></span> <span class="id"><a href="monae.example_iquicksort.html#ni:203">ni</a></span>.<span class="id">1</span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="p:207" class="id"><a name="p:207" class="">p</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#dipartl">dipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:207">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#ni:203">ni</a></span>.<span class="id">1</span>.<span class="id">+1</span> <span class="id">0</span> <span class="id">0</span> <span class="id">n</span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="nynz:208" class="id"><a name="nynz:208" class="">nynz</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="ny:209" class="id"><a name="ny:209" class="">ny</a></span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#nynz:208">nynz</a></span>.<span class="id">1</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="nz:210" class="id"><a name="nz:210" class="">nz</a></span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#nynz:208">nynz</a></span>.<span class="id">2</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#aswap">aswap</a></span> <span class="id"><a href="monae.example_iquicksort.html#ni:203">ni</a></span>.<span class="id">1</span> (<span class="id"><a href="monae.example_iquicksort.html#ni:203">ni</a></span>.<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:209">ny</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#f:205">f</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ni:203">ni</a></span>.<span class="id">1,</span> <span class="id"><a href="monae.example_iquicksort.html#ny:209">ny</a></span>) <span class="id">_</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#f:205">f</a></span> (<span class="id"><a href="monae.example_iquicksort.html#ni:203">ni</a></span>.<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:209">ny</a></span>.<span class="id">+1,</span> <span class="id"><a href="monae.example_iquicksort.html#nz:210">nz</a></span>) <span class="id">_</span>))<br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Next Obligation.</span></div>
<div class="proofscript" id="proof16">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">[i</span> <span class="id">[//|n']]</span> <span class="id">/=</span> <span class="id">_</span> <span class="id">n</span> <span class="id">[&lt;-]</span> <span class="id">p</span> <span class="id">[[a</span> <span class="id">b]</span> <span class="id">/=]</span> <span class="id">/andP[an</span> <span class="id">_]</span> <span class="id">_</span>.<br/>
<span class="id">apply/ssrnat</span>.<span class="id">ltP;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">2!addn0</span> <span class="gallina-kwd">in</span> <span class="id">an</span>.<br/>
Qed.</div>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Next Obligation.</span></div>
<div class="proofscript" id="proof17">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">[i</span> <span class="id">[//|n']]</span> <span class="id">/=</span> <span class="id">_</span> <span class="id">n</span> <span class="id">[&lt;-]</span> <span class="id">p</span> <span class="id">[[a</span> <span class="id">b]</span> <span class="id">/=]</span> <span class="id">/andP[_</span> <span class="id">bn]</span> <span class="id">_</span>.<br/>
<span class="id">apply/ssrnat</span>.<span class="id">ltP;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">2!addn0</span> <span class="gallina-kwd">in</span> <span class="id">bn</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="well_founded_lt2" class="id"><a name="well_founded_lt2" class="">well_founded_lt2</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#well_founded">well_founded</a></span> (<span class="gallina-kwd">fun</span> <span id="x:211" class="id"><a name="x:211" class="">x</a></span> <span id="y:212" class="id"><a name="y:212" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">=&gt;</span> (<span class="id"><a href="monae.example_iquicksort.html#x:211">x</a></span>.<span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::coq_nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#y:212">y</a></span>.<span class="id">2</span>)%<span class="id">coq_nat</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="gallina-kwd">by</span> <span class="id">apply:</span> (@<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Arith.Wf_nat.html#well_founded_lt_compat">Wf_nat.well_founded_lt_compat</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">=&gt;</span> <span class="id">-[x1</span> <span class="id">x2]</span> <span class="id">[y1</span> <span class="id">y2];</span> <span class="id">exact</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="iqsort" class="id"><a name="iqsort" class="">iqsort</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_def.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#Fix">Fix</a></span> <span class="id"><a href="monae.example_iquicksort.html#well_founded_lt2">well_founded_lt2</a></span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_def.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id"><a href="monae.example_iquicksort.html#iqsort'">iqsort'</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="iqsort'_Fix" class="id"><a name="iqsort'_Fix" class="">iqsort'_Fix</a></span> (<span id="ni:213" class="id"><a name="ni:213" class="">ni</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>)<br/>
&nbsp;&nbsp;(<span id="f:215" class="id"><a name="f:215" class="">f</a></span> <span id="g:216" class="id"><a name="g:216" class="">g</a></span> <span class="id">:</span> <span class="gallina-kwd">forall</span> (<span id="n'j:214" class="id"><a name="n'j:214" class="">n'j</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>)<span class="id">,</span> (<span class="id"><a href="monae.example_iquicksort.html#n'j:214">n'j</a></span>.<span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::coq_nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#ni:213">ni</a></span>.<span class="id">2</span>)%<span class="id">coq_nat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_def.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> (<span id="n'j:217" class="id"><a name="n'j:217" class="">n'j</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) (<span id="p:218" class="id"><a name="p:218" class="">p</a></span> <span class="id">:</span> (<span class="id"><a href="monae.example_iquicksort.html#n'j:217">n'j</a></span>.<span class="id">2</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::coq_nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#ni:213">ni</a></span>.<span class="id">2</span>)%<span class="id">coq_nat</span>)<span class="id">,</span> <span class="id"><a href="monae.example_iquicksort.html#f:215">f</a></span> <span class="id"><a href="monae.example_iquicksort.html#n'j:217">n'j</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:218">p</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.example_iquicksort.html#g:216">g</a></span> <span class="id"><a href="monae.example_iquicksort.html#n'j:217">n'j</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:218">p</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#iqsort'">iqsort'</a></span> <span class="id"><a href="monae.example_iquicksort.html#f:215">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort'">iqsort'</a></span> <span class="id"><a href="monae.example_iquicksort.html#g:216">g</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?;</span> <span class="id">congr</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort'">iqsort';</a></span> <span class="id">apply</span> <span class="id"><a href="monae.monae_lib.html#funext_dep">funext_dep</a></span> <span class="id">=&gt;</span> <span class="id">?;</span> <span class="id">apply</span> <span class="id"><a href="NOTFOUND the module url for mathcomp.classical.boolp#funext">boolp.funext</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="iqsort_nil" class="id"><a name="iqsort_nil" class="">iqsort_nil</a></span> <span id="i:219" class="id"><a name="i:219" class="">i</a></span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:219">i,</a></span> <span class="id">0</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#tt">tt</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/iqsort</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#Fix_eq">Fix_eq</a></span> <span class="id">//;</span> <span class="id">exact:</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort'_Fix">iqsort'_Fix</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="iqsort_cons" class="id"><a name="iqsort_cons" class="">iqsort_cons</a></span> <span id="i:220" class="id"><a name="i:220" class="">i</a></span> (<span id="n:221" class="id"><a name="n:221" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:220">i,</a></span> <span class="id"><a href="monae.example_iquicksort.html#n:221">n</a></span>.<span class="id">+1</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.hierarchy.html#aget">aget</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:220">i</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="p:222" class="id"><a name="p:222" class="">p</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#dipartl">dipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:222">p</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:220">i</a></span>.<span class="id">+1</span> <span class="id">0</span> <span class="id">0</span> <span class="id"><a href="monae.example_iquicksort.html#n:221">n</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="nynz:223" class="id"><a name="nynz:223" class="">nynz</a></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="ny:224" class="id"><a name="ny:224" class="">ny</a></span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#dipartlT1">dipartlT1</a></span> <span class="id"><a href="monae.example_iquicksort.html#nynz:223">nynz</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="nz:225" class="id"><a name="nz:225" class="">nz</a></span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#dipartlT2">dipartlT2</a></span> <span class="id"><a href="monae.example_iquicksort.html#nynz:223">nynz</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#aswap">aswap</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:220">i</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:220">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:224">ny</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:220">i,</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:224">ny</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id"><a href="monae.example_iquicksort.html#i:220">i</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:224">ny</a></span>.<span class="id">+1,</span> <span class="id"><a href="monae.example_iquicksort.html#nz:225">nz</a></span>))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]/iqsort</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#Fix_eq">Fix_eq</a></span> <span class="id">//=;</span> <span class="id">exact:</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort'_Fix">iqsort'_Fix</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_def">iqsort_def</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> <span class="id">{d</span> <span class="id">T</span> <span class="id">M}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="iqsort_spec" class="id"><a name="iqsort_spec" class="">iqsort_spec</a></span>.<br/>
<span class="vernacular">Variable</span> (<span id="iqsort_spec.d" class="id"><a name="iqsort_spec.d" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="iqsort_spec.E" class="id"><a name="iqsort_spec.E" class="">E</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monae.example_iquicksort.html#d:226">d</a></span>) (<span id="iqsort_spec.M" class="id"><a name="iqsort_spec.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monae.hierarchy.html#MonadPlusArray.Exports.plusArrayMonad">plusArrayMonad</a></span> <span class="id"><a href="monae.example_iquicksort.html#E:227">E</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#nat_eqType">nat_eqType</a></span>).<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">i</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="iqsort_slowsort" class="id"><a name="iqsort_slowsort" class="">iqsort_slowsort</a></span> <span id="i:229" class="id"><a name="i:229" class="">i</a></span> <span id="xs:230" class="id"><a name="xs:230" class="">xs</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:229">i</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:230">xs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">M</span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_spec.M">M</a></span>) (<span class="id"><a href="monae.example_iquicksort.html#i:229">i,</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:230">xs</a></span>) <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_iquicksort.html#xs:230">xs</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id"><a href="monae.example_iquicksort.html#i:229">i</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">have</span> <span class="id">[n</span> <span class="id">nxs]</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ubnP">ubnP</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">xs</span>)<span class="id">;</span> <span class="id">elim:</span> <span class="id">n</span> <span class="id">xs</span> <span class="id">i</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">n</span> <span class="id">ih</span> <span class="id">xs</span> <span class="id">i</span> <span class="gallina-kwd">in</span> <span class="id">nxs</span> <span class="id">*</span>.<br/>
<span class="id">move:</span> <span class="id">xs</span> <span class="id">=&gt;</span> <span class="id">[|p</span> <span class="id">xs]</span> <span class="gallina-kwd">in</span> <span class="id">nxs</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_nil">iqsort_nil</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort_nil">slowsort_nil</a></span> <span class="id">2!bindretf</span> <span class="id">/=;</span> <span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="comment">(*&nbsp;step&nbsp;1:&nbsp;l.342&nbsp;in&nbsp;IQSOrt.agda,<br/>
&nbsp;&nbsp;&nbsp;corresponds&nbsp;to&nbsp;second&nbsp;equation&nbsp;on&nbsp;page&nbsp;13&nbsp;of&nbsp;mu2020flops&nbsp;*)</span><br/>
<span class="id">pose</span> <span class="id">p1</span> <span class="id">:</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_spec.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span> <span class="id">:=</span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id">xs</span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="ys:232" class="id"><a name="ys:232" class="">ys,</a></span> <span id="zs:231" class="id"><a name="zs:231" class="">zs</a></span>) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:232">ys</a></span>).<span class="id">+1</span>) <span class="id"><a href="monae.example_iquicksort.html#zs:231">zs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:232">ys</a></span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="ys':234" class="id"><a name="ys':234" class="">ys'</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys':234">ys'</a></span> <span class="id">p</span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:232">ys</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:232">ys</a></span>).<span class="id">+1,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:231">zs</a></span>))).<br/>
<span class="id">apply:</span> (@<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">p1</span>).<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;step&nbsp;2:&nbsp;introduce&nbsp;aswap&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply:</span> (@<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id">xs</span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="ys:239" class="id"><span id="ys:236" class="id"><a name="ys:239" class="">ys,</a></span></span> <span id="zs:238" class="id"><span id="zs:235" class="id"><a name="zs:238" class="">zs</a></span></span>) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:236">ys</a></span>).<span class="id">+1</span>) <span class="id"><a href="monae.example_iquicksort.html#zs:235">zs</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:236">ys</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.array_lib.html#aswap">aswap</a></span> <span class="id">i</span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:236">ys</a></span>)) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:236">ys</a></span>)) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:236">ys</a></span>).<span class="id">+1,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:235">zs</a></span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;3:&nbsp;commute&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:247">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id">xs</span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="ys:249" class="id"><span id="ys:245" class="id"><span id="ys:242" class="id"><a name="ys:249" class="">ys,</a></span></span></span> <span id="zs:248" class="id"><span id="zs:244" class="id"><span id="zs:241" class="id"><a name="zs:248" class="">zs</a></span></span></span>) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#aput">aput</a></span> <span class="id">i</span> <span class="id">p</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span>.<span class="id">+1</span> (<span class="id"><a href="monae.example_iquicksort.html#ys:242">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:241">zs</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#aswap">aswap</a></span> <span class="id">i</span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:242">ys</a></span>)) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:242">ys</a></span>)) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:242">ys</a></span>).<span class="id">+1,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:241">zs</a></span>)))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[ys</span> <span class="id">zs]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-bindA</span> <span class="id">-writeListC//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id"><a href="monae.array_lib.html#writeList_cat">writeList_cat</a></span> <span class="id">!bindA</span> <span class="id">-addSnnS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;4:&nbsp;commute&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:257">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.hierarchy.html#aput">aput</a></span> <span class="id">i</span> <span class="id">p</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id">xs</span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="ys:259" class="id"><span id="ys:255" class="id"><span id="ys:252" class="id"><a name="ys:259" class="">ys,</a></span></span></span> <span id="zs:258" class="id"><span id="zs:254" class="id"><span id="zs:251" class="id"><a name="zs:258" class="">zs</a></span></span></span>) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span>.<span class="id">+1</span> (<span class="id"><a href="monae.example_iquicksort.html#ys:252">ys</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:251">zs</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#aswap">aswap</a></span> <span class="id">i</span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:252">ys</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:252">ys</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys:252">ys</a></span>).<span class="id">+1,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:251">zs</a></span>))))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[RHS]bindA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id">xs</span>))<span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">bind_ext=&gt;</span> <span class="id">-[a</span> <span class="id">b];</span> <span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;5&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">{nxs}</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:273">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monae.hierarchy.html#aput">aput</a></span> <span class="id">i</span> <span class="id">p</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#qperm_partl">qperm_partl</a></span> <span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="id">xs</span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="ys:275" class="id"><span id="ys:268" class="id"><span id="ys:262" class="id"><a name="ys:275" class="">ys,</a></span></span></span> <span id="zs:274" class="id"><span id="zs:267" class="id"><span id="zs:261" class="id"><a name="zs:274" class="">zs</a></span></span></span>) <span class="id">=&gt;</span> <span class="id"><a href="monae.array_lib.html#write2L">write2L</a></span> <span class="id">i</span>.<span class="id">+1</span> (<span class="id"><a href="monae.example_iquicksort.html#ys:262">ys,</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs:261">zs</a></span>)) <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span class="id">'</span>(<span id="ny:278" class="id"><span id="ny:271" class="id"><span id="ny:265" class="id"><a name="ny:278" class="">ny,</a></span></span></span> <span id="nz:277" class="id"><span id="nz:270" class="id"><span id="nz:264" class="id"><a name="nz:277" class="">nz</a></span></span></span>) <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.array_lib.html#aswap">aswap</a></span> <span class="id">i</span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:265">ny</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i,</span> <span class="id"><a href="monae.example_iquicksort.html#ny:265">ny</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#ny:265">ny</a></span>.<span class="id">+1,</span> <span class="id"><a href="monae.example_iquicksort.html#nz:264">nz</a></span>)))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]bindA;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[a</span> <span class="id">b];</span> <span class="id">rewrite</span> <span class="id"><a href="monae.array_lib.html#write2LE">write2LE</a></span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;6:&nbsp;refin_ipartl_qperm_partl&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:280">X]</a></span>(<span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> (<span class="id"><a href="monae.hierarchy.html#aput">aput</a></span> <span class="id">i</span> <span class="id">p</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">ttt;</span> <span class="id">exact/refin_bindr/refin_ipartl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;7&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:281">X]bindA</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monae.hierarchy.html#aput">aput</a></span> <span class="id">i</span> <span class="id">p</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.hierarchy.html#Ret">Ret</a></span> <span class="id">p</span>) <span class="id">&gt;&gt;=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="p:284" class="id"><span id="p:283" class="id"><span id="p:282" class="id"><a name="p:284" class="">p</a></span></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_iquicksort.html#ipartl">ipartl</a></span> <span class="id"><a href="monae.example_iquicksort.html#p:282">p</a></span> <span class="id">i</span>.<span class="id">+1</span> <span class="id">0</span> <span class="id">0</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">xs</span>)))<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">-[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]</a></span>(<span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> (<span class="id"><a href="monae.hierarchy.html#aput">aput</a></span> <span class="id">i</span> <span class="id">p</span>)) <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]bindA</a></span> <span class="id">!bindretf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;8&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.array_lib.html#writeListRet">writeListRet</a></span> <span class="id">2![in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:285">X]bindA</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_cons">iqsort_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.example_iquicksort.html#ipartlE">ipartlE</a></span> <span class="id">/=</span> <span class="id"><a href="monae.hierarchy.html#fmapE">fmapE</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:287">X]bindA</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">under</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:288">X]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="monae.fail_lib.html#refin_refl">refin_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">+</span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[ys</span> <span class="id">sz]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">4!bindA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-2![in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:289">X]bindA</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:291">X]</a></span>(<span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> <span class="id">_</span>) (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-2![in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_iquicksort.html#X:292">X</a></span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id">_]bindA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_iquicksort.html#X:294">X</a></span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id">_]</span>(<span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> <span class="id">_</span>) (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindr">refin_bindr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span> <span class="id"><a href="monae.array_lib.html#refin_writeList_cons_aswap">refin_writeList_cons_aswap</a></span>.<br/>
<span class="id">-</span> <span class="comment">(*&nbsp;step&nbsp;1a:&nbsp;refin_partition_slowsort&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans;</a></span> <span class="id">last</span> <span class="id">exact/refin_bindr/refin_partition_slowsort</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">move</span> <span class="id">pxs</span> <span class="id">:</span> (<span class="id"><a href="monae.example_quicksort.html#partition">partition</a></span> <span class="id">p</span> <span class="id">xs</span>) <span class="id">=&gt;</span> <span class="id">tmp;</span> <span class="id">case:</span> <span class="id">tmp</span> <span class="id">=&gt;</span> <span class="id">[ys</span> <span class="id">zs]</span> <span class="gallina-kwd">in</span> <span class="id">pxs</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;1b:&nbsp;introduce&nbsp;qperm's&nbsp;and&nbsp;commute&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-qperm_slowsort</span> <span class="id">2!kleisliE</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:303">X]</a></span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="zs':304" class="id"><span id="zs':299" class="id"><span id="zs':295" class="id"><a name="zs':304" class="">zs'</a></span></span></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id">zs;</span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="ys':305" class="id"><span id="ys':300" class="id"><span id="ys':296" class="id"><a name="ys':305" class="">ys'</a></span></span></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id">ys;</span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="ys'':306" class="id"><span id="ys'':301" class="id"><span id="ys'':297" class="id"><a name="ys'':306" class="">ys''</a></span></span></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_iquicksort.html#ys':296">ys';</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="zs'':307" class="id"><span id="zs'':302" class="id"><span id="zs'':298" class="id"><a name="zs'':307" class="">zs''</a></span></span></span> <span class="id"><a href="monae.hierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs':295">zs';</a></span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id"><a href="monae.example_iquicksort.html#ys'':297">ys''</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">p</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monae.example_iquicksort.html#zs'':298">zs''</a></span>))%<span class="id">Do</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id">zs</span>))<span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">ys'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!bindA;</span> <span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id">zs</span>))<span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">zs';</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">ys''</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;1c:&nbsp;refine&nbsp;partl&nbsp;to&nbsp;qperm_partl&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans;</a></span> <span class="id">first</span> <span class="id">exact/refin_bindr/refin_qperm_partl</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;1d:&nbsp;execute&nbsp;the&nbsp;first&nbsp;qperm&nbsp;and&nbsp;record&nbsp;size&nbsp;information&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-partition_partl</span> <span class="id">pxs</span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="monae.hierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.hierarchy.html#bindretf">bindretf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.fail_lib.html#bind_qperm_guard">bind_qperm_guard</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:308">X]bind_qperm_guard</a></span><span class="comment">(*NB:&nbsp;interesting?*)</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">zs'</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bind_guard">refin_bind_guard</a></span> <span class="id">=&gt;</span> <span class="id">/eqP</span> <span class="id">zszs'</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;1e:&nbsp;commutation&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">![in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_iquicksort.html#X:309">X</a></span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id">_]bindA</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.fail_lib.html#qperm">qperm</a></span> <span class="id">ys</span>))<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;1f:&nbsp;qperm_preserves_size2,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute&nbsp;the&nbsp;second&nbsp;qperm&nbsp;and&nbsp;record&nbsp;size&nbsp;information&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="monae.fail_lib.html#qperm_preserves_size2">qperm_preserves_size2</a></span> <span class="id">ys</span> (<span class="gallina-kwd">fun</span> <span id="a:315" class="id"><span id="a:313" class="id"><span id="a:311" class="id"><a name="a:315" class="">a</a></span></span></span> <span id="b:316" class="id"><span id="b:314" class="id"><span id="b:312" class="id"><a name="b:316" class="">b</a></span></span></span> <span class="id">=&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:312">b</a></span>.<span class="id">+1</span>) <span class="id">zs'</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> (<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monae.example_iquicksort.html#a:311">a</a></span> <span class="id">p</span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i,</span> <span class="id"><a href="monae.example_iquicksort.html#b:312">b</a></span>) <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:312">b</a></span>.<span class="id">+1,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">zs'</span>))))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.fail_lib.html#bind_qperm_guard">bind_qperm_guard</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:317">X]bind_qperm_guard</a></span> <span class="comment">(*NB:&nbsp;interesting?*)</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">ys'</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bind_guard">refin_bind_guard</a></span> <span class="id">=&gt;</span> <span class="id">/eqP</span> <span class="id">ysys'</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;1g:&nbsp;ih&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-cats1</span> <span class="id"><a href="monae.array_lib.html#writeList_cat">writeList_cat</a></span> <span class="id"><a href="monae.array_lib.html#writeListC">writeListC//</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="monae.hierarchy.html#bindA">bindA</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys'</span>))).<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (@<span class="id"><a href="monae.fail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> <span class="id">_</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys'</span>).<span class="id">+1</span>) <span class="id">zs'</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys'</span>) <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#506674b18256ef8f50efed43fa1dfd7d">[::</a></span> <span class="id">p]</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id">ys'</span> <span class="id"><a href="monae.hierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span>))) <span class="id">&gt;&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">ys'</span>).<span class="id">+1,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">zs'</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span> <span class="id">2</span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">2!bindretf</span> <span class="id">-2!bindA;</span> <span class="id">apply/refin_bindr/ih</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move:</span> <span class="id">nxs;</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS;</a></span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#leq_ltn_trans">leq_ltn_trans</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-ysys'</span> <span class="id">-</span>(<span class="id"><a href="monae.example_quicksort.html#size_partition">size_partition</a></span> <span class="id">p</span> <span class="id">xs</span>) <span class="id">pxs</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#leq_addr">leq_addr</a></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;1h:&nbsp;slowsort_preserves_size2&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_iquicksort.html#X:318">X</a></span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id">_]</span>(<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id">ys'</span>))<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monae.example_iquicksort.html#X:319">X</a></span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id">_]</span>(<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id">ys'</span>))<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="monae.example_quicksort.html#slowsort_preserves_size2">slowsort_preserves_size2</a></span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="a:324" class="id"><span id="a:322" class="id"><span id="a:320" class="id"><a name="a:324" class="">a</a></span></span></span> <span id="b:325" class="id"><span id="b:323" class="id"><span id="b:321" class="id"><a name="b:325" class="">b</a></span></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:321">b</a></span>.<span class="id">+1</span>) <span class="id">zs'</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:321">b</a></span>) <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#506674b18256ef8f50efed43fa1dfd7d">[::</a></span> <span class="id">p]</span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monae.array_lib.html#writeList">writeList</a></span> <span class="id">i</span> <span class="id"><a href="monae.example_iquicksort.html#a:320">a</a></span> <span class="id"><a href="monae.hierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monae.example_iquicksort.html#iqsort">iqsort</a></span> (<span class="id">i</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monae.example_iquicksort.html#b:321">b</a></span>.<span class="id">+1,</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">zs'</span>)))).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monae.example_quicksort.html#bind_slowsort_guard">bind_slowsort_guard</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:326">X]bind_slowsort_guard</a></span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">ys''</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bind_guard">refin_bind_guard</a></span> <span class="id">=&gt;</span> <span class="id">/eqP</span> <span class="id">ys'ys''</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-bindA</span> <span class="id">-</span>(<span class="id"><a href="monae.array_lib.html#writeListC">writeListC</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">ys''</span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:327">X]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">-cat_rcons</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monae.fail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monae.example_iquicksort.html#X:328">X]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monae.array_lib.html#writeList_cat">writeList_cat</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="monae.fail_lib.html#plus_commute">plus_commute</a></span> (<span class="id"><a href="monae.example_quicksort.html#slowsort">slowsort</a></span> <span class="id">zs'</span>))<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="monae.array_lib.html#writeList_cat">writeList_cat</a></span> <span class="id">i</span> <span class="id">ys''</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#506674b18256ef8f50efed43fa1dfd7d">[::</a></span> <span class="id">p]</span>) <span class="id">-</span>(<span class="id"><a href="monae.array_lib.html#writeListC">writeListC</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">zs'</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cats1">cats1</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_rcons">size_rcons/=</a></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;step&nbsp;1i:&nbsp;ih&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cats1">cats1</a></span> <span class="id"><a href="monae.hierarchy.html#bindA">bindA;</a></span> <span class="id">apply:</span> <span class="id"><a href="monae.fail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_rcons">size_rcons;</a></span> <span class="id">apply:</span> <span class="id">ih</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> <span class="id">nxs;</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS;</a></span> <span class="id">apply:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#leq_ltn_trans">leq_ltn_trans</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-zszs'</span> <span class="id">-</span>(<span class="id"><a href="monae.example_quicksort.html#size_partition">size_partition</a></span> <span class="id">p</span> <span class="id">xs</span>) <span class="id">pxs</span> <span class="id">/=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#leq_addl">leq_addl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monae.example_iquicksort.html#iqsort_spec">iqsort_spec</a></span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
