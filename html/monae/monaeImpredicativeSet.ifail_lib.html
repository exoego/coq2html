
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module monaeImpredicativeSet.ifail_lib</title>
<meta name="description" content="Documentation of Coq module monaeImpredicativeSet.ifail_lib" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      <li><details id="monae"><summary>monae</summary>
          <ul>
          <li><a href="monae.altprob_model.html">altprob_model</a></li>
<li><a href="monae.array_lib.html">array_lib</a></li>
<li><a href="monae.category.html">category</a></li>
<li><a href="monae.category_ext.html">category_ext</a></li>
<li><a href="monae.example_iquicksort.html">example_iquicksort</a></li>
<li><a href="monae.example_monty.html">example_monty</a></li>
<li><a href="monae.example_nqueens.html">example_nqueens</a></li>
<li><a href="monae.example_quicksort.html">example_quicksort</a></li>
<li><a href="monae.example_relabeling.html">example_relabeling</a></li>
<li><a href="monae.example_spark.html">example_spark</a></li>
<li><a href="monae.example_transformer.html">example_transformer</a></li>
<li><a href="monae.example_typed_store.html">example_typed_store</a></li>
<li><a href="monae.fail_lib.html">fail_lib</a></li>
<li><a href="monae.gcm_model.html">gcm_model</a></li>
<li><a href="monae.hierarchy.html">hierarchy</a></li>
<li><a href="monae.monad_composition.html">monad_composition</a></li>
<li><a href="monae.monad_lib.html">monad_lib</a></li>
<li><a href="monae.monad_model.html">monad_model</a></li>
<li><a href="monae.monad_transformer.html">monad_transformer</a></li>
<li><a href="monae.monae_lib.html">monae_lib</a></li>
<li><a href="monae.proba_lib.html">proba_lib</a></li>
<li><a href="monae.proba_monad_model.html">proba_monad_model</a></li>
<li><a href="monae.smallstep.html">smallstep</a></li>
<li><a href="monae.state_lib.html">state_lib</a></li>
<li><a href="monae.trace_lib.html">trace_lib</a></li>
<li><a href="monae.typed_store_lib.html">typed_store_lib</a></li>
<li><a href="monae.typed_store_model.html">typed_store_model</a></li>
          </ul>
          </details>
          </li>
<li><details id="monaeImpredicativeSet"><summary>monaeImpredicativeSet</summary>
          <ul>
          <li><a href="monaeImpredicativeSet.iexample_transformer.html">iexample_transformer</a></li>
<li><a href="monaeImpredicativeSet.ifail_lib.html">ifail_lib</a></li>
<li><a href="monaeImpredicativeSet.ifmt_lifting.html">ifmt_lifting</a></li>
<li><a href="monaeImpredicativeSet.ihierarchy.html">ihierarchy</a></li>
<li><a href="monaeImpredicativeSet.imonad_composition.html">imonad_composition</a></li>
<li><a href="monaeImpredicativeSet.imonad_lib.html">imonad_lib</a></li>
<li><a href="monaeImpredicativeSet.imonad_model.html">imonad_model</a></li>
<li><a href="monaeImpredicativeSet.imonad_transformer.html">imonad_transformer</a></li>
<li><a href="monaeImpredicativeSet.imonae_lib.html">imonae_lib</a></li>
<li><a href="monaeImpredicativeSet.iparametricity_codensity.html">iparametricity_codensity</a></li>
<li><a href="monaeImpredicativeSet.istate_lib.html">istate_lib</a></li>
<li><a href="monaeImpredicativeSet.itrace_lib.html">itrace_lib</a></li>
          </ul>
          </details>
          </li>
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module monaeImpredicativeSet.ifail_lib</h1>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.all_ssreflect.html">all_ssreflect</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html">imonae_lib</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">HB</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for HB.structures">structures</a></span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html">ihierarchy</a></span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html">imonad_lib</a></span>.<br/>
<span class="vernacular">From</span> <span class="id">Equations</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id"><a href="NOTFOUND the module url for Equations.Prop.Equations">Equations</a></span>.<br/>
<br/>
<pre class="ssrdoc">
    Definitions and lemmas using failure and nondeterministic monads       
                                                                           
                  arb == arbitrary nondeterministic choice between         
                         booleans                                          
                foldM                                                      
        unfoldM p f y == generates a list a from a seed y, if p y holds    
                         the generation stops,otherwise an element and a   
                         new seed of generated using f                     
                hyloM == [2, Sect. 5.1]                                    
      arbitrary def s == nondeterministic choice of an element in the list 
                         s and def if the list is empty                    
               subs s == subsequence of a list                             
                         (ref: Sect. 3.1, gibbons2012utp)                  
           insert a s == insert a in the list s nondeterministically       
              iperm s == nondeterministic permutation of the list s,       
                         defined as a Fixpoint using insert [1, Sect. 3]   
             select s == nondeterministically splits the list s into a     
                         pair of one chosen element and the rest           
                      [2, Sect. 3.2]                                       
              uperm s == nondeterministically computes a permutation of s, 
                         defined using unfoldM and select [2, Sect. 3.2]   
             splits s == split a list nondeterministically                 
                         type: seq A -&gt; M (seq A * seq A)                  
           m1 `&lt;=` m2 == m1 refines m2, i.e., every result of m1 is a      
                         possible result of m2                             
            f `&lt;.=` g == refinement relation lifted to functions, i.e.,    
                         forall x, f x `&lt;=` g x                            
                                                                           
ref:                                                                       
- [1] mu2019tr2                                                            
- [2] mu2019tr3                                                            
- [3] gibbons2011icfp                                                      
- [4] mu2020flops                                                          
</pre>
<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">&quot;m1 `&lt;=` m2&quot;</span> (<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">70,</span> <span class="id">no</span> <span class="id">associativity</span>).<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">&quot;f `&lt;.=` g&quot;</span> (<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">70,</span> <span class="id">no</span> <span class="id">associativity</span>).<br/>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Printing</span> <span class="vernacular">Implicit</span> <span class="vernacular">Defensive</span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">monae_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="mem_rcons_cat" class="id"><a name="mem_rcons_cat" class="">mem_rcons_cat</a></span> (<span id="A:1" class="id"><a name="A:1" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#Equality.Exports.eqType">eqType</a></span>) (<span id="b:2" class="id"><a name="b:2" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:1">A</a></span>) <span id="h:3" class="id"><a name="h:3" class="">h</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:3">h</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:2">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> <span id="b1:4" class="id"><a name="b1:4" class="">b1</a></span> <span id="b2:5" class="id"><a name="b2:5" class="">b2,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:2">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b1:4">b1</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:3">h</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b2:5">b2</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">move=&gt;</span> <span class="id">hb;</span> <span class="gallina-kwd">exists</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#take">take</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#index">index</a></span> <span class="id">h</span> <span class="id">b</span>) <span class="id">b</span>)<span class="id">,</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#drop">drop</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#index">index</a></span> <span class="id">h</span> <span class="id">b</span>).<span class="id">+1</span> <span class="id">b</span>).<br/>
<span class="id">rewrite</span> <span class="id">-cats1</span> <span class="id">-catA</span> <span class="id">-{1}</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cat_take_drop">cat_take_drop</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#index">index</a></span> <span class="id">h</span> <span class="id">b</span>) <span class="id">b</span>)<span class="id">;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">_</span>) <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-{2}</span>(<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nth_index">nth_index</a></span> <span class="id">h</span> <span class="id">hb</span>) <span class="id">-drop_nth</span> <span class="id">//</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#index_mem">index_mem</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="bind_ext_guard" class="id"><a name="bind_ext_guard" class="">bind_ext_guard</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFail.Exports.failMonad">failMonad}</a></span> (<span id="A:7" class="id"><a name="A:7" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="b:8" class="id"><a name="b:8" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span id="m1:9" class="id"><a name="m1:9" class="">m1</a></span> <span id="m2:10" class="id"><a name="m2:10" class="">m2</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:6">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:7">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:8">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:9">m1</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:10">m2</a></span>) <span class="id">-&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:8">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:9">m1</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:8">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:10">m2</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
 <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">b</span> <span class="id">=&gt;</span> <span class="id">[-&gt;//|_];</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardF">guardF</a></span> <span class="id">!bindfailf</span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="arb" class="id"><a name="arb" class="">arb</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad}</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:11">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="monadalt_lemmas" class="id"><a name="monadalt_lemmas" class="">monadalt_lemmas</a></span>.<br/>
<span class="vernacular">Variable</span> (<span id="monadalt_lemmas.M" class="id"><a name="monadalt_lemmas.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="alt_fmapDr" class="id"><a name="alt_fmapDr" class="">alt_fmapDr</a></span> (<span id="A:13" class="id"><a name="A:13" class="">A</a></span> <span id="B:14" class="id"><a name="B:14" class="">B</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="f:15" class="id"><a name="f:15" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:13">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:14">B</a></span>) (<span id="m1:16" class="id"><a name="m1:16" class="">m1</a></span> <span id="m2:17" class="id"><a name="m2:17" class="">m2</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#monadalt_lemmas.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:13">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#monadalt_lemmas.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#5ffd50877ab4fcdc0107cf881b980bc8">#</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:15">f</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:16">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:17">m2</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#monadalt_lemmas.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#5ffd50877ab4fcdc0107cf881b980bc8">#</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:15">f</a></span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:16">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#monadalt_lemmas.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#5ffd50877ab4fcdc0107cf881b980bc8">#</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:15">f</a></span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:17">m2</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">3!fmapE</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDl">alt_bindDl</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#monadalt_lemmas">monadalt_lemmas</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="fmap_fail" class="id"><a name="fmap_fail" class="">fmap_fail</a></span> <span class="id">{A</span> <span id="B:19" class="id"><a name="B:19" class="">B</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0}</a></span> (<span id="M:20" class="id"><a name="M:20" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFail.Exports.failMonad">failMonad</a></span>) (<span id="f:21" class="id"><a name="f:21" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:18">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:19">B</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:20">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#5ffd50877ab4fcdc0107cf881b980bc8">#</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:21">f</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindfailf">bindfailf</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="well_founded_size" class="id"><a name="well_founded_size" class="">well_founded_size</a></span> <span id="A:22" class="id"><a name="A:22" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#well_founded">well_founded</a></span> (<span class="gallina-kwd">fun</span> <span id="x:23" class="id"><a name="x:23" class="">x</a></span> <span id="y:24" class="id"><a name="y:24" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:22">A</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:23">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:24">y</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
 <span class="gallina-kwd">by</span> <span class="id">apply:</span> (@<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Arith.Wf_nat.html#well_founded_lt_compat">Wf_nat.well_founded_lt_compat</a></span> <span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span>) <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">?</span> <span class="id">/ltP</span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span id="bassert_hylo" class="id"><a name="bassert_hylo" class="">bassert_hylo</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFail.Exports.failMonad">failMonad}</a></span> (<span id="A:26" class="id"><a name="A:26" class="">A</a></span> <span id="B:27" class="id"><a name="B:27" class="">B</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>)<br/>
&nbsp;&nbsp;(<span id="f:28" class="id"><a name="f:28" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:27">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:25">M</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:26">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:27">B</a></span>)%<span class="id">type</span>) (<span id="p:29" class="id"><a name="p:29" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:27">B</a></span>) (<span id="r:32" class="id"><a name="r:32" class="">r</a></span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="p:30" class="id"><a name="p:30" class="">p</a></span> <span id="f:31" class="id"><a name="f:31" class="">f,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:27">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:27">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="b:33" class="id"><a name="b:33" class="">b,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:28">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:33">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bassert">bassert</a></span> (<span class="gallina-kwd">fun</span> <span id="z:34" class="id"><a name="z:34" class="">z</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#r:32">r</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#p:29">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:28">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#z:34">z</a></span>.<span class="id">2</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:33">b</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:28">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:33">b</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="bassert_size" class="id"><a name="bassert_size" class="">bassert_size</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFail.Exports.failMonad">failMonad}</a></span> (<span id="A:36" class="id"><a name="A:36" class="">A</a></span> <span id="B:37" class="id"><a name="B:37" class="">B</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>)<br/>
&nbsp;&nbsp;(<span id="f:38" class="id"><a name="f:38" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:37">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:35">M</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:36">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:37">B</a></span>)%<span class="id">type</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;@<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#bassert_hylo">bassert_hylo</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:35">M</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:38">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#predT">predT</a></span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">_</span> <span id="x:39" class="id"><a name="x:39" class="">x</a></span> <span id="y:40" class="id"><a name="y:40" class="">y</a></span> <span class="id">=&gt;</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:39">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:40">y</a></span>).<br/>
<br/>
<span class="vernacular">Section</span> <span id="foldM" class="id"><a name="foldM" class="">foldM</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="foldM.M" class="id"><a name="foldM.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Monad.Exports.monad">monad</a></span>) (<span id="foldM.T" class="id"><a name="foldM.T" class="">T</a></span> <span id="foldM.R" class="id"><a name="foldM.R" class="">R</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="foldM.f" class="id"><a name="foldM.f" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#R:42">R</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:43">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:41">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#R:42">R</a></span>).<br/>
<span class="vernacular">Fixpoint</span> <span id="foldM" class="id"><a name="foldM" class="">foldM</a></span> <span id="z:45" class="id"><a name="z:45" class="">z</a></span> <span id="s:46" class="id"><a name="s:46" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#foldM.M">M</a></span> <span class="id">_</span> <span class="id">:=</span> <span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:46">s</a></span> <span class="id">is</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">s'</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#foldM.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#z:45">z</a></span> <span class="id">x</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="y:49" class="id"><a name="y:49" class="">y</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#foldM:47">foldM</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:49">y</a></span> <span class="id">s'</span>) <span class="gallina-kwd">else</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#z:45">z</a></span>).<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#foldM">foldM</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="unfoldM" class="id"><a name="unfoldM" class="">unfoldM</a></span>.<br/>
<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="unfoldM.unfoldM_monad" class="id"><a name="unfoldM.unfoldM_monad" class="">unfoldM_monad</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="unfoldM.unfoldM_monad.M" class="id"><a name="unfoldM.unfoldM_monad.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Monad.Exports.monad">monad</a></span>) (<span id="unfoldM.unfoldM_monad.A" class="id"><a name="unfoldM.unfoldM_monad.A" class="">A</a></span> <span id="unfoldM.unfoldM_monad.B" class="id"><a name="unfoldM.unfoldM_monad.B" class="">B</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>).<br/>
<span class="vernacular">Variable</span> (<span id="unfoldM.unfoldM_monad.r" class="id"><a name="unfoldM.unfoldM_monad.r" class="">r</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.B">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.B">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>).<br/>
<span class="vernacular">Hypothesis</span> <span id="unfoldM.unfoldM_monad.wfr" class="id"><a name="unfoldM.unfoldM_monad.wfr" class="">wfr</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#well_founded">well_founded</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.r">r</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="unfoldM.unfoldM_monad.p" class="id"><a name="unfoldM.unfoldM_monad.p" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.B">B</a></span>) (<span id="unfoldM.unfoldM_monad.f" class="id"><a name="unfoldM.unfoldM_monad.f" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.B">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.M">M</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.B">B</a></span>)%<span class="id">type</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="unfoldM'" class="id"><a name="unfoldM'" class="">unfoldM'</a></span> (<span id="y:57" class="id"><a name="y:57" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.B">B</a></span>) (<span id="g:59" class="id"><a name="g:59" class="">g</a></span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="y':58" class="id"><a name="y':58" class="">y'</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.B">B,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.r">r</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y':58">y'</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:57">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.A">A</a></span>)) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.A">A</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:57">y</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:57">y</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="xz:60" class="id"><a name="xz:60" class="">xz</a></span> <span class="id">=&gt;</span> <span class="gallina-kwd">match</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Bool.Bool.html#bool_dec">Bool.bool_dec</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.r">r</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:60">xz</a></span>.<span class="id">2</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:57">y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#left">left</a></span> <span class="id">H</span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:60">xz</a></span>.<span class="id">1</span>) (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#g:59">g</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:60">xz</a></span>.<span class="id">2</span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#right">right</a></span> <span class="id">H</span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">end</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="unfoldM" class="id"><a name="unfoldM" class="">unfoldM</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#Fix">Fix</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad.wfr">wfr</a></span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">_</span> <span class="id">_</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM'">unfoldM'</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_monad">unfoldM_monad</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="unfoldM.unfoldM_failMonad" class="id"><a name="unfoldM.unfoldM_failMonad" class="">unfoldM_failMonad</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="unfoldM.unfoldM_failMonad.M" class="id"><a name="unfoldM.unfoldM_failMonad.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFail.Exports.failMonad">failMonad</a></span>) (<span id="unfoldM.unfoldM_failMonad.A" class="id"><a name="unfoldM.unfoldM_failMonad.A" class="">A</a></span> <span id="unfoldM.unfoldM_failMonad.B'" class="id"><a name="unfoldM.unfoldM_failMonad.B'" class="">B'</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>).<br/>
<span class="vernacular">Let</span> <span id="unfoldM.unfoldM_failMonad.B" class="id"><a name="unfoldM.unfoldM_failMonad.B" class="">B</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.B'">B'</a></span>.<br/>
<span class="vernacular">Notation</span> <span id="unfoldM" class="id"><a name="unfoldM" class="">unfoldM</a></span> <span class="id">:=</span> (@<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM">unfoldM</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.A">A</a></span> <span class="id">_</span> <span class="id">_</span> (@<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#well_founded_size">well_founded_size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.B'">B'</a></span>)).<br/>
<span class="vernacular">Variables</span> (<span id="unfoldM.unfoldM_failMonad.p" class="id"><a name="unfoldM.unfoldM_failMonad.p" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.B">B</a></span>) (<span id="unfoldM.unfoldM_failMonad.f" class="id"><a name="unfoldM.unfoldM_failMonad.f" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.B">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.M">M</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.B">B</a></span>)%<span class="id">type</span>).<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="unfoldM.unfoldM_failMonad.decr_size" class="id"><a name="unfoldM.unfoldM_failMonad.decr_size" class="">decr_size</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#bassert_size">bassert_size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.f">f</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="unfoldME" class="id"><a name="unfoldME" class="">unfoldME</a></span> <span id="y:67" class="id"><a name="y:67" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM">unfoldM</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:67">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:67">y</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:67">y</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="xz:68" class="id"><a name="xz:68" class="">xz</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:68">xz</a></span>.<span class="id">1</span>) (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM">unfoldM</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:68">xz</a></span>.<span class="id">2</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id">rewrite</span> <span class="id">/unfoldM</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#Fix_eq">Init.Wf.Fix_eq</a></span><span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">b</span> <span class="id">g</span> <span class="id">g'</span> <span class="id">H;</span> <span class="id">rewrite</span> <span class="id">/unfoldM';</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">pb</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[a'</span> <span class="id">b']</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Bool.Bool.html#bool_dec">Bool.bool_dec</a></span> <span class="id">=&gt;</span> <span class="id">//;</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">H</span>.<br/>
<span class="id">rewrite</span> <span class="id">/unfoldM';</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">py</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad.decr_size">decr_size</a></span> <span class="id">/bassert</span> <span class="id">2!bindA;</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[a'</span> <span class="id">b']</span>.<br/>
<span class="id">case:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#assertPn">assertPn</a></span> <span class="id">=&gt;</span> <span class="id">b'y;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">2!bindfailf</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">2!bindretf</span> <span class="id">/=</span> <span class="id">b'y</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM.unfoldM_failMonad">unfoldM_failMonad</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM">unfoldM</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM">unfoldM</a></span> <span class="id">:</span> <span class="id">simpl</span> <span class="id">never</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="hyloM" class="id"><a name="hyloM" class="">hyloM</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="hyloM.M" class="id"><a name="hyloM.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFail.Exports.failMonad">failMonad</a></span>) (<span id="hyloM.A" class="id"><a name="hyloM.A" class="">A</a></span> <span id="hyloM.B" class="id"><a name="hyloM.B" class="">B</a></span> <span id="hyloM.C" class="id"><a name="hyloM.C" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>).<br/>
<span class="vernacular">Variables</span> (<span id="hyloM.op" class="id"><a name="hyloM.op" class="">op</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.C">C</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.C">C</a></span>) (<span id="hyloM.e" class="id"><a name="hyloM.e" class="">e</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.C">C</a></span>) (<span id="hyloM.p" class="id"><a name="hyloM.p" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.B">B</a></span>) (<span id="hyloM.f" class="id"><a name="hyloM.f" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.B">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.M">M</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.B">B</a></span>)%<span class="id">type</span>).<br/>
<span class="vernacular">Variable</span> <span id="hyloM.seed" class="id"><a name="hyloM.seed" class="">seed</a></span> <span class="id">:</span> <span class="gallina-kwd">forall</span> (<span id="p:77" class="id"><a name="p:77" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.B">B</a></span>) (<span id="f:78" class="id"><a name="f:78" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.B">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.M">M</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.B">B</a></span>)%<span class="id">type</span>)<span class="id">,</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.B">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.B">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="hyloM'" class="id"><a name="hyloM'" class="">hyloM'</a></span> (<span id="y:80" class="id"><a name="y:80" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.B">B</a></span>) (<span id="g:82" class="id"><a name="g:82" class="">g</a></span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="y':81" class="id"><a name="y':81" class="">y',</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.seed">seed</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y':81">y'</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:80">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.C">C</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.C">C</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:80">y</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.e">e</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:80">y</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span id="xz:83" class="id"><a name="xz:83" class="">xz</a></span> <span class="id">=&gt;</span> <span class="gallina-kwd">match</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Bool.Bool.html#bool_dec">Bool.bool_dec</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.seed">seed</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:83">xz</a></span>.<span class="id">2</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:80">y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#true">true</a></span> <span class="gallina-kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#left">left</a></span> <span class="id">H</span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:83">xz</a></span>.<span class="id">1</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#g:82">g</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:83">xz</a></span>.<span class="id">2</span> <span class="id">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Specif.html#right">right</a></span> <span class="id">H</span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">end</span>).<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="hyloM.well_founded_seed" class="id"><a name="hyloM.well_founded_seed" class="">well_founded_seed</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#well_founded">well_founded</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.seed">seed</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.f">f</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="hyloM" class="id"><a name="hyloM" class="">hyloM</a></span> <span class="id">:=</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#Fix">Fix</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.well_founded_seed">well_founded_seed</a></span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.M">M</a></span> <span class="id">_</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM'">hyloM'</a></span>.<br/>
<br/>
<span class="vernacular">Hypothesis</span> <span id="hyloM.Hdecr_seed" class="id"><a name="hyloM.Hdecr_seed" class="">Hdecr_seed</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#bassert_hylo">bassert_hylo</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.seed">seed</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="hyloME" class="id"><a name="hyloME" class="">hyloME</a></span> <span id="y:86" class="id"><a name="y:86" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM">hyloM</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:86">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:86">y</a></span> <span class="gallina-kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.e">e</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.f">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:86">y</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="xz:87" class="id"><a name="xz:87" class="">xz</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.op">op</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:87">xz</a></span>.<span class="id">1</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM">hyloM</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xz:87">xz</a></span>.<span class="id">2</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">rewrite</span> <span class="id">/hyloM</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Wf.html#Fix_eq">Init.Wf.Fix_eq</a></span><span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">b</span> <span class="id">g</span> <span class="id">g'</span> <span class="id">K;</span> <span class="id">rewrite</span> <span class="id">/hyloM';</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">pb</span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[a'</span> <span class="id">b']</span> <span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Bool.Bool.html#bool_dec">Bool.bool_dec</a></span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">K</span>.<br/>
<span class="id">rewrite</span> <span class="id">{1}/hyloM';</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">py</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM.Hdecr_seed">Hdecr_seed</a></span> <span class="id">/bassert</span> <span class="id">!bindA</span>.<br/>
<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">-[b'</span> <span class="id">a']</span>.<br/>
<span class="id">case:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#assertPn">assertPn</a></span> <span class="id">=&gt;</span> <span class="id">Hseed;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">2!bindfailf</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">2!bindretf</span> <span class="id">Hseed</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM">hyloM</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#hyloM">hyloM</a></span> <span class="id">{M}</span> <span class="id">{A}</span> <span class="id">{B}</span> <span class="id">{C}</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="arbitrary" class="id"><a name="arbitrary" class="">arbitrary</a></span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span id="arbitrary.M" class="id"><a name="arbitrary.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad</a></span>) (<span id="arbitrary.A" class="id"><a name="arbitrary.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="arbitrary.def" class="id"><a name="arbitrary.def" class="">def</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:89">A</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="arbitrary" class="id"><a name="arbitrary" class="">arbitrary</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary.A">A</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#foldr1">foldr1</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary.def">def</a></span>) (<span class="gallina-kwd">fun</span> <span id="x:91" class="id"><a name="x:91" class="">x</a></span> <span id="y:92" class="id"><a name="y:92" class="">y</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:91">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:92">y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id">{M}</span> <span class="id">{A}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="arbitrary1" class="id"><a name="arbitrary1" class="">arbitrary1</a></span> (<span id="N:93" class="id"><a name="N:93" class="">N</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad</a></span>) (<span id="T:94" class="id"><a name="T:94" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="def:95" class="id"><a name="def:95" class="">def</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:94">T</a></span>) <span id="h:96" class="id"><a name="h:96" class="">h</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#def:95">def</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#506674b18256ef8f50efed43fa1dfd7d">[::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:96">h]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:96">h</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#N:93">N</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:94">T</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Section</span> <span id="arbitrary_lemmas" class="id"><a name="arbitrary_lemmas" class="">arbitrary_lemmas</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="arbitrary_lemmas.M" class="id"><a name="arbitrary_lemmas.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAltCI.Exports.altCIMonad">altCIMonad</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="arbitrary2" class="id"><a name="arbitrary2" class="">arbitrary2</a></span> (<span id="T:98" class="id"><a name="T:98" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="def:99" class="id"><a name="def:99" class="">def</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:98">T</a></span>) <span id="h:100" class="id"><a name="h:100" class="">h</a></span> <span id="t:101" class="id"><a name="t:101" class="">t</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#def:99">def</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#9e9281397dab83046645f1b62dbb2487">[::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:100">h;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:101">t]</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:100">h</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:101">t</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/arbitrary</span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altC">altC</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="arbitrary_cons" class="id"><a name="arbitrary_cons" class="">arbitrary_cons</a></span> (<span id="T:102" class="id"><a name="T:102" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="def:103" class="id"><a name="def:103" class="">def</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:102">T</a></span>) <span id="h:104" class="id"><a name="h:104" class="">h</a></span> <span id="t:105" class="id"><a name="t:105" class="">t</a></span> <span class="id">:</span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:105">t</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#def:103">def</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:104">h</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:105">t</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:104">h</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#def:103">def</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:105">t</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">move:</span> <span class="id">def</span> <span class="id">h;</span> <span class="id">elim:</span> <span class="id">t</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">a</span> <span class="id">[//|b</span> <span class="id">[|c</span> <span class="id">t]]</span> <span class="id">ih</span> <span class="id">def</span> <span class="id">h</span> <span class="id">_</span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary2">arbitrary2</a></span>.<br/>
<span class="id">-</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/arbitrary</span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altA">altA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altC">altC</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altC">altC</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">b</span>)).<br/>
<span class="id">-</span> <span class="id">move:</span> (<span class="id">ih</span> <span class="id">a</span> <span class="id">h</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id">/arbitrary</span> <span class="id">/=</span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">ih</span> <span class="id">h</span> <span class="id">a</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#erefl">erefl</a></span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id">/arbitrary</span> <span class="id">/=</span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altCA">altCA</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="arbitrary_naturality" class="id"><a name="arbitrary_naturality" class="">arbitrary_naturality</a></span> (<span id="T:106" class="id"><a name="T:106" class="">T</a></span> <span id="U:107" class="id"><a name="U:107" class="">U</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="a:108" class="id"><a name="a:108" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:106">T</a></span>) (<span id="b:109" class="id"><a name="b:109" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#U:107">U</a></span>) (<span id="f:110" class="id"><a name="f:110" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:106">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#U:107">U</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="x:111" class="id"><a name="x:111" class="">x,</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:111">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#5ffd50877ab4fcdc0107cf881b980bc8">#</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:110">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:108">a</a></span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:111">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:109">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:110">f</a></span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:111">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
<span class="id">elim=&gt;</span> <span class="id">//</span> <span class="id">x</span> <span class="id">[_</span> <span class="id">_</span> <span class="id">|</span> <span class="id">x'</span> <span class="id">xs</span> <span class="id">/</span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#isT">isT</a></span>)<span class="id">]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]compE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:112">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">_]/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id">=&gt;</span> <span class="id">ih</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]compE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]/=</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]</a></span>(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_cons">arbitrary_cons</a></span> <span class="id">b</span>) <span class="id">//</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]compE</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]arbitrary_cons</a></span> <span class="id">//</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDl">alt_bindDl</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">/=</span> <span class="id">ih</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="mpair_arbitrary_base_case" class="id"><a name="mpair_arbitrary_base_case" class="">mpair_arbitrary_base_case</a></span> (<span id="T:113" class="id"><a name="T:113" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span id="a:114" class="id"><a name="a:114" class="">a</a></span> <span id="x:115" class="id"><a name="x:115" class="">x</a></span> (<span id="y:116" class="id"><a name="y:116" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:113">T</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:116">y</a></span>)%<span class="id">nat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:114">a,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:114">a</a></span>) (<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#cp">cp</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#506674b18256ef8f50efed43fa1dfd7d">[::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:115">x]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:116">y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#mpair">mpair</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:114">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#506674b18256ef8f50efed43fa1dfd7d">[::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:115">x],</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:114">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:116">y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">move=&gt;</span> <span class="id">y0;</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#cp1">cp1</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id">a</span> <span class="id">y</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="y':118" class="id"><span id="y':117" class="id"><a name="y':118" class="">y'</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">x,</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y':117">y'</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id">_</span>)) <span class="id">-</span>(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_naturality">arbitrary_naturality</a></span> <span class="id">a</span>) <span class="id">//</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="z:121" class="id"><span id="z:119" class="id"><a name="z:121" class="">z</a></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">x;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="y':122" class="id"><span id="y':120" class="id"><a name="y':122" class="">y'</a></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id">a</span> <span class="id">y;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#z:119">z,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y':120">y'</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id">_</span>)%<span class="id">Do</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">[]</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="arbitrary_cat" class="id"><a name="arbitrary_cat" class="">arbitrary_cat</a></span> (<span id="T:123" class="id"><a name="T:123" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="a:124" class="id"><a name="a:124" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:123">T</a></span>) <span id="s:125" class="id"><a name="s:125" class="">s</a></span> <span id="t:126" class="id"><a name="t:126" class="">t</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="m:127" class="id"><a name="m:127" class="">m</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:125">s</a></span> <span class="gallina-kwd">in</span> <span class="gallina-kwd">let</span> <span id="n:128" class="id"><a name="n:128" class="">n</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:126">t</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m:127">m</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#n:128">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:124">a</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:125">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:126">t</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:124">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:125">s</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:124">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:126">t</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">t</span> <span class="id">=&gt;</span> <span class="id">[//|s1</span> <span class="id">s2</span> <span class="id">IH]</span>.<br/>
<span class="id">elim/last_ind</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">_</span> <span class="id">m</span> <span class="id">n</span> <span class="id">m0</span> <span class="id">n0</span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cat_cons">cat_cons</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]arbitrary_cons;</a></span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_cat">size_cat</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_rcons">size_rcons</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addnS">addnS</a></span>.<br/>
<span class="id">destruct</span> <span class="id">s2</span> <span class="gallina-kwd">as</span> <span class="id">[|s2</span> <span class="id">s3]</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id">IH</span> <span class="id">//</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altA">altA;</a></span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]arbitrary_cons</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="mpair_arbitrary" class="id"><a name="mpair_arbitrary" class="">mpair_arbitrary</a></span> (<span id="T:129" class="id"><a name="T:129" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span id="a:130" class="id"><a name="a:130" class="">a</a></span> (<span id="x:131" class="id"><a name="x:131" class="">x</a></span> <span id="y:132" class="id"><a name="y:132" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:129">T</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:131">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:132">y</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#mpair">mpair</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:130">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:131">x,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:130">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:132">y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:130">a,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:130">a</a></span>) (<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#cp">cp</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:131">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:132">y</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:129">T</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:129">T</a></span>)%<span class="id">type</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">elim:</span> <span class="id">x</span> <span class="id">y</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">x;</span> <span class="id">case=&gt;</span> <span class="id">[_</span> <span class="id">y</span> <span class="id">_</span> <span class="id">size_y|x'</span> <span class="id">xs</span> <span class="id">IH</span> <span class="id">y</span> <span class="id">_</span> <span class="id">size_y];</span> <span class="id">apply/esym</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/mpair_arbitrary_base_case</span>.<br/>
<span class="id">set</span> <span class="id">xxs</span> <span class="id">:=</span> <span class="id">x'</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span>.<br/>
<span class="id">rewrite</span> <span class="id">/cp</span> <span class="id">-cat1s</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#allpairs_cat">allpairs_cat</a></span> <span class="id">-/</span>(<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#cp">cp</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#cp1">cp1</a></span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_cat">arbitrary_cat;</a></span> <span class="id">last</span> <span class="id">2</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_map">size_map</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_cat">size_cat</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size_map">size_map</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#addn_gt0">addn_gt0</a></span> <span class="id">size_y</span>.<br/>
<span class="id">pose</span> <span class="id">n</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">y</span>.<br/>
<span class="id">pose</span> <span class="id">l</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> (<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#cp">cp</a></span> <span class="id">xxs</span> <span class="id">y</span>).<br/>
<span class="id">rewrite</span> <span class="id">-IH</span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id">-/xxs</span>.<br/>
<span class="id">move:</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#mpair_arbitrary_base_case">mpair_arbitrary_base_case</a></span> <span class="id">a</span> <span class="id">x</span> <span class="id">size_y</span>).<br/>
<span class="id">rewrite</span> <span class="id">{1}/cp</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:133">X]/=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cats0">cats0</a></span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
<span class="id">rewrite</span> <span class="id">-alt_bindDl</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-arbitrary_cat</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="arbitrary_inde" class="id"><a name="arbitrary_inde" class="">arbitrary_inde</a></span> (<span id="T:134" class="id"><a name="T:134" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span id="a:135" class="id"><a name="a:135" class="">a</a></span> (<span id="s:136" class="id"><a name="s:136" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:134">T</a></span>) <span class="id">{U}</span> (<span id="m:138" class="id"><a name="m:138" class="">m</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#U:137">U</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:136">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:135">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:136">s</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m:138">m</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m:138">m</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">a</span> <span class="id">m</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">h</span> <span class="id">[_</span> <span class="id">a</span> <span class="id">m</span> <span class="id">_|h'</span> <span class="id">t</span> <span class="id">ih</span> <span class="id">a</span> <span class="id">m</span> <span class="id">_]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary1">arbitrary1</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_cons">arbitrary_cons</a></span> <span class="id">//</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDl">alt_bindDl</a></span> <span class="id">ih</span> <span class="id">//</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altmm">altmm</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="arbitrary_flatten" class="id"><a name="arbitrary_flatten" class="">arbitrary_flatten</a></span> (<span id="A:139" class="id"><a name="A:139" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span id="def:140" class="id"><a name="def:140" class="">def</a></span> (<span id="s:141" class="id"><a name="s:141" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:139">A</a></span>) (<span id="f:142" class="id"><a name="f:142" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:139">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:139">A</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:141">s</a></span>)%<span class="id">nat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:143" class="id"><a name="x:143" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#def:140">def</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:141">s;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:142">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:143">x</a></span>))%<span class="id">Do</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#def:140">def</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#flatten">flatten</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#dcd18413b33436252c77b6c6465f02bc">[seq</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#506674b18256ef8f50efed43fa1dfd7d">[::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:142">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:144">y]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#dcd18413b33436252c77b6c6465f02bc">|</a></span> <span id="y:145" class="id"><span id="y:144" class="id"><a name="y:145" class="">y</a></span></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#dcd18413b33436252c77b6c6465f02bc">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:141">s]</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">f</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">a</span> <span class="id">[_</span> <span class="id">f</span> <span class="id">_</span> <span class="id">/=|h</span> <span class="id">t</span> <span class="id">ih</span> <span class="id">f</span> <span class="id">_]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/arbitrary</span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t]lock</span> <span class="id">/=</span> <span class="id">-lock</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]arbitrary_cons//</a></span> <span class="id">-ih//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_cons">arbitrary_cons//</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDl">alt_bindDl</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="arbitrary_flatten2" class="id"><a name="arbitrary_flatten2" class="">arbitrary_flatten2</a></span> (<span id="A:146" class="id"><a name="A:146" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span id="def:147" class="id"><a name="def:147" class="">def</a></span> (<span id="s:148" class="id"><a name="s:148" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:146">A</a></span>) (<span id="f:149" class="id"><a name="f:149" class="">f</a></span> <span id="g:150" class="id"><a name="g:150" class="">g</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:146">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:146">A</a></span>) <span class="id">:</span> (<span class="id">0</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#::nat_scope:x_'&lt;'_x">&lt;</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:148">s</a></span>)%<span class="id">nat</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:151" class="id"><a name="x:151" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#def:147">def</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:148">s;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:149">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:151">x</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#g:150">g</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:151">x</a></span>))%<span class="id">Do</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary">arbitrary</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#def:147">def</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#flatten">flatten</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#dcd18413b33436252c77b6c6465f02bc">[seq</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#9e9281397dab83046645f1b62dbb2487">[::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:149">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:152">y;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#g:150">g</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:152">y]</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#dcd18413b33436252c77b6c6465f02bc">|</a></span> <span id="y:153" class="id"><span id="y:152" class="id"><a name="y:153" class="">y</a></span></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#dcd18413b33436252c77b6c6465f02bc">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:148">s]</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">def</span> <span class="id">f</span> <span class="id">g</span> <span class="id">=&gt;</span> <span class="id">//</span>.<br/>
<span class="id">move=&gt;</span> <span class="id">h</span> <span class="id">[|t1</span> <span class="id">t2]</span> <span class="id">ih</span> <span class="id">def</span> <span class="id">f</span> <span class="id">g</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary1">arbitrary1</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_cons">arbitrary_cons</a></span> <span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id">[t1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t2]lock</span> <span class="id">/=</span> <span class="id">-lock</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]arbitrary_cons//</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]arbitrary_cons//</a></span> <span class="id">-ih//</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_cons">arbitrary_cons//</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDl">alt_bindDl</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altA">altA</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_lemmas">arbitrary_lemmas</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#arbitrary_naturality">arbitrary_naturality</a></span> <span class="id">{M</span> <span class="id">T</span> <span class="id">U}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="subsequences_of_a_list" class="id"><a name="subsequences_of_a_list" class="">subsequences_of_a_list</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Variables</span> (<span id="subsequences_of_a_list.M" class="id"><a name="subsequences_of_a_list.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad</a></span>) (<span id="subsequences_of_a_list.A" class="id"><a name="subsequences_of_a_list.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>).<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="subs" class="id"><a name="subs" class="">subs</a></span> (<span id="s:156" class="id"><a name="s:156" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subsequences_of_a_list.A">A</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subsequences_of_a_list.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subsequences_of_a_list.A">A</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:156">s</a></span> <span class="id">isn't</span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="t':159" class="id"><a name="t':159" class="">t'</a></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs:157">subs</a></span> <span class="id">t</span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">h</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t':159">t'</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t':159">t'</a></span>.<br/>
<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="subs_cons" class="id"><a name="subs_cons" class="">subs_cons</a></span> <span id="x:160" class="id"><a name="x:160" class="">x</a></span> (<span id="xs:161" class="id"><a name="xs:161" class="">xs</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subsequences_of_a_list.A">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs">subs</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:160">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xs:161">xs</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">let</span> <span id="t':162" class="id"><a name="t':162" class="">t'</a></span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs">subs</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xs:161">xs</a></span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:160">x</a></span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t':162">t'</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t':162">t'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="subs_cat" class="id"><a name="subs_cat" class="">subs_cat</a></span> (<span id="xs:163" class="id"><a name="xs:163" class="">xs</a></span> <span id="ys:164" class="id"><a name="ys:164" class="">ys</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subsequences_of_a_list.A">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs">subs</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xs:163">xs</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#ys:164">ys</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="us:165" class="id"><a name="us:165" class="">us</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs">subs</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#xs:163">xs;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="vs:166" class="id"><a name="vs:166" class="">vs</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs">subs</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#ys:164">ys;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#us:165">us</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#vs:166">vs</a></span>))%<span class="id">Do</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">elim:</span> <span class="id">xs</span> <span class="id">ys</span> <span class="id">=&gt;</span> <span class="id">[ys</span> <span class="id">|x</span> <span class="id">xs</span> <span class="id">ih</span> <span class="id">ys]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cat0s">cat0s</a></span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindmret">bindmret</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">{1}[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]/subs</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id">-/</span>(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs">subs</a></span> <span class="id">_</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDl">alt_bindDl</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
<span class="vernacular">Open</span> (<span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs">subs</a></span> <span class="id">xs</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:167">X</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cat_cons">cat_cons</a></span>.<br/>
&nbsp;&nbsp;<span class="id">over</span>.<br/>
<span class="id">rewrite</span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:172">X</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_]</span>(<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">x</span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x0:173" class="id"><span id="x0:170" class="id"><span id="x0:168" class="id"><a name="x0:173" class="">x0</a></span></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs">subs</a></span> <span class="id">xs;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x1:174" class="id"><span id="x1:171" class="id"><span id="x1:169" class="id"><a name="x1:174" class="">x1</a></span></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs">subs</a></span> <span class="id">ys;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x0:168">x0</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x1:169">x1</a></span>)))%<span class="id">Do;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">x0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-ih</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cat_cons">cat_cons</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subs_cons">subs_cons</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#subsequences_of_a_list">subsequences_of_a_list</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="insert" class="id"><a name="insert" class="">insert</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad}</a></span> <span class="id">{A</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0}</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="insert" class="id"><a name="insert" class="">insert</a></span> (<span id="a:177" class="id"><a name="a:177" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert.A">A</a></span>) (<span id="s:178" class="id"><a name="s:178" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert.A">A</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert.A">A</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:178">s</a></span> <span class="id">isn't</span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#506674b18256ef8f50efed43fa1dfd7d">[::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:177">a]</a></span> <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:177">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">h</span>) (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert:179">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:177">a</a></span> <span class="id">t</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="insertE" class="id"><a name="insertE" class="">insertE</a></span> (<span id="a:181" class="id"><a name="a:181" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert.A">A</a></span>) <span id="s:182" class="id"><a name="s:182" class="">s</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:181">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:182">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:182">s</a></span> <span class="id">isn't</span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#506674b18256ef8f50efed43fa1dfd7d">[::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:181">a]</a></span> <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:181">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">h</span>) (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:181">a</a></span> <span class="id">t</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
 <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">s</span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id">:</span> <span class="id">simpl</span> <span class="id">never</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="insert_altMonad" class="id"><a name="insert_altMonad" class="">insert_altMonad</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="insert_altMonad.M" class="id"><a name="insert_altMonad.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="insert_map" class="id"><a name="insert_map" class="">insert_map</a></span> (<span id="A:185" class="id"><a name="A:185" class="">A</a></span> <span id="B:186" class="id"><a name="B:186" class="">B</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="f:187" class="id"><a name="f:187" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:185">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:186">B</a></span>) (<span id="a:188" class="id"><a name="a:188" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:185">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:187">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:188">a</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:187">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:187">f</a></span> (<span class="id">o</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:188">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.M">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext;</a></span> <span class="id">elim</span> <span class="id">=&gt;</span> <span class="id">[|y</span> <span class="id">xs</span> <span class="id">IH]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id">-</span>(<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id">f</span>))) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#natural">natural</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#ret">ret</a></span>) <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span>.<br/>
<span class="id">apply/esym</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#alt_fmapDr">alt_fmapDr</a></span>.<br/>
<span class="comment">(*&nbsp;first&nbsp;branch&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id">f</span>))) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#natural">natural</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#ret">ret</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#FIdE">FIdE</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:189">X</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span> <span class="id">]/=</span>.<br/>
<span class="comment">(*&nbsp;second&nbsp;branch&nbsp;*)</span><br/>
<span class="id">rewrite</span> <span class="id">-fmap_oE</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id">f</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> (<span class="id">f</span> <span class="id">y</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id">f</span>) <span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#fmap_oE">fmap_oE</a></span> <span class="id">-</span>(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id">f</span>)) <span class="id">-IH</span> <span class="id">[RHS]/=</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Hypothesis</span> <span id="insert_altMonad.Mmm" class="id"><a name="insert_altMonad.Mmm" class="">Mmm</a></span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="A:190" class="id"><a name="A:190" class="">A,</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#idempotent">idempotent</a></span> (@<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt">alt</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:190">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:190">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:190">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:190">A</a></span>).<br/>
<br/>
<span class="vernacular">Variables</span> (<span id="insert_altMonad.A" class="id"><a name="insert_altMonad.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="insert_altMonad.p" class="id"><a name="insert_altMonad.p" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:192">A</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="filter_insertN" class="id"><a name="filter_insertN" class="">filter_insertN</a></span> <span id="a:194" class="id"><a name="a:194" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b3ebd0deddd84fd60e149cb5ef719351">~~</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:194">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span id="s:195" class="id"><a name="s:195" class="">s,</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span> (<span class="id">o</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:194">a</a></span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:195">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:195">s</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
<span class="id">move=&gt;</span> <span class="id">pa;</span> <span class="id">elim</span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">t</span> <span class="id">IH]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id">-</span>(<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id">_</span>)) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#natural">natural</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#ret">ret</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#FIdE">FIdE</a></span> <span class="id">/=</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">pa</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#alt_fmapDr">alt_fmapDr</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-</span>(<span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id">_</span>)) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#natural">natural</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#ret">ret</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#FIdE">FIdE</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:196">X</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_]/=</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">pa</span>).<br/>
<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">ph</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-fmap_oE</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">h</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">h</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">ph</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#fmap_oE">fmap_oE</a></span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">IH</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id">/=</span> <span class="id">ph</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.Mmm">Mmm</a></span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">-fmap_oE</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">h</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">ph</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">move:</span> (<span class="id">IH</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id">=&gt;</span> <span class="id">-&gt;</span> <span class="id">/=;</span> <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">ph</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.Mmm">Mmm</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="filter_insertT" class="id"><a name="filter_insertT" class="">filter_insertT</a></span> <span id="a:197" class="id"><a name="a:197" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:197">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span> (<span class="id">o</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:197">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:197">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.M">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
<span class="id">move=&gt;</span> <span class="id">pa;</span> <span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext;</a></span> <span class="id">elim</span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">t</span> <span class="id">IH]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id">!insertE</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">/=</span> <span class="id">pa</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]/=;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">ph</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]insertE</a></span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">IH</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:198">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">_]/=</span> <span class="id">=&gt;</span> <span class="id">&lt;-</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#alt_fmapDr">alt_fmapDr;</a></span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">/=</span> <span class="id">pa</span> <span class="id">ph</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!fmapE</span> <span class="id">/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bind_fmap">bind_fmap</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id">[LHS]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id">ph</span>.<br/>
<span class="id">-</span> <span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#alt_fmapDr">alt_fmapDr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:199">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">_]fmap_oE</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#cons">cons</a></span> <span class="id">h</span>) <span class="id">=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.p">p</a></span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">x</span> <span class="id">/=;</span> <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">ph</span>).<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">IH</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id">=&gt;</span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">/=</span> <span class="id">pa</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">ph</span>) <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]insertE;</a></span> <span class="id">case:</span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id">=&gt;</span> <span class="id">[|h'</span> <span class="id">t']</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.Mmm">Mmm</a></span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!insertE</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altA">altA</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad.Mmm">Mmm</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altMonad">insert_altMonad</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="insert_altCIMonad" class="id"><a name="insert_altCIMonad" class="">insert_altCIMonad</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="insert_altCIMonad.M" class="id"><a name="insert_altCIMonad.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAltCI.Exports.altCIMonad">altCIMonad</a></span>) (<span id="insert_altCIMonad.A" class="id"><a name="insert_altCIMonad.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="insert_altCIMonad.a" class="id"><a name="insert_altCIMonad.a" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:201">A</a></span>).<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="insert_rcons" class="id"><a name="insert_rcons" class="">insert_rcons</a></span> <span id="a':203" class="id"><a name="a':203" class="">a'</a></span> <span id="s:204" class="id"><a name="s:204" class="">s</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altCIMonad.a">a</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:204">s</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a':203">a'</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:204">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#9e9281397dab83046645f1b62dbb2487">[::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a':203">a';</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altCIMonad.a">a]</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons^~</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a':203">a'</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altCIMonad.a">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:204">s</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altCIMonad.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">a'</span> <span class="id">=&gt;</span> <span class="id">[a'|s1</span> <span class="id">s2</span> <span class="id">IH</span> <span class="id">a']</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cat0s">cat0s</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altC">altC;</a></span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]/=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id">IH</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#alt_fmapDr">alt_fmapDr</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:205">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">_]fmapE</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#alt_fmapDr">alt_fmapDr</a></span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:206">X]fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-!fmap_oE</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altCA">altCA</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="rev_insert" class="id"><a name="rev_insert" class="">rev_insert</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rev">rev</a></span> (<span class="id">o</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altCIMonad.a">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altCIMonad.a">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rev">rev</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altCIMonad.M">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
<span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext;</a></span> <span class="id">elim</span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">t</span> <span class="id">ih]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#alt_fmapDr">alt_fmapDr</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]rev_cons</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_rcons">insert_rcons</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rev_cons">rev_cons</a></span> <span class="id">-cats1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rev_cons">rev_cons</a></span> <span class="id">-cats1</span> <span class="id">-catA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>).<br/>
<span class="id">move:</span> <span class="id">ih;</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id">[X</span> <span class="gallina-kwd">in</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:207">X</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id">_]/=</span> <span class="id">=&gt;</span> <span class="id">&lt;-</span>.<br/>
<span class="id">rewrite</span> <span class="id">-!fmap_oE</span>. <span class="id">congr</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id">_</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altCIMonad.a">a</a></span> <span class="id">t</span>)).<br/>
<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">s;</span> <span class="id">rewrite</span> <span class="id">/=</span> <span class="id">-rev_cons</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_altCIMonad">insert_altCIMonad</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="test_canonical" class="id"><a name="test_canonical" class="">test_canonical</a></span> (<span id="M:208" class="id"><a name="M:208" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadNondet.Exports.nondetMonad">nondetMonad</a></span>) <span id="A:209" class="id"><a name="A:209" class="">A</a></span> (<span id="a:210" class="id"><a name="a:210" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:208">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:209">A</a></span>) (<span id="b:211" class="id"><a name="b:211" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:209">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:208">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:209">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:210">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:211">b</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:210">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="gallina-kwd">Set</span> <span class="vernacular">Printing</span> <span class="id">All</span>.<br/>
<span class="vernacular">Unset</span> <span class="vernacular">Printing</span> <span class="id">All</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindfailf">bindfailf</a></span>.<br/>
Abort.</div>
<br/>
<span class="vernacular">Section</span> <span id="insert_plusMonad" class="id"><a name="insert_plusMonad" class="">insert_plusMonad</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="insert_plusMonad.M" class="id"><a name="insert_plusMonad.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="insertC" class="id"><a name="insertC" class="">insertC</a></span> (<span id="A:213" class="id"><a name="A:213" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span id="a:214" class="id"><a name="a:214" class="">a</a></span> <span id="b:215" class="id"><a name="b:215" class="">b</a></span> (<span id="s:216" class="id"><a name="s:216" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:213">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:217" class="id"><a name="x:217" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:215">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:216">s;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:214">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:217">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:218" class="id"><a name="x:218" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:214">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:216">s;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:215">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:218">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_plusMonad.M">M</a></span> <span class="id">_</span>)%<span class="id">Do</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
<span class="id">have</span> <span class="id">[n</span> <span class="id">ns]</span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ubnP">ubnP</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#size">size</a></span> <span class="id">s</span>)<span class="id">;</span> <span class="id">elim:</span> <span class="id">n</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">a</span> <span class="id">b</span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">n</span> <span class="id">ih</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">a</span> <span class="id">b</span>.<br/>
<span class="id">case:</span> <span class="id">s</span> <span class="id">ns</span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">t]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!insertE</span> <span class="id">!bindretf</span> <span class="id">!insertE</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altC">altC</a></span> <span class="id">!fmapE</span> <span class="id">!bindretf</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ltnS">ltnS</a></span> <span class="id">/=</span> <span class="id">=&gt;</span> <span class="id">ns</span>.<br/>
<span class="id">rewrite</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id">_</span> (<span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span>)) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDl">alt_bindDl</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]</a></span>(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id">_</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#ab09fa4bd99b3931b6a319926b973947">[::</a></span> <span class="id">b,</span> <span class="id">h</span> &amp; <span class="id">t]</span>) <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]</a></span>(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id">_</span> (<span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span>)).<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]</a></span>(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id">_</span> (<span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span>)) <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]alt_bindDl</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">2![in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]insertE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]alt_fmapDr</a></span> <span class="id">![in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]altA</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]</a></span>(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altC">altC</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#ab09fa4bd99b3931b6a319926b973947">[::</a></span> <span class="id">a,</span> <span class="id">b,</span> <span class="id">h</span> &amp; <span class="id">t]</span>)).<br/>
<span class="id">rewrite</span> <span class="id">-!altA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>)<span class="id">;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#alt_fmapDr">alt_fmapDr</a></span> <span class="id">-!altA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>)<span class="id">;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]altC</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bind_fmap">bind_fmap</a></span> <span class="id">/=</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]/comp</a></span> <span class="id">/=</span>.<br/>
<span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDr">alt_bindDr</a></span>.<br/>
<span class="id">under</span> <span class="id">[in</span> <span class="id">X</span> <span class="gallina-kwd">in</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#X:219">X</a></span>) <span class="id">[~]</span> <span class="id">_]eq_bind</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-bindA</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]ih</a></span> <span class="id">//</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]altC</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bind_fmap">bind_fmap</a></span> <span class="id">/=</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]/comp</a></span> <span class="id">/=</span>.<br/>
<span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDr">alt_bindDr</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]altC</a></span> <span class="id">-!altA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!fmapE</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">!bindretf</span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]altC;</a></span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!fmapE</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="insert_cat" class="id"><a name="insert_cat" class="">insert_cat</a></span> (<span id="A:220" class="id"><a name="A:220" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span id="h:221" class="id"><a name="h:221" class="">h</a></span> (<span id="a:222" class="id"><a name="a:222" class="">a</a></span> <span id="b:223" class="id"><a name="b:223" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:220">A</a></span>) <span id="u:224" class="id"><a name="u:224" class="">u</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:221">h</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:222">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#u:224">u</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:223">b</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:225" class="id"><a name="x:225" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:221">h</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:222">a;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:225">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#u:224">u</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:223">b</a></span>))%<span class="id">Do</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:226" class="id"><a name="x:226" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:221">h</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:223">b;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:222">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#u:224">u</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:226">x</a></span>))%<span class="id">Do</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_plusMonad.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
<span class="id">elim:</span> <span class="id">a</span> <span class="id">h</span> <span class="id">u</span> <span class="id">b</span> <span class="id">=&gt;</span> <span class="id">[h</span> <span class="id">u</span> <span class="id">b|a1</span> <span class="id">a2</span> <span class="id">ih</span> <span class="id">h</span> <span class="id">u</span> <span class="id">b]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/=</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id">h</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#cat_cons">cat_cons</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]insertE</a></span> <span class="id">[u</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">b]lock</span> <span class="id">/=</span> <span class="id">-lock</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]ih</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]insertE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]alt_bindDl</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">-altA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]bind_fmap</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]fmapE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]alt_bindDl</a></span> <span class="id">!bindA</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id">_</span>)<span class="id">;</span> <span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_plusMonad">insert_plusMonad</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="insert_nondetMonad" class="id"><a name="insert_nondetMonad" class="">insert_nondetMonad</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadNondet.Exports.nondetMonad">nondetMonad}</a></span> <span class="id">{A</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0}</a></span>.<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">s</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_nondetMonad.A">A</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="insert_Ret" class="id"><a name="insert_Ret" class="">insert_Ret</a></span> <span id="a:229" class="id"><a name="a:229" class="">a</a></span> <span id="s:230" class="id"><a name="s:230" class="">s</a></span> <span class="id">:</span> <span class="gallina-kwd">exists</span> <span id="m:231" class="id"><a name="m:231" class="">m,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:229">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:230">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:229">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:230">s</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m:231">m</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_nondetMonad.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">t</span> <span class="id">[m</span> <span class="id">ih]]</span> <span class="id">/=;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">eexists;</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE;</a></span> <span class="id">reflexivity</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE;</a></span> <span class="gallina-kwd">exists</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail;</a></span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altmfail">altmfail</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_nondetMonad">insert_nondetMonad</a></span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="iperm" class="id"><a name="iperm" class="">iperm</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad}</a></span> <span class="id">{A</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0}</a></span> (<span id="s:234" class="id"><a name="s:234" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:233">A</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:232">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:233">A</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:234">s</a></span> <span class="id">isn't</span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm:235">iperm</a></span> <span class="id">t</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id">h</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="iperm_altMonad" class="id"><a name="iperm_altMonad" class="">iperm_altMonad</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad}</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="iperm_o_map" class="id"><a name="iperm_o_map" class="">iperm_o_map</a></span> (<span id="A:238" class="id"><a name="A:238" class="">A</a></span> <span id="B:239" class="id"><a name="B:239" class="">B</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="f:240" class="id"><a name="f:240" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:238">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:239">B</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:240">f</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#map">map</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:240">f</a></span> (<span class="id">o</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_altMonad.M">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext;</a></span> <span class="id">elim</span> <span class="id">=&gt;</span> <span class="id">[/=|x</span> <span class="id">xs</span> <span class="id">IH]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id">[iperm</span> <span class="id">_]/=</span> <span class="id">-[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]compE</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#natural">natural</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#ret">ret</a></span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id">[in</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> <span class="id">_]/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmap_bind">fmap_bind</a></span> <span class="id">-insert_map</span> <span class="id">-bind_fmap</span> <span class="id">-fcompE</span> <span class="id">-IH</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Hypothesis</span> <span id="iperm_altMonad.Mmm" class="id"><a name="iperm_altMonad.Mmm" class="">Mmm</a></span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span id="A:241" class="id"><a name="A:241" class="">A,</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#idempotent">idempotent</a></span> (@<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt">alt</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:241">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_altMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:241">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_altMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:241">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_altMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:241">A</a></span>).<br/>
<br/>
<span class="vernacular">Variables</span> (<span id="iperm_altMonad.A" class="id"><a name="iperm_altMonad.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="iperm_altMonad.p" class="id"><a name="iperm_altMonad.p" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#pred">pred</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:243">A</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="iperm_filter" class="id"><a name="iperm_filter" class="">iperm_filter</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#8b4742e3f67816503ce4ab2f3b81c27e">\o</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_altMonad.p">p</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#filter">filter</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_altMonad.p">p</a></span> (<span class="id">o</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_altMonad.M">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext;</a></span> <span class="id">elim</span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">t</span> <span class="id">/=</span> <span class="id">IH]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">ph</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]/=</a></span> <span class="id">IH</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]fcomp_def</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">LHS]bind_fmap</a></span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]fcomp_def</a></span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#compE">compE</a></span> <span class="id">-/</span>(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> <span class="id">_</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">_</a></span>) <span class="id">[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]fmap_bind;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#filter_insertT">filter_insertT</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmap_bind">fmap_bind</a></span> <span class="id">IH</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fcompE">fcompE</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmapE">fmapE;</a></span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">s</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#filter_insertN">filter_insertN</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_altMonad">iperm_altMonad</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="iperm_nondetMonad" class="id"><a name="iperm_nondetMonad" class="">iperm_nondetMonad</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadNondet.Exports.nondetMonad">nondetMonad}</a></span> <span class="id">{A</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0}</a></span>.<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">s</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_nondetMonad.A">A</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="iperm_is_alt_ret" class="id"><a name="iperm_is_alt_ret" class="">iperm_is_alt_ret</a></span> <span id="s:247" class="id"><a name="s:247" class="">s</a></span> <span class="id">:</span> <span class="gallina-kwd">exists</span> <span id="m:248" class="id"><a name="m:248" class="">m,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:247">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:247">s</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m:248">m</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_nondetMonad.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">=&gt;</span> <span class="id">[|h</span> <span class="id">t</span> <span class="id">[m</span> <span class="id">ih]</span> <span class="id">/=];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="gallina-kwd">exists</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail;</a></span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altmfail">altmfail</a></span>.<br/>
<span class="id">case:</span> (@<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert_Ret">insert_Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_nondetMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_nondetMonad.A">A</a></span> <span class="id">h</span> <span class="id">t</span>) <span class="id">=&gt;</span> <span class="id">n</span> <span class="id">Hn</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">eexists;</span> <span class="id">rewrite</span> <span class="id">ih</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#alt_bindDl">alt_bindDl</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span> <span class="id">Hn</span> <span class="id">-altA</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_nondetMonad">iperm_nondetMonad</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="iperm_plusMonad" class="id"><a name="iperm_plusMonad" class="">iperm_plusMonad</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadPlus.Exports.plusMonad">plusMonad}</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="iperm_insert" class="id"><a name="iperm_insert" class="">iperm_insert</a></span> <span class="id">{A</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0}</a></span> <span id="a:251" class="id"><a name="a:251" class="">a</a></span> <span id="b:252" class="id"><a name="b:252" class="">b</a></span> (<span id="s:253" class="id"><a name="s:253" class="">s</a></span> <span id="t:254" class="id"><a name="t:254" class="">t</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:250">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:255" class="id"><a name="x:255" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:252">b</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:253">s</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:254">t</a></span>)<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:251">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:255">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:256" class="id"><a name="x:256" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:253">s</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:251">a</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:254">t</a></span>)<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:252">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:256">x</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_plusMonad.M">M</a></span> <span class="id">_</span>)%<span class="id">Do</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">=&gt;</span> <span class="id">[/=|h</span> <span class="id">tl</span> <span class="id">ih]</span> <span class="gallina-kwd">in</span> <span class="id">a</span> <span class="id">b</span> <span class="id">t</span> <span class="id">*</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">!bindA</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertC">insertC</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">[h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">tl]lock</span> <span class="id">/=</span> <span class="id">-lock</span> <span class="id">ih</span> <span class="id">/=</span> <span class="id">!bindA</span>.<br/>
<span class="id">suff</span> <span class="id">:</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:257" class="id"><a name="x:257" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">tl</span> <span class="id">b</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">t</span>)<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x0:258" class="id"><a name="x0:258" class="">x0</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id">a</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:257">x;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id">h</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x0:258">x0</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:259" class="id"><a name="x:259" class="">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#rcons">rcons</a></span> <span class="id">tl</span> <span class="id">a</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#93e0a78b945d3f9f22195c004c67aa36">++</a></span> <span class="id">t</span>)<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">;</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x0:260" class="id"><a name="x0:260" class="">x0</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id">b</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:259">x;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id">h</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x0:260">x0</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_plusMonad.M">M</a></span> <span class="id">_</span>)%<span class="id">Do</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertC">insertC</a></span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span> <span class="id">-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">under</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#eq_bind">eq_bind</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertC">insertC</a></span>.<br/>
<span class="id">rewrite</span> <span class="id">-bindA</span> <span class="id">-ih</span> <span class="id">/=</span> <span class="id">-bindA</span> <span class="id">-[in</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.RHS">RHS]ih</a></span> <span class="id">/=</span> <span class="id">!bindA;</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">a'</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-bindA</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertC">insertC</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindA">bindA</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_plusMonad">iperm_plusMonad</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="select" class="id"><a name="select" class="">select</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="select.M" class="id"><a name="select.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadNondet.Exports.nondetMonad">nondetMonad</a></span>) (<span id="select.A" class="id"><a name="select.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>).<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">s</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#select.A">A</a></span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="select" class="id"><a name="select" class="">select</a></span> <span id="s:263" class="id"><a name="s:263" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#select.M">M</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#select.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#select.A">A</a></span>)%<span class="id">type</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:263">s</a></span> <span class="id">isn't</span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">t</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail</a></span> <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">h,</span> <span class="id">t</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#select:264">select</a></span> <span class="id">t</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x:266" class="id"><a name="x:266" class="">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:266">x</a></span>.<span class="id">1,</span> <span class="id">h</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:266">x</a></span>.<span class="id">2</span>))).<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#select">select</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#select">select</a></span> <span class="id">{M}</span> <span class="id">{A}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="uperm" class="id"><a name="uperm" class="">uperm</a></span>.<br/>
<span class="vernacular">Variables</span> (<span id="uperm.A" class="id"><a name="uperm.A" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="uperm.M" class="id"><a name="uperm.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadNondet.Exports.nondetMonad">nondetMonad</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="uperm" class="id"><a name="uperm" class="">uperm</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#uperm.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#uperm.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#uperm.A">A</a></span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#unfoldM">unfoldM</a></span> (@<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#well_founded_size">well_founded_size</a></span> <span class="id">_</span>) (@<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#nilp">nilp</a></span> <span class="id">_</span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#select">select</a></span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#uperm">uperm</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#uperm">uperm</a></span> <span class="id">{A}</span> <span class="id">{M}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="splits" class="id"><a name="splits" class="">splits</a></span>.<br/>
<span class="vernacular">Context</span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad}</a></span> <span class="id">{A</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0}</a></span>.<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">s</span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#splits.A">A</a></span>.<br/>
<br/>
<span class="vernacular">Fixpoint</span> <span id="splits" class="id"><a name="splits" class="">splits</a></span> <span id="s:271" class="id"><a name="s:271" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#splits.M">M</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#splits.A">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4">*</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#splits.A">A</a></span>)%<span class="id">type</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:271">s</a></span> <span class="id">isn't</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id">xs</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::],</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#0a934e621391740b862762275992e626">[::]</a></span>) <span class="gallina-kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#splits:272">splits</a></span> <span class="id">xs</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="yz:274" class="id"><a name="yz:274" class="">yz</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#yz:274">yz</a></span>.<span class="id">1,</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#yz:274">yz</a></span>.<span class="id">2</span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#yz:274">yz</a></span>.<span class="id">1,</span> <span class="id">x</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#yz:274">yz</a></span>.<span class="id">2</span>)).<br/>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#splits">splits</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="fastproduct" class="id"><a name="fastproduct" class="">fastproduct</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="product" class="id"><a name="product" class="">product</a></span> <span class="id">:=</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#muln">muln</a></span> <span class="id">1</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="product0" class="id"><a name="product0" class="">product0</a></span> <span id="s:275" class="id"><a name="s:275" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:275">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#product">product</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:275">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="id">elim:</span> <span class="id">s</span> <span class="id">=&gt;</span> <span class="id">//=</span> <span class="id">h</span> <span class="id">t</span> <span class="id">ih;</span> <span class="id">rewrite</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.finset.html#inE">inE</a></span> <span class="id">=&gt;</span> <span class="id">/orP[/eqP</span> <span class="id">&lt;-|/ih</span> <span class="id">-&gt;];</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">?muln0</span> <span class="id">?mul0n</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Section</span> <span id="fastproduct.work" class="id"><a name="fastproduct.work" class="">work</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="fastproduct.work.M" class="id"><a name="fastproduct.work.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadFail.Exports.failMonad">failMonad</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">mprog</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="work" class="id"><a name="work" class="">work</a></span> <span id="s:277" class="id"><a name="s:277" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#fastproduct.work.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:277">s</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#product">product</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:277">s</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="fastproduct.work.Work" class="id"><a name="fastproduct.work.Work" class="">Work</a></span> <span id="s:278" class="id"><a name="s:278" class="">s</a></span> <span class="id">:=</span> <span class="gallina-kwd">if</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b09457274bcb94927e289b8a9e9cd3f7">\in</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:278">s</a></span> <span class="gallina-kwd">then</span> @<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#fastproduct.work.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#product">product</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:278">s</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="workE" class="id"><a name="workE" class="">workE</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span> <span id="next:281" class="id"><a name="next:281" class="">next</a></span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span id="n:279" class="id"><a name="n:279" class="">n</a></span> (<span id="mx:280" class="id"><a name="mx:280" class="">mx</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#fastproduct.work.M">M</a></span> <span class="id">_</span>) <span class="id">=&gt;</span> <span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#n:279">n</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#df45e8c2e8370fd4f0f7c4fdaf208180">==</a></span> <span class="id">0</span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fail">fail</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::mprog:'fmap'_x">fmap</a></span> (<span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#muln">muln</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#n:279">n</a></span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#mx:280">mx</a></span> <span class="gallina-kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#work">work</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#foldr">foldr</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#next:281">next</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">1</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#foldr_universal">foldr_universal</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">h</span> <span class="id">t;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">[/eqP</span> <span class="id">-&gt;</span> <span class="id">//|</span> <span class="id">h0]</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/work</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.finset.html#inE">inE</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.eqtype.html#eq_sym">eq_sym</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negbTE">negbTE</a></span> <span class="id">h0</span>) <span class="id">[_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185">||</a></span> <span class="id">_]/=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#fmap_if">fmap_if</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#fmap_fail">fmap_fail</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#fastproduct.work">work</a></span>.<br/>
<span class="vernacular">Arguments</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#work">work</a></span> <span class="id">{M}</span>.<br/>
<br/>
<span class="vernacular">Variable</span> <span id="fastproduct.M" class="id"><a name="fastproduct.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadExcept.Exports.exceptMonad">exceptMonad</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="fastprod" class="id"><a name="fastprod" class="">fastprod</a></span> <span id="s:283" class="id"><a name="s:283" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#fastproduct.M">M</a></span> <span class="id">_</span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#catch">catch</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#work">work</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:283">s</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="fastproduct.Fastprod" class="id"><a name="fastproduct.Fastprod" class="">Fastprod</a></span> (<span id="s:284" class="id"><a name="s:284" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:=</span> @<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#catch">catch</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#fastproduct.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#work">work</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:284">s</a></span>) (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#O">O</a></span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="fastprodE" class="id"><a name="fastprodE" class="">fastprodE</a></span> <span id="s:285" class="id"><a name="s:285" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#fastprod">fastprod</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:285">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#product">product</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:285">s</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
<span class="id">rewrite</span> <span class="id">/fastprod</span> <span class="id">/work</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#fun_if">fun_if</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#if_arg">if_arg</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#catchfailm">catchfailm</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#catchret">catchret;</a></span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">//</span> <span class="id">/product0</span> <span class="id">&lt;-</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#fastproduct">fastproduct</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="addM" class="id"><a name="addM" class="">addM</a></span> (<span id="M:286" class="id"><a name="M:286" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Monad.Exports.monad">monad</a></span>) (<span id="a:287" class="id"><a name="a:287" class="">a</a></span> <span id="b:288" class="id"><a name="b:288" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:286">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:286">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:287">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x:289" class="id"><a name="x:289" class="">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:288">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="y:290" class="id"><a name="y:290" class="">y</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:289">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:290">y</a></span>))).<br/>
<span class="vernacular">Notation</span> <span id="7aa8cb8e47c797318e09c69d9adc22d2" class="id"><a name="7aa8cb8e47c797318e09c69d9adc22d2" class="">&quot;a +m b&quot; := (addM a b) (at level 50, format &quot;a  +m  b&quot;</a></span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span id="mulM" class="id"><a name="mulM" class="">mulM</a></span> (<span id="M:291" class="id"><a name="M:291" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Monad.Exports.monad">monad</a></span>) (<span id="a:292" class="id"><a name="a:292" class="">a</a></span> <span id="b:293" class="id"><a name="b:293" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:291">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:291">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:292">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="x:294" class="id"><a name="x:294" class="">x</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:293">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="y:295" class="id"><a name="y:295" class="">y</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:294">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#ea2ff3d561159081cea6fb2e8113cc54">*</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:295">y</a></span>))).<br/>
<span class="vernacular">Notation</span> <span id="bcd06a636910308fc155f844c4b9fc4d" class="id"><a name="bcd06a636910308fc155f844c4b9fc4d" class="">&quot;a *m b&quot; := (mulM a b) (at level 50, format &quot;a  *m  b&quot;</a></span>).<br/>
<br/>
<br/>
<span class="vernacular">Section</span> <span id="continuation_example" class="id"><a name="continuation_example" class="">continuation_example</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="continuation_example.M" class="id"><a name="continuation_example.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadContinuation.Exports.contMonad">contMonad</a></span>.<br/>
<br/>
<span class="vernacular">Let</span> <span id="continuation_example.wadler94_sect31" class="id"><a name="continuation_example.wadler94_sect31" class="">wadler94_sect31</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">1</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#7aa8cb8e47c797318e09c69d9adc22d2">+m</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#callcc">callcc</a></span> (<span class="gallina-kwd">fun</span> <span id="f:297" class="id"><a name="f:297" class="">f</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">10</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#7aa8cb8e47c797318e09c69d9adc22d2">+m</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:297">f</a></span> <span class="id">100</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id">100</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#b8b2ebc8e1a8b9aa935c0702efb5dccf">:&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#continuation_example.M">M</a></span> <span class="id">_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">rewrite</span> <span class="id">{1}/addM</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#callcc">callcc</a></span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">100</span>) <span class="id">?bindretf</span> <span class="id">//</span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#callcc">callcc</a></span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#continuation_example.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">100</span>))<span class="id">;</span> <span class="id">last</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#callcc1">callcc1</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#callcc">callcc</a></span> (<span class="gallina-kwd">fun</span> <span id="f:300" class="id"><span id="f:298" class="id"><a name="f:300" class="">f</a></span></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#continuation_example.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">10</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="a:301" class="id"><span id="a:299" class="id"><a name="a:301" class="">a</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:298">f</a></span> <span class="id">100</span>)))<span class="id">;</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#callcc2">callcc2</a></span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#callcc3">callcc3</a></span> <span class="id">//;</span> <span class="id">congr</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#callcc">callcc</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">g;</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#continuation_example">continuation_example</a></span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="shiftreset_examples" class="id"><a name="shiftreset_examples" class="">shiftreset_examples</a></span>.<br/>
<span class="vernacular">Variable</span> (<span id="shiftreset_examples.M" class="id"><a name="shiftreset_examples.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadShiftReset.Exports.shiftresetMonad">shiftresetMonad</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span>).<br/>
<br/>
<span class="vernacular">Let</span> <span id="shiftreset_examples.wadler94_sect32_1" class="id"><a name="shiftreset_examples.wadler94_sect32_1" class="">wadler94_sect32_1</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">1</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#7aa8cb8e47c797318e09c69d9adc22d2">+m</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#reset">reset</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">10</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#7aa8cb8e47c797318e09c69d9adc22d2">+m</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#shift">shift</a></span> (<span class="gallina-kwd">fun</span> <span id="f:303" class="id"><a name="f:303" class="">f</a></span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:303">f</a></span> <span class="id">100</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:303">f</a></span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id">_</span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id">_</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id">10</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id">10</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id">100</span>))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
<span class="id">rewrite</span> <span class="id">/addM</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">transitivity</span> ((<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">10</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id">10</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id">100</span>))) <span class="id">&gt;&gt;=</span> (<span class="gallina-kwd">fun</span> <span id="y:305" class="id"><span id="y:304" class="id"><a name="y:305" class="">y</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:304">y</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id">_</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">congr</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bind">bind</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#shiftreset3">shiftreset3</a></span>.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="x:310" class="id"><span id="x:308" class="id"><span id="x:306" class="id"><a name="x:310" class="">x</a></span></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">10;</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">do</a></span> <span id="y:311" class="id"><span id="y:309" class="id"><span id="y:307" class="id"><a name="y:311" class="">y</a></span></span></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#9ea10614b4f1828e308ae6355a0a3b02">&lt;-</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#shift">shift</a></span> (@<span class="id">^~</span> <span class="id">100</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id">_;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">10</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> (<span class="id">10</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:307">y</a></span>)))%<span class="id">Do;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#shiftreset4">shiftreset4</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Let</span> <span id="shiftreset_examples.wadler94_sect32_2" class="id"><a name="shiftreset_examples.wadler94_sect32_2" class="">wadler94_sect32_2</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">1</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#7aa8cb8e47c797318e09c69d9adc22d2">+m</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#reset">reset</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">10</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#7aa8cb8e47c797318e09c69d9adc22d2">+m</a></span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#shift">shift</a></span> (<span class="gallina-kwd">fun</span> <span id="f:312" class="id"><a name="f:312" class="">f</a></span> <span class="id">:</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">nat</a></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">100</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id">_</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id">_</span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id">_</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id">100</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
<span class="id">rewrite</span> <span class="id">/addM</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">transitivity</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id">100</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> (<span class="gallina-kwd">fun</span> <span id="y:314" class="id"><span id="y:313" class="id"><a name="y:314" class="">y</a></span></span> <span class="id">=&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id">1</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.ssrnat.html#0dacc1786c5ba797d47dd85006231633">+</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:313">y</a></span>)) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples.M">M</a></span> <span class="id">_</span>)<span class="id">;</span> <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
<span class="id">congr</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bind">bind</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="id">rewrite</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#shiftreset2">shiftreset2</a></span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindretf">bindretf</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#shiftreset_examples">shiftreset_examples</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="refin" class="id"><a name="refin" class="">refin</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad}</a></span> <span id="A:316" class="id"><a name="A:316" class="">A</a></span> (<span id="m1:317" class="id"><a name="m1:317" class="">m1</a></span> <span id="m2:318" class="id"><a name="m2:318" class="">m2</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:315">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:316">A</a></span>) <span class="id">:</span> <span class="gallina-kwd">Prop</span> <span class="id">:=</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:317">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:318">m2</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:318">m2</a></span>.<br/>
<span class="vernacular">Notation</span> <span id="6dd59ac36f434063a5e5ef81e754b682" class="id"><a name="6dd59ac36f434063a5e5ef81e754b682" class="">&quot;m1 `&lt;=` m2&quot;</a></span> <span class="id">:=</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin">refin</a></span> <span class="id">m1</span> <span class="id">m2</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_bindr" class="id"><a name="refin_bindr" class="">refin_bindr</a></span> (<span id="M:319" class="id"><a name="M:319" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad</a></span>) <span id="A:320" class="id"><a name="A:320" class="">A</a></span> <span id="B:321" class="id"><a name="B:321" class="">B</a></span> (<span id="m1:322" class="id"><a name="m1:322" class="">m1</a></span> <span id="m2:323" class="id"><a name="m2:323" class="">m2</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:319">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:320">A</a></span>) (<span id="f:324" class="id"><a name="f:324" class="">f</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:320">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:319">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:321">B</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:322">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:323">m2</a></span>) <span class="id">-&gt;</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:322">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:324">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:323">m2</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:324">f</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">m12;</span> <span class="id">rewrite</span> <span class="id">/refin</span> <span class="id">-alt_bindDl</span> <span class="id">m12</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_if" class="id"><a name="refin_if" class="">refin_if</a></span> (<span id="M:325" class="id"><a name="M:325" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad</a></span>) <span id="A:326" class="id"><a name="A:326" class="">A</a></span> (<span id="m1:327" class="id"><a name="m1:327" class="">m1</a></span> <span id="m2:328" class="id"><a name="m2:328" class="">m2</a></span> <span id="m1':329" class="id"><a name="m1':329" class="">m1'</a></span> <span id="m2':330" class="id"><a name="m2':330" class="">m2'</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:325">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:326">A</a></span>) (<span id="b:331" class="id"><a name="b:331" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:331">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:327">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1':329">m1'</a></span>) <span class="id">-&gt;</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b3ebd0deddd84fd60e149cb5ef719351">~~</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:331">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:328">m2</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2':330">m2'</a></span>) <span class="id">-&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:331">b</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:327">m1</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:328">m2</a></span>) <span class="id">`&lt;=`</span> (<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:331">b</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1':329">m1'</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2':330">m2'</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
 <span class="gallina-kwd">by</span> <span class="id">case:</span> <span class="id">b</span> <span class="id">=&gt;</span> <span class="id">[+</span> <span class="id">_|_];</span> <span class="id">exact</span>. Qed.</div>
<br/>
<span class="vernacular">Import</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.TTheory">Order.TTheory</a></span>.<br/>
<span class="vernacular">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">order_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span id="refin_lemmas_altCIMonad" class="id"><a name="refin_lemmas_altCIMonad" class="">refin_lemmas_altCIMonad</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="refin_lemmas_altCIMonad.M" class="id"><a name="refin_lemmas_altCIMonad.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAltCI.Exports.altCIMonad">altCIMonad</a></span>.<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">A</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_refl" class="id"><a name="refin_refl" class="">refin_refl</a></span> <span id="A:333" class="id"><a name="A:333" class="">A</a></span> (<span id="a:334" class="id"><a name="a:334" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_lemmas_altCIMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:333">A</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:334">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:334">a</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/refin</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altmm">altmm</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="eq_refin" class="id"><a name="eq_refin" class="">eq_refin</a></span> <span id="A:335" class="id"><a name="A:335" class="">A</a></span> (<span id="a:336" class="id"><a name="a:336" class="">a</a></span> <span id="b:337" class="id"><a name="b:337" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_lemmas_altCIMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:335">A</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:336">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:337">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:336">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:337">b</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">-&gt;;</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_refl">refin_refl</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_trans" class="id"><a name="refin_trans" class="">refin_trans</a></span> <span id="A:338" class="id"><a name="A:338" class="">A</a></span> (<span id="b:339" class="id"><a name="b:339" class="">b</a></span> <span id="a:340" class="id"><a name="a:340" class="">a</a></span> <span id="c:341" class="id"><a name="c:341" class="">c</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_lemmas_altCIMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:338">A</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:340">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:339">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:339">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#c:341">c</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:340">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#c:341">c</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/refin</span> <span class="id">=&gt;</span> <span class="id">h1</span> <span class="id">&lt;-;</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altA">altA</a></span> <span class="id">h1</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_antisym" class="id"><a name="refin_antisym" class="">refin_antisym</a></span> <span id="A:342" class="id"><a name="A:342" class="">A</a></span> (<span id="a:343" class="id"><a name="a:343" class="">a</a></span> <span id="b:344" class="id"><a name="b:344" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_lemmas_altCIMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:342">A</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:343">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:344">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:344">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:343">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:343">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:344">b</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/refin</span> <span class="id">=&gt;</span> <span class="id">h1</span> <span class="id">&lt;-;</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altC">altC</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_alt" class="id"><a name="refin_alt" class="">refin_alt</a></span> <span id="A:345" class="id"><a name="A:345" class="">A</a></span> (<span id="m1:346" class="id"><a name="m1:346" class="">m1</a></span> <span id="m1':347" class="id"><a name="m1':347" class="">m1'</a></span> <span id="m2:348" class="id"><a name="m2:348" class="">m2</a></span> <span id="m2':349" class="id"><a name="m2':349" class="">m2'</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_lemmas_altCIMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:345">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:346">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1':347">m1'</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:348">m2</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2':349">m2'</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:346">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:348">m2</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1':347">m1'</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2':349">m2'</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">h1</span> <span class="id">h2;</span> <span class="id">rewrite</span> <span class="id">/refin</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altACA">altACA</a></span> <span class="id">h1</span> <span class="id">h2</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refinR" class="id"><a name="refinR" class="">refinR</a></span> <span id="A:350" class="id"><a name="A:350" class="">A</a></span> (<span id="a:351" class="id"><a name="a:351" class="">a</a></span> <span id="b:352" class="id"><a name="b:352" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_lemmas_altCIMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:350">A</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:351">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:351">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bdf043675a5fe817d484e3f9853f2e96">[~]</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:352">b</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/refin</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altA">altA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altmm">altmm</a></span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_lemmas_altCIMonad">refin_lemmas_altCIMonad</a></span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span id="lrefin" class="id"><a name="lrefin" class="">lrefin</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAlt.Exports.altMonad">altMonad}</a></span> <span id="A:354" class="id"><a name="A:354" class="">A</a></span> <span id="B:355" class="id"><a name="B:355" class="">B</a></span> (<span id="f:356" class="id"><a name="f:356" class="">f</a></span> <span id="g:357" class="id"><a name="g:357" class="">g</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:354">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:353">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:355">B</a></span>) <span class="id">:=</span> <span class="gallina-kwd">forall</span> <span id="x:358" class="id"><a name="x:358" class="">x,</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:356">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:358">x</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`g</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:358">x</a></span>.<br/>
<span class="vernacular">Notation</span> <span id="3c6f54eb333403a121cf5ee349e0c952" class="id"><a name="3c6f54eb333403a121cf5ee349e0c952" class="">&quot;f `&lt;.=` g&quot;</a></span> <span class="id">:=</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#lrefin">lrefin</a></span> <span class="id">f</span> <span class="id">g</span>).<br/>
<br/>
<span class="vernacular">Section</span> <span id="lrefin_lemmas_altCIMonad" class="id"><a name="lrefin_lemmas_altCIMonad" class="">lrefin_lemmas_altCIMonad</a></span>.<br/>
<span class="vernacular">Variable</span> <span id="lrefin_lemmas_altCIMonad.M" class="id"><a name="lrefin_lemmas_altCIMonad.M" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAltCI.Exports.altCIMonad">altCIMonad</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="lrefin_refl" class="id"><a name="lrefin_refl" class="">lrefin_refl</a></span> <span id="A:360" class="id"><a name="A:360" class="">A</a></span> <span id="B:361" class="id"><a name="B:361" class="">B</a></span> (<span id="a:362" class="id"><a name="a:362" class="">a</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:360">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#lrefin_lemmas_altCIMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:361">B</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:362">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#3c6f54eb333403a121cf5ee349e0c952">`&lt;</a></span>.<span class="id">=`</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:362">a</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
 <span class="gallina-kwd">by</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">?;</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_refl">refin_refl</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="lrefin_trans" class="id"><a name="lrefin_trans" class="">lrefin_trans</a></span> <span id="A:363" class="id"><a name="A:363" class="">A</a></span> <span id="B:364" class="id"><a name="B:364" class="">B</a></span> (<span id="b:365" class="id"><a name="b:365" class="">b</a></span> <span id="a:366" class="id"><a name="a:366" class="">a</a></span> <span id="c:367" class="id"><a name="c:367" class="">c</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:363">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#lrefin_lemmas_altCIMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:364">B</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:366">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#3c6f54eb333403a121cf5ee349e0c952">`&lt;</a></span>.<span class="id">=`</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:365">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:365">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#3c6f54eb333403a121cf5ee349e0c952">`&lt;</a></span>.<span class="id">=`</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#c:367">c</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:366">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#3c6f54eb333403a121cf5ee349e0c952">`&lt;</a></span>.<span class="id">=`</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#c:367">c</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
 <span class="gallina-kwd">by</span> <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_trans">refin_trans</a></span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="lrefin_antisym" class="id"><a name="lrefin_antisym" class="">lrefin_antisym</a></span> <span id="A:368" class="id"><a name="A:368" class="">A</a></span> <span id="B:369" class="id"><a name="B:369" class="">B</a></span> (<span id="a:370" class="id"><a name="a:370" class="">a</a></span> <span id="b:371" class="id"><a name="b:371" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:368">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#lrefin_lemmas_altCIMonad.M">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:369">B</a></span>) <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:370">a</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#3c6f54eb333403a121cf5ee349e0c952">`&lt;</a></span>.<span class="id">=`</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:371">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:371">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#3c6f54eb333403a121cf5ee349e0c952">`&lt;</a></span>.<span class="id">=`</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:370">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#a:370">a</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a">=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:371">b</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
 <span class="id">move</span> <span class="id">=&gt;</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">apply</span> <span class="id"><a href="monaeImpredicativeSet.imonae_lib.html#funext">funext</a></span> <span class="id">=&gt;</span> <span class="id">?;</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_antisym">refin_antisym</a></span>. Qed.</div>
<span class="vernacular">End</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#lrefin_lemmas_altCIMonad">lrefin_lemmas_altCIMonad</a></span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_bindl" class="id"><a name="refin_bindl" class="">refin_bindl</a></span> (<span id="M:372" class="id"><a name="M:372" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadPrePlus.Exports.prePlusMonad">prePlusMonad</a></span>) <span id="A:373" class="id"><a name="A:373" class="">A</a></span> <span id="B:374" class="id"><a name="B:374" class="">B</a></span> (<span id="m:375" class="id"><a name="m:375" class="">m</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:372">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:373">A</a></span>) (<span id="f:376" class="id"><a name="f:376" class="">f</a></span> <span id="g:377" class="id"><a name="g:377" class="">g</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:373">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:372">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:374">B</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:376">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#3c6f54eb333403a121cf5ee349e0c952">`&lt;</a></span>.<span class="id">=`</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#g:377">g</a></span>) <span class="id">-&gt;</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m:375">m</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:376">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m:375">m</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#g:377">g</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">fg;</span> <span class="id">rewrite</span> <span class="id">/refin</span> <span class="id">-alt_bindDr;</span> <span class="id">bind_ext</span> <span class="id">=&gt;</span> <span class="id">a;</span> <span class="id">exact:</span> <span class="id">fg</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_bind" class="id"><a name="refin_bind" class="">refin_bind</a></span> (<span id="M:378" class="id"><a name="M:378" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>) <span id="A:379" class="id"><a name="A:379" class="">A</a></span> <span id="B:380" class="id"><a name="B:380" class="">B</a></span> <span class="id">{m</span> <span id="n:382" class="id"><a name="n:382" class="">n</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:378">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:379">A}</a></span> <span class="id">{f</span> <span id="g:384" class="id"><a name="g:384" class="">g</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:379">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:378">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:380">B}</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m:381">m</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#n:382">n</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:383">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#3c6f54eb333403a121cf5ee349e0c952">`&lt;</a></span>.<span class="id">=`</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#g:384">g</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m:381">m</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:383">f</a></span>) <span class="id">`&lt;=`</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#n:382">n</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#2409e092bcd148d27284e4f1ad307e1d">&gt;&gt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#g:384">g</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">mn</span> <span class="id">/refin_bindl</span> <span class="id">?;</span> <span class="id">exact:</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_trans">refin_trans</a></span> <span class="id">_</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_bindr">refin_bindr</a></span> <span class="id">_</span> <span class="id">mn</span>)).<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_liftM2" class="id"><a name="refin_liftM2" class="">refin_liftM2</a></span> (<span id="M:385" class="id"><a name="M:385" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>) (<span id="A:386" class="id"><a name="A:386" class="">A</a></span> <span id="B:387" class="id"><a name="B:387" class="">B</a></span> <span id="C:388" class="id"><a name="C:388" class="">C</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span class="id">{f</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:386">A</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:387">B</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#C:388">C}</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{m1</span> <span id="n1:391" class="id"><a name="n1:391" class="">n1</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:385">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:386">A}</a></span> <span class="id">{m2</span> <span id="n2:393" class="id"><a name="n2:393" class="">n2</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:385">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#B:387">B}</a></span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:390">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#n1:391">n1</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:392">m2</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#n2:393">n2</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#liftM2">liftM2</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:389">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:390">m1</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:392">m2</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.imonad_lib.html#liftM2">liftM2</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#f:389">f</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#n1:391">n1</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#n2:393">n2</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
<span class="id">move=&gt;</span> <span class="id">mn1</span> <span class="id">mn2;</span> <span class="id">rewrite</span> <span class="id">/liftM2</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">apply:</span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_bind">refin_bind</a></span> <span class="id">mn1</span> <span class="id">_</span>) <span class="id">=&gt;</span> <span class="id">a;</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_bindr">refin_bindr</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_guard_le" class="id"><a name="refin_guard_le" class="">refin_guard_le</a></span> (<span id="M:394" class="id"><a name="M:394" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>) (<span id="d:395" class="id"><a name="d:395" class="">d</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span id="T:396" class="id"><a name="T:396" class="">T</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.Total.Exports.orderType">orderType</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#d:395">d</a></span>) (<span id="x:397" class="id"><a name="x:397" class="">x</a></span> <span id="y:398" class="id"><a name="y:398" class="">y</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#T:396">T</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b3ebd0deddd84fd60e149cb5ef719351">~~</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:398">y</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:397">x</a></span>)%<span class="id">O</span>) <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:394">M</a></span> <span class="id">_</span>) <span class="id">`&lt;=`</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#x:397">x</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#6267442e1f81ed96252446fa7b1c579b">&lt;=</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#y:398">y</a></span>)%<span class="id">O</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
<span class="id">rewrite</span> <span class="id">-ltNge</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.order.html#Order.POrderTheory.le_eqVlt">le_eqVlt</a></span>.<br/>
<span class="id">case:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardPn">guardPn</a></span> <span class="id">=&gt;</span> <span class="id">H</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orbT">orbT</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardT">guardT;</a></span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#orbF">orbF</a></span> <span class="id">/refin</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altfailm">altfailm</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_if_guard" class="id"><a name="refin_if_guard" class="">refin_if_guard</a></span> (<span id="M:399" class="id"><a name="M:399" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>) <span id="A:400" class="id"><a name="A:400" class="">A</a></span> (<span id="p:401" class="id"><a name="p:401" class="">p</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span id="m1:402" class="id"><a name="m1:402" class="">m1</a></span> <span id="m2:403" class="id"><a name="m2:403" class="">m2</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:399">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:400">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">if</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#p:401">p</a></span> <span class="gallina-kwd">then</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:402">m1</a></span> <span class="gallina-kwd">else</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:403">m2</a></span>) <span class="id">`&lt;=`</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#p:401">p</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:402">m1</a></span>) <span class="id">[~]</span> (<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#b3ebd0deddd84fd60e149cb5ef719351">~~</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#p:401">p</a></span>) <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:403">m2</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
<span class="id">rewrite</span> <span class="id">/refin;</span> <span class="id">case:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">ifPn</a></span> <span class="id">=&gt;</span> <span class="id">/=</span> <span class="id">[pT|pF];</span> <span class="id">rewrite</span> <span class="id">!</span>(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardT">guardT,guardF</a></span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindskipf">bindskipf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindfailf">bindfailf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altA">altA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altmm">altmm</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindfailf">bindfailf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#bindskipf">bindskipf</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altCA">altCA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altmm">altmm</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_bind_guard" class="id"><a name="refin_bind_guard" class="">refin_bind_guard</a></span> <span class="id">{M</span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadPlus.Exports.plusMonad">plusMonad}</a></span> <span id="A:405" class="id"><a name="A:405" class="">A</a></span> (<span id="b:406" class="id"><a name="b:406" class="">b</a></span> <span class="id">:</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span id="m1:407" class="id"><a name="m1:407" class="">m1</a></span> <span id="m2:408" class="id"><a name="m2:408" class="">m2</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:404">M</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:405">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:406">b</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x">-&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:408">m2</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:407">m1</a></span>) <span class="id">-&gt;</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:406">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m2:408">m2</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guard">guard</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#b:406">b</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#::monae_scope:x_'&gt;&gt;'_x">&gt;&gt;</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#m1:407">m1</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
<span class="id">case:</span> <span class="id">b</span> <span class="id">=&gt;</span> <span class="id">[h|_];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_bindl">refin_bindl</a></span> <span class="id">=&gt;</span> <span class="id">-[];</span> <span class="id">exact:</span> <span class="id">h</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#guardF">guardF</a></span> <span class="id">!bindfailf;</span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_refl">refin_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_ret_insert" class="id"><a name="refin_ret_insert" class="">refin_ret_insert</a></span> (<span id="M:409" class="id"><a name="M:409" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadAltCI.Exports.altCIMonad">altCIMonad</a></span>) (<span id="A:410" class="id"><a name="A:410" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) <span id="h:411" class="id"><a name="h:411" class="">h</a></span> (<span id="t:412" class="id"><a name="t:412" class="">t</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:410">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:411">h</a></span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#::seq_scope:x_'::'_x">::</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:412">t</a></span>) <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#6dd59ac36f434063a5e5ef81e754b682">`&lt;=`</a></span> (<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insert">insert</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#h:411">h</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#t:412">t</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:409">M</a></span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
<span class="id">elim:</span> <span class="id">t</span> <span class="id">h</span> <span class="id">=&gt;</span> <span class="id">[h|t1</span> <span class="id">t2</span> <span class="id">ih</span> <span class="id">h];</span> <span class="id">first</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE;</a></span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refin_refl">refin_refl</a></span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#insertE">insertE;</a></span> <span class="id">exact:</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#refinR">refinR</a></span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span id="refin_ret_iperm" class="id"><a name="refin_ret_iperm" class="">refin_ret_iperm</a></span> (<span id="M:413" class="id"><a name="M:413" class="">M</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#MonadPlus.Exports.plusMonad">plusMonad</a></span>) (<span id="A:414" class="id"><a name="A:414" class="">A</a></span> <span class="id">:</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#UU0">UU0</a></span>) (<span id="s:415" class="id"><a name="s:415" class="">s</a></span> <span class="id">:</span> <span class="id"><a href="https://math-comp.github.io/htmldoc_1_18_0/mathcomp.ssreflect.seq.html#seq">seq</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#A:414">A</a></span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#Ret">Ret</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:415">s</a></span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssreflect.html#::core_scope:x_':'_x">:</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#M:413">M</a></span> <span class="id">_</span>) <span class="id">`&lt;=`</span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm">iperm</a></span> <span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#s:415">s</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
<span class="gallina-kwd">by</span> <span class="id">case:</span> (@<span class="id"><a href="monaeImpredicativeSet.ifail_lib.html#iperm_is_alt_ret">iperm_is_alt_ret</a></span> <span class="id">M</span> <span class="id">_</span> <span class="id">s</span>) <span class="id">=&gt;</span> <span class="id">m</span> <span class="id">-&gt;;</span> <span class="id">rewrite</span> <span class="id">/refin</span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altA">altA</a></span> <span class="id"><a href="monaeImpredicativeSet.ihierarchy.html#altmm">altmm</a></span>.<br/>
Qed.</div>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
