
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.hoelder</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.hoelder" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>

<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">
<h1 class="title">Module mathcomp.analysis.hoelder</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">HB</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">structures</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">all_ssreflect</span> <span class="id">ssralg</span> <span class="id">ssrnum</span> <span class="id">ssrint</span> <span class="id">interval</span> <span class="id">finmap</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></span> <span class="id"><a href="mathcomp.classical.boolp.html">boolp</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html">classical_sets</a></span> <span class="id"><a href="mathcomp.classical.functions.html">functions</a></span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.classical.cardinality.html">cardinality</a></span> <span class="id"><a href="mathcomp.classical.fsbigop.html">fsbigop</a></span> .<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.signed.html">signed</a></span> <span class="id"><a href="mathcomp.analysis.reals.html">reals</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html">ereal</a></span> <span class="id"><a href="mathcomp.analysis.topology.html">topology</a></span> <span class="id"><a href="mathcomp.analysis.normedtype.html">normedtype</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html">sequences</a></span> <span class="id"><a href="mathcomp.analysis.real_interval.html">real_interval</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.esum.html">esum</a></span> <span class="id"><a href="mathcomp.analysis.measure.html">measure</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html">lebesgue_measure</a></span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html">lebesgue_integral</a></span> <span class="id"><a href="mathcomp.analysis.numfun.html">numfun</a></span> <span class="id"><a href="mathcomp.analysis.exp.html">exp</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.convex.html">convex</a></span> <span class="id"><a href="mathcomp.analysis.itv.html">itv</a></span>.<br/>
<br/>
<pre class="ssrdoc">
                        Hoelder's Inequality                               
                                                                           
This file provides Hoelder's inequality.                                   
                                                                           
          'N[mu]_p[f] := (\int[mu]_x (`|f x| `^ p)%:E) `^ p^-1             
                         The corresponding definition is Lnorm.            
                                                                           
</pre>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="kwd">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="kwd">Implicit</span>.<br/>
<span class="id">Unset</span> <span class="id">Printing</span> <span class="kwd">Implicit</span> <span class="id">Defensive</span>.<br/>
<span class="kwd">Import</span> <span class="id">Order.TTheory</span> <span class="id">GRing.Theory</span> <span class="id">Num.Def</span> <span class="id">Num.Theory</span>.<br/>
<span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.topology.html#numFieldTopology.Exports">numFieldTopology.Exports</a></span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">classical_set_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ring_scope</span>.<br/>
<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "'<span class="id">N</span>[ <span class="id">mu</span> ]<span class="id">_</span> <span class="id">p</span> [ <span class="id">F</span> ]"<br/>
&nbsp;&nbsp;(<span class="kwd">at</span> <span class="id">level</span> 5, <span class="id">F</span> <span class="kwd">at</span> <span class="id">level</span> 36, <span class="id">mu</span> <span class="kwd">at</span> <span class="id">level</span> 10,<br/>
&nbsp;&nbsp;<span class="id">format</span> "'[' ''<span class="id">N</span>[' <span class="id">mu</span> ]<span class="id">_</span> <span class="id">p</span> '/  ' [ <span class="id">F</span> ] ']'").<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "'<span class="id">N_</span> <span class="id">p</span> [ <span class="id">F</span> ]"<br/>
&nbsp;&nbsp;(<span class="kwd">at</span> <span class="id">level</span> 5, <span class="id">F</span> <span class="kwd">at</span> <span class="id">level</span> 36, <span class="id">format</span> "'[' ''<span class="id">N_</span>' <span class="id">p</span> '/  ' [ <span class="id">F</span> ] ']'").<br/>
<br/>
<span class="id">Declare</span> <span class="kwd">Scope</span> <span class="id">Lnorm_scope</span>.<br/>
<br/>
<span class="id">HB.lock</span> <span class="kwd">Definition</span> <span class="id">Lnorm</span> {<span class="id">d</span>} {<span class="id">T</span> : <span class="id">measurableType</span> <span class="id">d</span>} {<span class="id">R</span> : <span class="id"><a name="d:1">realType</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">mu</span> : {<span class="id">measure</span> <span class="id">set</span> <span class="id">T</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}) (<span class="id">p</span> : \<span class="id">bar</span> <span class="id">R</span>) (<span class="id">f</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">p</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">p</span>%:<span class="id">E</span> =&gt; (<span class="kwd">if</span> <span class="id">p</span> == 0%<span class="id">R</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mu</span> (<span class="id">f</span> @^-1` (<span class="id">setT</span> `\ 0%<span class="id">R</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> (`|<span class="id">f</span> <span class="id">x</span>| `^ <span class="id">p</span>)%:<span class="id">E</span>) `^ <span class="id">p</span>^-1)%<span class="id">E</span><br/>
&nbsp;&nbsp;| +<span class="id">oo</span>%<span class="id">E</span> =&gt; (<span class="kwd">if</span> <span class="id">mu</span> [<span class="id">set</span>: <span class="id">T</span>] &gt; 0 <span class="kwd">then</span> <span class="id">ess_sup</span> <span class="id">mu</span> (<span class="id">normr</span> \<span class="id">o</span> <span class="id">f</span>) <span class="kwd">else</span> 0)%<span class="id">E</span><br/>
&nbsp;&nbsp;| -<span class="id">oo</span>%<span class="id">E</span> =&gt; 0%<span class="id">E</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<span class="kwd">Canonical</span> <span class="id">locked_Lnorm</span> := <span class="id">Unlockable</span> <span class="id">Lnorm.unlock</span>.<br/>
<span class="kwd">Arguments</span> <span class="id">Lnorm</span> {<span class="id">d</span> <span class="id">T</span> <span class="id">R</span>} <span class="id">mu</span> <span class="id"><a href="mathcomp.analysis.hoelder.html#body">p</a></span> <span class="id">f</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Lnorm_properties</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> {<span class="id">T</span> : <span class="id">measurableType</span> <span class="id">d</span>} {<span class="id">R</span> : <span class="id">realType</span>}.<br/>
<span class="kwd">Variable</span> <span class="id">mu</span> : {<span class="id">measure</span> <span class="id">set</span> <span class="id">T</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">p</span> : \<span class="id">bar</span> <span class="id">R</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) (<span class="id">r</span> : <span class="id">R</span>).<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "'<span class="id">N_</span> <span class="id">p</span> [ <span class="id">f</span> ]" := (<span class="id">Lnorm</span> <span class="id">mu</span> <span class="id">p</span> <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Lnorm1</span> <span class="id">f</span> : '<span class="id">N_1</span>[<span class="id">f</span>] = \<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> `|<span class="id">f</span> <span class="id">x</span>|%:<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
<span class="id">rewrite</span> <span class="id">unlock</span> <span class="id">oner_eq0</span> <span class="id">invr1</span>// <span class="id">poweRe1</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">t</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">_</a></span>; <span class="id">rewrite</span> <span class="id">powRr1</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">integral_ge0</span> =&gt; <span class="id">t</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">powRr1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Lnorm_ge0</span> <span class="id">p</span> <span class="id">f</span> : 0 &lt;= '<span class="id">N_p</span>[<span class="id">f</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">rewrite</span> <span class="id">unlock</span>; <span class="id">move</span>: <span class="id">p</span> =&gt; [<span class="id">r</span>/=|/=|//].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: <span class="id">ifPn</span> =&gt; // <span class="id">r0</span>; <span class="id">exact</span>: <span class="id">poweR_ge0</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: <span class="id">ifPn</span> =&gt; // /<span class="id">ess_sup_ge0</span>; <span class="id">apply</span> =&gt; <span class="id">t</span>/=.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">eq_Lnorm</span> <span class="id">p</span> <span class="id">f</span> <span class="id">g</span> : <span class="id"><a name="eq_Lnorm">f</a></span> =1 <span class="id">g</span> -&gt; '<span class="id"><a name="f:18">N_p</a></span>[<span class="id">f</span>] = '<span class="id">N_p</span>[<span class="id">g</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">fg</span>; <span class="id">congr</span> <span class="id">Lnorm</span>; <span class="id">exact</span>/<span class="id">funext</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">Lnorm_eq0_eq0</span> <span class="id">r</span> <span class="id">f</span> : (0 &lt; <span class="id">r</span>)%<span class="id">R</span> -&gt; <span class="id"><a name="f:21">measurable_fun</a></span> <span class="id">setT</span> <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">N_r</span>%:<span class="id">E</span>[<span class="id">f</span>] = 0 -&gt; <span class="id">ae_eq</span> <span class="id">mu</span> [<span class="id">set</span>: <span class="id">T</span>] (<span class="kwd">fun</span> <span class="id"><a href="mathcomp.analysis.hoelder.html#Lnorm_properties.mu">t</a></span> =&gt; (`|<span class="id">f</span> <span class="id">t</span>| `^ <span class="id">r</span>)%:<span class="id">E</span>) (<span class="id">cst</span> 0).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
<span class="id">move</span>=&gt; <span class="id">r0</span> <span class="id">mf</span>; <span class="id">rewrite</span> <span class="id">unlock</span> (<span class="id">gt_eqF</span> <span class="id">r0</span>) =&gt; /<span class="id">poweR_eq0_eq0</span> <span class="id">fp</span>.<br/>
<span class="id">apply</span>/<span class="id">ae_eq_integral_abs</span> =&gt; //=.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: (@<span class="id">measurableT_comp</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">_</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (@<span class="id">powR</span> <span class="id">R</span> ^~ <span class="id">r</span>)) =&gt; //.<br/>
&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">measurableT_comp</span>.<br/>
<span class="id">under</span> <span class="id">eq_integral</span> =&gt; <span class="id">x</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">_</a></span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">ger0_norm</span> ?<span class="id">powR_ge0</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">fp</span>//; <span class="id">apply</span>: <span class="id">integral_ge0</span> =&gt; <span class="id">t</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_Lnorm</span> <span class="id">f</span> <span class="id">r</span> : <span class="id">r</span> != 0%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">N_r</span>%:<span class="id">E</span>[<span class="id">f</span>] `^ <span class="id">r</span> = \<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> (`| <span class="id">f</span> <span class="id">x</span> | `^ <span class="id">r</span>)%:<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">move</span>=&gt; <span class="id">r0</span>; <span class="id">rewrite</span> <span class="id">unlock</span> (<span class="id">negbTE</span> <span class="id">r0</span>) -<span class="id">poweRrM</span> <span class="id">mulVf</span>// <span class="id">poweRe1</span>//.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">integral_ge0</span> =&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>// <span class="id">powR_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">Lnorm_properties</span>.<br/>
<br/>
#[<span class="id">global</span>]<br/>
<span class="kwd">Hint</span> <span class="id">Extern</span> 0 (0 &lt;= <span class="id">Lnorm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt; <span class="id">solve</span> [<span class="id">apply</span>: <span class="id">Lnorm_ge0</span>] : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="id">N</span>[ <span class="id">mu</span> ]<span class="id">_</span> <span class="id">p</span> [ <span class="id">f</span> ]" := (<span class="id">Lnorm</span> <span class="id">mu</span> <span class="id">p</span> <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id">lnorm</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> {<span class="id">T</span> : <span class="id">measurableType</span> <span class="id">d</span>} {<span class="id">R</span> : <span class="id">realType</span>}.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "'<span class="id">N_</span> <span class="id">p</span> [ <span class="id">f</span> ]" := (<span class="id">Lnorm</span> [<span class="id">the</span> <span class="id">measure</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.hoelder.html#lnorm">of</a></span> <span class="id">counting</span>] <span class="id">p</span> <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">Lnorm_counting</span> <span class="id">p</span> (<span class="id">f</span> : <span class="id">R</span>^<span class="id">nat</span>) : (0 &lt; <span class="id">p</span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">N_p</span>%:<span class="id">E</span> [<span class="id">f</span>] = (\<span class="id">sum_</span>(<span class="id">k</span> &lt;<span class="id">oo</span>) (`| <span class="id">f</span> <span class="id">k</span> | `^ <span class="id">p</span>)%:<span class="id">E</span>) `^ <span class="id">p</span>^-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id">move</span>=&gt; <span class="id">p0</span>; <span class="id">rewrite</span> <span class="id">unlock</span> <span class="id">gt_eqF</span>// <span class="id">ge0_integral_count</span>// =&gt; <span class="id">k</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">lnorm</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">hoelder</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> {<span class="id">T</span> : <span class="id">measurableType</span> <span class="id">d</span>} {<span class="id">R</span> : <span class="id">realType</span>}.<br/>
<span class="kwd">Variable</span> <span class="id">mu</span> : {<span class="id">measure</span> <span class="id">set</span> <span class="id">T</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">p</span> <span class="id"><a href="mathcomp.analysis.hoelder.html#hoelder.mu">q</a></span> : <span class="id">R</span>) (<span class="id">f</span> <span class="id">g</span> : <span class="id"><a name="hoelder.integrable_powR">T</a></span> -&gt; <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id">measurableT_comp_powR</span> <span class="id">f</span> <span class="id">p</span> :<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id"><a href="mathcomp.analysis.hoelder.html#hoelder.T">set</a></span>: <span class="id">T</span>] <span class="id">f</span> -&gt; <span class="id">measurable_fun</span> <span class="id">setT</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span> `^ <span class="id">p</span>)%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
 <span class="id">exact</span>: (@<span class="id">measurableT_comp</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (@<span class="id">powR</span> <span class="id">R</span> ^~ <span class="id">p</span>)). Qed.</div>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "'<span class="id">N_</span> <span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">p</a></span> [ <span class="id">f</span> ]" := (<span class="id">Lnorm</span> <span class="id">mu</span> <span class="id">p</span> <span class="id">f</span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id">integrable_powR</span> <span class="id">f</span> <span class="id">p</span> : (0 &lt; <span class="id">p</span>)%<span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">R</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">T</span>] <span class="id">f</span> -&gt; '<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#contra">N_p</a></span>%:<span class="id">E</span>[<span class="id">f</span>] != +<span class="id">oo</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">mu</span>.-<span class="id"><a href="mathcomp.analysis.exp.html#eqy_poweR">integrable</a></span> [<span class="id">set</span>: <span class="id">T</span>] (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (`|<span class="id">f</span> <span class="id">x</span>| `^ <span class="id">p</span>)%:<span class="id">E</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">move</span>=&gt; <span class="id">p0</span> <span class="id">mf</span> <span class="id">foo</span>; <span class="id">apply</span>/<span class="id">integrableP</span>; <span class="id">split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">apply</span>: <span class="id">measurableT_comp_powR</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">measurableT_comp</span>.<br/>
<span class="id">rewrite</span> <span class="id"><a name="f:44">ltey</a></span>; <span class="id"><a name="q:47">apply</a></span>: <span class="id">contra</span> <span class="id">foo</span>.<br/>
<span class="id"><a href="mathcomp.classical.classical_sets.html#setT">move</a></span>=&gt; /<span class="id">eqP</span>/(@<span class="id">eqy_poweR</span> <span class="id">_</span> <span class="id">_</span> <span class="id">p</span>^-1); <span class="id">rewrite</span> <span class="id">invr_gt0</span> =&gt; /(<span class="id">_</span> <span class="id">p0</span>) &lt;-.<br/>
<span class="id">rewrite</span> <span class="id">unlock</span> (<span class="id">gt_eqF</span> <span class="id">p0</span>); <span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">congr</span> (<span class="id">_</span> `^ <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eq_integral</span> =&gt; <span class="id">t</span> <span class="id">_</span>; <span class="id">rewrite</span> [<span class="id">RHS</span>]<span class="id">gee0_abs</span>// <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">hoelder0</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html#leLHS">f</a></span> <span class="id">g</span> <span class="id">p</span> <span class="id">q</span> : <span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ae_eq_integral">f</a></span> -&gt; <span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">g</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id">p</span>)%<span class="id">R</span> -&gt; (0 &lt; <span class="id">q</span>)%<span class="id">R</span> -&gt; (<span class="id">p</span>^-1 + <span class="id">q</span>^-1 = 1)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] = 0 -&gt; '<span class="id">N_1</span>[(<span class="id">f</span> \* <span class="id">g</span>)%<span class="id">R</span>]  &lt;= '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] * '<span class="id">N_q</span>%:<span class="id">E</span>[<span class="id">g</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
<span class="id">move</span>=&gt; <span class="id">mf</span> <span class="id">mg</span> <span class="id">p0</span> <span class="id">q0</span> <span class="id">pq</span> <span class="id">f0</span>; <span class="id">rewrite</span> <span class="id">f0</span> <span class="id">mul0e</span> <span class="id">Lnorm1</span> [<span class="id">leLHS</span>](<span class="id">_</span> : <span class="id">_</span> = 0)//.<br/>
<span class="id">rewrite</span> (<span class="id">ae_eq_integral</span> (<span class="id">cst</span> 0)) =&gt; [|//||//|]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">integral0</span>.<br/>
- <span class="kwd">by</span> <span class="id">do</span> 2 <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">exact</span>: <span class="id">measurable_funM</span>.<br/>
- <span class="id">apply</span>: <span class="id">filterS</span> (<span class="id">Lnorm_eq0_eq0</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine_ge0">p0</a></span> <span class="id">mf</span> <span class="id">f0</span>) =&gt; <span class="id">x</span> /(<span class="id">_</span> <span class="id">I</span>)[] /<span class="id">powR_eq0_eq0</span> + <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a name="f:55">normrM</a></span> =&gt; -&gt;; <span class="id">rewrite</span> <span class="id">mul0r</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">normalized</span> <span class="id">p</span> <span class="id">f</span> <span class="id">x</span> := `|<span class="id">f</span> <span class="id">x</span>| / <span class="id">fine</span> '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>].<br/>
<br/>
<span class="kwd">Let</span> <span class="id">normalized_ge0</span> <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_funM">p</a></span> <span class="id">f</span> <span class="id">x</span> : (0 &lt;= <span class="id">normalized</span> <span class="id">p</span> <span class="id">f</span> <span class="id">x</span>)%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">normalized</span> <span class="id">divr_ge0</span>// <span class="id">fine_ge0</span>// <span class="id">Lnorm_ge0</span>. Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">measurable_normalized</span> <span class="id">p</span> <span class="id">f</span> : <span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id">T</span>] <span class="id">f</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> [<span class="id">set</span>: <span class="id"><a href="mathcomp.analysis.hoelder.html#hoelder.normalized">T</a></span>] (<span class="id">normalized</span> <span class="id">p</span> <span class="id">f</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">mf</span>; <span class="id">apply</span>: <span class="id">measurable_funM</span> =&gt; //; <span class="id">exact</span>: <span class="id">measurableT_comp</span>. Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">integral_normalized</span> <span class="id">f</span> <span class="id">p</span> : (0 &lt; <span class="id">p</span>)%<span class="id">R</span> -&gt; 0 &lt; '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">mu</span>.-<span class="id">integrable</span> [<span class="id">set</span>: <span class="id">T</span>] (<span class="kwd">fun</span> <span class="id">x</span> =&gt; (`|<span class="id">f</span> <span class="id">x</span>| `^ <span class="id">p</span>)%:<span class="id">E</span>) -&gt;<br/>
&nbsp;&nbsp;\<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">normalized</a></span> <span class="id">p</span> <span class="id">f</span> <span class="id">x</span> `^ <span class="id">p</span>)%:<span class="id">E</span> = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">move</span>=&gt; <span class="id">p0</span> <span class="id">fpos</span> <span class="id">ifp</span>.<br/>
<span class="id">transitivity</span> (\<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> (`|<span class="id"><a href="mathcomp.analysis.exp.html#powR_inv1">f</a></span> <span class="id">x</span>| `^ <span class="id">p</span> / <span class="id">fine</span> ('<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] `^ <span class="id">p</span>))%:<span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.hoelder.html#hoelder.mu">apply</a></span>: <span class="id">eq_integral</span> =&gt; <span class="id">t</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">powRM</span>//; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invr_ge0</span> <span class="id"><a href="mathcomp.analysis.exp.html#gt0_poweR">fine_ge0</a></span>// <span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -[<span class="kwd">in</span> <span class="id">LHS</span>]<span class="id">powR_inv1</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">fine_ge0</span> // <span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">fine_poweR</span> <span class="id">powRAC</span> -<span class="id">powR_inv1</span> // <span class="id">powR_ge0</span>.<br/>
<span class="id">have</span> <span class="id">fp0</span> : 0 &lt; \<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> (`|<span class="id">f</span> <span class="id">x</span>| `^ <span class="id">p</span>)%:<span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">unlock</span> (<span class="id">gt_eqF</span> <span class="id">p0</span>) <span class="kwd">in</span> <span class="id">fpos</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">gt0_poweR</span> <span class="id">fpos</span>; <span class="id">rewrite</span> ?<span class="id">invr_gt0</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span> <span class="id">integral_ge0</span> =&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>; <span class="id">exact</span>: <span class="id">powR_ge0</span>.<br/>
<span class="id">rewrite</span> <span class="id">unlock</span> (<span class="id">gt_eqF</span> <span class="id">p0</span>) -<span class="id">poweRrM</span> <span class="id">mulVf</span> ?(<span class="id">gt_eqF</span> <span class="id">p0</span>)// (<span class="id">poweRe1</span> (<span class="id">ltW</span> <span class="id">fp0</span>))//.<br/>
<span class="id">under</span> <span class="id">eq_integral</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">EFinM</span> <span class="id">muleC</span>.<br/>
<span class="id">have</span> <span class="id">foo</span> : \<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> (`|<span class="id">f</span> <span class="id">x</span>| `^ <span class="id">p</span>)%:<span class="id">E</span> &lt; +<span class="id">oo</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>/<span class="id">integrableP</span>: <span class="id">ifp</span> =&gt; -[<span class="id">_</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">under</span> <span class="id">eq_integral</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">gee0_abs</span>// ?<span class="id">lee_fin</span> ?<span class="id">powR_ge0</span>//.<br/>
<span class="id">rewrite</span> <span class="id">integralZl</span>//; <span class="id">apply</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">eqe_pdivr_mull</span> ?<span class="id">mule1</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">fineK</span>// <span class="id">gt0_fin_numE</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">gt_eqF</span>// <span class="id">fine_gt0</span>// <span class="id">foo</span> <span class="id">andbT</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">hoelder</span> <span class="id">f</span> <span class="id">g</span> <span class="id"><a href="mathcomp.analysis.hoelder.html#hoelder.hoelder0">p</a></span> <span class="id">q</span> : <span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">f</span> -&gt; <span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">g</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; <span class="id">p</span>)%<span class="id">R</span> -&gt; (0 &lt; <span class="id">q</span>)%<span class="id">R</span> -&gt; (<span class="id">p</span>^-1 + <span class="id">q</span>^-1 = 1)%<span class="id">R</span> -&gt;<br/>
&nbsp;'<span class="id">N_1</span>[(<span class="id">f</span> \* <span class="id">g</span>)%<span class="id">R</span>] &lt;= '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] * '<span class="id">N_q</span>%:<span class="id">E</span>[<span class="id">g</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">move</span>=&gt; <span class="id">mf</span> <span class="id">mg</span> <span class="id">p0</span> <span class="id">q0</span> <span class="id">pq</span>.<br/>
<span class="id">have</span> [<span class="id">f0</span>|<span class="id">f0</span>] := <span class="id">eqVneq</span> '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] 0%<span class="id">E</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">hoelder0</span>.<br/>
<span class="id">have</span> [<span class="id">g0</span>|<span class="id">g0</span>] := <span class="id">eqVneq</span> '<span class="id">N_q</span>%:<span class="id">E</span>[<span class="id">g</span>] 0%<span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">muleC</span>; <span class="id">apply</span>: <span class="id">le_trans</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">hoelder0</span> =&gt; //; <span class="id">rewrite</span> <span class="id">addrC</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">under</span> <span class="id">eq_Lnorm</span> <span class="id">do</span> <span class="id">rewrite</span> /= <span class="id">mulrC</span>.<br/>
<span class="id">have</span> {<span class="id">f0</span>}<span class="id">fpos</span> : 0 &lt; '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lt0e</span> <span class="id">f0</span> <span class="id">Lnorm_ge0</span>.<br/>
<span class="id">have</span> {<span class="id">g0</span>}<span class="id">gpos</span> : 0 &lt; '<span class="id">N_q</span>%:<span class="id">E</span>[<span class="id">g</span>] <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lt0e</span> <span class="id">g0</span> <span class="id"><a href="mathcomp.analysis.hoelder.html#hoelder.normalized">Lnorm_ge0</a></span>.<br/>
<span class="id">have</span> [<span class="id">foo</span>|<span class="id">foo</span>] := <span class="id">eqVneq</span> '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] +<span class="id">oo</span>%<span class="id">E</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">foo</span> <span class="id">gt0_mulye</span> ?<span class="id">leey</span>.<br/>
<span class="id">have</span> [<span class="id">goo</span>|<span class="id">goo</span>] := <span class="id">eqVneq</span> '<span class="id">N_q</span>%:<span class="id">E</span>[<span class="id">g</span>] +<span class="id">oo</span>%<span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">E</a></span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">goo</span> <span class="id">gt0_muley</span> ?<span class="id">leey</span>.<br/>
<span class="id">pose</span> <span class="id">F</span> := <span class="id"><a href="mathcomp.analysis.hoelder.html#hoelder.normalized">normalized</a></span> <span class="id">p</span> <span class="id">f</span>; <span class="id">pose</span> <span class="id">G</span> := <span class="id">normalized</span> <span class="id">q</span> <span class="id">g</span>.<br/>
<span class="id">rewrite</span> [<span class="id">leLHS</span>](<span class="id">_</span> : <span class="id">_</span> = '<span class="id">N_1</span>[(<span class="id">F</span> \* <span class="id">G</span>)%<span class="id">R</span>] * '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] * '<span class="id">N_q</span>%:<span class="id">E</span>[<span class="id">g</span>]); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id">Lnorm1</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span> [<span class="kwd">in</span> <span class="id">RHS</span>]<span class="id">eq_integral</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">F</span> /<span class="id">G</span> /= /<span class="id">normalized</span> (<span class="id">mulrC</span> `|<span class="id">f</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ge0_integralZl">x</a></span>|)%<span class="id">R</span> <span class="id">mulrA</span> -(<span class="id">mulrA</span> (<span class="id">_</span>^-1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">mulrC</span> (<span class="id">_</span>^-1)) -<span class="id">mulrA</span> <span class="id">ger0_norm</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr_ge0</span>// <span class="id">divr_ge0</span> ?(<span class="id">fine_ge0</span>, <span class="id">Lnorm_ge0</span>, <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine_ge0">invr_ge0</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrC</span> -<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleA">normrM</a></span> <span class="id">EFinM</span>; <span class="id">over</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">ge0_integralZl</span>//; <span class="id">last</span> 2 <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">do</span> 2 <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mul1e">apply</a></span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">exact</span>: <span class="id">measurable_funM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">mulr_ge0</span>// <span class="id">invr_ge0</span> <span class="id">fine_ge0</span>// <span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -<span class="id">muleA</span> <span class="id">muleC</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#fine_gt0">muleA</a></span> <span class="id">EFinM</span> <span class="id">muleCA</span> 2!<span class="id">muleA</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> : <span class="id">_</span> * '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] = 1) ?<span class="id">mul1e</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> * <span class="id">X</span>]<span class="id">fineK</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ge0_fin_numE</span> ?<span class="id">ltey</span>// <span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">EFinM</span> <span class="id">mulVr</span> ?<span class="id">unitfE</span> ?<span class="id">gt_eqF</span>// <span class="id">fine_gt0</span>// <span class="id">fpos</span>/= <span class="id">ltey</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> : '<span class="id">N_q</span>%:<span class="id">E</span>[<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleA">g</a></span>] * <span class="id">_</span> = 1) ?<span class="id">mul1e</span>// <span class="id">muleC</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> * <span class="id">X</span>]<span class="id">fineK</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ge0_fin_numE</span> ?<span class="id">ltey</span>// <span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">EFinM</span> <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#ae_ge0_le_integral">mulVr</a></span> ?<span class="id">unitfE</span> ?<span class="id">gt_eqF</span>// <span class="id">fine_gt0</span>// <span class="id">gpos</span>/= <span class="id">ltey</span>.<br/>
<span class="id">rewrite</span> -(<span class="id">mul1e</span> ('<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] * <span class="id">_</span>)) -<span class="id">muleA</span> <span class="id">lee_pmul</span> ?<span class="id">mule_ge0</span> ?<span class="id">Lnorm_ge0</span>//.<br/>
<span class="id">rewrite</span> [<span class="id">leRHS</span>](<span class="id">_</span> : <span class="id">_</span> = \<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> (<span class="id">F</span> <span class="id">x</span> `^ <span class="id">p</span> / <span class="id">p</span> + <span class="id">G</span> <span class="id">x</span> `^ <span class="id">q</span> / <span class="id">q</span>)%:<span class="id"><a href="mathcomp.analysis.exp.html#powR_ge0">E</a></span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Lnorm1</span> <span class="id">ae_ge0_le_integral</span> //.<br/>
&nbsp;&nbsp;- <span class="id">do</span> 2 <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="mathcomp.analysis.lebesgue_measure.html#measurable_funM">measurable_funM</a></span> =&gt; //; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.hoelder.html#hoelder.measurableT_comp_powR">measurable_normalized</a></span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">addr_ge0</span>// <span class="id">divr_ge0</span>// ?<span class="id">powR_ge0</span>// <span class="id">ltW</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">apply</span>: <span class="id">measurable_funD</span> =&gt; //;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">measurable_funM</span> =&gt; //; <span class="id">apply</span>: <span class="id">measurableT_comp_powR</span> =&gt; //;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">measurable_normalized</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">aeW</span> =&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">ger0_norm</span> ?<span class="id">conjugate_powR</span> ?<span class="id">normalized_ge0</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr_ge0</span>// <span class="id">normalized_ge0</span>.<br/>
<span class="id">under</span> <span class="id">eq_integral</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">EFinD</span> <span class="id">mulrC</span> (<span class="id">mulrC</span> <span class="id">_</span> (<span class="id">_</span>^-1)).<br/>
<span class="id">rewrite</span> <span class="id">ge0_integralD</span>//; <span class="id">last</span> 4 <span class="id">first</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">mulr_ge0</span>// ?<span class="id">invr_ge0</span> ?<span class="id">powR_ge0</span>// <span class="id">ltW</span>.<br/>
- <span class="id">do</span> 2 <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurableT_comp_powR</span> =&gt; //; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.lebesgue_integral.html#eq_integral">measurable_normalized</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">mulr_ge0</span>// ?<span class="id">invr_ge0</span> ?<span class="id">powR_ge0</span>// <span class="id">ltW</span>.<br/>
- <span class="id">do</span> 2 <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurableT_comp_powR</span> =&gt; //; <span class="id">exact</span>: <span class="id">measurable_normalized</span>.<br/>
<span class="id">under</span> <span class="id">eq_integral</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">EFinM</span>.<br/>
<span class="id">rewrite</span> {1}<span class="id">ge0_integralZl</span>//; <span class="id">last</span> 3 <span class="id">first</span>.<br/>
- <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurableT_comp_powR</span> =&gt; //; <span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.measure.html#measurableT_comp">measurable_normalized</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">invr_ge0</span> <span class="id">ltW</span>.<br/>
<span class="id">under</span> [<span class="id">X</span> <span class="kwd">in</span> (<span class="id">_</span> + <span class="id">X</span>)%<span class="id">E</span>]<span class="id">eq_integral</span> =&gt; <span class="id">x</span> <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">EFinM</span>.<br/>
<span class="id">rewrite</span> <span class="id">ge0_integralZl</span>//; <span class="id">last</span> 3 <span class="id">first</span>.<br/>
- <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">measurableT_comp_powR</span> =&gt; //; <span class="id">exact</span>: <span class="id">measurable_normalized</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">invr_ge0</span> <span class="id">ltW</span>.<br/>
<span class="id">rewrite</span> <span class="id">integral_normalized</span>//; <span class="id">last</span> <span class="id">exact</span>: <span class="id">integrable_powR</span>.<br/>
<span class="id">rewrite</span> <span class="id">integral_normalized</span>//; <span class="id">last</span> <span class="id">exact</span>: <span class="id">integrable_powR</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> 2!<span class="id">mule1</span> -<span class="id">EFinD</span> <span class="id">pq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">hoelder</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">hoelder2</span>.<br/>
<span class="kwd">Context</span> {<span class="id">R</span> : <span class="id">realType</span>}.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ring_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">hoelder2</span> (<span class="id">a1</span> <span class="id">a2</span> <span class="id">b1</span> <span class="id">b2</span> : <span class="id">R</span>) (<span class="id">p</span> <span class="id">q</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;0 &lt;= <span class="id">a1</span> -&gt; 0 &lt;= <span class="id">a2</span> -&gt; 0 &lt;= <span class="id">b1</span> -&gt; 0 &lt;= <span class="id">b2</span> -&gt;<br/>
&nbsp;&nbsp;0 &lt; <span class="id">p</span> -&gt; 0 &lt; <span class="id">q</span> -&gt; <span class="id">p</span>^-1 + <span class="id">q</span>^-1 = 1 -&gt;<br/>
&nbsp;&nbsp;<span class="id">a1</span> * <span class="id">b1</span> + <span class="id">a2</span> * <span class="id">b2</span> &lt;= (<span class="id">a1</span> `^ <span class="id">p</span> + <span class="id">a2</span> `^ <span class="id">p</span>) `^ <span class="id">p</span>^-1 *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="mathcomp.analysis.measure.html#Measure.Exports.measure">b1</a></span> `^ <span class="id">q</span> + <span class="id">b2</span> `^ <span class="id">q</span>) `^ <span class="id">q</span>^-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">move</span>=&gt; <span class="id">a10</span> <span class="id">a20</span> <span class="id">b10</span> <span class="id">b20</span> <span class="id">p0</span> <span class="id">q0</span> <span class="id">pq</span>.<br/>
<span class="id">pose</span> <span class="id">f</span> <span class="id">a</span> <span class="id">b</span> <span class="id">n</span> : <span class="id">R</span> := <span class="kwd">match</span> <span class="id">n</span> <span class="kwd">with</span> 0%<span class="id">nat</span> =&gt; <span class="id">a</span> | 1%<span class="id">nat</span> =&gt; <span class="id">b</span> | <span class="id">_</span> =&gt; 0 <span class="kwd">end</span>.<br/>
<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">have</a></span> <span class="id">mf</span> <span class="id"><a href="mathcomp.analysis.exp.html#powR_ge0">a</a></span> <span class="id">b</span> : <span class="id">measurable_fun</span> <span class="id">setT</span> (<span class="id">f</span> <span class="id">a</span> <span class="id">b</span>) <span class="kwd">by</span> [].<br/>
<span class="id">have</span> := <span class="id">hoelder</span> [<span class="id">the</span> <span class="id">measure</span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id">counting</span>] (<span class="id">mf</span> <span class="id">a1</span> <span class="id">a2</span>) (<span class="id">mf</span> <span class="id">b1</span> <span class="id">b2</span>) <span class="id">p0</span> <span class="id">q0</span> <span class="id">pq</span>.<br/>
<span class="id">rewrite</span> !<span class="id">Lnorm_counting</span>//.<br/>
<span class="id">rewrite</span> (<span class="id">nneseries_split</span> 2); <span class="id">last</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">k</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
<span class="id">rewrite</span> <span class="id">ereal_series_cond</span> <span class="id">eseries0</span> ?<span class="id">adde0</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; [//|] [//|<span class="id">n</span> <span class="id">_</span>]; <span class="id">rewrite</span> /<span class="id">f</span> /= <span class="id">mulr0</span> <span class="id">normr0</span> <span class="id">powR0</span>.<br/>
<span class="id">rewrite</span> 2!<span class="id">big_ord_recr</span> /= <span class="id">big_ord0</span> <span class="id">add0e</span> <span class="id">powRr1</span> ?<span class="id"><a href="mathcomp.analysis.exp.html#powR0">normr_ge0</a></span> ?<span class="id">powRr1</span> ?<span class="id">normr_ge0</span>//.<br/>
<span class="id">rewrite</span> (<span class="id">nneseries_split</span> 2); <span class="id">last</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">k</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
<span class="id">rewrite</span> <span class="id">ereal_series_cond</span> <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#lee_fin">eseries0</a></span> ?<span class="id">adde0</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; [//|] [//|<span class="id">n</span> <span class="id">_</span>]; <span class="id">rewrite</span> /<span class="id">f</span> /= <span class="id">normr0</span> <span class="id">powR0</span>// <span class="id">gt_eqF</span>.<br/>
<span class="id">rewrite</span> 2!<span class="id">big_ord_recr</span> /= <span class="id">big_ord0</span> <span class="id">add0e</span> -<span class="id">EFinD</span> <span class="id">poweR_EFin</span>.<br/>
<span class="id">rewrite</span> (<span class="id">nneseries_split</span> 2); <span class="id">last</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">k</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
<span class="id">rewrite</span> <span class="id">ereal_series_cond</span> <span class="id">eseries0</span> ?<span class="id">adde0</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; [//|] [//|<span class="id">n</span> <span class="id">_</span>]; <span class="id">rewrite</span> /<span class="id">f</span> /= <span class="id">normr0</span> <span class="id">powR0</span>// <span class="id">gt_eqF</span>.<br/>
<span class="id">rewrite</span> 2!<span class="id">big_ord_recr</span> /= <span class="id">big_ord0</span> <span class="id">add0e</span> -<span class="id">EFinD</span> <span class="id">poweR_EFin</span>.<br/>
<span class="id">rewrite</span> -<span class="id">EFinM</span> <span class="id">invr1</span> <span class="id">powRr1</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addr_ge0</span>.<br/>
<span class="id">do</span> 2 (<span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.convex.html#convex_function">ger0_norm</a></span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr_ge0</span>).<br/>
<span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.hoelder.html#convex_powR.R">do</a></span> 4 (<span class="id">rewrite</span> <span class="id">ger0_norm</span>; <span class="id">last</span> <span class="kwd">by</span> []).<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">hoelder2</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">convex_powR</span>.<br/>
<span class="kwd">Context</span> {<span class="id">R</span> : <span class="id">realType</span>}.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ring_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">convex_powR</span> <span class="id">p</span> : 1 &lt;= <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">convex_function</span> `[0, +<span class="id">oo</span>[%<span class="id">classic</span> (@<span class="id">powR</span> <span class="id">R</span> ^~ <span class="id">p</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
<span class="id">move</span>=&gt; <span class="id">p1</span> <span class="id">t</span> <span class="id">x</span> <span class="id">y</span> /[!<span class="id">inE</span>] /= /[!<span class="id">in_itv</span>] /= /[!<span class="id">andbT</span>] <span class="id">x_ge0</span> <span class="id">y_ge0</span>.<br/>
<span class="id">have</span> <span class="id"><a href="mathcomp.analysis.exp.html#powR0">p0</a></span> : 0 &lt; <span class="id">p</span> <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id">p1</span>).<br/>
<span class="id">rewrite</span> !<span class="id">convRE</span>; <span class="id">set</span> <span class="id">w1</span> := `1-(<span class="id">t</span>%:<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">inum</a></span>); <span class="id">set</span> <span class="id">w2</span> := <span class="id">t</span>%:<span class="id">inum</span>.<br/>
<span class="id">have</span> [-&gt;|<span class="id">w10</span>] := <span class="id">eqVneq</span> <span class="id">w1</span> 0.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id">mul0r</span> !<span class="id">add0r</span>; <span class="id">have</span> [-&gt;|<span class="id">w20</span>] := <span class="id">eqVneq</span> <span class="id">w2</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">mul0r</span> <span class="id">powR0</span>// <span class="id">gt_eqF</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ge1r_powRZ</span>// /<span class="id">w2</span> <span class="id">lt_neqAle</span> <span class="id">eq_sym</span> <span class="id">w20</span>/=; <span class="id">apply</span>/<span class="id">andP</span>.<br/>
<span class="id">have</span> [-&gt;|<span class="id">w20</span>] := <span class="id">eqVneq</span> <span class="id">w2</span> 0.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">mul0r</span> !<span class="id">addr0</span> <span class="id">ge1r_powRZ</span>// <span class="id">onem_le1</span>// <span class="id">andbT</span> <span class="id">lt0r</span> <span class="id">w10</span> <span class="id">onem_ge0</span>.<br/>
<span class="id">have</span> [-&gt;|<span class="id">p_neq1</span>] := <span class="id">eqVneq</span> <span class="id">p</span> 1.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">powRr1</span>// <span class="id">addr_ge0</span>// <span class="id">mulr_ge0</span>// /<span class="id">w2</span> ?<span class="id">onem_ge0</span>.<br/>
<span class="id">have</span> {<span class="id">p_neq1</span>} {}<span class="id">p1</span> : 1 &lt; <span class="id">p</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lt_neqAle</span> <span class="id">eq_sym</span> <span class="id">p_neq1</span>.<br/>
<span class="id">pose</span> <span class="id">q</span> := <span class="id">p</span> / (<span class="id">p</span> - 1).<br/>
<span class="id">have</span> <span class="id">q1</span> : 1 &lt;= <span class="id">q</span> <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">q</span> <span class="id">ler_pdivl_mulr</span>// ?<span class="id">mul1r</span> ?<span class="id">gerBl</span>// <span class="id">subr_gt0</span>.<br/>
<span class="id">have</span> <span class="id">q0</span> : 0 &lt; <span class="id">q</span> <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id">q1</span>).<br/>
<span class="id">have</span> <span class="id">pq1</span> : <span class="id">p</span>^-1 + <span class="id">q</span>^-1 = 1.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">q</span> <span class="id">invf_div</span> -{1}(<span class="id">div1r</span> <span class="id">p</span>) -<span class="id">mulrDl</span> <span class="id">addrCA</span> <span class="id">subrr</span> <span class="id">addr0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulfV</span>// <span class="id">gt_eqF</span>.<br/>
<span class="id">rewrite</span> -(@<span class="id">powRr1</span> <span class="id">_</span> (<span class="id">w1</span> * <span class="id">x</span> `^ <span class="id">p</span> + <span class="id">w2</span> * <span class="id">y</span> `^ <span class="id">p</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addr_ge0</span>// <span class="id">mulr_ge0</span>// ?<span class="id">powR_ge0</span>// /<span class="id">w2</span> ?<span class="id">onem_ge0</span>// <span class="id">itv_ge0</span>.<br/>
<span class="id">have</span> -&gt; : 1 = <span class="id">p</span>^-1 * <span class="id">p</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulVf</span> ?<span class="id">gt_eqF</span>.<br/>
<span class="id">rewrite</span> <span class="id">powRrM</span> (<span class="id">ge0_ler_powR</span> (<span class="id">le_trans</span> <span class="id">_</span> (<span class="id">ltW</span> <span class="id">p1</span>)))//.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">nnegrE</span> <span class="id">addr_ge0</span>// <span class="id">mulr_ge0</span> /<span class="id">w2</span> ?<span class="id">onem_ge0</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">nnegrE</span> <span class="id">powR_ge0</span>.<br/>
<span class="id">have</span> -&gt; : <span class="id">w1</span> * <span class="id">x</span> + <span class="id">w2</span> * <span class="id">y</span> = <span class="id">w1</span> `^ (<span class="id">p</span>^-1) * <span class="id">w1</span> `^ (<span class="id">q</span>^-1) * <span class="id">x</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">w2</span> `^ (<span class="id">p</span>^-1) * <span class="id">w2</span> `^ (<span class="id">q</span>^-1) * <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -!<span class="id">powRD</span> <span class="id">pq1</span>; [|<span class="id">exact</span>/<span class="id">implyP</span>..].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">powRr1</span>// /<span class="id">w2</span> ?<span class="id">onem_ge0</span>.<br/>
<span class="id">apply</span>: (@<span class="id">le_trans</span> <span class="id">_</span> <span class="id">_</span> ((<span class="id">w1</span> * <span class="id">x</span> `^ <span class="id">p</span> + <span class="id">w2</span> * <span class="id">y</span> `^ <span class="id">p</span>) `^ (<span class="id">p</span>^-1) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">w1</span> + <span class="id">w2</span>) `^ <span class="id">q</span>^-1)).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">a1</span> := <span class="id">w1</span> `^ <span class="id">p</span>^-1 * <span class="id">x</span>. <span class="id">pose</span> <span class="id">a2</span> := <span class="id">w2</span> `^ <span class="id">p</span>^-1 * <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">b1</span> := <span class="id">w1</span> `^ <span class="id">q</span>^-1. <span class="id">pose</span> <span class="id">b2</span> := <span class="id">w2</span> `^ <span class="id">q</span>^-1.<br/>
&nbsp;&nbsp;<span class="id">have</span> : <span class="id">a1</span> * <span class="id"><a href="mathcomp.analysis.exp.html#powR_ge0">b1</a></span> + <span class="id">a2</span> * <span class="id">b2</span> &lt;= (<span class="id">a1</span> `^ <span class="id">p</span> + <span class="id">a2</span> `^ <span class="id">p</span>) `^ <span class="id">p</span>^-1 *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">b1</span> `^ <span class="id">q</span> + <span class="id">b2</span> `^ <span class="id">q</span>) `^ <span class="id">q</span>^-1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">hoelder2</span> =&gt; //; <span class="id">rewrite</span> ?<span class="id">mulr_ge0</span> ?<span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> ?<span class="id">powRM</span> ?<span class="id">powR_ge0</span> -?<span class="id">powRrM</span> ?<span class="id">mulVf</span> ?<span class="id">powRr1</span> ?<span class="id">gt_eqF</span> ?<span class="id">onem_ge0</span>/<span class="id">w2</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrAC</span> (<span class="id">mulrAC</span> <span class="id">_</span> <span class="id">y</span>) =&gt; /<span class="id">le_trans</span>; <span class="id">exact</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> {2}/<span class="id">w1</span> {2}/<span class="id">w2</span> <span class="id">subrK</span> <span class="id">powR1</span> <span class="id">mulr1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">convex_powR</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">minkowski</span>.<br/>
<span class="kwd">Context</span> <span class="id">d</span> (<span class="id">T</span> : <span class="id">measurableType</span> <span class="id">d</span>) (<span class="id">R</span> : <span class="id">realType</span>).<br/>
<span class="kwd">Variable</span> <span class="id">mu</span> : {<span class="id">measure</span> <span class="id">set</span> <span class="id">T</span> -&gt; \<span class="id">bar</span> <span class="id">R</span>}.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">f</span> <span class="id">g</span> : <span class="id">T</span> -&gt; <span class="id">R</span>) (<span class="id">p</span> : <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id">convex_powR_abs_half</span> <span class="id">f</span> <span class="id">g</span> <span class="id">p</span> <span class="id">x</span> : 1 &lt;= <span class="id">p</span> -&gt;<br/>
&nbsp;&nbsp;`| 2^-1 * <span class="id">f</span> <span class="id">x</span> + 2^-1 * <span class="id">g</span> <span class="id">x</span> | `^ <span class="id">p</span> &lt;=<br/>
&nbsp;&nbsp;&nbsp;2^-1 * `| <span class="id">f</span> <span class="id">x</span> | `^ <span class="id">p</span> + 2^-1 * `| <span class="id">g</span> <span class="id">x</span> | `^ <span class="id">p</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
<span class="id">move</span>=&gt; <span class="id">p1</span>; <span class="id">rewrite</span> (@<span class="id">le_trans</span> <span class="id">_</span> <span class="id">_</span> ((2^-1 * `| <span class="id">f</span> <span class="id">x</span> | + 2^-1 * `| <span class="id">g</span> <span class="id">x</span> |) `^ <span class="id">p</span>))//.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">ge0_ler_powR</span> ?<span class="id">nnegrE</span> ?(<span class="id">le_trans</span> <span class="id">_</span> <span class="id">p1</span>)//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_norm_add</span> <span class="id">_</span> <span class="id">_</span>))// 2!<span class="id">normrM</span> <span class="id">ger0_norm</span>.<br/>
<span class="id">rewrite</span> {1 3}(<span class="id">_</span> : 2^-1 = 1 - 2^-1); <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> {2}(<span class="id">splitr</span> 1) <span class="id">div1r</span> <span class="id">addrK</span>.<br/>
<span class="id">rewrite</span> (@<span class="id">convex_powR</span> <span class="id">_</span> <span class="id">_</span> <span class="id">p1</span> (@<span class="id">Itv.mk</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) ?<span class="id">inE</span>/= ?<span class="id">in_itv</span>/= ?<span class="id">normr_ge0</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">Itv.itv_cond</span>/= <span class="id">in_itv</span>/= <span class="id">invr_ge0</span> <span class="id">ler0n</span> <span class="id">invf_le1</span> ?<span class="id">ler1n</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">measurableT_comp_powR</span> <span class="id">f</span> <span class="id">p</span> :<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">f</span> -&gt; <span class="id">measurable_fun</span> <span class="id">setT</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">f</span> <span class="id">x</span> `^ <span class="id">p</span>)%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
 <span class="id">exact</span>: (@<span class="id">measurableT_comp</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (@<span class="id">powR</span> <span class="id">R</span> ^~ <span class="id">p</span>)). Qed.</div>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "'<span class="id">N_</span> <span class="id">p</span> [ <span class="id">f</span> ]" := (<span class="id">Lnorm</span> <span class="id">mu</span> <span class="id">p</span> <span class="id">f</span>).<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id">minkowski1</span> <span class="id">f</span> <span class="id">g</span> <span class="id">p</span> : <span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">f</span> -&gt; <span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">g</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">N_1</span>[(<span class="id">f</span> \+ <span class="id">g</span>)%<span class="id">R</span>] &lt;= '<span class="id">N_1</span>[<span class="id">f</span>] + '<span class="id">N_1</span>[<span class="id">g</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
<span class="id">move</span>=&gt; <span class="id">mf</span> <span class="id">mg</span>.<br/>
<span class="id">rewrite</span> !<span class="id">Lnorm1</span> -<span class="id">ge0_integralD</span>//; [|<span class="kwd">by</span> <span class="id">do</span> 2 <span class="id">apply</span>: <span class="id">measurableT_comp</span>..].<br/>
<span class="id">rewrite</span> <span class="id">ge0_le_integral</span>//.<br/>
- <span class="kwd">by</span> <span class="id">do</span> 2 <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">exact</span>: <span class="id">measurable_funD</span>.<br/>
- <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">measurableT_comp</span>/<span class="id">measurable_funD</span>; <span class="id">exact</span>/<span class="id">measurableT_comp</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">ler_norm_add</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">minkowski_lty</span> <span class="id">f</span> <span class="id">g</span> <span class="id">p</span> :<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">f</span> -&gt; <span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">g</span> -&gt; (1 &lt;= <span class="id">p</span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] &lt; +<span class="id">oo</span> -&gt; '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">g</span>] &lt; +<span class="id">oo</span> -&gt; '<span class="id">N_p</span>%:<span class="id">E</span>[(<span class="id">f</span> \+ <span class="id">g</span>)%<span class="id">R</span>] &lt; +<span class="id">oo</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
<span class="id">move</span>=&gt; <span class="id">mf</span> <span class="id">mg</span> <span class="id">p1</span> <span class="id">Nfoo</span> <span class="id">Ngoo</span>.<br/>
<span class="id">have</span> <span class="id">p0</span> : <span class="id">p</span> != 0%<span class="id">R</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">gt_eqF</span>// (<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id">p1</span>).<br/>
<span class="id">have</span> <span class="id">h</span> <span class="id">x</span> : (`| <span class="id">f</span> <span class="id">x</span> + <span class="id">g</span> <span class="id">x</span> | `^ <span class="id">p</span> &lt;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 `^ (<span class="id">p</span> - 1) * (`| <span class="id">f</span> <span class="id">x</span> | `^ <span class="id">p</span> + `| <span class="id">g</span> <span class="id">x</span> | `^ <span class="id">p</span>))%<span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> := <span class="id">convex_powR_abs_half</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; 2 * <span class="id">f</span> <span class="id">x</span>)%<span class="id">R</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; 2 * <span class="id">g</span> <span class="id">x</span>)%<span class="id">R</span> <span class="id">x</span> <span class="id">p1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id">normrM</span> (@<span class="id">ger0_norm</span> <span class="id">_</span> 2)// !<span class="id">mulrA</span> <span class="id">mulVf</span>// !<span class="id">mul1r</span> =&gt; /<span class="id">le_trans</span>; <span class="id">apply</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id">powRM</span>// !<span class="id">mulrA</span> -<span class="id">powR_inv1</span>// -<span class="id">powRD</span> ?<span class="id">pnatr_eq0</span> ?<span class="id">implybT</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">addrC</span> <span class="id">_</span> <span class="id">p</span>) -<span class="id">mulrDr</span>.<br/>
<span class="id">rewrite</span> <span class="id">unlock</span> (<span class="id">gt_eqF</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id">p1</span>))// <span class="id">poweR_lty</span>//.<br/>
<span class="id">pose</span> <span class="id">x</span> := \<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> (2 `^ (<span class="id">p</span> - 1) * (`|<span class="id">f</span> <span class="id">x</span>| `^ <span class="id">p</span> + `|<span class="id">g</span> <span class="id">x</span>| `^ <span class="id">p</span>))%:<span class="id">E</span>.<br/>
<span class="id">apply</span>: (@<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">ge0_le_integral</span>//=.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">t</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>// <span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span> =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">measurable_funD</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">t</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">mulr_ge0</span> ?<span class="id">addr_ge0</span> ?<span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurable_funM</span>/<span class="id">measurable_funD</span> =&gt; //;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; ? <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span>.<br/>
<span class="id">rewrite</span> {}/<span class="id">x</span>; <span class="id">under</span> <span class="id">eq_integral</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">EFinM</span>.<br/>
<span class="id">rewrite</span> <span class="id">ge0_integralZl_EFin</span> ?<span class="id">powR_ge0</span>//; <span class="id">last</span> 2 <span class="id">first</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">addr_ge0</span>// <span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurable_funD</span> =&gt; //;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>.<br/>
<span class="id">rewrite</span> <span class="id">lte_mul_pinfty</span> ?<span class="id">lee_fin</span> ?<span class="id">powR_ge0</span>//.<br/>
<span class="id">under</span> <span class="id">eq_integral</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">EFinD</span>.<br/>
<span class="id">rewrite</span> <span class="id">ge0_integralD</span>//; <span class="id">last</span> 4 <span class="id">first</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;- <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;- <span class="id">exact</span>/<span class="id">EFin_measurable_fun</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lte_add_pinfty</span>// -<span class="id">powR_Lnorm</span> ?(<span class="id">gt_eqF</span> (<span class="id">lt_trans</span> <span class="id">_</span> <span class="id">p1</span>))// <span class="id">poweR_lty</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">minkowski</span> <span class="id">f</span> <span class="id">g</span> <span class="id">p</span> :<br/>
&nbsp;&nbsp;<span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">f</span> -&gt; <span class="id">measurable_fun</span> <span class="id">setT</span> <span class="id">g</span> -&gt; (1 &lt;= <span class="id">p</span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;'<span class="id">N_p</span>%:<span class="id">E</span>[(<span class="id">f</span> \+ <span class="id">g</span>)%<span class="id">R</span>] &lt;= '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] + '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">g</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="id">move</span>=&gt; <span class="id">mf</span> <span class="id">mg</span>; <span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;-|<span class="id">p1</span>]; <span class="id">first</span> <span class="id">exact</span>: <span class="id">minkowski1</span>.<br/>
<span class="id">have</span> [-&gt;|<span class="id">Nfoo</span>] := <span class="id">eqVneq</span> '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] +<span class="id">oo</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addye</span> ?<span class="id">leey</span>// -<span class="id">ltNye</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> (<span class="id">Lnorm_ge0</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
<span class="id">have</span> [-&gt;|<span class="id">Ngoo</span>] := <span class="id">eqVneq</span> '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">g</span>] +<span class="id">oo</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addey</span> ?<span class="id">leey</span>// -<span class="id">ltNye</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> (<span class="id">Lnorm_ge0</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
<span class="id">have</span> <span class="id">Nfgoo</span> : '<span class="id">N_p</span>%:<span class="id">E</span>[(<span class="id">f</span> \+ <span class="id">g</span>)%<span class="id">R</span>] &lt; +<span class="id">oo</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">minkowski_lty</span>// ?<span class="id">ltW</span>// <span class="id">ltey</span>; [<span class="id">exact</span>: <span class="id">Nfoo</span>|<span class="id">exact</span>: <span class="id">Ngoo</span>].<br/>
<span class="id">suff</span> : '<span class="id">N_p</span>%:<span class="id">E</span>[(<span class="id">f</span> \+ <span class="id">g</span>)%<span class="id">R</span>] `^ <span class="id">p</span> &lt;= ('<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] + '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">g</span>]) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;'<span class="id">N_p</span>%:<span class="id">E</span>[(<span class="id">f</span> \+ <span class="id">g</span>)%<span class="id">R</span>] `^ <span class="id">p</span> * (<span class="id">fine</span> '<span class="id">N_p</span>%:<span class="id">E</span>[(<span class="id">f</span> \+ <span class="id">g</span>)%<span class="id">R</span>])^-1%:<span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> [-&gt; <span class="id">_</span>|<span class="id">Nfg0</span>] := <span class="id">eqVneq</span> '<span class="id">N_p</span>%:<span class="id">E</span>[(<span class="id">f</span> \+ <span class="id">g</span>)%<span class="id">R</span>] 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">adde_ge0</span> ?<span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">lee_pdivl_mulr</span> ?<span class="id">fine_gt0</span>// ?<span class="id">lt0e</span> ?<span class="id">Nfg0</span> ?<span class="id">Lnorm_ge0</span>//.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -{1}(@<span class="id">fineK</span> <span class="id">_</span> ('<span class="id">N_p</span>%:<span class="id">E</span>[(<span class="id">f</span> \+ <span class="id">g</span>)%<span class="id">R</span>] `^ <span class="id">p</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">fin_num_poweR</span>// <span class="id">ge0_fin_numE</span>// <span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -(<span class="id">invrK</span> (<span class="id">fine</span> <span class="id">_</span>)) <span class="id">lee_pdivr_mull</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">invr_gt0</span> <span class="id">fine_gt0</span>// (<span class="id">poweR_lty</span> <span class="id">_</span> <span class="id">Nfgoo</span>) <span class="id">andbT</span> <span class="id">poweR_gt0</span>//.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lt0e</span> <span class="id">Nfg0</span> <span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">fineK</span> ?<span class="id">ge0_fin_numE</span> ?<span class="id">Lnorm_ge0</span>// =&gt; /<span class="id">le_trans</span>; <span class="id">apply</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">lee_pdivr_mull</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">fine_gt0</span>// <span class="id">poweR_lty</span>// <span class="id">andbT</span> <span class="id">poweR_gt0</span>// <span class="id">lt0e</span> <span class="id">Nfg0</span> <span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">fineK</span>// 1?<span class="id">muleC</span>// <span class="id">fin_num_poweR</span>// <span class="id">ge0_fin_numE</span> ?<span class="id">Lnorm_ge0</span>.<br/>
<span class="id">have</span> <span class="id">p0</span> : (0 &lt; <span class="id">p</span>)%<span class="id">R</span> <span class="kwd">by</span> <span class="id">exact</span>: (<span class="id">lt_trans</span> <span class="id">_</span> <span class="id">p1</span>).<br/>
<span class="id">rewrite</span> <span class="id">powR_Lnorm</span> ?<span class="id">gt_eqF</span>//.<br/>
<span class="id">under</span> <span class="id">eq_integral</span> =&gt; <span class="id">x</span> <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> -<span class="id">mulr_powRB1</span>//.<br/>
<span class="id">apply</span>: (@<span class="id">le_trans</span> <span class="id">_</span> <span class="id">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> ((`|<span class="id">f</span> <span class="id">x</span>| + `|<span class="id">g</span> <span class="id">x</span>|) * `|<span class="id">f</span> <span class="id">x</span> + <span class="id">g</span> <span class="id">x</span>| `^ (<span class="id">p</span> - 1))%:<span class="id">E</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">ge0_le_integral</span>//.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; ? <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">mulr_ge0</span>// <span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">apply</span>: <span class="id">measurable_funM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">measurableT_comp</span>/<span class="id">measurable_funD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>/<span class="id">measurable_funD</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; ? <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">mulr_ge0</span>// <span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span>/<span class="id">measurableT_comp</span> =&gt; //; <span class="id">apply</span>: <span class="id">measurable_funM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">measurable_funD</span> =&gt; //; <span class="id">exact</span>: <span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>/<span class="id">measurable_funD</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; ? <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">ler_wpmul2r</span>// ?<span class="id">powR_ge0</span>// <span class="id">ler_norm_add</span>.<br/>
<span class="id">under</span> <span class="id">eq_integral</span>=&gt; ? <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">mulrDl</span> <span class="id">EFinD</span>.<br/>
<span class="id">rewrite</span> <span class="id">ge0_integralD</span>//; <span class="id">last</span> 4 <span class="id">first</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">mulr_ge0</span>// <span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">apply</span>: <span class="id">measurable_funM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>/<span class="id">measurable_funD</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">mulr_ge0</span>// <span class="id">powR_ge0</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span>: <span class="id">measurableT_comp</span> =&gt; //; <span class="id">apply</span>: <span class="id">measurable_funM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">measurableT_comp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>/<span class="id">measurable_funD</span>.<br/>
<span class="id">rewrite</span> [<span class="id">leRHS</span>](<span class="id">_</span> : <span class="id">_</span> = ('<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">f</span>] + '<span class="id">N_p</span>%:<span class="id">E</span>[<span class="id">g</span>]) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(\<span class="id">int</span>[<span class="id">mu</span>]<span class="id">_x</span> (`|<span class="id">f</span> <span class="id">x</span> + <span class="id">g</span> <span class="id">x</span>| `^ <span class="id">p</span>)%:<span class="id">E</span>) `^ `1-(<span class="id">p</span>^-1)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">muleDl</span>; <span class="id">last</span> 2 <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">fin_num_poweR</span>// -<span class="id">powR_Lnorm</span> ?<span class="id">gt_eqF</span>// <span class="id">fin_num_poweR</span>//.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ge0_fin_numE</span> ?<span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ge0_adde_def</span>// <span class="id">inE</span> <span class="id">Lnorm_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">lee_add</span>.<br/>
&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">h</span> := (@<span class="id">powR</span> <span class="id">R</span> ^~ (<span class="id">p</span> - 1) \<span class="id">o</span> <span class="id">normr</span> \<span class="id">o</span> (<span class="id">f</span> \+ <span class="id">g</span>))%<span class="id">R</span>; <span class="id">pose</span> <span class="id">i</span> := (<span class="id">f</span> \* <span class="id">h</span>)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> [<span class="id">leLHS</span>](<span class="id">_</span> : <span class="id">_</span> = '<span class="id">N_1</span>[<span class="id">i</span>]%<span class="id">R</span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Lnorm1</span>; <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">x</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normrM</span> (<span class="id">ger0_norm</span> (<span class="id">powR_ge0</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> * <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = '<span class="id">N_</span>(<span class="id">p</span> / (<span class="id">p</span> - 1))%:<span class="id">E</span>[<span class="id">h</span>]); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">unlock</span> <span class="id">mulf_eq0</span> <span class="id">gt_eqF</span>//= <span class="id">invr_eq0</span> <span class="id">subr_eq0</span> (<span class="id">gt_eqF</span> <span class="id">p1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">onemV</span> ?<span class="id">gt_eqF</span>// <span class="id">invf_div</span>; <span class="id">apply</span>: <span class="id">congr2</span>; <span class="id">last</span> <span class="kwd">by</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">congr</span> <span class="id">EFin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">norm_powR</span>// <span class="id">normr_id</span> -<span class="id">powRrM</span> <span class="id">mulrCA</span> <span class="id">divff</span> ?<span class="id">mulr1</span>//.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">subr_eq0</span> <span class="id">gt_eqF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: (@<span class="id">hoelder</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">p</span> (<span class="id">p</span> / (<span class="id">p</span> - 1))) =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exact</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>/<span class="id">measurable_funD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">divr_gt0</span>// <span class="id">subr_gt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invf_div</span> -<span class="id">onemV</span> ?<span class="id">gt_eqF</span>// <span class="id">addrCA</span> <span class="id">subrr</span> <span class="id">addr0</span>.<br/>
&nbsp;&nbsp;- <span class="id">pose</span> <span class="id">h</span> := (<span class="kwd">fun</span> <span class="id">x</span> =&gt; `|<span class="id">f</span> <span class="id">x</span> + <span class="id">g</span> <span class="id">x</span>| `^ (<span class="id">p</span> - 1))%<span class="id">R</span>; <span class="id">pose</span> <span class="id">i</span> := (<span class="id">g</span> \* <span class="id">h</span>)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> [<span class="id">leLHS</span>](<span class="id">_</span> : <span class="id">_</span> = '<span class="id">N_1</span>[<span class="id">i</span>]); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Lnorm1</span>; <span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">x</span> <span class="id">_</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normrM</span> <span class="id">norm_powR</span>// <span class="id">normr_id</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> * <span class="id">X</span>](<span class="id">_</span> : <span class="id">_</span> = '<span class="id">N_</span>((1 - <span class="id">p</span>^-1)^-1)%:<span class="id">E</span>[<span class="id">h</span>])//; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">unlock</span> <span class="id">invrK</span> <span class="id">invr_eq0</span> <span class="id">subr_eq0</span> <span class="id">eq_sym</span> <span class="id">invr_eq1</span> (<span class="id">gt_eqF</span> <span class="id">p1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">congr2</span>; <span class="id">last</span> <span class="kwd">by</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">eq_integral</span> =&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">congr</span> <span class="id">EFin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> -/(<span class="id">onem</span> <span class="id">p</span>^-1) <span class="id">onemV</span> ?<span class="id">gt_eqF</span>// <span class="id">norm_powR</span>// <span class="id">normr_id</span> -<span class="id">powRrM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invf_div</span> <span class="id">mulrCA</span> <span class="id">divff</span> ?<span class="id">subr_eq0</span> ?<span class="id">gt_eqF</span>// ?<span class="id">mulr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: (<span class="id">le_trans</span> (@<span class="id">hoelder</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">p</span> (1 - <span class="id">p</span>^-1)^-1 <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) =&gt; //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exact</span>/<span class="id">measurableT_comp_powR</span>/<span class="id">measurableT_comp</span>/<span class="id">measurable_funD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invr_gt0</span> <span class="id">onem_gt0</span>// <span class="id">invf_lt1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">invrK</span> <span class="id">addrCA</span> <span class="id">subrr</span> <span class="id">addr0</span>.<br/>
<span class="id">rewrite</span> -<span class="id">muleA</span>; <span class="id">congr</span> (<span class="id">_</span> * <span class="id">_</span>).<br/>
<span class="id">under</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> * <span class="id">_</span>]<span class="id">eq_integral</span>=&gt; <span class="id">x</span> <span class="id">_</span> <span class="id">do</span> <span class="id">rewrite</span> <span class="id">mulr_powRB1</span> ?<span class="id">subr_gt0</span>//.<br/>
<span class="id">rewrite</span> <span class="id">poweRD</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">poweRD_defE</span> <span class="id">gt_eqF</span> ?<span class="id">implyFb</span>// <span class="id">subr_gt0</span> <span class="id">invf_lt1</span>.<br/>
<span class="id">rewrite</span> <span class="id">poweRe1</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">integral_ge0</span> =&gt; <span class="id">x</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">powR_ge0</span>.<br/>
<span class="id">congr</span> (<span class="id">_</span> * <span class="id">_</span>); <span class="id">rewrite</span> <span class="id">poweRN</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">unlock</span> <span class="id">gt_eqF</span>// <span class="id">fine_poweR</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">powR_Lnorm</span> ?<span class="id">gt_eqF</span>// <span class="id">fin_num_poweR</span>// <span class="id">ge0_fin_numE</span> ?<span class="id">Lnorm_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">minkowski</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/tree/yoshihiro503%40generate_index">a fork of coq2html</a></div>
</body>
</html>
