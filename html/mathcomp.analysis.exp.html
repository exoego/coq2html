
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.exp</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.exp" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>

<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">
<h1 class="title">Module mathcomp.analysis.exp</h1>
<div class="coq">
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">all_ssreflect</span> <span class="id">ssralg</span> <span class="id">ssrint</span> <span class="id">ssrnum</span> <span class="id">matrix</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">interval</span> <span class="id">rat</span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.classical.boolp.html">boolp</a></span> <span class="id"><a href="mathcomp.classical.classical_sets.html">classical_sets</a></span> <span class="id"><a href="mathcomp.classical.functions.html">functions</a></span>.<br/>
<span class="kwd">From</span> <span class="id">mathcomp</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.classical.mathcomp_extra.html">mathcomp_extra</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.reals.html">reals</a></span> <span class="id"><a href="mathcomp.analysis.ereal.html">ereal</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.signed.html">signed</a></span> <span class="id"><a href="mathcomp.analysis.topology.html">topology</a></span> <span class="id"><a href="mathcomp.analysis.normedtype.html">normedtype</a></span> <span class="id"><a href="mathcomp.analysis.landau.html">landau</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html">sequences</a></span> <span class="id"><a href="mathcomp.analysis.derive.html">derive</a></span> <span class="id"><a href="mathcomp.analysis.realfun.html">realfun</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="mathcomp.analysis.itv.html">itv</a></span> <span class="id"><a href="mathcomp.analysis.convex.html">convex</a></span>.<br/>
<br/>
<pre class="ssrdoc">
              Theory of exponential/logarithm functions                    
                                                                           
This file defines exponential and logarithm functions and develops their   
theory.                                                                    
                                                                           
* Differentiability of series (Section PseriesDiff)                        
  This formalization is inspired by HOL-Light (transc.ml). This part is    
  temporary: it should be subsumed by a proper theory of power series.     
        pseries f x == [series f n * x ^ n]_n                              
  pseries_diffs f i == (i + 1) * f (i + 1)                                 
                                                                           
            expeR x == extended real number-valued exponential function    
               ln x == the natural logarithm                               
             s `^ r == power function, in ring_scope (assumes s &gt;= 0)      
             e `^ r == power function, in ereal_scope (assumes e &gt;= 0)     
         riemannR a == sequence n |-&gt; 1 / (n.+1) `^ a where a has a type   
                       of type realType                                    
      e `^?(r +? s) == validity condition for the distributivity of        
                       the power of the addition, in ereal_scope           
                                                                           
</pre>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="kwd">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="kwd">Implicit</span>.<br/>
<span class="id">Unset</span> <span class="id">Printing</span> <span class="kwd">Implicit</span> <span class="id">Defensive</span>.<br/>
<span class="kwd">Import</span> <span class="id">Order.TTheory</span> <span class="id">GRing.Theory</span> <span class="id">Num.Def</span> <span class="id">Num.Theory</span>.<br/>
<span class="kwd">Import</span> <span class="id">numFieldNormedType.Exports</span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">classical_set_scope</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ring_scope</span>.<br/>
<br/>
<span class="kwd">Reserved</span> <span class="kwd">Notation</span> "<span class="id">x</span> '`^?' ( <span class="id">r</span> +? <span class="id">s</span> )"<br/>
&nbsp;(<span class="id">format</span> "<span class="id">x</span>  '`^?' ( <span class="id">r</span>  +?  <span class="id">s</span> )", <span class="id">r</span> <span class="kwd">at</span> <span class="id">next</span> <span class="id">level</span>, <span class="kwd">at</span> <span class="id">level</span> 11) .<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">normr_nneg</span> (<span class="id">R</span> : <span class="id">numDomainType</span>) (<span class="id">x</span> : <span class="id">R</span>) : `|<span class="id">x</span>| \<span class="id">is</span> <span class="id">Num.nneg</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">qualifE</span>. Qed.</div>
#[<span class="id">global</span>] <span class="kwd">Hint</span> <span class="id">Resolve</span> <span class="id">normr_nneg</span> : <span class="id">core</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">PseriesDiff</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">realType</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">pseries</span> <span class="id">f</span> (<span class="id">x</span> : <span class="id">R</span>) := [<span class="id">series</span> <span class="id">f</span> <span class="id">i</span> * <span class="id">x</span> ^+ <span class="id">i</span>]<span class="id">_i</span>.<br/>
<br/>
<span class="kwd">Fact</span> <span class="id">is_cvg_pseries_inside_norm</span> <span class="id">f</span> (<span class="id">x</span> <span class="id">z</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">cvg</span> (<span class="id">pseries</span> <span class="id">f</span> <span class="id">x</span>) -&gt; `|<span class="id">z</span>| &lt; `|<span class="id">x</span>| -&gt; <span class="id">cvg</span> (<span class="id">pseries</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; `|<span class="id">f</span> <span class="id">i</span>|) <span class="id">z</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">move</span>=&gt; <span class="id">Cx</span> <span class="id">zLx</span>; <span class="id">have</span> [<span class="id">K</span> [<span class="id">Kreal</span> <span class="id">Kf</span>]] := <span class="id">cvg_series_bounded</span> <span class="id">Cx</span>.<br/>
<span class="id">have</span> <span class="id">Kzxn</span> <span class="id">n</span> : 0 &lt;= `|<span class="id">K</span> + 1| * `|<span class="id">z</span> ^+ <span class="id">n</span>| / `|<span class="id">x</span> ^+ <span class="id">n</span>|  <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">mulr_ge0</span>.<br/>
<span class="id">apply</span>: <span class="id">normed_cvg</span>.<br/>
<span class="id">apply</span>: <span class="id">series_le_cvg</span> <span class="id">Kzxn</span> <span class="id">_</span> <span class="id">_</span> =&gt; [//=| /= <span class="id">n</span>|].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">_</span> : `|<span class="id">_</span> * <span class="id">_</span>| = `|<span class="id">f</span> <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>| * `|<span class="id">z</span> ^+ <span class="id">n</span>| / `|<span class="id">x</span> ^+ <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbC">n</a></span>|); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id">normrM</span> <span class="id">normr_id</span> <span class="id">mulrAC</span> <span class="id">mulfK</span> // <span class="id">normr_eq0</span> <span class="id">expf_eq0</span> <span class="id">andbC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: <span class="id">ltrgt0P</span> <span class="id">zLx</span>; <span class="id">rewrite</span> //= <span class="id">normr_lt0</span>.<br/>
&nbsp;&nbsp;<span class="id">do</span>! (<span class="id">apply</span>: <span class="id">ler_pmul</span> || <span class="id">apply</span>: <span class="id">mulr_ge0</span> || <span class="id">rewrite</span> <span class="id">invr_ge0</span>) =&gt; //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span> <span class="id">Kf</span> =&gt; //; <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> (<span class="id">ler_norm</span> <span class="id">_</span>))// <span class="id">ltr_addl</span>.<br/>
<span class="id">have</span> <span class="id">F</span> : `|<span class="id">z</span> / <span class="id">x</span>| &lt; 1.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normrM</span> <span class="id"><a href="mathcomp.analysis.sequences.html#geometric">normfV</a></span> <span class="id">ltr_pdivr_mulr</span> ?<span class="id">mul1r</span> // (<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">zLx</span>).<br/>
<span class="id"><a href="mathcomp.classical.boolp.html#funext">rewrite</a></span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = <span class="id">geometric</span> `|<span class="id">K</span> + 1| `|<span class="id">z</span> / <span class="id">x</span>|); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span> /=; <span class="id">rewrite</span> <span class="id">normrM</span> <span class="id">exprMn</span> <span class="id">mulrA</span> <span class="id">normfV</span> !<span class="id">normrX</span> <span class="id">exprVn</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a name="z:16">is_cvg_geometric_series</a></span>; <span class="id">rewrite</span> <span class="id">normr_id</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fact</span> <span class="id">is_cvg_pseries_inside</span> <span class="id">f</span> (<span class="id">x</span> <span class="id">z</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">cvg</span> (<span class="id">pseries</span> <span class="id">f</span> <span class="id">x</span>) -&gt; `|<span class="id">z</span>| &lt; `|<span class="id">x</span>| -&gt; <span class="id">cvg</span> (<span class="id">pseries</span> <span class="id">f</span> <span class="id">z</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
<span class="id">move</span>=&gt; <span class="id">Cx</span> <span class="id">zLx</span>.<br/>
<span class="id">apply</span>: <span class="id">normed_cvg</span>; <span class="id">rewrite</span> /<span class="id">normed_series_of</span> /=.<br/>
<span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = (<span class="kwd">fun</span> <span class="id">i</span> =&gt; `|<span class="id">f</span> <span class="id">i</span>| * `|<span class="id">z</span>| ^+ <span class="id">i</span>)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> <span class="id">normrM</span> <span class="id">normrX</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">is_cvg_pseries_inside_norm</span> <span class="id">Cx</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">normr_id</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">pseries_diffs</span> (<span class="id">f</span> : <span class="id">nat</span> -&gt; <span class="id">R</span>) <span class="id">i</span> := <span class="id">i</span>.+1%:<span class="id">R</span> * <span class="id">f</span> <span class="id">i</span>.+1.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">pseries_diffsN</span> (<span class="id">f</span> : <span class="id">nat</span> -&gt; <span class="id">R</span>) :  <span class="id">pseries_diffs</span> (- <span class="id">f</span>) = -(<span class="id">pseries_diffs</span> <span class="id">f</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id">pseries_diffs</span> /= -<span class="id">mulrN</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">pseries_diffs_inv_fact</span> :<br/>
&nbsp;&nbsp;<span class="id">pseries_diffs</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">n</span>`!%:<span class="id">R</span>)^-1) = (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">n</span>`!%:<span class="id">R</span>)^-1 : <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
<span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">pseries_diffs</span> <span class="id">factS</span> <span class="id">natrM</span> <span class="id">invfM</span> <span class="id">mulrA</span> <span class="id">mulfV</span> ?<span class="id">mul1r</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">pseries_diffs_sumE</span> <span class="id">n</span> <span class="id">f</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;\<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">n</span>)  <span class="id">pseries_diffs</span> <span class="id">f</span> <span class="id">i</span> * <span class="id">x</span> ^+ <span class="id">i</span> =<br/>
&nbsp;&nbsp;(\<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">n</span>) <span class="id">i</span>%:<span class="id">R</span> * <span class="id">f</span> <span class="id">i</span> * <span class="id">x</span> ^+ <span class="id">i</span>.-1) + <span class="id">n</span>%:<span class="id">R</span> * <span class="id">f</span> <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>.-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
<span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">case</a></span>: <span class="id">n</span> =&gt; [|<span class="id">n</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">big_nil</span> !<span class="id">mul0r</span> <span class="id">add0r</span>.<br/>
<span class="id">under</span> <span class="id">eq_bigr</span> <span class="id">do</span> <span class="id">unfold</span> <span class="id">pseries_diffs</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">big_nat_recr</span> //= <span class="id">big_nat_recl</span> //= !<span class="id">mul0r</span> <span class="id">add0r</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">pseries_diffs_equiv</a></span> <span class="id">f</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span> <span class="id">i</span> := <span class="id">i</span>%:<span class="id">R</span> * <span class="id">f</span> <span class="id">i</span> * <span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">x</a></span> ^+ <span class="id">i</span>.-1 <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">cvg</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span> <span class="id">f</span>) <span class="id">x</span>) -&gt; <span class="id">series</span> <span class="id">s</span> --&gt;<br/>
&nbsp;&nbsp;<span class="id">lim</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span> <span class="id">f</span>) <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
<span class="id">move</span>=&gt; <span class="id">s</span> <span class="id">Cx</span>; <span class="id">rewrite</span> -[<span class="id">lim</span> <span class="id">_</span>]<span class="id">subr0</span> /<span class="id">pseries</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> --&gt; <span class="id">_</span>]/<span class="id">series</span> /=.<br/>
<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> --&gt; <span class="id">_</span>](<span class="id">_</span> : <span class="id">_</span> = (<span class="kwd">fun</span> <span class="id">n</span> =&gt; \<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pseries_diffs</span> <span class="id">f</span> <span class="id">i</span> * <span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs_sumE">x</a></span> ^+ <span class="id">i</span> - <span class="id">n</span>%:<span class="id">R</span> * <span class="id">f</span> <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>.-1)); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">funeqE</span> =&gt; <span class="id">n</span>; <span class="id">rewrite</span> <span class="id">pseries_diffs_sumE</span> <span class="id">addrK</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">cvgB</span> =&gt; //; <span class="id">rewrite</span> -<span class="id">cvg_shiftS</span>; <span class="id">exact</span>: <span class="id">cvg_series_cvg_0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">is_cvg_pseries_diffs_equiv</span> <span class="id"><a name="i:54">f</a></span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">cvg</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span> <span class="id">f</span>) <span class="id">x</span>) -&gt; <span class="id">cvg</span> [<span class="id">series</span> <span class="id">i</span>%:<span class="id">R</span> * <span class="id">f</span> <span class="id">i</span> * <span class="id">x</span> ^+ <span class="id">i</span>.-1]<span class="id">_i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="kwd">by</span> <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">Cx</span>; <span class="id">have</span> := <span class="id"><a name="z:58">pseries_diffs_equiv</a></span> <span class="id">Cx</span>; <span class="id"><a name="i:60">move</a></span>/(<span class="id">cvg_lim</span> <span class="id">_</span>) =&gt; -&gt; //.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">pseries_diffs_P1</span> <span class="id">m</span> (<span class="id">z</span> <span class="id">h</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;\<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">m</span>) ((<span class="id">h</span> + <span class="id">z</span>) ^+ (<span class="id">m</span> - <span class="id">i</span>) * <span class="id">z</span> ^+ <span class="id">i</span> - <span class="id">z</span> ^+ <span class="id">m</span>) =<br/>
&nbsp;&nbsp;\<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">m</span>) <span class="id">z</span> ^+ <span class="id">i</span> * ((<span class="id">h</span> + <span class="id">z</span>) ^+ (<span class="id">m</span> - <span class="id">i</span>) - <span class="id">z</span> ^+ (<span class="id">m</span> - <span class="id">i</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
<span class="id">rewrite</span> !<span class="id">big_mkord</span>; <span class="id">apply</span>: <span class="id">eq_bigr</span> =&gt; <span class="id">i</span> <span class="id">_</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrDr</span> <span class="id">mulrN</span> -<span class="id">exprD</span> <span class="id">mulrC</span> <span class="id">addnC</span> <span class="id">subnK</span> // <span class="id">ltnW</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">pseries_diffs_P2</span> <span class="id">n</span> (<span class="id">z</span> <span class="id">h</span> : <span class="id">R</span>) :<br/>
&nbsp;&nbsp;<span class="id">h</span> != 0 -&gt;<br/>
&nbsp;&nbsp;((<span class="id">h</span> + <span class="id">z</span>) ^+ <span class="id">n</span> - (<span class="id">z</span> ^+ <span class="id">n</span>)) / <span class="id">h</span> - <span class="id">n</span>%:<span class="id">R</span> * <span class="id">z</span> ^+ <span class="id">n</span>.-1 =<br/>
&nbsp;&nbsp;<span class="id">h</span> * \<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">n</span>.-1) <span class="id">z</span> ^+ <span class="id">i</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<span class="id">sum_</span>(0 &lt;= <span class="id">j</span> &lt; <span class="id">n</span>.-1 - <span class="id">i</span>) (<span class="id">h</span> + <span class="id">z</span>) ^+ <span class="id">j</span> * <span class="id">z</span> ^+ (<span class="id">n</span>.-2 - <span class="id">i</span> - <span class="id">j</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
<span class="id">move</span>=&gt; <span class="id">hNZ</span>; <span class="id">apply</span>: (<span class="id">mulfI</span> <span class="id">hNZ</span>).<br/>
<span class="id">rewrite</span> <span class="id">mulrBr</span> <span class="id">mulrC</span> <span class="id">divfK</span> //.<br/>
<span class="id">case</span>: <span class="id">n</span> =&gt; [|<span class="id">n</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">expr0</span> !(<span class="id">mul0r</span>, <span class="id">mulr0</span>, <span class="id">subr0</span>, <span class="id">subrr</span>, <span class="id">big_geq</span>).<br/>
<span class="id">rewrite</span> <span class="id">subrXX</span> <span class="id">addrK</span> -<span class="id">mulrBr</span>; <span class="id">congr</span> (<span class="id">_</span> * <span class="id">_</span>).<br/>
<span class="id">rewrite</span> -(<span class="id">big_mkord</span> <span class="id">xpredT</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; (<span class="id">h</span> + <span class="id">z</span>) ^+ (<span class="id">n</span> - <span class="id">i</span>) * <span class="id">z</span> ^+ <span class="id">i</span>)).<br/>
<span class="id">rewrite</span> <span class="id">big_nat_recr</span> //= <span class="id">subnn</span> <span class="id">expr0</span> -<span class="id">addrA</span> -<span class="id">mulrBl</span>.<br/>
<span class="id">rewrite</span> -<span class="id">nat1r</span> <span class="id">opprD</span> <span class="id">addrA</span> <span class="id">subrr</span> <span class="id">sub0r</span> <span class="id">mulNr</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulr_natl</span> -[<span class="kwd">in</span> <span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> *+ <span class="id">X</span>](<span class="id">subn0</span> <span class="id">n</span>) -<span class="id">sumr_const_nat</span> -<span class="id">sumrB</span>.<br/>
<span class="id">rewrite</span> <span class="id">pseries_diffs_P1</span> <span class="id">mulr_sumr</span> !<span class="id">big_mkord</span>; <span class="id">apply</span>: <span class="id">eq_bigr</span> =&gt; <span class="id">i</span> <span class="id">_</span>.<br/>
<span class="id">rewrite</span> <span class="id">mulrCA</span>; <span class="id">congr</span> (<span class="id">_</span> * <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id">subrXX</span> <span class="id">addrK</span> <span class="id">big_nat_rev</span> /= <span class="id">big_mkord</span>; <span class="id">congr</span> (<span class="id"><a name="PseriesDiff.pseries_diffs_P3">_</a></span> * <span class="id">_</span>).<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a name="z:79">eq_bigr</a></span> =&gt; <span class="id"><a name="K:82">k</a></span> <span class="id">_</span>; <span class="id">rewrite</span> -!<span class="id">predn_sub</span> <span class="id">subKn</span> // -<span class="id">subnS</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id">pseries_diffs_P3</span> (<span class="id">z</span> <span class="id">h</span> : <span class="id">R</span>) <span class="id">n</span> <span class="id">K</span> :<br/>
&nbsp;&nbsp;<span class="id">h</span> != 0 -&gt; `|<span class="id">z</span>| &lt;= <span class="id">K</span> -&gt; `|<span class="id">h</span> + <span class="id">z</span>| &lt;= <span class="id">K</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;`|((<span class="id">h</span> +<span class="id">z</span>) ^+ <span class="id">n</span> - <span class="id">z</span> ^+ <span class="id">n</span>) / <span class="id">h</span> - <span class="id">n</span>%:<span class="id">R</span> * <span class="id">z</span> ^+ <span class="id">n</span>.-1|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="id">n</span>%:<span class="id">R</span> * <span class="id">n</span>.-1%:<span class="id">R</span> * <span class="id">K</span> ^+ <span class="id">n</span>.-2 * `|<span class="id">h</span>|.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
<span class="id">move</span>=&gt; <span class="id">hNZ</span> <span class="id">zLK</span> <span class="id">zhLk</span>.<br/>
<span class="id">rewrite</span> <span class="id">pseries_diffs_P2</span>// <span class="id">normrM</span> <span class="id">mulrC</span>.<br/>
<span class="id">rewrite</span> <span class="id">ler_pmul2r</span> ?<span class="id">normr_gt0</span>//.<br/>
<span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_norm_sum</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>))//.<br/>
<span class="id">rewrite</span> -<span class="id">mulrA</span> <span class="id">mulrC</span> -<span class="id">mulrA</span> <span class="id">mulr_natl</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> *+ <span class="id">X</span>]<span class="id">subn0</span> -<span class="id">sumr_const_nat</span>.<br/>
<span class="id">apply</span> <span class="id">ler_sum_nat</span> =&gt; <span class="id">i</span> /=.<br/>
<span class="id">case</span>: <span class="id">n</span> =&gt; //= <span class="id">n</span> <span class="id">ni</span>.<br/>
<span class="id">rewrite</span> <span class="id">normrM</span>.<br/>
<span class="id">pose</span> <span class="id">d</span> := (<span class="id">n</span>.-1 - <span class="id">i</span>)%<span class="id">nat</span>.<br/>
<span class="id">rewrite</span> -[(<span class="id">n</span> - <span class="id">i</span>)%<span class="id">nat</span>]<span class="id">prednK</span> ?<span class="id">subn_gt0</span>// <span class="id">predn_sub</span> -/<span class="id">d</span>.<br/>
<span class="id">rewrite</span> -(<span class="id">subnK</span> (<span class="id">_</span> : <span class="id">i</span> &lt;= <span class="id">n</span>.-1)%<span class="id">nat</span>) -/<span class="id">d</span>; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ltnS</span> <span class="id">prednK</span>// (<span class="id">leq_ltn_trans</span> <span class="id">_</span> <span class="id">ni</span>).<br/>
<span class="id">rewrite</span> <span class="id">addnC</span> <span class="id">exprD</span> <span class="id">mulrAC</span> -<span class="id">mulrA</span>.<br/>
<span class="id">apply</span>: <span class="id">ler_pmul</span> =&gt; //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normrX</span> <span class="id">ler_expn2r</span>// <span class="id">qualifE</span> (<span class="id">le_trans</span> <span class="id">_</span> <span class="id">zLK</span>).<br/>
<span class="id">apply</span>: <span class="id">le_trans</span> (<span class="id">_</span> : <span class="id">d</span>.+1%:<span class="id">R</span> * <span class="id">K</span> ^+ <span class="id">d</span> &lt;= <span class="id">_</span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">ler_wpmul2r</span> //; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">exprn_ge0</span> // (<span class="id">le_trans</span> <span class="id">_</span> <span class="id">zLK</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_nat</span> <span class="id">ltnS</span> /<span class="id">d</span> -<span class="id">subn1</span> -<span class="id">subnDA</span> <span class="id">leq_subr</span>.<br/>
<span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_norm_sum</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>))//.<br/>
<span class="id">rewrite</span> <span class="id">mulr_natl</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> *+ <span class="id">X</span>]<span class="id">subn0</span> -<span class="id">sumr_const_nat</span> <span class="id">ler_sum_nat</span>//= =&gt; <span class="id">j</span> <span class="id">jd1</span>.<br/>
<span class="id">rewrite</span> -[<span class="kwd">in</span> <span class="id">leRHS</span>](<span class="id">subnK</span> (<span class="id">_</span> : <span class="id">j</span> &lt;= <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#qualifE">d</a></span>)%<span class="id">nat</span>) -1?<span class="id">ltnS</span> // <span class="id">addnC</span> <span class="id">exprD</span> <span class="id">normrM</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_pmul</span>// <span class="id"><a href="mathcomp.analysis.exp.html#PseriesDiff.R">normrX</a></span> <span class="id"><a name="K:86">ler_expn2r</a></span>// <span class="id"><a href="mathcomp.analysis.exp.html#pseries">qualifE</a></span> (<span class="id">le_trans</span> <span class="id"><a href="mathcomp.analysis.topology.html#cvg">_</a></span> <span class="id">zLK</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">pseries_snd_diffs</span> (<span class="id"><a href="mathcomp.analysis.topology.html#cvg">c</a></span> : <span class="id">R</span>^<span class="id">nat</span>) <span class="id">K</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;<span class="id">cvg</span> (<span class="id">pseries</span> <span class="id">c</span> <span class="id">K</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">cvg</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span> <span class="id">c</span>) <span class="id">K</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">cvg</span> (<span class="id">pseries</span> (<span class="id"><a name="x:88">pseries_diffs</a></span> (<span class="id">pseries_diffs</span> <span class="id"><a href="mathcomp.analysis.topology.html#lim">c</a></span>)) <span class="id">K</span>) -&gt;<br/>
&nbsp;&nbsp;`|<span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">x</a></span>| &lt; `|<span class="id">K</span>| -&gt;<br/>
&nbsp;&nbsp;<span class="id">is_derive</span> <span class="id">x</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">lim</span> (<span class="id">pseries</span> <span class="id">c</span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lim</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span> <span class="id">c</span>) <span class="id">x</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
<span class="id">move</span>=&gt; <span class="id">Ck</span> <span class="id">CdK</span> <span class="id">CddK</span> <span class="id">xLK</span>; <span class="id">rewrite</span> /<span class="id">pseries</span>.<br/>
<span class="id">set</span> <span class="id">s</span> := (<span class="kwd">fun</span> <span class="id">n</span> : <span class="id">nat</span> =&gt; <span class="id">_</span>); <span class="id">set</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">x0</span> =&gt; <span class="id">_</span>).<br/>
<span class="id">suff</span> <span class="id">hfxs</span> : <span class="id">h</span>^-1 *: (<span class="id">f</span> (<span class="id">h</span> + <span class="id">x</span>) - <span class="id">f</span> <span class="id">x</span>) @[<span class="id">h</span> --&gt; 0^'] --&gt; <span class="id">lim</span> (<span class="id">series</span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">F</span> : <span class="id">f</span>^`() <span class="id">x</span> = <span class="id">lim</span> (<span class="id">series</span> <span class="id"><a href="mathcomp.analysis.derive.html#derivable">s</a></span>) <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">cvg_lim</span> <span class="id">hfxs</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">Df</span> : <span class="id">derivable</span> <span class="id">f</span> <span class="id">x</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move</span>: <span class="id">hfxs</span>; <span class="id">rewrite</span> /<span class="id">derivable</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> @ <span class="id">_</span>](<span class="id">_</span> : <span class="id">_</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> =&gt; <span class="id">h</span>^-1 *: (<span class="id">f</span> (<span class="id">h</span>%:<span class="id">A</span> + <span class="id">x</span>) - <span class="id">f</span> <span class="id">x</span>))) /=; <span class="id"><a href="mathcomp.analysis.topology.html#cvg_lim">last</a></span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span> //=; <span class="id">rewrite</span> [<span class="id">i</span>%:<span class="id"><a href="mathcomp.analysis.derive.html#derive1E">A</a></span>]<span class="id">mulr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">move</span>=&gt; /(<span class="id">cvg_lim</span> <span class="id">_</span>) -&gt; //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">constructor</span>; [<span class="id"><a href="mathcomp.analysis.topology.html#cvg">exact</a></span>: <span class="id">Df</span>|<span class="id">rewrite</span> -<span class="id">derive1E</span>].<br/>
<span class="id">pose</span> <span class="id">sx</span> := <span class="kwd">fun</span> <span class="id">n</span> : <span class="id">nat</span> =&gt; <span class="id">c</span> <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>.<br/>
<span class="id">have</span> <span class="id"><a name="n:101">Csx</a></span> : <span class="id">cvg</span> (<span class="id">pseries</span> <span class="id">c</span> <span class="id">x</span>) <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">is_cvg_pseries_inside</span> <span class="id"><a href="mathcomp.analysis.sequences.html#series">Ck</a></span> <span class="id">_</span>.<br/>
<span class="id">pose</span> <span class="id">shx</span> := <span class="kwd">fun</span> <span class="id">h</span> (<span class="id">n</span> : <span class="id">nat</span>) =&gt; <span class="id">c</span> <span class="id"><a href="mathcomp.analysis.topology.html#lim">n</a></span> * (<span class="id"><a href="mathcomp.analysis.sequences.html#series">h</a></span> + <span class="id">x</span>) ^+ <span class="id">n</span>.<br/>
<span class="id">suff</span> <span class="id">Cc</span> : <span class="id">lim</span> (<span class="id">h</span>^-1 *: (<span class="id">series</span> (<span class="id">shx</span> <span class="id">h</span> - <span class="id">sx</span>))) @[<span class="id">h</span> --&gt; 0^'] --&gt; <span class="id">lim</span> (<span class="id">series</span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">cvg_sub0</span> <span class="id">Cc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">cvgrPdist_lt</span> =&gt; <span class="id">eps</span> <span class="id">eps_gt0</span> /=.<br/>
&nbsp;&nbsp;<span class="id">near</span>=&gt; <span class="id">h</span>; <span class="id">rewrite</span> <span class="id">sub0r</span> <span class="id">normrN</span> /=.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">eps_gt0</span>)//.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normr_le0</span> <span class="id">subr_eq0</span> -/<span class="id">sx</span> -/(<span class="id">shx</span> <span class="id">_</span>); <span class="id">apply</span>/<span class="id">eqP</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">Cshx</span>' : <span class="id">cvg</span> (<span class="id">series</span> (<span class="id">shx</span> <span class="id">h</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">is_cvg_pseries_inside</span> <span class="id">Ck</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_lt_trans</span> (<span class="id">ler_norm_add</span> <span class="id">_</span> <span class="id">_</span>))// -(<span class="id">subrK</span>  `|<span class="id">x</span>| `|<span class="id">K</span>|) <span class="id">ltr_add2r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">near</span>: <span class="id">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">nbhs_ballP</span> =&gt; /=; <span class="kwd">exists</span> ((`|<span class="id">K</span>| - `|<span class="id">x</span>|) /2%:<span class="id">R</span>) =&gt; /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">divr_gt0</span> // <span class="id">subr_gt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">t</span>; <span class="id">rewrite</span> /<span class="id">ball</span> /= <span class="id">sub0r</span> <span class="id">normrN</span> =&gt; <span class="id">H</span> <span class="id">tNZ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">H</span>)// <span class="id">ler_pdivr_mulr</span> // <span class="id">mulr2n</span> <span class="id">mulrDr</span> <span class="id">mulr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_paddr</span> // <span class="id">subr_ge0</span> <span class="id">ltW</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">limZr</span>; [<span class="id">rewrite</span> <span class="id">lim_seriesB</span>|<span class="id">exact</span>: <span class="id">is_cvg_seriesB</span>].<br/>
<span class="id">apply</span>: <span class="id">cvg_zero</span> =&gt; /=.<br/>
<span class="id">suff</span> <span class="id">Cc</span> : <span class="id">lim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">series</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">c</span> <span class="id"><a href="mathcomp.analysis.exp.html#PseriesDiff.R">n</a></span> * (((<span class="id">h</span> + <span class="id">x</span>) ^+ <span class="id">n</span> - <span class="id">x</span> ^+ <span class="id">n</span>) / <span class="id">h</span> - <span class="id">n</span>%:<span class="id">R</span> * <span class="id">x</span> ^+ <span class="id">n</span>.-1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@[<span class="id">h</span> --&gt; 0^'] --&gt; (0 : <span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">cvg_sub0</span> <span class="id">Cc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">cvgrPdist_lt</span> =&gt; <span class="id">eps</span> <span class="id">eps_gt0</span> /=.<br/>
&nbsp;&nbsp;<span class="id">near</span>=&gt; <span class="id">h</span>; <span class="id">rewrite</span> <span class="id">sub0r</span> <span class="id">normrN</span> /=.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_lt_trans</span> <span class="id"><a href="mathcomp.analysis.exp.html#is_cvg_pseries_inside">_</a></span> <span class="id">eps_gt0</span>)// <span class="id">normr_le0</span> <span class="id">subr_eq0</span>; <span class="id">apply</span>/<span class="id">eqP</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">Cs</span> : <span class="id">cvg</span> (<span class="id">series</span> <span class="id">s</span>) <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">is_cvg_pseries_inside</span> <span class="id">CdK</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">Cs1</span> := <span class="id">is_cvg_pseries_diffs_equiv</span> <span class="id">Cs</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">Fs1</span> := <span class="id">pseries_diffs_equiv</span> <span class="id">Cs</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> <span class="id">s1</span> := (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">_</span>) <span class="kwd">in</span> <span class="id">Cs1</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">Cshx</span> : <span class="id">cvg</span> (<span class="id">series</span> (<span class="id">shx</span> <span class="id">h</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">is_cvg_pseries_inside</span> <span class="id">Ck</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_lt_trans</span> (<span class="id">ler_norm_add</span> <span class="id">_</span> <span class="id">_</span>))// -(<span class="id">subrK</span>  `|<span class="id">x</span>| `|<span class="id">K</span>|) <span class="id">ltr_add2r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">near</span>: <span class="id">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">nbhs_ballP</span> =&gt; /=; <span class="kwd">exists</span> ((`|<span class="id">K</span>| - `|<span class="id"><a href="mathcomp.analysis.topology.html#ball">x</a></span>|) / 2%:<span class="id">R</span>) =&gt; /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">divr_gt0</span> // <span class="id">subr_gt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move</span>=&gt; <span class="id">t</span>; <span class="id">rewrite</span> /<span class="id">ball</span> /= <span class="id">sub0r</span> <span class="id">normrN</span> =&gt; <span class="id">H</span> <span class="id">tNZ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">H</span>)// <span class="id">ler_pdivr_mulr</span> // <span class="id">mulr2n</span> <span class="id">mulrDr</span> <span class="id">mulr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ler_paddr</span> // <span class="id">subr_ge0</span> <span class="id">ltW</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">C1</span> := <span class="id"><a href="mathcomp.analysis.sequences.html#series">is_cvg_seriesB</a></span> <span class="id">Cshx</span> <span class="id">Csx</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id"><a href="mathcomp.analysis.sequences.html#series">Ckf</a></span> := @<span class="id">is_cvg_seriesZ</span> <span class="id">_</span> <span class="id">_</span> <span class="id">h</span>^-1 <span class="id">C1</span>.<br/>
&nbsp;&nbsp;<span class="id"><a href="mathcomp.analysis.topology.html#lim">have</a></span> <span class="id"><a href="mathcomp.analysis.sequences.html#series">Cu</a></span> : (<span class="id">series</span> (<span class="id">h</span>^-1 *: (<span class="id">shx</span> <span class="id">h</span> - <span class="id">sx</span>)) - <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> <span class="id">s1</span>) <span class="id">x0</span> @[<span class="id">x0</span> --&gt; \<span class="id">oo</span>] --&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lim</span> (<span class="id">series</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.Init.Datatypes.html#nat">h</a></span>^-1 *: (<span class="id">shx</span> <span class="id">h</span> - <span class="id">sx</span>))) - <span class="id">lim</span> (<span class="id">series</span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">cvgB</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span> <span class="id">w</span> := (<span class="kwd">fun</span> <span class="id">n</span> : <span class="id">nat</span> =&gt; <span class="id">_</span> <span class="kwd">in</span> <span class="id">RHS</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> -&gt; : <span class="id">w</span> = <span class="id">h</span>^-1 *: (<span class="id">shx</span> <span class="id">h</span> - <span class="id">sx</span>)  - <span class="id">s1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">funext</span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> !<span class="id">fctE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">w</span> /<span class="id">shx</span> /<span class="id">sx</span> /<span class="id">s1</span> /= <span class="id">mulrBr</span>; <span class="id">congr</span> (<span class="id">_</span> - <span class="id">_</span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrCA</span> !<span class="id">mulrA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">mulrBr</span> [<span class="id">RHS</span>]<span class="id">mulrCA</span> [<span class="id">_</span>^-1 * <span class="id">_</span>]<span class="id">mulrC</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> [<span class="id">X</span> <span class="kwd">in</span> <span class="id">X</span> <span class="id">h</span> = <span class="id">_</span>]/+%<span class="id">R</span> /= [<span class="id">X</span> <span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.sequences.html#series">_</a></span> + <span class="id">X</span> <span class="id">h</span> = <span class="id">_</span>]/-%<span class="id">R</span> /=.<br/>
&nbsp;&nbsp;<span class="id">have</span> -&gt; : <span class="id"><a href="mathcomp.analysis.sequences.html#series">series</a></span> (<span class="id">h</span>^-1 *: (<span class="id">shx</span> <span class="id">h</span> - <span class="id"><a href="mathcomp.classical.boolp.html#funext">sx</a></span>) - <span class="id">s1</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">series</span> (<span class="id">h</span>^-1 *: (<span class="id">shx</span> <span class="id">h</span> - <span class="id">sx</span>)) - (<span class="id">series</span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.sequences.html#series">funext</a></span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id">series</span> /= <span class="id">sumrB</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> -&gt; : <span class="id">h</span>^-1 *: <span class="id">series</span> (<span class="id">shx</span> <span class="id">h</span> - <span class="id">sx</span>) = <span class="id">series</span> (<span class="id">h</span>^-1 *: (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#esym">shx</a></span> <span class="id">h</span> - <span class="id">sx</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id">series</span> /= -<span class="id">scaler_sumr</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span>/<span class="id">esym</span>/<span class="id">cvg_lim</span>.<br/>
<span class="id">pose</span> <span class="id">r</span> := (`|<span class="id">x</span>| + `|<span class="id">K</span>|) / 2%:<span class="id">R</span>.<br/>
<span class="id">have</span> <span class="id">xLr</span> : `|<span class="id">x</span>| &lt; <span class="id">r</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltr_pdivl_mulr</span> // <span class="id">mulr2n</span> <span class="id">mulrDr</span> <span class="id">mulr1</span> <span class="id">ltr_add2l</span>.<br/>
<span class="id">have</span> <span class="id">rLx</span> : <span class="id">r</span> &lt; `|<span class="id">K</span>| <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltr_pdivr_mulr</span> // <span class="id">mulr2n</span> <span class="id">mulrDr</span> <span class="id">mulr1</span> <span class="id">ltr_add2r</span>.<br/>
<span class="id">have</span> <span class="id">r_gt0</span> : 0 &lt; <span class="id">r</span> <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">le_lt_trans</span> <span class="id">xLr</span>.<br/>
<span class="id">have</span> <span class="id">rNZ</span> : <span class="id">r</span> != 0<span class="kwd">by</span> <span class="id">case</span>: <span class="id">ltrgt0P</span> <span class="id">r_gt0</span>.<br/>
<span class="id">apply</span>: (@<span class="id">lim_cvg_to_0_linear</span> <span class="id">_</span><br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; `|<span class="id">c</span> <span class="id">n</span>| * <span class="id">n</span>%:<span class="id">R</span> * (<span class="id">n</span>.-1)%:<span class="id">R</span> * <span class="id">r</span> ^+ <span class="id">n</span>.-2)<br/>
&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">h</span> <span class="id">n</span> =&gt; <span class="id">c</span> <span class="id">n</span> * (((<span class="id">h</span> + <span class="id">x</span>) ^+ <span class="id">n</span> - <span class="id">x</span> ^+ <span class="id">n</span>) / <span class="id">h</span> - <span class="id">n</span>%:<span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">R</a></span> * <span class="id">x</span> ^+ <span class="id">n</span>.-1))<br/>
&nbsp;&nbsp;(<span class="id">r</span> - `|<span class="id">x</span>|)); <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">subr_gt0</span>.<br/>
- <span class="id">have</span> : <span class="id">cvg</span> [<span class="id">series</span> `|<span class="id">pseries_diffs</span> (<span class="id">pseries_diffs</span> <span class="id">c</span>) <span class="id">n</span>| * <span class="id">r</span> ^+ <span class="id">n</span>]<span class="id">_n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>: <span class="id">is_cvg_pseries_inside_norm</span> <span class="id"><a name="n:122">CddK</a></span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ger0_norm</span> // <span class="id">ltW</span> // (<span class="id">le_lt_trans</span> <span class="id">_</span> <span class="id">xLr</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> -&gt; : (<span class="kwd">fun</span> <span class="id">n</span> =&gt; `|<span class="id">pseries_diffs</span> (<span class="id">pseries_diffs</span> <span class="id">c</span>) <span class="id">n</span>| * <span class="id">r</span> ^+ <span class="id">n</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">pseries_diffs</span> (<span class="id">pseries_diffs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">m</span> =&gt; `|<span class="id">c</span> <span class="id">m</span>|)) <span class="id">n</span> * <span class="id">r</span> ^+ <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">pseries_diffs</span> !<span class="id">normrM</span> !<span class="id">mulrA</span> <span class="id">ger0_norm</span> // <span class="id">ger0_norm</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; /<span class="id">is_cvg_pseries_diffs_equiv</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">pseries_diffs</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> -&gt; : (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">n</span>%:<span class="id">R</span> * ((<span class="id">n</span>.+1)%:<span class="id">R</span> * `|<span class="id">c</span> <span class="id">n</span>.+1|) * <span class="id">r</span> ^+ <span class="id">n</span>.-1) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">pseries_diffs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs">m</a></span> =&gt; (<span class="id">m</span>.-1)%:<span class="id">R</span> * `|<span class="id">c</span> <span class="id">m</span>| * <span class="id">r</span>^-1) <span class="id">n</span> * <span class="id">r</span> ^+ <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">pseries_diffs</span> /= <span class="id">mulrA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case</span>: <span class="id">n</span> =&gt; [|<span class="id">n</span> /=]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> !(<span class="id">mul0r</span>, <span class="id">mulr0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> [<span class="id">_</span>%:<span class="id">R</span> *<span class="id">_</span>]<span class="id">mulrC</span> !<span class="id">mulrA</span> -[<span class="id">RHS</span>]<span class="id">mulrA</span> <span class="id">exprS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">_</span>^-1 * <span class="id">_</span>]<span class="id">mulrA</span> <span class="id">mulVf</span> ?<span class="id">mul1r</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>/<span class="id">is_cvg_pseries_diffs_equiv</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span> -&gt;// : (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">n</span>%:<span class="id">R</span> * (<span class="id">n</span>.-1%:<span class="id">R</span> * `|<span class="id">c</span> <span class="id">n</span>| / <span class="id">r</span>) * <span class="id">r</span> ^+ <span class="id">n</span>.-1) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">n</span> =&gt; `|<span class="id">c</span> <span class="id">n</span>| * <span class="id">n</span>%:<span class="id">R</span> * <span class="id">n</span>.-1%:<span class="id">R</span> * <span class="id">r</span> ^+ <span class="id">n</span>.-2).<br/>
&nbsp;&nbsp;<span class="id">apply</span>/<span class="id">funext</span> =&gt; [] [|[|<span class="id">i</span>]]; <span class="id">rewrite</span> ?(<span class="id">mul0r</span>, <span class="id">mulr0</span>) //=.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mulrA</span> -<span class="id">mulrA</span> <span class="id">exprS</span> [<span class="id">_</span>^-1 * <span class="id">_</span>]<span class="id">mulrA</span> <span class="id">mulVf</span> //.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">mul1r</span> !<span class="id">mulrA</span>; <span class="id">congr</span> (<span class="id">_</span> * <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrC</span> <span class="id">mulrA</span>.<br/>
- <span class="id">move</span>=&gt; <span class="id">h</span> /<span class="id">andP</span>[<span class="id">h_gt0</span> <span class="id">hLrBx</span>] <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">normrM</span> -!<span class="id">mulrA</span> <span class="id">ler_wpmul2l</span> //.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">pseries_diffs_P3</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">ltW</span> <span class="id">xLr</span>) <span class="id">_</span>))// ?<span class="id">mulrA</span> -?<span class="id">normr_gt0</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_norm_add</span> <span class="id">_</span> <span class="id">_</span>))// -(<span class="id">subrK</span> `|<span class="id"><a name="expR">x</a></span>| <span class="id">r</span>) <span class="id">ler_add2r</span> <span class="id">ltW</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">PseriesDiff</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">expR</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">realType</span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">x</span> : <span class="id">R</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR0</span> : <span class="id">expR</span> 0 = 1 :&gt; <span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
<span class="id">apply</span>: <span class="id">lim_near_cst</span> =&gt; //.<br/>
<span class="id">near</span>=&gt; <span class="id">m</span>; <span class="id">rewrite</span> -[<span class="id">m</span>]<span class="id">prednK</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">near</span>: <span class="id">m</span>.<br/>
<span class="id">rewrite</span> -<span class="id">addn1</span> <span class="id">series_addn</span> <span class="id">series_exp_coeff0</span> <span class="id">big_add1</span> <span class="id">big1</span> ?<span class="id">addr0</span>//.<br/>
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id"><a name="expR_ge1Dx">i</a></span> <span class="id">_</span>; <span class="id">rewrite</span> /<span class="id">exp_coeff</span> /= <span class="id">expr0n</span> <span class="id"><a href="mathcomp.analysis.sequences.html#expR">mul0r</a></span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR_ge1Dx</span> <span class="id">x</span> : 0 &lt;= <span class="id">x</span> -&gt; 1 + <span class="id">x</span> &lt;= <span class="id">expR</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">move</span>=&gt; <span class="id">x_gt0</span>; <span class="id">rewrite</span> /<span class="id">expR</span>.<br/>
<span class="id">pose</span> <span class="id">f</span> (<span class="id">x</span> : <span class="id">R</span>) <span class="id">i</span> := (<span class="id">i</span> == 0%<span class="id">nat</span>)%:<span class="id">R</span> + <span class="id">x</span> *+ (<span class="id">i</span> == 1%<span class="id">nat</span>).<br/>
<span class="id">have</span> <span class="id">F</span> <span class="id">n</span> : (1 &lt; <span class="id">n</span>)%<span class="id">nat</span> -&gt; \<span class="id">sum_</span>(0 &lt;= <span class="id">i</span> &lt; <span class="id">n</span>) (<span class="id">f</span> <span class="id">x</span> <span class="id">i</span>) = 1 + <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; /<span class="id">subnK</span>&lt;-.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addn2</span> !<span class="id"><a href="mathcomp.analysis.sequences.html#series">big_nat_recl</a></span> //= /<span class="id">f</span> /= <span class="id">mulr1n</span> !<span class="id"><a href="mathcomp.analysis.topology.html#lim_near_cst">mulr0n</a></span> <span class="id">big1</span> ?<span class="id">add0r</span> ?<span class="id">addr0</span>.<br/>
<span class="id">have</span> -&gt; : 1 + <span class="id">x</span> = <span class="id">lim</span> (<span class="id">series</span> (<span class="id">f</span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">esym</span>/<span class="id"><a href="mathcomp.analysis.topology.html#is_cvg_near_cst">lim_near_cst</a></span> =&gt; //; <span class="id">near</span>=&gt; <span class="id">n</span>; <span class="id">apply</span>: <span class="id">F</span>; <span class="id">near</span>: <span class="id">n</span>.<br/>
<span class="id">apply</span>: <span class="id">ler_lim</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">is_cvg_near_cst</span>; <span class="id">near</span>=&gt; <span class="id">n</span>; <span class="id">apply</span>: <span class="id">F</span>; <span class="id">near</span>: <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">is_cvg_series_exp_coeff</span>.<br/>
<span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id">n</span>; <span class="id">apply</span>: <span class="id">ler_sum</span> =&gt; -[|[|<span class="id">i</span>]] <span class="id">_</span>;<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> /<span class="id">f</span> /<span class="id"><a href="mathcomp.analysis.sequences.html#exp_coeff_ge0">exp_coeff</a></span> /= !(<span class="id">mulr0n</span>, <span class="id">mulr1n</span>, <span class="id">expr0</span>, <span class="id">expr1</span>, <span class="id">divr1</span>, <span class="id">addr0</span>, <span class="id">add0r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// <span class="id">exp_coeff_ge0</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">exp_coeffE</span> <span class="id">x</span> : <span class="id">exp_coeff</span> <span class="id">x</span> = (<span class="kwd">fun</span> <span class="id"><a href="mathcomp.analysis.sequences.html#exp_coeff">n</a></span> =&gt; (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">n</span>`!%:<span class="id">R</span>)^-1) <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id">exp_coeff</span> /= <span class="id">mulrC</span>. Qed.</div>
<br/>
<span class="kwd">Import</span> <span class="id">GRing.Theory</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ring_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">expRE</span> :<br/>
&nbsp;&nbsp;<span class="id">expR</span> = <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">lim</span> (<span class="id">pseries</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">n</span>`!%:<span class="id">R</span>)^-1) <span class="id">n</span>) <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> /<span class="id">pseries</span> -<span class="id">exp_coeffE</span>. Qed.</div>
<br/>
<span class="id"><a name="n:147">Global</a></span> <span class="kwd">Instance</span> <span class="id">is_derive_expR</span> <span class="id">x</span> : <span class="id">is_derive</span> <span class="id">x</span> 1 <span class="id">expR</span> (<span class="id">expR</span> <span class="id"><a href="mathcomp.analysis.exp.html#expRE">x</a></span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
<span class="id">pose</span> <span class="id">s1</span> <span class="id">n</span> := <span class="id">pseries_diffs</span> (<span class="kwd">fun</span> <span class="id">n</span> =&gt; <span class="id">n</span>`!%:<span class="id">R</span>^-1) <span class="id">n</span> * <span class="id">x</span> ^+ <span class="id">n</span>.<br/>
<span class="id">rewrite</span> <span class="id">expRE</span> /= /<span class="id">pseries</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = <span class="id">s1</span>); <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> /<span class="id">s1</span> <span class="id">pseries_diffs_inv_fact</span>.<br/>
<span class="id">apply</span>: (@<span class="id">pseries_snd_diffs</span> <span class="id">_</span> <span class="id">_</span> (`|<span class="id">x</span>| + 1)); <span class="id">rewrite</span> /<span class="id">pseries</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">exp_coeffE</span>; <span class="id">apply</span>: <span class="id">is_cvg_series_exp_coeff</span>.<br/>
- <span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = <span class="id">exp_coeff</span> (`|<span class="id">x</span>| + 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">is_cvg_series_exp_coeff</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> <span class="id">pseries_diffs_inv_fact</span> <span class="id">exp_coeffE</span>.<br/>
- <span class="id">rewrite</span> (<span class="id">_</span> : (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id">_</span>) = <span class="id">exp_coeff</span> (`|<span class="id"><a href="mathcomp.analysis.exp.html#pseries_diffs_inv_fact">x</a></span>| + 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact</span>: <span class="id">is_cvg_series_exp_coeff</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">i</span>; <span class="id">rewrite</span> !<span class="id">pseries_diffs_inv_fact</span> <span class="id">exp_coeffE</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> [<span class="id">ltRHS</span>]<span class="id">ger0_norm</span>// <span class="id">addrC</span> -<span class="id">subr_gt0</span> <span class="id">addrK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derivable_expR</span> <span class="id">x</span> : <span class="id">derivable</span> <span class="id">expR</span> <span class="id">x</span> 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
 <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">ex_derive</span>; <span class="id">apply</span>: <span class="id">is_derive_exp</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">derive_expR</span> : '<span class="id">D_1</span> <span class="id">expR</span> = <span class="id">expR</span> :&gt; (<span class="id">R</span> -&gt; <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id"><a href="mathcomp.analysis.sequences.html#expR">funext</a></span> =&gt; <span class="id">r</span> /=; <span class="id">rewrite</span> <span class="id">derive_val</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">continuous_expR</span> : <span class="id">continuous</span> (@<span class="id">expR</span> <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">exact</span>/<span class="id">differentiable_continuous</span>/<span class="id"><a href="mathcomp.analysis.sequences.html#expR">derivable1_diffP</a></span>/<span class="id">derivable_expR</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expRxDyMexpx</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">expR</span> (<span class="id">x</span> + <span class="id">y</span>) * <span class="id">expR</span> (- <span class="id">x</span>) = <span class="id">expR</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
<span class="id">set</span> <span class="id">v</span> := <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#etrans">LHS</a></span>; <span class="id">pattern</span> <span class="id">x</span> <span class="kwd">in</span> <span class="id">v</span>; <span class="id">move</span>: @<span class="id">v</span>; <span class="id">set</span> <span class="id">f</span> := (<span class="id">X</span> <span class="kwd">in</span> <span class="kwd">let</span> <span class="id">_</span> := <span class="id">X</span> <span class="id"><a href="mathcomp.analysis.exp.html#expR0">x</a></span> <span class="kwd">in</span> <span class="id">_</span>) =&gt; /=.<br/>
<span class="id">apply</span>: <span class="id">etrans</span> (<span class="id">_</span> : <span class="id">f</span> <span class="id">x</span> = <span class="id">f</span> 0) <span class="id">_</span>; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">f</span> <span class="id">add0r</span> <span class="id">oppr0</span> <span class="id">expR0</span> <span class="id">mulr1</span>.<br/>
<span class="id">apply</span>: <span class="id">is_derive_0_is_cst</span> =&gt; <span class="id">x1</span>.<br/>
<span class="id">apply</span>: <span class="id">trigger_derive</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">GRing.scale</span> /= <span class="id">mulrN1</span> <span class="id">addr0</span> <span class="id">mulr1</span> <span class="id">mulrN</span> <span class="id">addrC</span> <span class="id">mulrC</span> <span class="id">subrr</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expRxMexpNx_1</span> <span class="id">x</span> : <span class="id">expR</span> <span class="id">x</span> * <span class="id">expR</span> (- <span class="id">x</span>) = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
 <span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="id">X</span> <span class="kwd">in</span> <span class="id">_</span> <span class="id">X</span> * <span class="id">_</span> = <span class="id">_</span>]<span class="id">addr0</span> <span class="id">expRxDyMexpx</span> <span class="id">expR0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">pexpR_gt1</span> <span class="id">x</span> : 0 &lt; <span class="id">x</span> -&gt; 1 &lt; <span class="id">expR</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x_gt0</span>; <span class="id">rewrite</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> (<span class="id">expR_ge1Dx</span> (<span class="id">ltW</span> <span class="id">x_gt0</span>)))// <span class="id">ltr_addl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR_gt0</span> <span class="id">x</span> : 0 &lt; <span class="id">expR</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
<span class="id">case</span>: (<span class="id">ltrgt0P</span> <span class="id">x</span>) =&gt; [<span class="id">x_gt0</span>|<span class="id">x_gt0</span>|-&gt;]; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expR0</span>.<br/>
- <span class="id">exact</span>: <span class="id">lt_trans</span> (<span class="id">pexpR_gt1</span> <span class="id">x_gt0</span>).<br/>
- <span class="id">have</span> <span class="id">F</span> : 0 &lt; <span class="id">expR</span> (- <span class="id">x</span>) <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">lt_trans</span> <span class="id">_</span> (<span class="id">pexpR_gt1</span> <span class="id">_</span>))// <span class="id">oppr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -(<span class="id">pmulr_lgt0</span> <span class="id">_</span> <span class="id">F</span>) <span class="id">expRxMexpNx_1</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR_ge0</span> <span class="id">x</span> : 0 &lt;= <span class="id">expR</span> <span class="id">x</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span>// <span class="id">expR_gt0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR_eq0</span> <span class="id">x</span> : (<span class="id">expR</span> <span class="id">x</span> == 0) = <span class="id"><a href="mathcomp.analysis.sequences.html#expR">false</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">gt_eqF</span> ?<span class="id">expR_gt0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expRN</span> <span class="id">x</span> : <span class="id">expR</span> (- <span class="id">x</span>) = (<span class="id">expR</span> <span class="id">x</span>)^-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
<span class="id">apply</span>: (<span class="id"><a href="mathcomp.analysis.exp.html#expR_gt0">mulfI</a></span> (<span class="id">lt0r_neq0</span> (<span class="id">expR_gt0</span> <span class="id">x</span>))).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expRxMexpNx_1</span> <span class="id">mulfV</span> // (<span class="id">lt0r_neq0</span> (<span class="id">expR_gt0</span> <span class="id">x</span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expRD</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">expR</span> (<span class="id">x</span> + <span class="id">y</span>) = <span class="id">expR</span> <span class="id">x</span> * <span class="id">expR</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
<span class="id">apply</span>: (<span class="id">mulIf</span> (<span class="id">lt0r_neq0</span> (<span class="id">expR_gt0</span> (- <span class="id">x</span>)))).<br/>
<span class="id">rewrite</span> <span class="id">expRxDyMexpx</span> <span class="id">expRN</span> [<span class="id"><a name="x:163">_</a></span> * <span class="id"><a href="mathcomp.analysis.sequences.html#expR">expR</a></span> <span class="id">y</span>]<span class="id">mulrC</span> <span class="id">mulfK</span> //.<br/>
<span class="kwd">by</span> <span class="id">case</span>: <span class="id">ltrgt0P</span> (<span class="id">expR_gt0</span> <span class="id">x</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expRMm</span> <span class="id">n</span> <span class="id">x</span> : <span class="id">expR</span> (<span class="id">n</span>%:<span class="id">R</span> * <span class="id">x</span>) = <span class="id">expR</span> <span class="id">x</span> ^+ <span class="id">n</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">elim</span>: <span class="id">n</span> <span class="id">x</span> =&gt; [<span class="id">x</span>|<span class="id">n</span> <span class="id">IH</span> <span class="id">x</span>] /=; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mul0r</span> <span class="id">expr0</span> <span class="id">expR0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">exprS</span> -<span class="id">nat1r</span> <span class="id">mulrDl</span> <span class="id">mul1r</span> <span class="id">expRD</span> <span class="id">IH</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR_gt1</span> <span class="id">x</span> : (1 &lt; <span class="id">expR</span> <span class="id">x</span>) = (0 &lt; <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
<span class="id">case</span>: <span class="id">ltrgt0P</span> =&gt; [<span class="id">x_gt0</span>| <span class="id">xN</span>|-&gt;]; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expR0</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.exp.html#expR_gt0">pexpR_gt1</a></span> <span class="id">x_gt0</span>).<br/>
- <span class="id">apply</span>/<span class="id">idP</span>/<span class="id">negP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -[<span class="id">x</span>]<span class="id">opprK</span> <span class="id">expRN</span> -<span class="id">leNgt</span> <span class="id"><a name="expR_lt1">invf_cp1</a></span> ?<span class="id">expR_gt0</span> //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> // <span class="id">pexpR_gt1</span> // <span class="id">lter_oppE</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR_lt1</span> <span class="id">x</span> : (<span class="id">expR</span> <span class="id">x</span> &lt; 1) = (<span class="id">x</span> &lt; 0).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
<span class="id">case</span>: <span class="id">ltrgt0P</span> =&gt; [<span class="id">x_gt0</span>|<span class="id">xN</span>|-&gt;]; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expR0</span>.<br/>
- <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">idP</span>/<span class="id">negP</span>; <span class="id">rewrite</span> -<span class="id">leNgt</span> <span class="id">ltW</span> // <span class="id">expR_gt1</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> -[<span class="id">x</span>]<span class="id">opprK</span> <span class="id">expRN</span> <span class="id">invf_cp1</span> ?<span class="id">expR_gt0</span> // <span class="id">expR_gt1</span> <span class="id">lter_oppE</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expRB</span> <span class="id">x</span> <span class="id"><a name="ltr_expR">y</a></span> : <span class="id">expR</span> (<span class="id">x</span> - <span class="id">y</span>) = <span class="id"><a href="mathcomp.analysis.sequences.html#expR">expR</a></span> <span class="id"><a href="mathcomp.analysis.exp.html#expR.R">x</a></span> / <span class="id">expR</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expRD</span> <span class="id">expRN</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssrmatching.ssrmatching.html#SsrMatchingSyntax.LHS">ltr_expR</a></span> : {<span class="id">mono</span> (@<span class="id">expR</span> <span class="id">R</span>) : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt; <span class="id">y</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="kwd">by</span>  <span class="id">rewrite</span> -[<span class="kwd">in</span> <span class="id">LHS</span>](<span class="id">subrK</span> <span class="id">x</span> <span class="id">y</span>) <span class="id"><a href="mathcomp.analysis.sequences.html#expR">expRD</a></span> <span class="id">ltr_pmull</span> ?<span class="id">expR_gt0</span> // <span class="id">expR_gt1</span> <span class="id">subr_gt0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ler_expR</span> : {<span class="id">mono</span> (@<span class="id">expR</span> <span class="id">R</span>) : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="id">case</span>: (<span class="id">ltrgtP</span> <span class="id">x</span> <span class="id">y</span>) =&gt; [<span class="id">xLy</span>|<span class="id">yLx</span>|&lt;-]; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lexx</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> // <span class="id">ltr_expR</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">leNgt</span> <span class="id">ltr_expR</span> <span class="id">yLx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR_inj</span> : <span class="id">injective</span> (@<span class="id">expR</span> <span class="id">R</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> <span class="id">exE</span>.<br/>
<span class="kwd">by</span> <span class="id">have</span> [] := (<span class="id">ltr_expR</span> <span class="id"><a name="x:176">x</a></span> <span class="id">y</span>, <span class="id">ltr_expR</span> <span class="id">y</span> <span class="id">x</span>); <span class="id">rewrite</span> <span class="id">exE</span> <span class="id">ltxx</span>; <span class="id">case</span>: <span class="id">ltrgtP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR_total_gt1</span> <span class="id">x</span> :<br/>
&nbsp;&nbsp;1 &lt;= <span class="id">x</span> -&gt; <span class="kwd">exists</span> <span class="id">y</span>, [/\ 0 &lt;= <span class="id">y</span>, 1 + <span class="id">y</span> &lt;= <span class="id">x</span> &amp; <span class="id">expR</span> <span class="id">y</span> = <span class="id">x</span>].<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
<span class="id">move</span>=&gt; <span class="id">x_ge1</span>; <span class="id">have</span> <span class="id">x_ge0</span> : 0 &lt;= <span class="id">x</span> <span class="kwd">by</span> <span class="id">apply</span>: <span class="id">le_trans</span> <span class="id">x_ge1</span>.<br/>
<span class="id">have</span> [<span class="id">x1</span> <span class="id">x1Ix</span>| |<span class="id">x1</span> <span class="id">_</span> /<span class="id">eqP</span>] := @<span class="id">IVT</span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">y</span> =&gt; <span class="id">expR</span> <span class="id">y</span> - <span class="id">x</span>) <span class="id">_</span> <span class="id">_</span> 0 <span class="id">x_ge0</span>.<br/>
- <span class="id">apply</span>: <span class="id">continuousB</span> =&gt; // <span class="id">y1</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id">cst_continuous</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">continuous_subspaceT</span>=&gt; ?; <span class="id">exact</span>: <span class="id">continuous_expR</span>.<br/>
- <span class="id">rewrite</span> <span class="id">expR0</span>; <span class="id">have</span> [<span class="id">_</span>| |] := <span class="id">ltrgtP</span> (1- <span class="id">x</span>) (<span class="id">expR</span> <span class="id">x</span> - <span class="id">x</span>).<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">subr_le0</span> <span class="id"><a href="mathcomp.analysis.exp.html#expR_lt1">x_ge1</a></span> <span class="id">subr_ge0</span> (<span class="id">le_trans</span> <span class="id">_</span> (<span class="id">expR_ge1Dx</span> <span class="id">_</span>)) ?<span class="id">ler_addr</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltr_add2r</span> <span class="id">expR_lt1</span> <span class="id">ltNge</span> <span class="id">x_ge0</span>.<br/>
&nbsp;&nbsp;+ <span class="id"><a href="mathcomp.analysis.exp.html#expR_ge1Dx">rewrite</a></span> <span class="id">subr_le0</span> <span class="id">x_ge1</span> =&gt; -&gt; /=; <span class="id">rewrite</span> <span class="id">subr_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_trans</span> <span class="id">_</span> (<span class="id">expR_ge1Dx</span> <span class="id">x_ge0</span>)) ?<span class="id">ler_addr</span>.<br/>
- <span class="id">rewrite</span> <span class="id">subr_eq0</span> =&gt; /<span class="id">eqP</span> <span class="id">x1_x</span>; <span class="kwd">exists</span> <span class="id">x1</span>; <span class="id">split</span> =&gt; //.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ler_expR</span> <span class="id">expR0</span> <span class="id">x1_x</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">x1_x</span> <span class="id"><a name="y:180">expR_ge1Dx</a></span> // -<span class="id">ler_expR</span> <span class="id">x1_x</span> <span class="id">expR0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expR_total</span> <span class="id">x</span> : 0 &lt; <span class="id">x</span> -&gt; <span class="kwd">exists</span> <span class="id">y</span>, <span class="id">expR</span> <span class="id">y</span> = <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">case</span>: (<span class="id">lerP</span> 1 <span class="id">x</span>) =&gt; [/<span class="id">expR_total_gt1</span>[<span class="id">y</span> [<span class="id">_</span> <span class="id">_</span> <span class="id">Hy</span>]]|<span class="id">x_lt1</span> <span class="id">x_gt0</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="kwd">exists</span> <span class="id">y</span>.<br/>
<span class="id">have</span> /<span class="id">expR_total_gt1</span>[<span class="id">y</span> [<span class="id"><a href="mathcomp.analysis.exp.html#expRN">H1y</a></span> <span class="id">H2y</span> <span class="id">H3y</span>]] : 1 &lt;= <span class="id">x</span>^-1 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ltW</span> // !<span class="id">invf_cp1</span>.<br/>
<span class="kwd">by</span> <span class="kwd">exists</span> (-<span class="id">y</span>); <span class="id">rewrite</span> <span class="id">expRN</span> <span class="id">H3y</span> <span class="id"><a name="b:183">invrK</a></span>.<br/>
Qed.</div>
<br/>
<span class="id"><a href="mathcomp.analysis.sequences.html#expR">Local</a></span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">convex_scope</span>.<br/>
<span class="kwd">Lemma</span> <span class="id">convex_expR</span> (<span class="id">t</span> : {<span class="id"><a href="mathcomp.analysis.exp.html#expR.R">i01</a></span> <span class="id">R</span>}) (<span class="id">a</span> <span class="id">b</span> : <span class="id">R</span>^<span class="id">o</span>) :<br/>
&nbsp;&nbsp;<span class="id">expR</span> (<span class="id">a</span> &lt;| <span class="id">t</span> |&gt; <span class="id">b</span>) &lt;= (<span class="id">expR</span> <span class="id"><a href="mathcomp.analysis.convex.html#second_derivative_convex">a</a></span> : <span class="id">R</span>^<span class="id">o</span>) &lt;| <span class="id">t</span> |&gt; (<span class="id">expR</span> <span class="id">b</span> : <span class="id">R</span>^<span class="id">o</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
<span class="id">have</span> [<span class="id">ab</span>|/<span class="id">ltW</span> <span class="id">ba</span>] := <span class="id"><a href="mathcomp.analysis.exp.html#derive_expR">leP</a></span> <span class="id">a</span> <span class="id">b</span>.<br/>
- <span class="id">apply</span>: <span class="id">second_derivative_convex</span> =&gt; //.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">axb</span>; <span class="id">rewrite</span> <span class="id">derive_expR</span> <span class="id">derive_val</span> <span class="id">expR_ge0</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exact</span>/<span class="id">cvg_at_left_filter</span>/<span class="id">continuous_expR</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exact</span>/<span class="id">cvg_at_right_filter</span>/<span class="id">continuous_expR</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span> <span class="id">zab</span>; <span class="id">rewrite</span> <span class="id">derive_expR</span>; <span class="id">exact</span>: <span class="id">derivable_expR</span>.<br/>
- <span class="id">rewrite</span> <span class="id">convC</span> [<span class="id">leRHS</span>]<span class="id">convC</span>; <span class="id">apply</span>: <span class="id">second_derivative_convex</span> =&gt; //.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">axb</span>; <span class="id">rewrite</span> <span class="id">derive_expR</span> <span class="id">derive_val</span> <span class="id">expR_ge0</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exact</span>/<span class="id">cvg_at_left_filter</span>/<span class="id">continuous_expR</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exact</span>/<span class="id">cvg_at_right_filter</span>/<span class="id">continuous_expR</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">z</span> <span class="id">zab</span>; <span class="id">rewrite</span> <span class="id">derive_expR</span>; <span class="id">exact</span>: <span class="id">derivable_expR</span>.<br/>
Qed.</div>
<span class="id">Local</span> <span class="kwd">Close</span> <span class="kwd">Scope</span> <span class="id">convex_scope</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">expR</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">expeR</span>.<br/>
<span class="kwd">Context</span> {<span class="id">R</span> : <span class="id">realType</span>}.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">x</span> <span class="id">y</span> : \<span class="id">bar</span> <span class="id">R</span>) (<span class="id">r</span> <span class="id">s</span> : <span class="id">R</span>).<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">expeR</span> <span class="id">x</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span> | <span class="id">r</span>%:<span class="id">E</span> =&gt; (<span class="id">expR</span> <span class="id">r</span>)%:<span class="id">E</span> | +<span class="id">oo</span> =&gt; +<span class="id">oo</span> | -<span class="id">oo</span> =&gt; 0 <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">expeR0</span> : <span class="id">expeR</span> 0 = 1<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
 <span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.exp.html#exp">rewrite</a></span> /= <span class="id">expR0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expeR_ge0</span> <span class="id">x</span> : 0 &lt;= <span class="id">expeR</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">x</span> =&gt; //= <span class="id">r</span>; <span class="id">rewrite</span> <span class="id">lee_fin</span> <span class="id">expR_ge0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expeR_gt0</span> <span class="id">x</span> : -<span class="id">oo</span> &lt; <span class="id">x</span> -&gt; 0 &lt; <span class="id">expeR</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">x</span> =&gt; //= <span class="id">r</span>; <span class="id">rewrite</span> <span class="id">lte_fin</span> <span class="id">expR_gt0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expeR_eq0</span> <span class="id">x</span> : (<span class="id">expeR</span> <span class="id">x</span> == 0) = (<span class="id">x</span> == -<span class="id">oo</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">x</span> =&gt; //= [<span class="id">r</span>|]; <span class="id">rewrite</span> ?<span class="id"><a href="mathcomp.analysis.exp.html#ln">eqxx</a></span>// <span class="id">eqe</span> <span class="id">expR_eq0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expeRD</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">expeR</span> (<span class="id">x</span> + <span class="id">y</span>) = <span class="id">expeR</span> <span class="id">x</span> * <span class="id">expeR</span> <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">case</span>: <span class="id">x</span> =&gt; /= [<span class="id">r</span>| |]; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mul0e</span>.<br/>
- <span class="id">case</span>: <span class="id">y</span> =&gt; /= [<span class="id">s</span>| |]; <span class="id">last</span> <span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.exp.html#lnK">rewrite</a></span> <span class="id">mule0</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expRD</span> <span class="id"><a name="lnM">EFinM</a></span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulry</span> <span class="id"><a href="mathcomp.analysis.exp.html#ln">gtr0_sg</a></span> ?<span class="id">mul1e</span>// <span class="id">expR_gt0</span>.<br/>
- <span class="id">case</span>: <span class="id">y</span> =&gt; /= [<span class="id">s</span>| |]; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mule0</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulyr</span> <span class="id">gtr0_sg</span> ?<span class="id">mul1e</span>// <span class="id">expR_gt0</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulyy</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expeR_ge1Dx</span> <span class="id">x</span> : 0 &lt;= <span class="id">x</span> -&gt; 1 + <span class="id">x</span> &lt;= <span class="id"><a href="mathcomp.analysis.exp.html#ln">expeR</a></span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">x</span> =&gt; //= <span class="id">r</span>; <span class="id">rewrite</span> -<span class="id">EFinD</span> !<span class="id">lee_fin</span>; <span class="id">exact</span>: <span class="id">expR_ge1Dx</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ltr_expeR</span> : {<span class="id">mono</span> <span class="id">expeR</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt; <span class="id">y</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
<span class="id">move</span>=&gt; [<span class="id">r</span>| |] [<span class="id">s</span>| |]//=; <span class="id">rewrite</span> ?<span class="id">ltry</span>//.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">lte_fin</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#qualifE">ltr_expR</a></span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">ltNge</span> <span class="id"><a name="ln_div">lee_fin</a></span> <span class="id">expR_ge0</span> <span class="id">leNye</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lte_fin</span> <span class="id">expR_gt0</span> <span class="id">ltNye</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ler_expeR</span> : {<span class="id">mono</span> <span class="id">expeR</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
<span class="id">move</span>=&gt; [<span class="id">r</span>| |] [<span class="id">s</span>| |]//=; <span class="id">rewrite</span> ?<span class="id">leey</span> ?<span class="id">lexx</span>//.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">lee_fin</span> <span class="id">ler_expR</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">leNgt</span> <span class="id">lte_fin</span> <span class="id">expR_gt0</span> <span class="id">ltNye</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a href="mathcomp.analysis.exp.html#ltr_expR">lee_fin</a></span> <span class="id">expR_ge0</span> <span class="id">leNye</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expeR_inj</span> : <span class="id">injective</span> <span class="id">expeR</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
<span class="id">move</span>=&gt; [<span class="id">r</span>| |] [<span class="id">s</span>| |] =&gt; //=.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; [] /<span class="id">expR_inj</span> -&gt;.<br/>
- <span class="kwd">by</span> <span class="id">case</span> =&gt; /<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">expR_eq0</span>.<br/>
- <span class="kwd">by</span> <span class="id">case</span> =&gt; /<span class="id">esym</span>/<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">expR_eq0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expeR_total</span> <span class="id">x</span> : 0 &lt;= <span class="id">x</span> -&gt; <span class="kwd">exists</span> <span class="id">y</span>, <span class="id">expeR</span> <span class="id">y</span> = <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
<span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">r</span>|<span class="id">_</span>|//]; <span class="id">last</span> <span class="kwd">by</span> <span class="kwd">exists</span> +<span class="id">oo</span>.<br/>
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;-|]; <span class="id">first</span> <span class="kwd">by</span> <span class="kwd">exists</span> -<span class="id">oo</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lte_fin</span> =&gt; /<span class="id">expR_total</span>[<span class="id"><a href="mathcomp.analysis.exp.html#ler_expR">y</a></span> &lt;-]; <span class="kwd">exists</span> <span class="id"><a href="mathcomp.analysis.exp.html#expR_ge1Dx">y</a></span>%:<span class="id">E</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">expeR</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">Ln</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">realType</span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">x</span> : <span class="id">R</span>.<br/>
<br/>
<span class="kwd">Notation</span> <span class="id">exp</span> := (@<span class="id">expR</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">ln</span> <span class="id">x</span> : <span class="id">R</span> := [<span class="id">get</span> <span class="id">y</span> | <span class="id">exp</span> <span class="id">y</span> == <span class="id">x</span> ].<br/>
<br/>
<span class="kwd">Fact</span> <span class="id">ln0</span> <span class="id"><a href="mathcomp.analysis.exp.html#ln">x</a></span> : <span class="id">x</span> &lt;= 0 -&gt; <span class="id">ln</span> <span class="id">x</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
<span class="id">rewrite</span> /<span class="id">ln</span>; <span class="id">case</span>: <span class="id">xgetP</span> =&gt; //= <span class="id">y</span> <span class="id">_</span> /<span class="id">eqP</span> <span class="id">yx</span> <span class="id">x0</span>.<br/>
<span class="kwd">by</span> <span class="id">have</span> := <span class="id"><a href="mathcomp.analysis.exp.html#ler_expR">expR_gt0</a></span> <span class="id"><a href="mathcomp.analysis.exp.html#lnK">y</a></span>; <span class="id">rewrite</span> <span class="id">yx</span> =&gt; /(<span class="id">le_lt_trans</span> <span class="id">x0</span>); <span class="id">rewrite</span> <span class="id">ltxx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">expRK</span> : <span class="id">cancel</span> <span class="id">exp</span> <span class="id">ln</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> /<span class="id">ln</span>; <span class="id">case</span>: <span class="id">xgetP</span> =&gt; [<span class="id">x1</span> <span class="id">_</span> /<span class="id">eqP</span>/<span class="id">expR_inj</span> //|/(<span class="id">_</span> <span class="id">x</span>)[]/=].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">lnK</span> : {<span class="kwd">in</span> <span class="id">Num.pos</span>, <span class="id">cancel</span> <span class="id">ln</span> <span class="id">exp</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
<span class="id">move</span>=&gt; <span class="id">x</span>; <span class="id">rewrite</span> <span class="id">qualifE</span> =&gt; <span class="id">x_gt0</span>.<br/>
<span class="id">rewrite</span> /<span class="id">ln</span>; <span class="id">case</span>: <span class="id">xgetP</span>=&gt; [<span class="id">x1</span> <span class="id">_</span> /<span class="id">eqP</span>// |<span class="id">H</span>].<br/>
<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">expR_total</span> <span class="id">x_gt0</span>) =&gt; <span class="id">y</span> /<span class="id">eqP</span> <span class="id">Hy</span>; <span class="id">case</span>: (<span class="id">H</span> <span class="id">y</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">lnK_eq</span> <span class="id">x</span> : (<span class="id">exp</span> (<span class="id">ln</span> <span class="id">x</span>) == <span class="id">x</span>) = (0 &lt; <span class="id">x</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">eqP</span>/<span class="id">idP</span>=&gt; [&lt;-|<span class="id">x0</span>]; [<span class="id">exact</span>: <span class="id">expR_gt0</span>|<span class="id"><a name="x:214">rewrite</a></span> <span class="id">lnK</span>// <span class="id">in_itv</span>/= <span class="id">x0</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ln1</span> : <span class="id">ln</span> 1 = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">expR_inj</span>; <span class="id">rewrite</span> <span class="id">lnK</span>// ?<span class="id">expR0</span>// <span class="id">qualifE</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">lnM</span> : {<span class="kwd">in</span> <span class="id">Num.pos</span> &amp;, {<span class="id">morph</span> <span class="id">ln</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> * <span class="id">y</span> &gt;-&gt; <span class="id">x</span> + <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> <span class="id">x0</span> <span class="id">y0</span>; <span class="id">apply</span>: <span class="id">expR_inj</span>; <span class="id">rewrite</span> <span class="id">expRD</span> !<span class="id">lnK</span>//.<br/>
<span class="kwd">by</span> <span class="id">move</span>: <span class="id">x0</span> <span class="id">y0</span>; <span class="id">rewrite</span> !<span class="id">qualifE</span>; <span class="id">exact</span>: <span class="id">mulr_gt0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ln_inj</span> : {<span class="kwd">in</span> <span class="id">Num.pos</span> &amp;, <span class="id">injective</span> <span class="id">ln</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> /<span class="id">lnK</span> {2}&lt;- /<span class="id">lnK</span> {2}&lt;- -&gt;. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">lnV</span> : {<span class="kwd">in</span> <span class="id"><a href="mathcomp.analysis.exp.html#continuous_expR">Num.pos</a></span>, {<span class="id">morph</span> <span class="id">ln</span> : <span class="id">x</span> / <span class="id">x</span> ^-1 &gt;-&gt; - <span class="id">x</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">x0</span>; <span class="id">apply</span>: <span class="id">expR_inj</span>; <span class="id">rewrite</span> <span class="id">lnK</span>// ?<span class="id">expRN</span> ?<span class="id">lnK</span>//.<br/>
<span class="kwd">by</span> <span class="id">move</span>: <span class="id"><a name="concave_ln">x0</a></span>; <span class="id">rewrite</span> !<span class="id">qualifE</span> <span class="id"><a href="mathcomp.analysis.exp.html#Ln.R">invr_gt0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ln_div</span> : {<span class="kwd">in</span> <span class="id">Num.pos</span> &amp;, {<span class="id">morph</span> <span class="id">ln</span> : <span class="id">x</span> <span class="id"><a href="mathcomp.analysis.exp.html#ln">y</a></span> / <span class="id">x</span> / <span class="id">y</span> &gt;-&gt; <span class="id">x</span> - <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
<span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> <span class="id">x0</span> <span class="id">y0</span>; <span class="id">rewrite</span> (<span class="id">lnM</span> <span class="id">x0</span>) ?<span class="id">lnV</span>//.<br/>
<span class="kwd">by</span> <span class="id">move</span>: <span class="id">y0</span>; <span class="id">rewrite</span> !<span class="id">qualifE</span>/= <span class="id">invr_gt0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ltr_ln</span> : {<span class="kwd">in</span> <span class="id">Num.pos</span> &amp;, {<span class="id">mono</span> <span class="id">ln</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt; <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> <span class="id"><a href="mathcomp.analysis.exp.html#Ln">x_gt0</a></span> <span class="id">y_gt0</span>; <span class="id"><a name="PowR">rewrite</a></span> -<span class="id">ltr_expR</span> !<span class="id"><a href="mathcomp.analysis.reals.html#Real.Exports.realType">lnK</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ler_ln</span> : {<span class="kwd">in</span> <span class="id">Num.pos</span> &amp;, {<span class="id">mono</span> <span class="id">ln</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x</span> <span class="id">y</span> <span class="id">x_gt0</span> <span class="id">y_gt0</span>; <span class="id">rewrite</span> -<span class="id">ler_expR</span> !<span class="id">lnK</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">lnX</span> <span class="id">n</span> <span class="id">x</span> : 0 &lt; <span class="id">x</span> -&gt; <span class="id">ln</span>(<span class="id">x</span> ^+ <span class="id"><a name="x:223">n</a></span>) = <span class="id">ln</span> <span class="id">x</span> *+ <span class="id">n</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
<span class="id">move</span>=&gt; <span class="id">x_gt0</span>; <span class="id">elim</span>: <span class="id">n</span> =&gt; [|<span class="id">n</span> <span class="id">ih</span>] /=; <span class="id">first</span> <span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.exp.html#expR_ge0">rewrite</a></span> <span class="id">expr0</span> <span class="id">ln1</span> <span class="id">mulr0n</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">exprS</span> <span class="id">lnM</span> ?<span class="id">qualifE</span>// ?<span class="id">exprn_gt0</span>// <span class="id">mulrS</span> <span class="id">ih</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">le_ln1Dx</span> <span class="id">x</span> : 0 &lt;= <span class="id">x</span> -&gt; <span class="id">ln</span> (1 + <span class="id">x</span>) &lt;= <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
<span class="id">move</span>=&gt; <span class="id">x_ge0</span>; <span class="id">rewrite</span> -<span class="id">ler_expR</span> <span class="id">lnK</span> ?<span class="id">expR_ge1Dx</span> //.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id">lt_le_trans</span> (<span class="id">_</span> : 0 &lt; 1) <span class="id">_</span>; <span class="id">rewrite</span> // <span class="id">ler_addl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ln_sublinear</span> <span class="id">x</span> : 0 &lt; <span class="id">x</span> -&gt; <span class="id">ln</span> <span class="id">x</span> &lt; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andbT">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
<span class="id">move</span>=&gt; <span class="id">x_gt0</span>; <span class="id">apply</span>: <span class="id">lt_le_trans</span> (<span class="id">_</span> : <span class="id">ln</span> (1 + <span class="id">x</span>) &lt;= <span class="id">_</span>).<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ltr_expR</span> !<span class="id">lnK</span> ?<span class="id">qualifE</span> ?<span class="id">addr_gt0</span> // <span class="id">ltr_addr</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ler_expR</span> <span class="id">lnK</span> ?<span class="id">qualifE</span> ?<span class="id">addr_gt0</span>// <span class="id">expR_ge1Dx</span> // <span class="id">ltW</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ln_ge0</span> <span class="id">x</span> : 1 &lt;= <span class="id">x</span> -&gt; 0 &lt;= <span class="id">ln</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x_ge1</span>; <span class="id">rewrite</span> -<span class="id">ler_expR</span> <span class="id">expR0</span> <span class="id">lnK</span>// <span class="id">qualifE</span> (<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id">x_ge1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ln_gt0</span> <span class="id">x</span> : 1 &lt; <span class="id">x</span> -&gt; 0 &lt; <span class="id">ln</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">x_gt1</span>; <span class="id">rewrite</span> -<span class="id">ltr_expR</span> <span class="id">expR0</span> <span class="id">lnK</span> // <span class="id">qualifE</span> (<span class="id">lt_trans</span> <span class="id"><a href="mathcomp.classical.boolp.html#funext">_</a></span> <span class="id">x_gt1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a href="mathcomp.analysis.exp.html#powR">ln_le0</a></span> (<span class="id">x</span> : <span class="id">R</span>) : <span class="id">x</span> &lt;= 1 -&gt; <span class="id">ln</span> <span class="id">x</span> &lt;= 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
<span class="id">have</span> [<span class="id">x0</span>|<span class="id"><a name="p:232">x0</a></span> <span class="id">x1</span>] := <span class="id">leP</span> <span class="id">x</span> 0; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ln0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">ler_expR</span> <span class="id">expR0</span> <span class="id">lnK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">continuous_ln</span> <span class="id">x</span> : 0 &lt; <span class="id">x</span> -&gt; {<span class="kwd">for</span> <span class="id">x</span>, <span class="id">continuous</span> <span class="id">ln</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
<span class="id">move</span>=&gt; <span class="id">x_gt0</span>; <span class="id">rewrite</span> -[<span class="id">x</span>]<span class="id">lnK</span>//.<br/>
<span class="id">apply</span>: <span class="id">nbhs_singleton</span> (<span class="id">near_can_continuous</span> <span class="id">_</span> <span class="id">_</span>); <span class="id">near</span>=&gt; <span class="id">z</span>; <span class="id">first</span> <span class="id">exact</span>: <span class="id">expRK</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>: <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#andP">continuous_expR</a></span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="id">Global</span> <span class="kwd">Instance</span> <span class="id">is_derive1_ln</span> (<span class="id">x</span> : <span class="id">R</span>) : 0 &lt; <span class="id">x</span> -&gt; <span class="id">is_derive</span> <span class="id">x</span> 1 <span class="id">ln</span> <span class="id">x</span>^-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
<span class="id">move</span>=&gt; <span class="id">x_gt0</span>; <span class="id">rewrite</span> -[<span class="id">x</span>]<span class="id">lnK</span>//.<br/>
<span class="id">apply</span>: (@<span class="id">is_derive_inverse</span> <span class="id">R</span> <span class="id">expR</span>); <span class="id">first</span> <span class="kwd">by</span> <span class="id">near</span>=&gt; <span class="id"><a href="mathcomp.analysis.exp.html#powR">z</a></span>; <span class="id">apply</span>: <span class="id">expRK</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">near</span>=&gt;<span class="id">z</span>; <span class="id">apply</span>: <span class="id">continuous_expR</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lnK</span> // <span class="id">lt0r_neq0</span>.<br/>
<span class="id">Unshelve</span>. <span class="id">all</span>: <span class="kwd">by</span> <span class="id">end_near</span>. Qed.</div>
<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">convex_scope</span>.<br/>
<span class="kwd">Lemma</span> <span class="id">concave_ln</span> (<span class="id">t</span> : {<span class="id">i01</span> <span class="id">R</span>}) (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrfun.html#injective">a</a></span> <span class="id">b</span> : <span class="id">R</span>^<span class="id">o</span>) : 0 &lt; <span class="id">a</span> -&gt; 0 &lt; <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">ln</span> <span class="id">a</span> : <span class="id">R</span>^<span class="id">o</span>) &lt;| <span class="id">t</span> |&gt; (<span class="id">ln</span> <span class="id">b</span> : <span class="id">R</span>^<span class="id">o</span>) &lt;= <span class="id">ln</span> (<span class="id">a</span> &lt;| <span class="id">t</span> |&gt; <span class="id">b</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
<span class="id">move</span>=&gt; <span class="id">a0</span> <span class="id">b0</span>; <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">have</a></span> := <span class="id">convex_expR</span> <span class="id">t</span> (<span class="id">ln</span> <span class="id">a</span>) (<span class="id">ln</span> <span class="id">b</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">lnK</span>// -(@<span class="id">ler_ln</span>) ?<span class="id">posrE</span> ?<span class="id">expR_gt0</span> ?<span class="id">conv_gt0</span>// <span class="id">expRK</span>.<br/>
Qed.</div>
<span class="id">Local</span> <span class="kwd">Close</span> <span class="kwd">Scope</span> <span class="id">convex_scope</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id">Ln</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">PowR</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">realType</span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">a</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">r</span> : <span class="id">R</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">powR</span> <span class="id">a</span> <span class="id">x</span> := <span class="kwd">if</span> <span class="id">a</span> == 0 <span class="kwd">then</span> (<span class="id">x</span> == 0)%:<span class="id">R</span> <span class="kwd">else</span> <span class="id">expR</span> (<span class="id">x</span> * <span class="id">ln</span> <span class="id">a</span>).<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "<span class="id">a</span> `^ <span class="id">x</span>" := (<span class="id">powR</span> <span class="id">a</span> <span class="id">x</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">expRM</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">expR</span> (<span class="id">x</span> * <span class="id">y</span>) = (<span class="id">expR</span> <span class="id">x</span>) `^ <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">gt_eqF</span> ?<span class="id">expR_gt0</span>// <span class="id">expRK</span> <span class="id">mulrC</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_ge0</span> <span class="id">a</span> <span class="id">x</span> : 0 &lt;= <span class="id">a</span> `^ <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">powR</span>; <span class="id">case</span>: <span class="id">ifPn</span> =&gt; // <span class="id">_</span>; <span class="id">exact</span>: <span class="id">expR_ge0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_gt0</span> <span class="id">a</span> <span class="id">x</span> : 0 &lt; <span class="id">a</span> -&gt; 0 &lt; <span class="id">a</span> `^ <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a0</span>; <span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">gt_eqF</span>// <span class="id">expR_gt0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">gt0_powR</span> <span class="id">a</span> <span class="id">x</span> : 0 &lt; <span class="id">x</span> -&gt; 0 &lt;= <span class="id">a</span> -&gt; 0 &lt; <span class="id">a</span> `^ <span class="id">x</span> -&gt; 0 &lt; <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
<span class="id">move</span>=&gt; <span class="id"><a name="ge1r_powR">x0</a></span> <span class="id">a0</span>; <span class="id">rewrite</span> /<span class="id">powR</span>; <span class="id">case</span>: <span class="id">ifPn</span> =&gt; [<span class="id">_</span>|<span class="id">a_neq0</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">gt_eqF</span>//= <span class="id">ltxx</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lt_neqAle</span> <span class="id">a0</span> <span class="id">andbT</span> <span class="id">eq_sym</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR0</span> <span class="id">x</span> : <span class="id">x</span> != 0 -&gt; 0 `^ <span class="id">x</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
 <span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.exp.html#PowR.R">move</a></span>=&gt; <span class="id">x0</span>; <span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">eqxx</span> (<span class="id">negbTE</span> <span class="id">x0</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powRr1</span> <span class="id">a</span> : 0 &lt;= <span class="id">a</span> -&gt; <span class="id">a</span> `^ 1 = <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;-|<span class="id">a0</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powR0</span>// <span class="id">oner_eq0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">gt_eqF</span>// <span class="id">mul1r</span> <span class="id">lnK</span>// <span class="id">posrE</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powRr0</span> <span class="id">a</span> : <span class="id">a</span> `^ 0 = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
 <span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">powR</span>; <span class="id">case</span>: <span class="id">ifPn</span>; <span class="id">rewrite</span> ?<span class="id">eqxx</span>// <span class="id">mul0r</span> <span class="id"><a href="mathcomp.analysis.exp.html#powR_gt0">expR0</a></span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR1</span> : <span class="id">powR</span> 1 = <span class="kwd">fun</span>=&gt; 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
 <span class="kwd">by</span> <span class="id">apply</span>/<span class="id">funext</span> =&gt; <span class="id">x</span>; <span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">oner_eq0</span> <span class="id">ln1</span> <span class="id">mulr0</span> <span class="id">expR0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_eq0</span> <span class="id">x</span> <span class="id">p</span> : (<span class="id">x</span> `^ <span class="id">p</span> == 0) = (<span class="id">x</span> == 0) &amp;&amp; (<span class="id">p</span> != 0).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
<span class="id">rewrite</span> /<span class="id">powR</span>; <span class="id">have</span> [<span class="id">_</span>|<span class="id">x_neq0</span>] := <span class="id">eqVneq</span> <span class="id">x</span> 0 =&gt; //.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">p</span> == 0); <span class="id">rewrite</span> (<span class="id">oner_eq0</span>, <span class="id">eqxx</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expR_eq0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_eq0_eq0</span> <span class="id">x</span> <span class="id">p</span> : <span class="id">x</span> `^ <span class="id">p</span> = 0 -&gt; <span class="id"><a href="mathcomp.analysis.exp.html#ge0_ler_powR">x</a></span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">eqP</span>; <span class="id">rewrite</span> <span class="id">powR_eq0</span> =&gt; /<span class="id">andP</span>[/<span class="id">eqP</span>]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ger_powR</span> <span class="id">a</span> : 0 &lt; <span class="id">a</span> &lt;= 1 -&gt; {<span class="id">homo</span> <span class="id">powR</span> <span class="id">a</span> : <span class="id">x</span> <span class="id">y</span> /~ <span class="id">y</span> &lt;= <span class="id">x</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
<span class="id"><a name="x:264">move</a></span>=&gt; /<span class="id">andP</span>[<span class="id">a0</span> <span class="id">a1</span>] <span class="id">x</span> <span class="id">y</span> <span class="id">xy</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">gt_eqF</span>// <span class="id">ler_expR</span> <span class="id">ler_wnmul2r</span>// <span class="id">ln_le0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ler_powR</span> <span class="id">a</span> : 1 &lt;= <span class="id">a</span> -&gt; {<span class="id">homo</span> <span class="id">powR</span> <span class="id">a</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span>}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
<span class="id">move</span>=&gt; <span class="id">a1</span> <span class="id">x</span> <span class="id">y</span> <span class="id">xy</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">gt_eqF</span> ?(<span class="id">lt_le_trans</span> <span class="id">_</span> <span class="id">a1</span>)// <span class="id">ler_expR</span> <span class="id">ler_wpmul2r</span> ?<span class="id">ln_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_injective</span> <span class="id">r</span> : 0 &lt; <span class="id">r</span> -&gt; {<span class="kwd">in</span> <span class="id">Num.nneg</span> &amp;, <span class="id">injective</span> (<span class="id">powR</span> ^~ <span class="id">r</span>)}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
<span class="id">move</span>=&gt; <span class="id">r0</span> <span class="id">x</span> <span class="id">y</span> <span class="id">x0</span> <span class="id">y0</span>; <span class="id">rewrite</span> /<span class="id">powR</span>; <span class="id">case</span>: <span class="id">ifPn</span> =&gt; [/<span class="id">eqP</span> -&gt;|<span class="id">xneq0</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: <span class="id">ifPn</span> =&gt; [/<span class="id">eqP</span> -&gt;//|<span class="id">_</span> /<span class="id">eqP</span>]; <span class="id">rewrite</span> (<span class="id">gt_eqF</span> <span class="id">r0</span>) <span class="id">eq_sym</span> <span class="id"><a name="le1r_powRZ">expR_eq0</a></span>.<br/>
<span class="id">case</span>: <span class="id">ifPn</span> =&gt; [/<span class="id">eqP</span> -&gt; /<span class="id">eqP</span>|<span class="id">yneq0</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">gt_eqF</span> <span class="id">r0</span>) <span class="id">expR_eq0</span>.<br/>
<span class="kwd">by</span> <span class="id">move</span>/<span class="id">expR_inj</span>/<span class="id">mulfI</span> =&gt; /(<span class="id">_</span> (<span class="id">negbT</span> (<span class="id">gt_eqF</span> <span class="id">r0</span>))); <span class="id">apply</span>: <span class="id">ln_inj</span>;<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">posrE</span> <span class="id"><a href="mathcomp.analysis.exp.html#le1r_powR">lt_neqAle</a></span> <span class="id">eq_sym</span> (<span class="id">xneq0</span>,<span class="id">yneq0</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a href="mathcomp.analysis.exp.html#PowR.R">ler1_powR</a></span> <span class="id">a</span> <span class="id">r</span> : 1 &lt;= <span class="id">a</span> -&gt; <span class="id">r</span> &lt;= 1 -&gt; <span class="id">a</span> &gt;= <span class="id">a</span> `^ <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a1</span> <span class="id">r1</span>; <span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_powR</span> <span class="id">_</span> <span class="id">r1</span>)) ?<span class="id">powRr1</span>// (<span class="id">le_trans</span> <span class="id">_</span> <span class="id">a1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">le1r_powR</span> <span class="id">a</span> <span class="id">r</span> : 1 &lt;= <span class="id">a</span> -&gt; 1 &lt;= <span class="id"><a href="mathcomp.analysis.exp.html#expRK">r</a></span> -&gt; <span class="id">a</span> &lt;= <span class="id">a</span> `^ <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a1</span> <span class="id">r1</span>; <span class="id">rewrite</span> (<span class="id">le_trans</span> <span class="id">_</span> (<span class="id">ler_powR</span> <span class="id">_</span> <span class="id">r1</span>)) ?<span class="id">powRr1</span>// (<span class="id">le_trans</span> <span class="id">_</span> <span class="id">a1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ger1_powR</span> <span class="id">a</span> <span class="id"><a name="x:279">r</a></span> : 0 &lt; <span class="id">a</span> &lt;= 1 -&gt; <span class="id">r</span> &lt;= 1 -&gt; <span class="id">a</span> &lt;= <span class="id">a</span> `^ <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
<span class="id">move</span>=&gt; /<span class="id">andP</span>[<span class="id">a0</span> <span class="id">_a1</span>] <span class="id">r1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id"><a href="mathcomp.analysis.exp.html#powR">le_trans</a></span> <span class="id">_</span> (<span class="id">ger_powR</span> <span class="id">_</span> <span class="id">r1</span>)) ?<span class="id">powRr1</span> ?<span class="id">a0</span>// <span class="id">ltW</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ge1r_powR</span> <span class="id">a</span> <span class="id"><a href="mathcomp.analysis.exp.html#expRD">r</a></span> : 0 &lt; <span class="id">a</span> &lt;= 1 -&gt; 1 &lt;= <span class="id">r</span> -&gt; <span class="id">a</span> &gt;= <span class="id">a</span> `^ <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
<span class="id">move</span>=&gt; /<span class="id">andP</span>[<span class="id">a0</span> <span class="id">a1</span>] <span class="id">r1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#negPf">ger_powR</a></span> <span class="id">_</span> <span class="id">r1</span>)) ?<span class="id">powRr1</span> ?<span class="id">a0</span>// <span class="id"><a name="r:283">ltW</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ge0_ler_powR</span> <span class="id">r</span> : 0 &lt;= <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">Num.nneg</span> &amp;, {<span class="id">homo</span> <span class="id">powR</span> ^~ <span class="id">r</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span> &gt;-&gt; <span class="id">x</span> &lt;= <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;- <span class="id">x</span> <span class="id">y</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="mathcomp.analysis.exp.html#powR0">_</a></span>|]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">powRr0</span>.<br/>
<span class="id">move</span>=&gt; <span class="id">a0</span> <span class="id">x</span> <span class="id">y</span>; <span class="id">rewrite</span> 2!<span class="id">nnegrE</span> !<span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;-|<span class="id">x0</span>].<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; /<span class="id">predU1P</span>[&lt;- <span class="id">_</span>|<span class="id">y0</span> <span class="id">_</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.exp.html#powRr0">rewrite</a></span> <span class="id">eqxx</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">powR0</span> ?(<span class="id">gt_eqF</span> <span class="id">a0</span>)// <span class="id">powR_gt0</span> ?<span class="id">orbT</span>.<br/>
<span class="id">move</span>=&gt; /<span class="id">predU1P</span>[&lt;-|<span class="id">y0</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">gt_eqF</span>//= <span class="id">ltNge</span> (<span class="id">ltW</span> <span class="id">x0</span>).<br/>
<span class="id">move</span>=&gt; /<span class="id">predU1P</span>[-&gt;//|<span class="id">xy</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id"><a name="powR_mulrn">rewrite</a></span> <span class="id">eqxx</span>.<br/>
<span class="kwd">by</span> <span class="id">apply</span>/<span class="id">orP</span>; <span class="id">right</span>; <span class="id">rewrite</span> /<span class="id">powR</span> !<span class="id">gt_eqF</span>// <span class="id">ltr_expR</span> <span class="id">ltr_pmul2l</span>// <span class="id">ltr_ln</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">gt0_ltr_powR</span> <span class="id">r</span> : 0 &lt; <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> <span class="id">Num.nneg</span> &amp;, {<span class="id">homo</span> <span class="id">powR</span> ^~ <span class="id">r</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt; <span class="id">y</span> &gt;-&gt; <span class="id">x</span> &lt; <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
<span class="id">move</span>=&gt; <span class="id">r0</span> <span class="id">x</span> <span class="id"><a name="a:289">y</a></span> <span class="id">x0</span> <span class="id">y0</span> <span class="id">xy</span>; <span class="id">have</span> := <span class="id">ge0_ler_powR</span> (<span class="id">ltW</span> <span class="id">r0</span>) <span class="id">x0</span> <span class="id">y0</span> (<span class="id">ltW</span> <span class="id">xy</span>).<br/>
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">orP</span>[/<span class="id">eqP</span>/(<span class="id">powR_injective</span> <span class="id">r0</span> <span class="id">x0</span> <span class="id">y0</span>)/<span class="id">eqP</span>|//].<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lt_eqF</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powRM</span> <span class="id">x</span> <span class="id">y</span> <span class="id">r</span> : 0 &lt;= <span class="id"><a href="mathcomp.analysis.exp.html#powRN">x</a></span> -&gt; 0 &lt;= <span class="id">y</span> -&gt; (<span class="id">x</span> * <span class="id">y</span>) `^ <span class="id">r</span> = <span class="id"><a name="powR_intmul">x</a></span> `^ <span class="id">r</span> * <span class="id">y</span> `^ <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
<span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">mulf_eq0</span>.<br/>
<span class="id">case</span>: (<span class="id">ltgtP</span> <span class="id">x</span> 0) =&gt; // <span class="id">x0</span> <span class="id">_</span>; <span class="id">case</span>: (<span class="id">ltgtP</span> <span class="id">y</span> 0) =&gt; //= <span class="id">y0</span> <span class="id">_</span>; <span class="id">do</span> ?<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.exp.html#powR_invn">case</a></span>: <span class="id">eqVneq</span> =&gt; [<span class="id">r0</span>|]; <span class="id">rewrite</span> ?<span class="id"><a name="a:294">r0</a></span> ?<span class="id">mul0r</span> ?<span class="id">expR0</span> ?<span class="id">mulr0</span> ?<span class="id">mul1r</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lnM</span>// <span class="id">mulrDr</span> <span class="id">expRD</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ge1r_powRZ</span> <span class="id">x</span> <span class="id">y</span> <span class="id">r</span> : 0 &lt; <span class="id">x</span> &lt;= 1 -&gt; 0 &lt;= <span class="id">y</span> -&gt; 1 &lt;= <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">x</span> * <span class="id">y</span>) `^ <span class="id">r</span> &lt;= <span class="id">x</span> * (<span class="id">y</span> `^ <span class="id">r</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
<span class="id">move</span>=&gt; /<span class="id">andP</span>[<span class="id"><a href="mathcomp.analysis.exp.html#powR">x0</a></span> <span class="id">x1</span>] <span class="id">y0</span> <span class="id">r1</span>.<br/>
<span class="kwd">by</span> <span class="id"><a href="mathcomp.analysis.exp.html#expRK">rewrite</a></span> (<span class="id">powRM</span> <span class="id">_</span> (<span class="id">ltW</span> <span class="id">_</span>))// <span class="id">ler_wpmul2r</span> ?<span class="id">powR_ge0</span>// <span class="id">ge1r_powR</span>// <span class="id">x0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">le1r_powRZ</span> <span class="id">x</span> <span class="id">y</span> <span class="id">r</span> : <span class="id">x</span> &gt;= 1 -&gt; 0 &lt;= <span class="id">y</span> -&gt; 1 &lt;= <span class="id">r</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id">x</span> * <span class="id">y</span>) `^ <span class="id">r</span> &gt;= <span class="id">x</span> * (<span class="id">y</span> `^ <span class="id">r</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
<span class="id">move</span>=&gt; <span class="id">x1</span> <span class="id">y0</span> <span class="id">r1</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">powRM</span> <span class="id">_</span> (<span class="id">le_trans</span> <span class="id">_</span> <span class="id">x1</span>))// <span class="id">ler_wpmul2r</span> ?<span class="id">powR_ge0</span>// <span class="id">le1r_powR</span>// <span class="id">x0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powRrM</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id">x</span> `^ (<span class="id">y</span> * <span class="id">z</span>) = (<span class="id">x</span> `^ <span class="id">y</span>) `^ <span class="id">z</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
<span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">mulf_eq0</span>; <span class="id">have</span> [<span class="id">_</span>|<span class="id">xN0</span>] := <span class="id">eqVneq</span> <span class="id">x</span> 0.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">case</span>: (<span class="id">y</span> == 0); <span class="id">rewrite</span> ?<span class="id">eqxx</span>//= <span class="id">oner_eq0</span> <span class="id">ln1</span> <span class="id">mulr0</span> <span class="id">expR0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">expR_eq0</span> <span class="id">expRK</span> <span class="id">mulrCA</span> <span class="id">mulrA</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powRAC</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : (<span class="id">x</span> `^ <span class="id">y</span>) `^ <span class="id">z</span> = (<span class="id">x</span> `^ <span class="id"><a href="mathcomp.analysis.exp.html#powR">z</a></span>) `^ <span class="id">y</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
 <span class="kwd">by</span> <span class="id">rewrite</span> -!<span class="id">powRrM</span> <span class="id">mulrC</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powRD</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : (<span class="id">r</span> + <span class="id">s</span> == 0) ==&gt; (<span class="id">x</span> != 0) -&gt; <span class="id">x</span> `^ (<span class="id">r</span> + <span class="id">s</span>) = <span class="id">x</span> `^ <span class="id">r</span> * <span class="id">x</span> `^ <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
<span class="id">rewrite</span> /<span class="id">powR</span>; <span class="id">case</span>: (<span class="id">eqVneq</span> <span class="id">x</span> 0) =&gt; //= [<span class="id">_</span>|<span class="id">x_neq0</span> <span class="id">_</span>];<br/>
&nbsp;&nbsp;<span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulrDl</span> <span class="id">expRD</span>.<br/>
<span class="id">have</span> [-&gt;|] := <span class="id">eqVneq</span> <span class="id">r</span> 0; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mul1r</span> <span class="id">add0r</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">implybF</span> <span class="id"><a href="mathcomp.analysis.exp.html#expR0">mul0r</a></span> =&gt; <span class="id">_</span> /<span class="id">negPf</span> -&gt;.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">mulr_powRB1</span> <span class="id"><a name="q:304">x</a></span> <span class="id">p</span> : 0 &lt;= <span class="id">x</span> -&gt; 0 &lt; <span class="id">p</span> -&gt; <span class="id">x</span> * <span class="id">x</span> `^ (<span class="id">p</span> - 1) = <span class="id">x</span> `^ <span class="id">p</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</span></div>
<div class="proofscript" id="proof94">
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;- <span class="id">p0</span>|<span class="id">x0</span> <span class="id">p0</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mul0r</span> <span class="id">powR0</span> ?<span class="id">gt_eqF</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -{1}(<span class="id">powRr1</span> (<span class="id">ltW</span> <span class="id">x0</span>))// -<span class="id">powRD</span> <span class="id">addrCA</span> <span class="id">subrr</span> <span class="id">addr0</span>// <span class="id">gt_eqF</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powRN</span> <span class="id">x</span> <span class="id">r</span> : <span class="id">x</span> `^ (- <span class="id">r</span>) = (<span class="id">x</span> `^ <span class="id">r</span>)^-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</span></div>
<div class="proofscript" id="proof95">
<span class="id">have</span> [<span class="id">r0</span>|<span class="id">r0</span>] := <span class="id">eqVneq</span> <span class="id"><a href="mathcomp.analysis.exp.html#powR0">r</a></span> 0%<span class="id">R</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">r0</span> <span class="id">oppr0</span> <span class="id">powRr0</span> <span class="id">invr1</span>.<br/>
<span class="id">have</span> [-&gt;|<span class="id">xN0</span>] := <span class="id">eqVneq</span> <span class="id">x</span> 0; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">powR0</span> ?<span class="id">oppr_eq0</span>// <span class="id">invr0</span>.<br/>
<span class="id">rewrite</span> -<span class="id">div1r</span>; <span class="id">apply</span>: (<span class="id">canRL</span> (<span class="id">mulfK</span> <span class="id">_</span>)); <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powR_eq0</span> (<span class="id">negPf</span> <span class="id">xN0</span>).<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">powRD</span> ?<span class="id">addNr</span> ?<span class="id">powRr0</span>// <span class="id">xN0</span> <span class="id">eqxx</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powRB</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : (<span class="id">r</span> == <span class="id">s</span>) ==&gt; (<span class="id">x</span> != 0) -&gt; <span class="id">x</span> `^ (<span class="id">r</span> - <span class="id">s</span>) = <span class="id">x</span> `^ <span class="id">r</span> / <span class="id">x</span> `^ <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</span></div>
<div class="proofscript" id="proof96">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">rewrite</span> <span class="id">powRD</span> ?<span class="id">subr_eq0</span>// <span class="id">powRN</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_mulrn</span> <span class="id">a</span> <span class="id">n</span> : 0 &lt;= <span class="id">a</span> -&gt; <span class="id">a</span> `^ <span class="id">n</span>%:<span class="id">R</span> = <span class="id">a</span> ^+ <span class="id">n</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</span></div>
<div class="proofscript" id="proof97">
<span class="id">move</span>=&gt; <span class="id">a_ge0</span>; <span class="id">elim</span>: <span class="id">n</span> =&gt; [|<span class="id">n</span> <span class="id">IHn</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powRr0</span> <span class="id">expr0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">natr1</span> <span class="id">powRD</span> ?<span class="id">natr1</span> ?<span class="id">pnatr_eq0</span>// <span class="id">powRr1</span>// <span class="id">IHn</span> <span class="id">exprSr</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_inv1</span> <span class="id">a</span> : 0 &lt;= <span class="id">a</span> -&gt; <span class="id">a</span> `^ (-1) = <span class="id">a</span> ^-1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</span></div>
<div class="proofscript" id="proof98">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a_ge0</span>; <span class="id">rewrite</span> <span class="id">powRN</span> <span class="id">powRr1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_invn</span> <span class="id">a</span> <span class="id">n</span> : 0 &lt;= <span class="id">a</span> -&gt; <span class="id">a</span> `^ (- <span class="id">n</span>%:<span class="id">R</span>) = <span class="id">a</span> ^- <span class="id">n</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof99')">Proof.</span></div>
<div class="proofscript" id="proof99">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a_ge0</span>; <span class="id">rewrite</span> <span class="id">powRN</span> <span class="id">powR_mulrn</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR_intmul</span> <span class="id">a</span> (<span class="id">z</span> : <span class="id">int</span>) : 0 &lt;= <span class="id">a</span> -&gt; <span class="id">a</span> `^ <span class="id">z</span>%:~<span class="id">R</span> = <span class="id">a</span> ^ <span class="id">z</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof100')">Proof.</span></div>
<div class="proofscript" id="proof100">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">a0</span>; <span class="id">case</span>: <span class="id">z</span> =&gt; <span class="id">n</span>; [<span class="id">exact</span>: <span class="id">powR_mulrn</span> | <span class="id">exact</span>: <span class="id">powR_invn</span>]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">ln_powR</span> <span class="id">a</span> <span class="id">x</span> : <span class="id">ln</span> (<span class="id">a</span> `^ <span class="id">x</span>) = <span class="id">x</span> * <span class="id">ln</span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof101')">Proof.</span></div>
<div class="proofscript" id="proof101">
<span class="id">have</span> [-&gt;|<span class="id">x0</span>] := <span class="id">eqVneq</span> <span class="id">x</span> 0; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powRr0</span> <span class="id">ln1</span>// <span class="id">mul0r</span>.<br/>
<span class="id">have</span> [-&gt;|<span class="id">a0</span>] := <span class="id">eqVneq</span> <span class="id">a</span> 0; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powR0</span>// <span class="id">ln0</span>// <span class="id">mulr0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">powR</span> (<span class="id">negbTE</span> <span class="id">a0</span>) <span class="id">expRK</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">powR12_sqrt</span> <span class="id">a</span> : 0 &lt;= <span class="id">a</span> -&gt; <span class="id">a</span> `^ (2^-1) = <span class="id">Num.sqrt</span> <span class="id">a</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof102')">Proof.</span></div>
<div class="proofscript" id="proof102">
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;-|<span class="id">a0</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id"><a name="r:311">rewrite</a></span> <span class="id">powR0</span> ?<span class="id">invr_eq0</span> ?<span class="id">pnatr_eq0</span>// <span class="id">sqrtr0</span>.<br/>
<span class="id">have</span> /<span class="id">eqP</span> : (<span class="id">a</span> `^ (2^-1)) ^+ 2 = (<span class="id">Num.sqrt</span> <span class="id">a</span>) ^+ 2.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">sqr_sqrtr</span>; <span class="id">last</span> <span class="id">exact</span>: <span class="id">ltW</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">gt_eqF</span>// -<span class="id">expRMm</span> <span class="id">mulrA</span> <span class="id">divrr</span> ?<span class="id">mul1r</span> ?<span class="id">unitfE</span>// <span class="id">lnK</span>.<br/>
<span class="id">rewrite</span> <span class="id">eqf_sqr</span> =&gt; /<span class="id">predU1P</span>[//|/<span class="id">eqP</span> <span class="id">h</span>].<br/>
<span class="id">have</span> : 0 &lt; <span class="id">a</span> `^ 2^-1 <span class="kwd">by</span> <span class="id">exact</span>: <span class="id">powR_gt0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">h</span> <span class="id">oppr_gt0</span> <span class="id">ltNge</span> <span class="id">sqrtr_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">norm_powR</span> <span class="id">a</span> <span class="id">x</span> : 0 &lt;= <span class="id">a</span> -&gt; `|<span class="id">a</span> `^ <span class="id">x</span>| = `|<span class="id">a</span>| `^ <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof103')">Proof.</span></div>
<div class="proofscript" id="proof103">
<span class="id">move</span>=&gt; <span class="id"><a name="r:316">a0</a></span>; <span class="id">rewrite</span> /<span class="id">powR</span>; <span class="id">case</span>: <span class="id">ifPn</span> =&gt; [/<span class="id">eqP</span> -&gt;|].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">normr0</span> <span class="id">eqxx</span> <span class="id">normr_nat</span>.<br/>
<span class="id">rewrite</span> <span class="id">neq_lt</span> <span class="id">ltNge</span> <span class="id">a0</span>/= =&gt; {}<span class="id">a0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">gtr0_norm</span> ?<span class="id">expR_gt0</span>// <span class="id">gtr0_norm</span>// <span class="id">gt_eqF</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">lt0_norm_powR</span> <span class="id">a</span> <span class="id">x</span> : <span class="id">a</span> &lt; 0 -&gt; `|<span class="id">a</span> `^ <span class="id">x</span>| = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof104')">Proof.</span></div>
<div class="proofscript" id="proof104">
<span class="id">move</span>=&gt; <span class="id">a0</span>; <span class="id">rewrite</span> /<span class="id">powR</span> <span class="id">lt_eqF</span>// <span class="id">gtr0_norm</span> ?<span class="id">expR_gt0</span>//.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">ln0</span> ?<span class="id">mulr0</span> ?<span class="id">expR0</span>// <span class="id">ltW</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">conjugate_powR</span> <span class="id">a</span> <span class="id">b</span> <span class="id">p</span> <span class="id">q</span> : 0 &lt;= <span class="id">a</span> -&gt; 0 &lt;= <span class="id">b</span> -&gt;<br/>
&nbsp;&nbsp;0 &lt; <span class="id">p</span> -&gt; 0 &lt; <span class="id">q</span> -&gt; <span class="id">p</span>^-1 + <span class="id">q</span>^-1 = 1 -&gt;<br/>
&nbsp;&nbsp;<span class="id">a</span> * <span class="id">b</span> &lt;= <span class="id">a</span> `^ <span class="id">p</span> / <span class="id">p</span> + <span class="id">b</span> `^ <span class="id">q</span> / <span class="id">q</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof105')">Proof.</span></div>
<div class="proofscript" id="proof105">
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;- <span class="id">b0</span> <span class="id">p0</span> <span class="id">q0</span> <span class="id">_</span>|<span class="id">a0</span>].<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id"><a name="poweR_ge0">rewrite</a></span> <span class="id">mul0r</span> <span class="id">powR0</span> ?<span class="id">gt_eqF</span>// <span class="id">mul0r</span> <span class="id">add0r</span> <span class="id">divr_ge0</span> ?<span class="id">powR_ge0</span> ?<span class="id">ltW</span>.<br/>
<span class="id">rewrite</span> <span class="id">le_eqVlt</span> =&gt; /<span class="id">predU1P</span>[&lt;-|<span class="id">b0</span>] <span class="id">p0</span> <span class="id">q0</span> <span class="id">pq</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id"><a name="r:326">mulr0</a></span> <span class="id">powR0</span> ?<span class="id">gt_eqF</span>// <span class="id">mul0r</span> <span class="id">addr0</span> <span class="id">divr_ge0</span> ?<span class="id">powR_ge0</span> ?<span class="id">ltW</span>.<br/>
<span class="id">have</span> <span class="id">q01</span> : (<span class="id">q</span>^-1 \<span class="kwd">in</span> `[0, 1])%<span class="id">R</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id"><a href="https://coq.inria.fr/doc/V8.18.0/stdlib/Coq.ssr.ssrbool.html#ifPn">rewrite</a></span> <span class="id">in_itv</span>/= <span class="id">invr_ge0</span> (<span class="id">ltW</span> <span class="id"><a name="r:328">q0</a></span>)/= -<span class="id">pq</span> <span class="id">ler_paddl</span>// <span class="id">invr_ge0</span> <span class="id">ltW</span>.<br/>
<span class="id">have</span> <span class="id">ap0</span> : (0 &lt; <span class="id">a</span> `^ <span class="id">p</span>)%<span class="id">R</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powR_gt0</span>.<br/>
<span class="id">have</span> <span class="id">bq0</span> : (0 &lt; <span class="id">b</span> `^ <span class="id">q</span>)%<span class="id">R</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powR_gt0</span>.<br/>
<span class="id">have</span> := @<span class="id">concave_ln</span> <span class="id">_</span> (@<span class="id">Itv.mk</span> <span class="id">_</span> `[0, 1] <span class="id">_</span> <span class="id">q01</span>)%<span class="id">R</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ap0</span> <span class="id">bq0</span>.<br/>
<span class="id">have</span> <span class="id">pq</span>' : (<span class="id">p</span>^-1 = 1 - <span class="id">q</span>^-1)%<span class="id">R</span> <span class="kwd">by</span> <span class="id">rewrite</span> -<span class="id">pq</span> <span class="id">addrK</span>.<br/>
<span class="id">rewrite</span> !<span class="id">convRE</span>/= /<span class="id">onem</span> -<span class="id">pq</span>' -<span class="id">ler_expR</span> <span class="id"><a href="mathcomp.analysis.exp.html#powR_eq0">expRD</a></span> (<span class="id">mulrC</span> <span class="id">p</span>^-1).<br/>
<span class="id">rewrite</span> <span class="id">ln_powR</span> <span class="id">mulrAC</span> <span class="id">divff</span> ?<span class="id">mul1r</span> ?<span class="id">gt_eqF</span>// (<span class="id">mulrC</span> <span class="id">q</span>^-1).<br/>
<span class="id">rewrite</span> <span class="id">ln_powR</span> <span class="id">mulrAC</span> <span class="id">divff</span> ?<span class="id">mul1r</span> ?<span class="id">gt_eqF</span>//.<br/>
<span class="id">rewrite</span> <span class="id">lnK</span> ?<span class="id">posrE</span>// <span class="id">lnK</span> ?<span class="id">posrE</span>// =&gt; /<span class="id">le_trans</span>; <span class="id">apply</span>.<br/>
<span class="id">rewrite</span> <span class="id">lnK</span>//; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">posrE</span> <span class="id">addr_gt0</span>// <span class="id">mulr_gt0</span>// ?<span class="id">invr_gt0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> (<span class="id">mulrC</span> <span class="id">_</span> <span class="id">p</span>^-1) (<span class="id">mulrC</span> <span class="id">_</span> <span class="id">q</span>^-1).<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">PowR</span>.<br/>
<span class="kwd">Notation</span> "<span class="id">a</span> `^ <span class="id">x</span>" := (<span class="id">powR</span> <span class="id">a</span> <span class="id">x</span>) : <span class="id">ring_scope</span>.<br/>
<br/>
#[<span class="id">deprecated</span>(<span class="id">since</span>="<span class="id">mathcomp</span>-<span class="id">analysis</span> 0.6.5", <span class="id">note</span>="<span class="id">renamed</span> `<span class="id">ge0_ler_powR</span>`")]<br/>
<span class="kwd">Notation</span> <span class="id">gt0_ler_powR</span> := <span class="id">ge0_ler_powR</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">poweR</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">ereal_scope</span>.<br/>
<span class="kwd">Context</span> {<span class="id">R</span> : <span class="id">realType</span>}.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> (<span class="id">s</span> <span class="id">r</span> : <span class="id">R</span>) (<span class="id">x</span> <span class="id">y</span> : \<span class="id">bar</span> <span class="id">R</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">poweR</span> <span class="id">x</span> <span class="id">r</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id">x</span>'%:<span class="id">E</span> =&gt; (<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#muleC">x</a></span>' `^ <span class="id">r</span>)%:<span class="id">E</span><br/>
&nbsp;&nbsp;| +<span class="id">oo</span> =&gt; <span class="kwd">if</span> <span class="id">r</span> == 0%<span class="id">R</span> <span class="kwd">then</span> 1%<span class="id">E</span> <span class="kwd">else</span> +<span class="id">oo</span><br/>
&nbsp;&nbsp;| -<span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mulyy">oo</a></span> =&gt; <span class="kwd">if</span> <span class="id">r</span> == 0%<span class="id">R</span> <span class="kwd">then</span> 1%<span class="id">E</span> <span class="kwd">else</span> 0%<span class="id">E</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="id">Local</span> <span class="kwd">Notation</span> "<span class="id">x</span> `^ <span class="id">r</span>" := (<span class="id">poweR</span> <span class="id">x</span> <span class="id">r</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR_EFin</span> <span class="id">s</span> <span class="id">r</span> : <span class="id">s</span>%:<span class="id">E</span> `^ <span class="id">r</span> = (<span class="id">s</span> `^ <span class="id"><a href="mathcomp.analysis.exp.html#poweRe0">r</a></span>)%:<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof106')">Proof.</span></div>
<div class="proofscript" id="proof106">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRyr</span> <span class="id">r</span> : <span class="id">r</span> != 0%<span class="id">R</span> -&gt; +<span class="id">oo</span> `^ <span class="id">r</span> = +<span class="id">oo</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof107')">Proof.</span></div>
<div class="proofscript" id="proof107">
 <span class="kwd">by</span> <span class="id">move</span>/<span class="id">negbTE</span> =&gt; /= -&gt;. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRe0</span> <span class="id">x</span> : <span class="id">x</span> `^ 0 = 1.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof108')">Proof.</span></div>
<div class="proofscript" id="proof108">
 <span class="kwd">by</span> <span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>'| |]/=; <span class="id">rewrite</span> ?<span class="id">powRr0</span>// <span class="id">eqxx</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRe1</span> <span class="id">x</span> : 0 &lt;= <span class="id">x</span> -&gt; <span class="id">x</span> `^ 1 = <span class="id"><a name="r:341">x</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof109')">Proof.</span></div>
<div class="proofscript" id="proof109">
<span class="kwd">by</span> <span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>'| |]//= <span class="id">x0</span>; <span class="id">rewrite</span> ?<span class="id">powRr1</span>// (<span class="id">negbTE</span> (<span class="id">oner_neq0</span> <span class="id">_</span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRN</span> <span class="id"><a name="x:343">x</a></span> <span class="id"><a name="r:344">r</a></span> : <span class="id">x</span> \<span class="id">is</span> <span class="id">a</span> <span class="id">fin_num</span> -&gt; <span class="id">x</span> `^ (- <span class="id">r</span>) = (<span class="id">fine</span> <span class="id">x</span> `^ <span class="id">r</span>)^-1%:<span class="id">E</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof110')">Proof.</span></div>
<div class="proofscript" id="proof110">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">x</span> =&gt; // <span class="id">x</span> <span class="id">xf</span>; <span class="id">rewrite</span> <span class="id">poweR_EFin</span> <span class="id">powRN</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRNyr</span> <span class="id">r</span> : <span class="id">r</span> != 0%<span class="id">R</span> -&gt; -<span class="id">oo</span> `^ <span class="id">r</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof111')">Proof.</span></div>
<div class="proofscript" id="proof111">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">r0</span> /=; <span class="id">rewrite</span> (<span class="id">negbTE</span> <span class="id">r0</span>). Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR_eqy</span> <span class="id">x</span> <span class="id">r</span> : <span class="id">x</span> `^ <span class="id">r</span> = +<span class="id">oo</span> -&gt; <span class="id">x</span> = +<span class="id">oo</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof112')">Proof.</span></div>
<div class="proofscript" id="proof112">
 <span class="kwd">by</span> <span class="id">case</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>| |] //=; <span class="id">case</span>: <span class="id">ifP</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">eqy_poweR</span> <span class="id">x</span> <span class="id">r</span> : (0 &lt; <span class="id"><a name="r:350">r</a></span>)%<span class="id">R</span> -&gt; <span class="id">x</span> = +<span class="id">oo</span> -&gt; <span class="id">x</span> `^ <span class="id">r</span> = +<span class="id">oo</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof113')">Proof.</span></div>
<div class="proofscript" id="proof113">
 <span class="kwd">by</span> <span class="id">move</span>: <span class="id">x</span> =&gt; [| |]//= <span class="id">r0</span> <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">gt_eqF</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR_lty</span> <span class="id">x</span> <span class="id">r</span> : <span class="id">x</span> &lt; +<span class="id">oo</span> -&gt; <span class="id">x</span> `^ <span class="id">r</span> &lt; +<span class="id">oo</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof114')">Proof.</span></div>
<div class="proofscript" id="proof114">
<span class="kwd">by</span> <span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>| |]//=; <span class="id">rewrite</span> ?<span class="id">ltry</span>//; <span class="id">case</span>: <span class="id"><a name="x:352">ifPn</a></span> =&gt; // <span class="id">_</span>; <span class="id">rewrite</span> <span class="id">ltry</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">lty_poweRy</span> <span class="id">x</span> <span class="id">r</span> : <span class="id">r</span> != 0%<span class="id">R</span> -&gt; <span class="id">x</span> `^ <span class="id">r</span> &lt; +<span class="id">oo</span> -&gt; <span class="id">x</span> &lt; +<span class="id">oo</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof115')">Proof.</span></div>
<div class="proofscript" id="proof115">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">r0</span>; <span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>| | <span class="id">_</span>]//=; <span class="id">rewrite</span> ?<span class="id">ltry</span>// (<span class="id">negbTE</span> <span class="id">r0</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR0r</span> <span class="id">r</span> : <span class="id">r</span> != 0%<span class="id">R</span> -&gt; 0 `^ <span class="id">r</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof116')">Proof.</span></div>
<div class="proofscript" id="proof116">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id"><a name="r:359">r0</a></span>; <span class="id">rewrite</span> <span class="id">poweR_EFin</span> <span class="id">powR0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR1r</span> <span class="id">r</span> : 1 `^ <span class="id">r</span> = 1<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof117')">Proof.</span></div>
<div class="proofscript" id="proof117">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">poweR_EFin</span> <span class="id">powR1</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">fine_poweR</span> <span class="id">x</span> <span class="id">r</span> : <span class="id">fine</span> (<span class="id">x</span> `^ <span class="id">r</span>) = ((<span class="id">fine</span> <span class="id">x</span>) `^ <span class="id">r</span>)%<span class="id">R</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof118')">Proof.</span></div>
<div class="proofscript" id="proof118">
<span class="kwd">by</span> <span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>| |]//=; <span class="id">case</span>: <span class="id">ifPn</span> =&gt; [/<span class="id">eqP</span> -&gt;|?]; <span class="id">rewrite</span> ?<span class="id">powRr0</span> ?<span class="id">powR0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR_ge0</span> <span class="id">x</span> <span class="id">r</span> : 0 &lt;= <span class="id">x</span> `^ <span class="id"><a name="s:363">r</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof119')">Proof.</span></div>
<div class="proofscript" id="proof119">
 <span class="kwd">by</span> <span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>| |]/=; <span class="id">rewrite</span> ?<span class="id">lee_fin</span> ?<span class="id">powR_ge0</span>//; <span class="id">case</span>: <span class="id">ifPn</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR_gt0</span> <span class="id">x</span> <span class="id">r</span> : 0 &lt; <span class="id">x</span> -&gt; 0 &lt; <span class="id">x</span> `^ <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof120')">Proof.</span></div>
<div class="proofscript" id="proof120">
<span class="kwd">by</span> <span class="id">move</span>: <span class="id"><a name="x:364">x</a></span> =&gt; [<span class="id">x</span>|<span class="id">_</span>|]//=; [<span class="id">rewrite</span> <span class="id">lte_fin</span>; <span class="id">exact</span>: <span class="id">powR_gt0</span>|<span class="id">case</span>: <span class="id">ifPn</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">gt0_poweR</span> <span class="id">x</span> <span class="id">r</span> : (0 &lt; <span class="id">r</span>)%<span class="id">R</span> -&gt; 0 &lt;= <span class="id">x</span> -&gt; 0 &lt; <span class="id">x</span> `^ <span class="id">r</span> -&gt; 0 &lt; <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof121')">Proof.</span></div>
<div class="proofscript" id="proof121">
<span class="id">move</span>=&gt; <span class="id">r0</span>; <span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>|//|]; <span class="id">rewrite</span> ?<span class="id">leeNe_eq</span>// <span class="id">lee_fin</span> !<span class="id">lte_fin</span>.<br/>
<span class="id">exact</span>: <span class="id"><a href="mathcomp.analysis.constructive_ereal.html#mule1">gt0_powR</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR_eq0</span> <span class="id">x</span> <span class="id">r</span> : 0 &lt;= <span class="id">x</span> -&gt; (<span class="id">x</span> `^ <span class="id">r</span> == 0) = ((<span class="id">x</span> == 0) &amp;&amp; (<span class="id">r</span> != 0%<span class="id">R</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof122')">Proof.</span></div>
<div class="proofscript" id="proof122">
<span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">x</span> <span class="id">_</span>|<span class="id">_</span>/=|//]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">poweR_EFin</span> <span class="id">eqe</span> <span class="id">powR_eq0</span>.<br/>
<span class="kwd">by</span> <span class="id">case</span>: <span class="id">ifP</span> =&gt; //; <span class="id">rewrite</span> <span class="id">onee_eq0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR_eq0_eq0</span> <span class="id">x</span> <span class="id">r</span> : 0 &lt;= <span class="id">x</span> -&gt; <span class="id">x</span> `^ <span class="id">r</span> = 0 -&gt; <span class="id">x</span> = 0.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof123')">Proof.</span></div>
<div class="proofscript" id="proof123">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; + /<span class="id">eqP</span> =&gt; /<span class="id">poweR_eq0</span>-&gt; /<span class="id">andP</span>[/<span class="id">eqP</span>]. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">gt0_ler_poweR</span> <span class="id">r</span> : (0 &lt;= <span class="id">r</span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;{<span class="kwd">in</span> `[0, +<span class="id">oo</span>] &amp;, {<span class="id">homo</span> <span class="id">poweR</span> ^~ <span class="id">r</span> : <span class="id">x</span> <span class="id">y</span> / <span class="id">x</span> &lt;= <span class="id">y</span> &gt;-&gt; <span class="id">x</span> &lt;= <span class="id">y</span>}}.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof124')">Proof.</span></div>
<div class="proofscript" id="proof124">
<span class="id">move</span>=&gt; <span class="id">r0</span> + <span class="id">y</span>; <span class="id">case</span>=&gt; //= [<span class="id">x</span> /[1!<span class="id">in_itv</span>]/= /<span class="id"><a href="mathcomp.analysis.exp.html#poweRyr">andP</a></span>[<span class="id">xint</span> <span class="id">_</span>]| <span class="id">_</span> <span class="id">_</span>].<br/>
- <span class="id">case</span>: <span class="id">y</span> =&gt; //= [<span class="id">y</span> /[1!<span class="id">in_itv</span>]/= /<span class="id">andP</span>[<span class="id">yint</span> <span class="id">_</span>] <span class="id">xy</span>| <span class="id">_</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">lee_fin</span> <span class="id">ge0_ler_powR</span>.<br/>
&nbsp;&nbsp;+ <span class="kwd">by</span> <span class="id">case</span>: <span class="id">eqP</span> =&gt; [-&gt;|]; <span class="id">rewrite</span> ?<span class="id">powRr0</span> ?<span class="id">leey</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">leye_eq</span> =&gt; /<span class="id">eqP</span> -&gt;.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">fin_num_poweR</span> <span class="id">x</span> <span class="id">r</span> : <span class="id">x</span> \<span class="id">is</span> <span class="id">a</span> <span class="id">fin_num</span> -&gt; <span class="id">x</span> `^ <span class="id">r</span> \<span class="id">is</span> <span class="id">a</span> <span class="id"><a name="n:373">fin_num</a></span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof125')">Proof.</span></div>
<div class="proofscript" id="proof125">
<span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">xfin</span>; <span class="id">rewrite</span> <span class="id">ge0_fin_numE</span> ?<span class="id">poweR_lty</span> ?<span class="id">ltey_eq</span> ?<span class="id">xfin</span>// <span class="id">poweR_ge0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRM</span> <span class="id">x</span> <span class="id">y</span> <span class="id">r</span> : 0 &lt;= <span class="id">x</span> -&gt; 0 &lt;= <span class="id">y</span> -&gt; (<span class="id">x</span> * <span class="id">y</span>) `^ <span class="id">r</span> = <span class="id">x</span> `^ <span class="id">r</span> * <span class="id">y</span> `^ <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof126')">Proof.</span></div>
<div class="proofscript" id="proof126">
<span class="id">have</span> [-&gt;|<span class="id">rN0</span>] := <span class="id">eqVneq</span> <span class="id">r</span> 0%<span class="id">R</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">poweRe0</span> <span class="id">mule1</span>.<br/>
<span class="id">have</span> <span class="id">powyrM</span> <span class="id">s</span> : (0 &lt;= <span class="id">s</span>)%<span class="id">R</span> -&gt; (+<span class="id">oo</span> * <span class="id"><a href="mathcomp.analysis.sequences.html#harmonic">s</a></span>%:<span class="id">E</span>) `^ <span class="id">r</span> = +<span class="id"><a href="mathcomp.analysis.exp.html#riemannR">oo</a></span> `^ <span class="id">r</span> * <span class="id">s</span>%:<span class="id">E</span> `^ <span class="id">r</span>.<br/>
&nbsp;&nbsp;<span class="id">case</span>: <span class="id">ltgtP</span> =&gt; // [<span class="id">s_gt0</span> <span class="id"><a href="mathcomp.analysis.exp.html#powR1">_</a></span>|&lt;- <span class="id">_</span>]; <span class="id">last</span> <span class="id">first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mule0</span> <span class="id">poweRyr</span>// !<span class="id"><a href="mathcomp.analysis.exp.html#powR_gt0">poweR0r</a></span>// <span class="id">mule0</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">gt0_mulye</span>// <span class="id">poweRyr</span>// <span class="id">gt0_mulye</span>// <span class="id">poweR_gt0</span>.<br/>
<span class="id">case</span>: <span class="id">x</span> <span class="id">y</span> =&gt; [<span class="id">x</span>| |] [<span class="id">y</span>| |]// <span class="id">x0</span> <span class="id">y0</span>; <span class="id"><a href="mathcomp.analysis.sequences.html#harmonic_ge0">first</a></span> <span class="kwd">by</span> <span class="id">rewrite</span> /= -<span class="id">EFinM</span> <span class="id">powRM</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">muleC</span> <span class="id">powyrM</span>// <span class="id">muleC</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powyrM</span>.<br/>
- <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulyy</span> !<span class="id">poweRyr</span>// <span class="id">mulyy</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRrM</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : <span class="id">x</span> `^ (<span class="id">r</span> * <span class="id">s</span>) = (<span class="id">x</span> `^ <span class="id">r</span>) `^ <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof127')">Proof.</span></div>
<div class="proofscript" id="proof127">
<span class="id">have</span> [-&gt;|<span class="id">s0</span>] := <span class="id">eqVneq</span> <span class="id">s</span> 0%<span class="id">R</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mulr0</span> !<span class="id">poweRe0</span>.<br/>
<span class="id">have</span> [-&gt;|<span class="id">r0</span>] := <span class="id">eqVneq</span> <span class="id">r</span> 0%<span class="id">R</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mul0r</span> <span class="id">poweRe0</span> <span class="id">poweR1r</span>.<br/>
<span class="id">case</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>| |]//; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> /= <span class="id">powRrM</span>.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">poweRyr</span>// <span class="id">mulf_neq0</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> !<span class="id">poweRNyr</span> ?<span class="id">poweR0r</span> ?(<span class="id">negPf</span> <span class="id">s0</span>)// <span class="id">mulf_neq0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRAC</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : (<span class="id">x</span> `^ <span class="id">r</span>) `^ <span class="id">s</span> = (<span class="id">x</span> `^ <span class="id">s</span>) `^ <span class="id">r</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof128')">Proof.</span></div>
<div class="proofscript" id="proof128">
 <span class="kwd">by</span> <span class="id">rewrite</span> -!<span class="id">poweRrM</span> <span class="id">mulrC</span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">poweRD_def</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> := ((<span class="id">r</span> + <span class="id">s</span> == 0)%<span class="id">R</span> ==&gt;<br/>
&nbsp;&nbsp;((<span class="id">x</span> != 0) &amp;&amp; ((<span class="id">x</span> \<span class="id">isn</span>'<span class="id">t</span> <span class="id">a</span> <span class="id">fin_num</span>) ==&gt; (<span class="id">r</span> == 0%<span class="id">R</span>) &amp;&amp; (<span class="id">s</span> == 0%<span class="id">R</span>)))).<br/>
<span class="kwd">Notation</span> "<span class="id">x</span> '`^?' ( <span class="id">r</span> +? <span class="id">s</span> )" := (<span class="id">poweRD_def</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span>) : <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRD_defE</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> :<br/>
&nbsp;&nbsp;<span class="id">x</span> `^?(<span class="id">r</span> +? <span class="id">s</span>) = ((<span class="id">r</span> + <span class="id">s</span> == 0)%<span class="id">R</span> ==&gt;<br/>
&nbsp;&nbsp;((<span class="id">x</span> != 0) &amp;&amp; ((<span class="id">x</span> \<span class="id">isn</span>'<span class="id">t</span> <span class="id">a</span> <span class="id">fin_num</span>) ==&gt; (<span class="id">r</span> == 0%<span class="id">R</span>) &amp;&amp; (<span class="id">s</span> == 0%<span class="id">R</span>)))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof129')">Proof.</span></div>
<div class="proofscript" id="proof129">
 <span class="kwd">by</span> []. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRB_defE</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> :<br/>
&nbsp;&nbsp;<span class="id">x</span> `^?(<span class="id">r</span> +? - <span class="id">s</span>) = ((<span class="id">r</span> == <span class="id">s</span>)%<span class="id">R</span> ==&gt;<br/>
&nbsp;&nbsp;((<span class="id">x</span> != 0) &amp;&amp; ((<span class="id">x</span> \<span class="id">isn</span>'<span class="id">t</span> <span class="id">a</span> <span class="id">fin_num</span>) ==&gt; (<span class="id">r</span> == 0%<span class="id">R</span>) &amp;&amp; (<span class="id">s</span> == 0%<span class="id">R</span>)))).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof130')">Proof.</span></div>
<div class="proofscript" id="proof130">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">poweRD_defE</span> <span class="id">subr_eq0</span> <span class="id">oppr_eq0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">add_neq0_poweRD_def</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : (<span class="id">r</span> + <span class="id">s</span> != 0)%<span class="id">R</span> -&gt; <span class="id">x</span> `^?(<span class="id">r</span> +? <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof131')">Proof.</span></div>
<div class="proofscript" id="proof131">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">poweRD_defE</span> =&gt; /<span class="id">negPf</span>-&gt;. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">add_neq0_poweRB_def</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : (<span class="id">r</span> != <span class="id">s</span>)%<span class="id">R</span> -&gt; <span class="id">x</span> `^?(<span class="id">r</span> +? - <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof132')">Proof.</span></div>
<div class="proofscript" id="proof132">
 <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">poweRB_defE</span> =&gt; /<span class="id">negPf</span>-&gt;. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nneg_neq0_poweRD_def</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : <span class="id">x</span> != 0 -&gt; (<span class="id">r</span> &gt;= 0)%<span class="id">R</span> -&gt; (<span class="id">s</span> &gt;= 0)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">x</span> `^?(<span class="id">r</span> +? <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof133')">Proof.</span></div>
<div class="proofscript" id="proof133">
<span class="id">move</span>=&gt; <span class="id">xN0</span> <span class="id">rge0</span> <span class="id">sge0</span>; <span class="id">rewrite</span> /<span class="id">poweRD_def</span> <span class="id">xN0</span>/=.<br/>
<span class="kwd">by</span> <span class="id">case</span>: <span class="id">ltgtP</span> <span class="id">rge0</span> =&gt; // [<span class="id">r_gt0</span>|&lt;-]; <span class="id">case</span>: <span class="id">ltgtP</span> <span class="id">sge0</span> =&gt; // [<span class="id">s_gt0</span>|&lt;-]//=;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> ?<span class="id">addr0</span> ?<span class="id">add0r</span> ?<span class="id">implybT</span>// <span class="id">gt_eqF</span>//= ?<span class="id">addr_gt0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">nneg_neq0_poweRB_def</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : <span class="id">x</span> != 0 -&gt; (<span class="id">r</span> &gt;= 0)%<span class="id">R</span> -&gt; (<span class="id">s</span> &lt;= 0)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">x</span> `^?(<span class="id">r</span> +? - <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof134')">Proof.</span></div>
<div class="proofscript" id="proof134">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; *; <span class="id">rewrite</span> <span class="id">nneg_neq0_poweRD_def</span>// <span class="id">oppr_ge0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRD</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : <span class="id">x</span> `^?(<span class="id">r</span> +? <span class="id">s</span>) -&gt; <span class="id">x</span> `^ (<span class="id">r</span> + <span class="id">s</span>) = <span class="id">x</span> `^ <span class="id">r</span> * <span class="id">x</span> `^ <span class="id">s</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof135')">Proof.</span></div>
<div class="proofscript" id="proof135">
<span class="id">rewrite</span> /<span class="id">poweRD_def</span>.<br/>
<span class="id">have</span> [-&gt;|<span class="id">r0</span>]/= := <span class="id">eqVneq</span> <span class="id">r</span> 0%<span class="id">R</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">add0r</span> <span class="id">poweRe0</span> <span class="id">mul1e</span>.<br/>
<span class="id">have</span> [-&gt;|<span class="id">s0</span>]/= := <span class="id">eqVneq</span> <span class="id">s</span> 0%<span class="id">R</span>; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">addr0</span> <span class="id">poweRe0</span> <span class="id">mule1</span>.<br/>
<span class="id">case</span>: <span class="id">x</span> =&gt; // [<span class="id">t</span>|/=|/=]; <span class="id">rewrite</span> ?(<span class="id">negPf</span> <span class="id">r0</span>, <span class="id">negPf</span> <span class="id">s0</span>, <span class="id">implybF</span>); <span class="id">last</span> 2 <span class="id">first</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">negPf</span>-&gt;; <span class="id">rewrite</span> <span class="id">mulyy</span>.<br/>
- <span class="kwd">by</span> <span class="id">move</span>=&gt; /<span class="id">negPf</span>-&gt;; <span class="id">rewrite</span> <span class="id">mule0</span>.<br/>
<span class="id">rewrite</span> !<span class="id">poweR_EFin</span> <span class="id">eqe</span> =&gt; /<span class="id">implyP</span>/(<span class="id">_</span> <span class="id">_</span>)/<span class="id">andP</span> <span class="id">cnd</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powRD</span>//; <span class="id">apply</span>/<span class="id">implyP</span> =&gt; /<span class="id">cnd</span>[].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweRB</span> <span class="id">x</span> <span class="id">r</span> <span class="id">s</span> : <span class="id">x</span> `^?(<span class="id">r</span> +? - <span class="id">s</span>) -&gt; <span class="id">x</span> `^ (<span class="id">r</span> - <span class="id">s</span>) = <span class="id">x</span> `^ <span class="id">r</span> * <span class="id">x</span> `^ (- <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof136')">Proof.</span></div>
<div class="proofscript" id="proof136">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; <span class="id">rs</span>; <span class="id">rewrite</span> <span class="id">poweRD</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">poweR12_sqrt</span> <span class="id">x</span> : 0 &lt;= <span class="id">x</span> -&gt; <span class="id">x</span> `^ 2^-1 = <span class="id">sqrte</span> <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof137')">Proof.</span></div>
<div class="proofscript" id="proof137">
<span class="id">move</span>: <span class="id">x</span> =&gt; [<span class="id">x</span>|<span class="id">_</span>|//]; <span class="id">last</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">poweRyr</span>.<br/>
<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">lee_fin</span> =&gt; <span class="id">x0</span> /=; <span class="id">rewrite</span> <span class="id">powR12_sqrt</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">poweR</span>.<br/>
<span class="kwd">Notation</span> "<span class="id">a</span> `^ <span class="id">x</span>" := (<span class="id">poweR</span> <span class="id">a</span> <span class="id">x</span>) : <span class="id">ereal_scope</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id">riemannR_series</span>.<br/>
<span class="kwd">Variable</span> <span class="id">R</span> : <span class="id">realType</span>.<br/>
<span class="kwd">Implicit</span> <span class="id">Types</span> <span class="id">a</span> : <span class="id">R</span>.<br/>
<span class="id">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">real_scope</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">riemannR</span> <span class="id">a</span> : <span class="id">R</span> ^<span class="id">nat</span> := <span class="kwd">fun</span> <span class="id">n</span> =&gt; (<span class="id">n</span>.+1%:<span class="id">R</span> `^ <span class="id">a</span>)^-1.<br/>
<span class="kwd">Arguments</span> <span class="id">riemannR</span> <span class="id">a</span> <span class="id">n</span> /.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">riemannR_gt0</span> <span class="id">a</span> <span class="id">i</span> : 0 &lt;= <span class="id">a</span> -&gt; 0 &lt; <span class="id">riemannR</span> <span class="id">a</span> <span class="id">i</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof138')">Proof.</span></div>
<div class="proofscript" id="proof138">
 <span class="kwd">by</span> <span class="id">move</span>=&gt; ?; <span class="id">rewrite</span> /<span class="id">riemannR</span> <span class="id">invr_gt0</span> <span class="id">powR_gt0</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">dvg_riemannR</span> <span class="id">a</span> : 0 &lt;= <span class="id">a</span> &lt;= 1 -&gt; ~ <span class="id">cvg</span> (<span class="id">series</span> (<span class="id">riemannR</span> <span class="id">a</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof139')">Proof.</span></div>
<div class="proofscript" id="proof139">
<span class="id">move</span>=&gt; /<span class="id">andP</span>[<span class="id">a0</span> <span class="id">a1</span>].<br/>
<span class="id">have</span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">harmonic</span> <span class="id">n</span> &lt;= <span class="id">riemannR</span> <span class="id">a</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">move</span>=&gt; [/=|<span class="id">n</span>]; <span class="id">first</span> <span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">powR1</span> <span class="id">invr1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> -[<span class="id">leRHS</span>]<span class="id">div1r</span> <span class="id">ler_pdivl_mulr</span> ?<span class="id">powR_gt0</span>// <span class="id">mulrC</span> <span class="id">ler_pdivr_mulr</span>//.<br/>
&nbsp;&nbsp;<span class="kwd">by</span> <span class="id">rewrite</span> <span class="id">mul1r</span> -[<span class="id">leRHS</span>]<span class="id">powRr1</span>// (<span class="id">ler_powR</span>)// <span class="id">ler1n</span>.<br/>
<span class="id">move</span>/(<span class="id">series_le_cvg</span> <span class="id">harmonic_ge0</span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id">ltW</span> (<span class="id">riemannR_gt0</span> <span class="id">i</span> <span class="id">a0</span>))).<br/>
<span class="kwd">by</span> <span class="id">move</span>/<span class="id">contra_not</span>; <span class="id">apply</span>; <span class="id">exact</span>: <span class="id">dvg_harmonic</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id">riemannR_series</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/tree/yoshihiro503%40generate_index">a fork of coq2html</a></div>
</body>
</html>
