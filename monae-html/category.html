
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module category</title>
<meta name="description" content="Documentation of Coq module category" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init('proofscript')">
<h1 class="title">Module category</h1>
<div class="coq">
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">all_ssreflect</span>.<br/>
<span class="vernacular">From</span> <span class="id">mathcomp</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">boolp</span>.<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">monae_lib</span>.<br/>
<span class="vernacular">From</span> <span class="id">HB</span> <span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">structures</span>.<br/>
<br/>
<pre class="ssrdoc">
                 Formalization of basic category theory                    
                                                                           
This file provides definitions of category, functor, monad, as well as     
basic theorems. It comes as a generalization of the first part of          
hierarchy.v which is specialized to the category of sets.                  
                                                                           
           category == type of categories, a category C is implemented     
                       with a universe a la Tarski, there is a realizer    
                       function el that associates to each object A the    
                       type el A of its elements; this corresponds to the  
                       definition of concrete categories                   
         {hom A, B} == the hom-set of morphisms from A to B, where A and B 
                       are objects of a category C                         
            [hom f] == morphism corresponding to the function f            
                 CT := [the category of Type]                              
        FunctorLaws == module that defines the functor laws                
                 \O == functor composition                                 
            F ~~&gt; G == forall a, {hom F a ,G a}, which corresponds to a    
                       natural transformation when it satisfies the        
                       predicate naturality                                
                NId == the identity natural transformation                 
         [NEq F, G] == natural transformation from F to G where F and G    
                       are convertible, especially when they are           
                       compositions, and differ only by associativity or   
                       insertion of unit functors                          
                 \v == vertical composition                                
                 \h == horizontal composition, or Godement product         
             F -| G == pair of adjoint functors (Module                    
                       Module AdjointFunctors); see also TriangularLaws.   
     Module AdjComp == define a pair of adjoint functors by composition of 
                       two pairs of adjoint functors                       
 JoinLaws, BindLaws == modules that define the monad laws                  
            isMonad == mixin that defines the monad interface              
  Monad_of_ret_bind == factory, monad defined by ret and bind              
  Monad_of_ret_join == factory, monad defined by ret and join              
Monad_of_adjoint_functors == module that defines a monad by a pair of      
                       adjoint functors                                    
Monad_of_category_monad == module, interface to isMonad from hierarchy.v   
Monad_of_category_monad.m == turns a monad over the Type category into     
                       a monad in the sense of isMonad from hierarchy.v    
</pre>
<br/>
<span class="vernacular">Reserved</span> <span class="vernacular">Notation</span> <span class="id">"F&nbsp;~~&gt;&nbsp;G"</span> (<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">51</span>).<br/>
<br/>
<span class="id">Declare</span> <span class="vernacular">Scope</span> <span class="id">category_scope</span>.<br/>
<span class="id">Delimit</span> <span class="vernacular">Scope</span> <span class="id">category_scope</span> <span class="gallina-kwd">with</span> <span class="id">category</span>.<br/>
<br/>
<span class="id">Local</span> <span class="vernacular">Open</span> <span class="vernacular">Scope</span> <span class="id">category_scope</span>.<br/>
<br/>
<span class="gallina-kwd">Set</span> <span class="vernacular">Implicit</span> <span class="vernacular">Arguments</span>.<br/>
<span class="id">Unset</span> <span class="id">Strict</span> <span class="vernacular">Implicit</span>.<br/>
<span class="id">Unset</span> <span class="id">Printing</span> <span class="vernacular">Implicit</span> <span class="id">Defensive</span>.<br/>
<br/>
<span class="id">#[global]</span><br/>
<span class="id">Remove</span> <span class="id">Hints</span> <span class="id">frefl</span> <span class="id">:</span> <span class="id">core</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">frefl_transparent</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">B</span>) <span class="id">:</span> <span class="id">f</span> <span class="id">=1</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof1')">Proof.</span></div>
<div class="proofscript" id="proof1">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Defined.</div>
<br/>
<span class="id">#[global]</span><br/>
<span class="vernacular">Hint</span> <span class="id">Resolve</span> <span class="id">frefl_transparent</span> <span class="id">:</span> <span class="id">core</span>.<br/>
<br/>
<span class="id">HB.mixin</span> <span class="vernacular">Record</span> <span class="id">isCategory</span> (<span class="id">obj</span> <span class="id">:</span> <span class="gallina-kwd">Type</span>) <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">el</span> <span class="id">:</span> <span class="id">obj</span> <span class="id">-&gt;</span> <span class="gallina-kwd">Type</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">inhom</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">a</span> <span class="id">b,</span> (<span class="id">el</span> <span class="id">a</span> <span class="id">-&gt;</span> <span class="id">el</span> <span class="id">b</span>) <span class="id">-&gt;</span> <span class="gallina-kwd">Prop</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">idfun_inhom</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">a,</span> <span class="id">@inhom</span> <span class="id">a</span> <span class="id">a</span> <span class="id">idfun</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">funcomp_inhom</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">el</span> <span class="id">a</span> <span class="id">-&gt;</span> <span class="id">el</span> <span class="id">b</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">el</span> <span class="id">b</span> <span class="id">-&gt;</span> <span class="id">el</span> <span class="id">c</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inhom</span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span> <span class="id">-&gt;</span> <span class="id">inhom</span> <span class="id">_</span> <span class="id">_</span> <span class="id">g</span> <span class="id">-&gt;</span> <span class="id">inhom</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">g</span> <span class="id">\o</span> <span class="id">f</span>)<br/>
<span class="id">}</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">isCategory.phant_Build</span> <span class="id">:</span> <span class="id">clear</span> <span class="id">implicits</span>.<br/>
<br/>
<span class="id">#[short</span>(<span class="id">type=category</span>)<span class="id">]</span><br/>
<span class="id">HB.structure</span> <span class="vernacular">Definition</span> <span class="id">Category</span> <span class="id">:=</span> <span class="id">{C</span> <span class="id">of</span> <span class="id">isCategory</span> <span class="id">C}</span>.<br/>
<br/>
<span class="vernacular">Arguments</span> <span class="id">idfun_inhom</span> <span class="id">[C]</span> <span class="id">:</span> <span class="id">rename</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">funcomp_inhom</span> <span class="id">[C</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">f</span> <span class="id">g]</span> <span class="id">:</span> <span class="id">rename</span>.<br/>
<br/>
<span class="id">HB.mixin</span> <span class="vernacular">Record</span> <span class="id">isHom</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">el</span> <span class="id">a</span> <span class="id">-&gt;</span> <span class="id">el</span> <span class="id">b</span>) <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">isHom_inhom</span> <span class="id">:</span> <span class="id">inhom</span> <span class="id">a</span> <span class="id">b</span> <span class="id">f</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB.structure</span> <span class="vernacular">Definition</span> <span class="id">Hom</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">{f</span> <span class="id">of</span> <span class="id">isHom</span> <span class="id">C</span> <span class="id">a</span> <span class="id">b</span> <span class="id">f}</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">isHom_inhom</span> <span class="id">[C</span> <span class="id">a</span> <span class="id">b]</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"{&nbsp;'hom'&nbsp;U&nbsp;,&nbsp;V&nbsp;}"</span> <span class="id">:=</span> (<span class="id">Hom.type</span> <span class="id">U</span> <span class="id">V</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span> <span class="id">format</span> <span class="id">"{&nbsp;'hom'&nbsp;&nbsp;U&nbsp;,&nbsp;&nbsp;V&nbsp;}"</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"{&nbsp;'hom'&nbsp;C&nbsp;;&nbsp;U&nbsp;,&nbsp;V&nbsp;}"</span> <span class="id">:=</span> (<span class="id">@Hom</span>.<span class="id">type</span> <span class="id">C</span> <span class="id">U</span> <span class="id">V</span>)<br/>
&nbsp;&nbsp;(<span class="id">only</span> <span class="id">parsing</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"[&nbsp;'hom'&nbsp;f&nbsp;]"</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">{hom</span> <span class="id">_</span> <span class="id">,</span> <span class="id">_}</span> <span class="id">of</span> <span class="id">f]</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span> <span class="id">format</span> <span class="id">"[&nbsp;'hom'&nbsp;&nbsp;f&nbsp;]"</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">hom_ext</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">f</span> <span class="id">=</span> <span class="id">g</span> <span class="id">&lt;-&gt;</span> <span class="id">f</span> <span class="id">=</span> <span class="id">g</span> <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof2')">Proof.</span></div>
<div class="proofscript" id="proof2">
<span class="id">move:</span> <span class="id">f</span> <span class="id">g</span> <span class="id">=&gt;</span> <span class="id">[f</span> <span class="id">[[Hf]]]</span> <span class="id">[g</span> <span class="id">[[Hg]]]</span> <span class="id">/=;</span> <span class="id">split</span> <span class="id">=&gt;</span> <span class="id">[[]//|fg</span> <span class="id">/=]</span>.<br/>
<span class="id">rewrite</span> <span class="id">fg</span> <span class="gallina-kwd">in</span> <span class="id">Hf</span> <span class="id">Hg</span> <span class="id">*</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> (<span class="id">boolp.Prop_irrelevance</span> <span class="id">Hf</span> <span class="id">Hg</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Section</span> <span class="id">hom_interface</span>.<br/>
<span class="vernacular">Variable</span> <span class="id">C</span> <span class="id">:</span> <span class="id">category</span>.<br/>
<span class="vernacular">Implicit</span> <span class="id">Types</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">:</span> <span class="id">C</span>.<br/>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">c</span> <span class="id">:=</span> <span class="id">isHom.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">@idfun</span> (<span class="id">el</span> <span class="id">c</span>)) (<span class="id">idfun_inhom</span> <span class="id">c</span>).<br/>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">c}</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>)<span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">isHom.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id">f</span> <span class="id">\o</span> <span class="id">g</span>) (<span class="id">funcomp_inhom</span> (<span class="id">isHom_inhom</span> <span class="id">g</span>) (<span class="id">isHom_inhom</span> <span class="id">f</span>)).<br/>
<span class="vernacular">End</span> <span class="id">hom_interface</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">comps_notation</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"[&nbsp;'\o'&nbsp;f&nbsp;,&nbsp;..&nbsp;,&nbsp;g&nbsp;,&nbsp;h&nbsp;]"</span> <span class="id">:=</span> (<span class="id">f</span> <span class="id">\o</span> <span class="id">.</span>. (<span class="id">g</span> <span class="id">\o</span> <span class="id">h</span>) <span class="id">.</span>.) (<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span><br/>
&nbsp;&nbsp;<span class="id">format</span> <span class="id">"[&nbsp;'['&nbsp;'\o'&nbsp;&nbsp;f&nbsp;,&nbsp;&nbsp;'/'&nbsp;..&nbsp;,&nbsp;&nbsp;'/'&nbsp;g&nbsp;,&nbsp;&nbsp;'/'&nbsp;h&nbsp;']'&nbsp;]"</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<span class="vernacular">End</span> <span class="id">comps_notation</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">category_lemmas</span>.<br/>
<span class="vernacular">Variable</span> <span class="id">C</span> <span class="id">:</span> <span class="id">category</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">homfunK</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span> <span class="id">[hom</span> <span class="id">f]</span> <span class="id">=</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof3')">Proof.</span></div>
<div class="proofscript" id="proof3">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">homcompA</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">d}</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">c}</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">[hom</span> <span class="id">[hom</span> <span class="id">h</span> <span class="id">\o</span> <span class="id">g]</span> <span class="id">\o</span> <span class="id">f]</span> <span class="id">=</span> <span class="id">[hom</span> <span class="id">h</span> <span class="id">\o</span> <span class="id">[hom</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">f]]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof4')">Proof.</span></div>
<div class="proofscript" id="proof4">
 <span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">f</span> <span class="id">g</span> <span class="id">h</span> <span class="id">=&gt;</span> <span class="id">[?</span> <span class="id">?]</span> <span class="id">[?</span> <span class="id">?]</span> <span class="id">[?</span> <span class="id">?];</span> <span class="id">apply</span> <span class="id">hom_ext</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">homcompE</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">c}</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">[hom</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">f]</span> <span class="id">=</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">f</span> <span class="id">:&gt;</span> (<span class="id">el</span> <span class="id">a</span> <span class="id">-&gt;</span> <span class="id">el</span> <span class="id">c</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof5')">Proof.</span></div>
<div class="proofscript" id="proof5">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">hom_compE</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">c}</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">x</span> <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">g</span> (<span class="id">f</span> <span class="id">x</span>) <span class="id">=</span> (<span class="id">g</span> <span class="id">\o</span> <span class="id">f</span>) <span class="id">x</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof6')">Proof.</span></div>
<div class="proofscript" id="proof6">
 <span class="id">exact:</span> <span class="id">compE</span>. Qed.</div>
<br/>
<span class="vernacular">Import</span> <span class="id">comps_notation</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">hom_compA</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">d}</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">c}</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">h</span> <span class="id">\o</span> <span class="id">g</span>) <span class="id">\o</span> <span class="id">f</span> <span class="id">=</span> <span class="id">[\o</span> <span class="id">h,</span> <span class="id">g,</span> <span class="id">f]</span> <span class="id">:&gt;</span> (<span class="id">el</span> <span class="id">a</span> <span class="id">-&gt;</span> <span class="id">el</span> <span class="id">d</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof7')">Proof.</span></div>
<div class="proofscript" id="proof7">
 <span class="id">exact:</span> <span class="id">compA</span>. Qed.</div>
<br/>
<span class="vernacular">Example</span> <span class="id">hom_compA'</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">d</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">d}</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">c}</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">h</span> <span class="id">\o</span> <span class="id">g</span>) <span class="id">\o</span> <span class="id">f</span> <span class="id">=</span> <span class="id">[\o</span> <span class="id">h,</span> <span class="id">g,</span> <span class="id">f]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof8')">Proof.</span></div>
<div class="proofscript" id="proof8">
<span class="id">rewrite</span> <span class="id">10!compA</span>.<br/>
<span class="id">Undo</span> <span class="id">1</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">!hom_compA</span>.<br/>
<span class="comment">(*&nbsp;rewrite&nbsp;!homcompA&nbsp;blocks&nbsp;id's&nbsp;from&nbsp;coming&nbsp;in,&nbsp;thanks&nbsp;to&nbsp;{hom&nbsp;_,_}&nbsp;conditions&nbsp;on&nbsp;arguments.&nbsp;*)</span><br/>
Abort.</div>
<br/>
<br/>
<span class="vernacular">End</span> <span class="id">category_lemmas</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">transport_lemmas</span>.<br/>
<span class="vernacular">Variable</span> <span class="id">C</span> <span class="id">:</span> <span class="id">category</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">transport_dom</span><br/>
&nbsp;&nbsp;(<span class="id">a</span> <span class="id">a'</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">p</span> <span class="id">:</span> <span class="id">a</span> <span class="id">=</span> <span class="id">a'</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span> <span class="id">{hom</span> <span class="id">a',</span> <span class="id">b}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_rect</span> <span class="id">a</span> (<span class="gallina-kwd">fun</span> <span class="id">x</span> <span class="id">=&gt;</span> <span class="id">{hom</span> <span class="id">x,</span> <span class="id">b}</span>) <span class="id">f</span> <span class="id">a'</span> <span class="id">p</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">transport_codom</span><br/>
&nbsp;&nbsp;(<span class="id">a</span> <span class="id">b</span> <span class="id">b'</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">p</span> <span class="id">:</span> <span class="id">b</span> <span class="id">=</span> <span class="id">b'</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span> <span class="id">{hom</span> <span class="id">a</span> <span class="id">,</span> <span class="id">b'}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eq_rect</span> <span class="id">b</span> (<span class="gallina-kwd">fun</span> <span class="id">x</span> <span class="id">=&gt;</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">x}</span>) <span class="id">f</span> <span class="id">b'</span> <span class="id">p</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">transport_hom</span> (<span class="id">a</span> <span class="id">a'</span> <span class="id">b</span> <span class="id">b'</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">pa</span> <span class="id">:</span> <span class="id">a</span> <span class="id">=</span> <span class="id">a'</span>) (<span class="id">pb</span> <span class="id">:</span> <span class="id">b</span> <span class="id">=</span> <span class="id">b'</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span> <span class="id">{hom</span> <span class="id">a',</span> <span class="id">b'}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">eq_rect</span> <span class="id">b</span> (<span class="gallina-kwd">fun</span> <span class="id">y</span> <span class="id">=&gt;</span> <span class="id">{hom</span> <span class="id">a',</span> <span class="id">y}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">eq_rect</span> <span class="id">a</span> (<span class="gallina-kwd">fun</span> <span class="id">x</span> <span class="id">=&gt;</span> <span class="id">{hom</span> <span class="id">x,</span> <span class="id">b}</span>) <span class="id">f</span> <span class="id">a'</span> <span class="id">pa</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">b'</span> <span class="id">pb</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">hom_of_eq</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">p</span> <span class="id">:</span> <span class="id">a</span> <span class="id">=</span> <span class="id">b</span>) <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">transport_codom</span> <span class="id">p</span> <span class="id">[hom</span> <span class="id">idfun]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">transport_domF</span> (<span class="id">a</span> <span class="id">a'</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">p</span> <span class="id">:</span> <span class="id">a</span> <span class="id">=</span> <span class="id">a'</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">transport_dom</span> <span class="id">p</span> <span class="id">f</span> <span class="id">=</span> <span class="id">[hom</span> <span class="id">f</span> <span class="id">\o</span> <span class="id">hom_of_eq</span> (<span class="id">esym</span> <span class="id">p</span>)<span class="id">]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof9')">Proof.</span></div>
<div class="proofscript" id="proof9">
 <span class="id">apply</span> <span class="id">hom_ext;</span> <span class="gallina-kwd">by</span> <span class="id">subst</span> <span class="id">a'</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">transport_codomF</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">b'</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">p</span> <span class="id">:</span> <span class="id">b</span> <span class="id">=</span> <span class="id">b'</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">transport_codom</span> <span class="id">p</span> <span class="id">f</span> <span class="id">=</span> <span class="id">[hom</span> <span class="id">hom_of_eq</span> <span class="id">p</span> <span class="id">\o</span> <span class="id">f]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof10')">Proof.</span></div>
<div class="proofscript" id="proof10">
 <span class="id">apply</span> <span class="id">hom_ext;</span> <span class="gallina-kwd">by</span> <span class="id">subst</span> <span class="id">b'</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">transport_homF</span> (<span class="id">a</span> <span class="id">a'</span> <span class="id">b</span> <span class="id">b'</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">pa</span> <span class="id">:</span> <span class="id">a</span> <span class="id">=</span> <span class="id">a'</span>) (<span class="id">pb</span> <span class="id">:</span> <span class="id">b</span> <span class="id">=</span> <span class="id">b'</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">transport_hom</span> <span class="id">pa</span> <span class="id">pb</span> <span class="id">f</span> <span class="id">=</span> <span class="id">[hom</span> <span class="id">hom_of_eq</span> <span class="id">pb</span> <span class="id">\o</span> <span class="id">f</span> <span class="id">\o</span> <span class="id">hom_of_eq</span> (<span class="id">esym</span> <span class="id">pa</span>)<span class="id">]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof11')">Proof.</span></div>
<div class="proofscript" id="proof11">
 <span class="id">apply</span> <span class="id">hom_ext;</span> <span class="gallina-kwd">by</span> <span class="id">subst</span> <span class="id">a'</span> <span class="id">b'</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">transport_lemmas</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">Type_as_a_category</span>.<br/>
<span class="vernacular">Let</span> <span class="id">UUx</span> <span class="id">:=</span> <span class="gallina-kwd">Type</span>.<br/>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">isCategory.Build</span> <span class="id">UUx</span> (<span class="gallina-kwd">fun</span> <span class="id">x</span> <span class="id">:</span> <span class="gallina-kwd">Type</span> <span class="id">=&gt;</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">True</span>) (<span class="id">fun=&gt;</span> <span class="id">I</span>) (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">I</span>).<br/>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">[the</span> <span class="id">category</span> <span class="id">of</span> <span class="id">UUx]</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">a</span> <span class="id">-&gt;</span> <span class="id">b</span>)<br/>
&nbsp;&nbsp;<span class="id">:=</span> <span class="id">isHom.Build</span> <span class="id">[the</span> <span class="id">category</span> <span class="id">of</span> <span class="id">UUx]</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">el</span> <span class="id">a</span> <span class="id">-&gt;</span> <span class="id">el</span> <span class="id">b</span>) <span class="id">I</span>.<br/>
<br/>
<span class="vernacular">End</span> <span class="id">Type_as_a_category</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">CT</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">category</span> <span class="id">of</span> <span class="id">Type]</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">FunctorLaws</span>.<br/>
<span class="vernacular">Section</span> <span class="id">def</span>.<br/>
<span class="vernacular">Variable</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>).<br/>
<span class="vernacular">Variable</span> (<span class="id">F</span> <span class="id">:</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D</span>) (<span class="id">f</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">a</span> <span class="id">b,</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span> <span class="id">-&gt;</span> <span class="id">{hom</span> <span class="id">F</span> <span class="id">a,</span> <span class="id">F</span> <span class="id">b}</span>).<br/>
<span class="vernacular">Definition</span> <span class="id">id</span> <span class="id">:=</span> <span class="gallina-kwd">forall</span> <span class="id">a,</span> <span class="id">f</span> <span class="id">[hom</span> <span class="id">idfun]</span> <span class="id">=</span> <span class="id">[hom</span> <span class="id">idfun]</span> <span class="id">:&gt;</span> <span class="id">{hom</span> <span class="id">F</span> <span class="id">a,</span> <span class="id">F</span> <span class="id">a}</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">comp</span> <span class="id">:=</span> <span class="gallina-kwd">forall</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">c}</span>) (<span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;<span class="id">f</span> <span class="id">[hom</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">h]</span> <span class="id">=</span> <span class="id">[hom</span> <span class="id">f</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">f</span> <span class="id">h]</span>.<br/>
<span class="vernacular">End</span> <span class="id">def</span>.<br/>
<span class="vernacular">End</span> <span class="id">FunctorLaws</span>.<br/>
<br/>
<span class="id">HB.mixin</span> <span class="vernacular">Record</span> <span class="id">isFunctor</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">:</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D</span>) <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">actm</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">a</span> <span class="id">b,</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span> <span class="id">-&gt;</span> <span class="id">{hom</span> <span class="id">F</span> <span class="id">a,</span> <span class="id">F</span> <span class="id">b}</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">functor_id_hom</span> <span class="id">:</span> <span class="id">FunctorLaws.id</span> <span class="id">actm</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">functor_o_hom</span> <span class="id">:</span> <span class="id">FunctorLaws.comp</span> <span class="id">actm</span> <span class="id">}</span>.<br/>
<br/>
<span class="id">HB.structure</span> <span class="vernacular">Definition</span> <span class="id">Functor</span> <span class="id">C</span> <span class="id">D</span> <span class="id">:=</span> <span class="id">{F</span> <span class="id">of</span> <span class="id">isFunctor</span> <span class="id">C</span> <span class="id">D</span> <span class="id">F}</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">functor_phant</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) <span class="id">of</span> <span class="id">phant</span> (<span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D</span>) <span class="id">:=</span> <span class="id">Functor.type</span> <span class="id">C</span> <span class="id">D</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">actm</span> <span class="id">[C</span> <span class="id">D]</span> <span class="id">F</span> <span class="id">[a</span> <span class="id">b]</span> <span class="id">f:</span> <span class="id">rename</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"F&nbsp;#&nbsp;f"</span> <span class="id">:=</span> (<span class="id">actm</span> <span class="id">F</span> <span class="id">f</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"{&nbsp;'functor'&nbsp;fCD&nbsp;}"</span> <span class="id">:=</span> (<span class="id">functor_phant</span> (<span class="id">Phant</span> <span class="id">fCD</span>))<br/>
&nbsp;&nbsp;(<span class="id">format</span> <span class="id">"{&nbsp;'functor'&nbsp;&nbsp;fCD&nbsp;}"</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">functor_lemmas</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">functor_id</span> <span class="id">a</span> <span class="id">:</span> <span class="id">F</span> <span class="id">#</span> <span class="id">[hom</span> <span class="id">idfun]</span> <span class="id">=</span> <span class="id">idfun</span> <span class="id">:&gt;</span> (<span class="id">el</span> (<span class="id">F</span> <span class="id">a</span>) <span class="id">-&gt;</span> <span class="id">el</span> (<span class="id">F</span> <span class="id">a</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof12')">Proof.</span></div>
<div class="proofscript" id="proof12">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">functor_id_hom</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">functor_o</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">c}</span>) (<span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">F</span> <span class="id">#</span> <span class="id">[hom</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">h]</span> <span class="id">=</span> <span class="id">F</span> <span class="id">#</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">F</span> <span class="id">#</span> <span class="id">h</span> <span class="id">:&gt;</span> (<span class="id">el</span> (<span class="id">F</span> <span class="id">a</span>) <span class="id">-&gt;</span> <span class="id">el</span> (<span class="id">F</span> <span class="id">c</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof13')">Proof.</span></div>
<div class="proofscript" id="proof13">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">functor_o_hom</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">functor_ext</span> (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">pm</span> <span class="id">:</span> <span class="id">F</span> <span class="id">=1</span> <span class="id">G</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span> (<span class="id">A</span> <span class="id">B</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">B}</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">transport_hom</span> (<span class="id">pm</span> <span class="id">A</span>) (<span class="id">pm</span> <span class="id">B</span>) (<span class="id">F</span> <span class="id">#</span> <span class="id">f</span>) <span class="id">=</span> <span class="id">G</span> <span class="id">#</span> <span class="id">f</span>) <span class="id">-&gt;</span> <span class="id">F</span> <span class="id">=</span> <span class="id">G</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof14')">Proof.</span></div>
<div class="proofscript" id="proof14">
<span class="id">move:</span> <span class="id">pm</span>.<br/>
<span class="id">case:</span> <span class="id">F</span> <span class="id">=&gt;</span> <span class="id">mf</span> <span class="id">cf;</span> <span class="id">case:</span> <span class="id">G</span> <span class="id">=&gt;</span> <span class="id">mg</span> <span class="id">cg</span> <span class="id">/=</span> <span class="id">pm</span>.<br/>
<span class="id">move:</span> <span class="id">cf</span> <span class="id">cg</span>.<br/>
<span class="id">rewrite</span> <span class="id">/transport_hom</span>.<br/>
<span class="id">move:</span> (<span class="id">funext</span> <span class="id">pm</span>) <span class="id">=&gt;</span> <span class="id">ppm</span>.<br/>
<span class="id">subst</span> <span class="id">mg</span> <span class="id">=&gt;</span> <span class="id">-[[ff</span> <span class="id">idf</span> <span class="id">cf]]</span> <span class="id">-[[fg</span> <span class="id">idg</span> <span class="id">cg]]</span> <span class="id">p</span>.<br/>
<span class="id">have</span> <span class="id">pp</span> <span class="id">:</span> <span class="id">ff</span> <span class="id">=</span> <span class="id">fg</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">functional_extensionality_dep=&gt;</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">functional_extensionality_dep=&gt;</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">functional_extensionality_dep=&gt;</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">p</span> <span class="id">A</span> <span class="id">B</span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">//</span> <span class="id">:</span> <span class="id">pm</span> <span class="id">=</span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">erefl</span>).<br/>
&nbsp;&nbsp;<span class="id">exact:</span> <span class="id">proof_irr</span>.<br/>
<span class="id">rewrite</span> <span class="id">{p}</span>.<br/>
<span class="id">move:</span> <span class="id">idf</span> <span class="id">cf</span> <span class="id">idg</span> <span class="id">cg;</span> <span class="id">rewrite</span> <span class="id">pp</span> <span class="id">=&gt;</span> <span class="id">idf</span> <span class="id">cf</span> <span class="id">idg</span> <span class="id">cg</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id">idf</span> <span class="id">=</span> <span class="id">idg</span> <span class="gallina-kwd">by</span> <span class="id">exact:</span> <span class="id">proof_irr</span>.<br/>
<span class="id">have</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id">cf</span> <span class="id">=</span> <span class="id">cg</span> <span class="gallina-kwd">by</span> <span class="id">exact:</span> <span class="id">proof_irr</span>.<br/>
<span class="id">exact:</span> <span class="id">erefl</span>.<br/>
Qed.</div>
<span class="vernacular">End</span> <span class="id">functor_lemmas</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">functor_o_head</span>.<br/>
<span class="vernacular">Import</span> <span class="id">comps_notation</span>.<br/>
<span class="vernacular">Variable</span> <span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">functor_o_head</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">c}</span>) (<span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">d</span> (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">k</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">d,</span> <span class="id">F</span> <span class="id">a}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">F</span> <span class="id">#</span> <span class="id">[hom</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">h]</span>) <span class="id">\o</span> <span class="id">k</span> <span class="id">=</span> <span class="id">[\o</span> <span class="id">F</span> <span class="id">#</span> <span class="id">g,</span> <span class="id">F</span> <span class="id">#</span> <span class="id">h,</span> <span class="id">k]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof15')">Proof.</span></div>
<div class="proofscript" id="proof15">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">functor_o_hom</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">functor_o_head</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">functor_o_head</span> <span class="id">[C</span> <span class="id">D</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">g</span> <span class="id">h</span> <span class="id">d]</span> <span class="id">F</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">functorid</span>.<br/>
<span class="vernacular">Variables</span> <span class="id">C</span> <span class="id">:</span> <span class="id">category</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">id_f</span> (<span class="id">A</span> <span class="id">B</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">B}</span>) <span class="id">:=</span> <span class="id">f</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">id_id</span> <span class="id">:</span> <span class="id">FunctorLaws.id</span> <span class="id">id_f</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof16')">Proof.</span></div>
<div class="proofscript" id="proof16">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">id_comp</span> <span class="id">:</span> <span class="id">FunctorLaws.comp</span> <span class="id">id_f</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof17')">Proof.</span></div>
<div class="proofscript" id="proof17">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isFunctor.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">idfun</span> <span class="id">id_id</span> <span class="id">id_comp</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">FId</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">{functor</span> <span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_}</span> <span class="id">of</span> <span class="id">idfun]</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">FIdf</span> (<span class="id">A</span> <span class="id">B</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">B}</span>) <span class="id">:</span> <span class="id">FId</span> <span class="id">#</span> <span class="id">f</span> <span class="id">=</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof18')">Proof.</span></div>
<div class="proofscript" id="proof18">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">functorid</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">FId</span> <span class="id">{C}</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">functorcomposition</span>.<br/>
<span class="vernacular">Variables</span> <span class="id">C0</span> <span class="id">C1</span> <span class="id">C2</span> <span class="id">:</span> <span class="id">category</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C1</span> <span class="id">-&gt;</span> <span class="id">C2}</span>) (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C0</span> <span class="id">-&gt;</span> <span class="id">C1}</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">functorcomposition</span> <span class="id">a</span> <span class="id">b</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span> <span class="id">=&gt;</span> <span class="id">F</span> <span class="id">#</span> (<span class="id">G</span> <span class="id">#</span> <span class="id">h</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">functorcomposition_id</span> <span class="id">:</span> <span class="id">FunctorLaws.id</span> <span class="id">functorcomposition</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof19')">Proof.</span></div>
<div class="proofscript" id="proof19">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">A;</span> <span class="id">rewrite</span> <span class="id">/functorcomposition</span> <span class="id">2!functor_id_hom</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">functorcomposition_comp</span> <span class="id">:</span> <span class="id">FunctorLaws.comp</span> <span class="id">functorcomposition</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof20')">Proof.</span></div>
<div class="proofscript" id="proof20">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">g</span> <span class="id">h;</span> <span class="id">rewrite</span> <span class="id">/functorcomposition;</span> <span class="id">rewrite</span> <span class="id">2!functor_o_hom</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">isFunctor.Build</span> <span class="id">C0</span> <span class="id">C2</span> (<span class="id">F</span> <span class="id">\o</span> <span class="id">G</span>) <span class="id">functorcomposition_id</span> <span class="id">functorcomposition_comp</span>.<br/>
<span class="vernacular">End</span> <span class="id">functorcomposition</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"F&nbsp;\O&nbsp;G"</span> <span class="id">:=</span> (<span class="id">[the</span> <span class="id">{functor</span> <span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_}</span> <span class="id">of</span> <span class="id">F</span> <span class="id">\o</span> <span class="id">G]</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">functorcomposition_lemmas</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">FCompE</span> (<span class="id">C0</span> <span class="id">C1</span> <span class="id">C2</span> <span class="id">:</span> <span class="id">category</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C1</span> <span class="id">-&gt;</span> <span class="id">C2}</span>) (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C0</span> <span class="id">-&gt;</span> <span class="id">C1}</span>) <span class="id">a</span> <span class="id">b</span> (<span class="id">k</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">F</span> <span class="id">\O</span> <span class="id">G</span>) <span class="id">#</span> <span class="id">k</span> <span class="id">=</span> <span class="id">F</span> <span class="id">#</span> (<span class="id">G</span> <span class="id">#</span> <span class="id">k</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof21')">Proof.</span></div>
<div class="proofscript" id="proof21">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Variables</span> (<span class="id">C0</span> <span class="id">C1</span> <span class="id">C2</span> <span class="id">C3</span> <span class="id">:</span> <span class="id">category</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">FCompId</span> (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C0</span> <span class="id">-&gt;</span> <span class="id">C1}</span>) <span class="id">:</span> <span class="id">F</span> <span class="id">\O</span> <span class="id">FId</span> <span class="id">=</span> <span class="id">F</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof22')">Proof.</span></div>
<div class="proofscript" id="proof22">
 <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">functor_ext=&gt;</span> <span class="id">*;</span> <span class="id">rewrite</span> <span class="id">FCompE</span> <span class="id">FIdf</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">FIdComp</span> (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C0</span> <span class="id">-&gt;</span> <span class="id">C1}</span>) <span class="id">:</span> <span class="id">FId</span> <span class="id">\O</span> <span class="id">F</span> <span class="id">=</span> <span class="id">F</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof23')">Proof.</span></div>
<div class="proofscript" id="proof23">
 <span class="gallina-kwd">by</span> <span class="id">apply:</span> <span class="id">functor_ext=&gt;</span> <span class="id">*;</span> <span class="id">rewrite</span> <span class="id">FCompE</span> <span class="id">FIdf</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">FCompA</span><br/>
&nbsp;&nbsp;(<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C2</span> <span class="id">-&gt;</span> <span class="id">C3}</span>) (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C1</span> <span class="id">-&gt;</span> <span class="id">C2}</span>) (<span class="id">H</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C0</span> <span class="id">-&gt;</span> <span class="id">C1}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">F</span> <span class="id">\O</span> <span class="id">G</span>) <span class="id">\O</span> <span class="id">H</span> <span class="id">=</span> <span class="id">F</span> <span class="id">\O</span> (<span class="id">G</span> <span class="id">\O</span> <span class="id">H</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof24')">Proof.</span></div>
<div class="proofscript" id="proof24">
 <span class="id">apply:</span> <span class="id">functor_ext=&gt;</span> <span class="id">*;</span> <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">FCompE</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">functorcomposition_lemmas</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">"F&nbsp;~~&gt;&nbsp;G"</span> <span class="id">:=</span> (<span class="gallina-kwd">forall</span> <span class="id">a,</span> <span class="id">{hom</span> <span class="id">F</span> <span class="id">a</span> <span class="id">,G</span> <span class="id">a}</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">naturality</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~~&gt;</span> <span class="id">G</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>)<span class="id">,</span> (<span class="id">G</span> <span class="id">#</span> <span class="id">h</span>) <span class="id">\o</span> (<span class="id">f</span> <span class="id">a</span>) <span class="id">=</span> (<span class="id">f</span> <span class="id">b</span>) <span class="id">\o</span> (<span class="id">F</span> <span class="id">#</span> <span class="id">h</span>).<br/>
<span class="vernacular">Arguments</span> <span class="id">naturality</span> <span class="id">[C</span> <span class="id">D]</span>.<br/>
<span class="id">HB.mixin</span> <span class="vernacular">Record</span> <span class="id">isNatural</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~~&gt;</span> <span class="id">G</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">{</span> <span class="id">natural</span> <span class="id">:</span> <span class="id">naturality</span> <span class="id">F</span> <span class="id">G</span> <span class="id">f</span> <span class="id">}</span>.<br/>
<span class="id">#[short</span>(<span class="id">type=nattrans</span>)<span class="id">]</span><br/>
<span class="id">HB.structure</span> <span class="vernacular">Definition</span> <span class="id">_</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">{f</span> <span class="id">of</span> <span class="id">isNatural</span> <span class="id">C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G</span> <span class="id">f}</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">natural</span> <span class="id">[C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G]</span> <span class="id">phi</span> <span class="id">:</span> <span class="id">rename</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"F&nbsp;~&gt;&nbsp;G"</span> <span class="id">:=</span> (<span class="id">nattrans</span> <span class="id">F</span> <span class="id">G</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">natural_transformation_lemmas</span>.<br/>
<span class="vernacular">Import</span> <span class="id">comps_notation</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>).<br/>
<span class="vernacular">Lemma</span> <span class="id">natural_head</span> (<span class="id">phi</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G</span>) <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> (<span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">F</span> <span class="id">a}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">[\o</span> <span class="id">G</span> <span class="id">#</span> <span class="id">h,</span> <span class="id">phi</span> <span class="id">a,</span> <span class="id">f]</span> <span class="id">=</span> <span class="id">[\o</span> <span class="id">phi</span> <span class="id">b,</span> <span class="id">F</span> <span class="id">#</span> <span class="id">h,</span> <span class="id">f]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof25')">Proof.</span></div>
<div class="proofscript" id="proof25">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-!hom_compA</span> <span class="id">natural</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">nattrans_ext</span> (<span class="id">f</span> <span class="id">g</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G</span>) <span class="id">:</span> <span class="id">f</span> <span class="id">=</span> <span class="id">g</span> <span class="id">&lt;-&gt;</span> <span class="gallina-kwd">forall</span> <span class="id">a,</span> (<span class="id">f</span> <span class="id">a</span> <span class="id">=</span> <span class="id">g</span> <span class="id">a</span> <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof26')">Proof.</span></div>
<div class="proofscript" id="proof26">
<span class="id">split=&gt;</span> <span class="id">[</span> <span class="id">-&gt;</span> <span class="id">//</span> <span class="id">|];</span> <span class="id">move:</span> <span class="id">f</span> <span class="id">g</span> <span class="id">=&gt;</span> <span class="id">[f</span> <span class="id">[[Hf]]]</span> <span class="id">[g</span> <span class="id">[[Hg]]]</span> <span class="id">/=</span> <span class="id">fg''</span>.<br/>
<span class="id">have</span> <span class="id">fg'</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">a,</span> <span class="id">f</span> <span class="id">a</span> <span class="id">=</span> <span class="id">g</span> <span class="id">a</span> <span class="id">:&gt;</span> <span class="id">{hom</span> <span class="id">_,</span> <span class="id">_}</span> <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">a;</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">fg''</span>.<br/>
<span class="id">move:</span> (<span class="id">functional_extensionality_dep</span> <span class="id">fg'</span>) <span class="id">=&gt;</span> <span class="id">fg</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">move:</span> <span class="id">Hf</span> <span class="id">Hg;</span> <span class="id">rewrite</span> <span class="id">fg=&gt;</span> <span class="id">Hf</span> <span class="id">Hg;</span> <span class="id">rewrite</span> (<span class="id">proof_irr</span> <span class="id">_</span> <span class="id">Hf</span> <span class="id">Hg</span>).<br/>
Qed.</div>
<span class="vernacular">End</span> <span class="id">natural_transformation_lemmas</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">natural_head</span> <span class="id">[C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G]</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">id_natural_transformation</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>).<br/>
<span class="vernacular">Definition</span> <span class="id">unnattrans_id</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> (<span class="id">a</span> <span class="id">:</span> <span class="id">C</span>) <span class="id">=&gt;</span> <span class="id">[hom</span> (<span class="id">@idfun</span> (<span class="id">el</span> (<span class="id">F</span> <span class="id">a</span>)))<span class="id">]</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">natural_id</span> <span class="id">:</span> <span class="id">naturality</span> <span class="id">_</span> <span class="id">_</span> <span class="id">unnattrans_id</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof27')">Proof.</span></div>
<div class="proofscript" id="proof27">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isNatural.Build</span> <span class="id">C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">F</span> <span class="id">unnattrans_id</span> <span class="id">natural_id</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">NId</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">F</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">_</span> <span class="id">~&gt;</span> <span class="id">_</span> <span class="id">of</span> <span class="id">unnattrans_id]</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">NIdE</span> <span class="id">:</span> <span class="id">NId</span>  <span class="id">=</span> (<span class="gallina-kwd">fun</span> <span class="id">a</span> <span class="id">=&gt;</span> <span class="id">[hom</span> <span class="id">idfun]</span>) <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">~~&gt;</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof28')">Proof.</span></div>
<div class="proofscript" id="proof28">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">id_natural_transformation</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">NEq</span>.<br/>
<span class="vernacular">Section</span> <span class="id">def</span>.<br/>
<span class="vernacular">Import</span> <span class="id">comps_notation</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>).<br/>
<span class="vernacular">Variable</span> (<span class="id">Iobj</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">c,</span> <span class="id">F</span> <span class="id">c</span> <span class="id">=</span> <span class="id">G</span> <span class="id">c</span>).<br/>
<span class="id">Local</span> <span class="vernacular">Notation</span> <span class="id">tc</span> <span class="id">:=</span> (<span class="id">transport_codom</span> (<span class="id">Iobj</span> <span class="id">_</span>)).<br/>
<span class="id">Local</span> <span class="vernacular">Notation</span> <span class="id">td</span> <span class="id">:=</span> (<span class="id">transport_dom</span> (<span class="id">esym</span> (<span class="id">Iobj</span> <span class="id">_</span>))).<br/>
<span class="vernacular">Variable</span> (<span class="id">Imor</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>)<span class="id">,</span> <span class="id">tc</span> (<span class="id">F</span> <span class="id">#</span> <span class="id">f</span>) <span class="id">=</span> <span class="id">td</span> (<span class="id">G</span> <span class="id">#</span> <span class="id">f</span>)).<br/>
<span class="vernacular">Definition</span> <span class="id">f</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~~&gt;</span> <span class="id">G</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) <span class="id">=&gt;</span> <span class="id">tc</span> <span class="id">[hom</span> <span class="id">idfun]</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">natural</span> <span class="id">:</span> <span class="id">naturality</span> <span class="id">F</span> <span class="id">G</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof29')">Proof.</span></div>
<div class="proofscript" id="proof29">
<span class="id">move=&gt;</span> <span class="id">a</span> <span class="id">b</span> <span class="id">h</span>.<br/>
<span class="id">rewrite</span> <span class="id">/f</span> <span class="id">!transport_codomF</span> <span class="id">2!homcompE</span> <span class="id">2!compfid</span>.<br/>
<span class="id">have</span> <span class="id">/hom_ext</span> <span class="id">-&gt;</span> <span class="id">:</span> <span class="id">[hom</span> (<span class="id">hom_of_eq</span> (<span class="id">Iobj</span> <span class="id">b</span>) <span class="id">\o</span> <span class="id">F</span> <span class="id">#</span> <span class="id">h</span>)<span class="id">]</span> <span class="id">=</span> <span class="id">[hom</span> <span class="id">tc</span> (<span class="id">F</span> <span class="id">#</span> <span class="id">h</span>)<span class="id">]</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">transport_codomF</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">Imor</span> <span class="id">transport_domF</span> <span class="id">homfunK</span> <span class="id">/=</span> <span class="id">esymK</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isNatural.Build</span> <span class="id">C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G</span> <span class="id">f</span> <span class="id">natural</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">n</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">_</span> <span class="id">~&gt;</span> <span class="id">_</span> <span class="id">of</span> <span class="id">f]</span>.<br/>
<span class="vernacular">End</span> <span class="id">def</span>.<br/>
<span class="vernacular">Module</span> <span class="id">Exports</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">n</span> <span class="id">[C</span> <span class="id">D]</span> <span class="id">:</span> <span class="id">simpl</span> <span class="id">never</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">NEq</span> <span class="id">:=</span> <span class="id">n</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">NEqE</span> <span class="id">C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G</span> <span class="id">Iobj</span> <span class="id">Imor</span> <span class="id">:</span> <span class="id">@NEq</span> <span class="id">C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G</span> <span class="id">Iobj</span> <span class="id">Imor</span> <span class="id">=</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span class="id">a</span> <span class="id">=&gt;</span> <span class="id">transport_codom</span> (<span class="id">Iobj</span> <span class="id">_</span>) <span class="id">[hom</span> <span class="id">idfun]</span>) <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">~~&gt;</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof30')">Proof.</span></div>
<div class="proofscript" id="proof30">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">Exports</span>.<br/>
<span class="vernacular">End</span> <span class="id">NEq</span>.<br/>
<span class="vernacular">Export</span> <span class="id">NEq.Exports</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">"[&nbsp;'NEq'&nbsp;F&nbsp;,&nbsp;G&nbsp;]"</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;(<span class="id">NEq</span> <span class="id">F</span> <span class="id">G</span> (<span class="gallina-kwd">fun</span> <span class="id">a</span> <span class="id">=&gt;</span> <span class="id">erefl</span>) (<span class="gallina-kwd">fun</span> <span class="id">a</span> <span class="id">b</span> <span class="id">f</span> <span class="id">=&gt;</span> <span class="id">erefl</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">at</span> <span class="id">level</span> <span class="id">0,</span> <span class="id">format</span> <span class="id">"[&nbsp;'NEq'&nbsp;&nbsp;F&nbsp;,&nbsp;&nbsp;G&nbsp;]"</span>) <span class="id">:</span> <span class="id">category_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">vertical_composition</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">H</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">g</span> <span class="id">:</span> <span class="id">G</span> <span class="id">~&gt;</span> <span class="id">H</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G</span>).<br/>
<span class="vernacular">Definition</span> <span class="id">vcomp</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span class="id">a</span> <span class="id">=&gt;</span> <span class="id">[hom</span> <span class="id">g</span> <span class="id">a</span> <span class="id">\o</span> <span class="id">f</span> <span class="id">a]</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">natural_vcomp</span> <span class="id">:</span> <span class="id">naturality</span> <span class="id">_</span> <span class="id">_</span> <span class="id">vcomp</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof31')">Proof.</span></div>
<div class="proofscript" id="proof31">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">A</span> <span class="id">B</span> <span class="id">h;</span> <span class="id">rewrite</span> <span class="id">compA</span> (<span class="id">natural</span> <span class="id">g</span>) <span class="id">-compA</span> (<span class="id">natural</span> <span class="id">f</span>). Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isNatural.Build</span> <span class="id">C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="id">vcomp</span> <span class="id">natural_vcomp</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">VComp</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">H</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">H</span> <span class="id">of</span> <span class="id">vcomp]</span>.<br/>
<span class="vernacular">End</span> <span class="id">vertical_composition</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"f&nbsp;\v&nbsp;g"</span> <span class="id">:=</span> (<span class="id">VComp</span> <span class="id">f</span> <span class="id">g</span>).<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">vcomp_lemmas</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">H</span> <span class="id">I</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">h</span> <span class="id">:</span> <span class="id">H</span> <span class="id">~&gt;</span> <span class="id">I</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">G</span> <span class="id">~&gt;</span> <span class="id">H</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G</span>).<br/>
<span class="vernacular">Lemma</span> <span class="id">VCompId</span> <span class="id">:</span> <span class="id">f</span> <span class="id">\v</span> <span class="id">NId</span> <span class="id">F</span> <span class="id">=</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof32')">Proof.</span></div>
<div class="proofscript" id="proof32">
 <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">nattrans_ext</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">VIdComp</span> <span class="id">:</span> <span class="id">NId</span> <span class="id">G</span> <span class="id">\v</span> <span class="id">f</span> <span class="id">=</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof33')">Proof.</span></div>
<div class="proofscript" id="proof33">
 <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">nattrans_ext</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">VCompA</span> <span class="id">:</span> (<span class="id">h</span> <span class="id">\v</span> <span class="id">g</span>) <span class="id">\v</span> <span class="id">f</span> <span class="id">=</span> <span class="id">h</span> <span class="id">\v</span> (<span class="id">g</span> <span class="id">\v</span> <span class="id">f</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof34')">Proof.</span></div>
<div class="proofscript" id="proof34">
 <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">nattrans_ext</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">VCompE_nat</span> <span class="id">:</span> <span class="id">g</span> <span class="id">\v</span> <span class="id">f</span> <span class="id">=</span> (<span class="gallina-kwd">fun</span> <span class="id">a</span> <span class="id">=&gt;</span> <span class="id">[hom</span> <span class="id">g</span> <span class="id">a</span> <span class="id">\o</span> <span class="id">f</span> <span class="id">a]</span>) <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">~~&gt;</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof35')">Proof.</span></div>
<div class="proofscript" id="proof35">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">VCompE</span> <span class="id">a</span> <span class="id">:</span> (<span class="id">g</span> <span class="id">\v</span> <span class="id">f</span>) <span class="id">a</span> <span class="id">=</span> <span class="id">g</span> <span class="id">a</span> <span class="id">\o</span> <span class="id">f</span> <span class="id">a</span> <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof36')">Proof.</span></div>
<div class="proofscript" id="proof36">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">vcomp_lemmas</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">horizontal_composition</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">E</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">F'</span> <span class="id">G'</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">E}</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G</span>) (<span class="id">t</span> <span class="id">:</span> <span class="id">F'</span> <span class="id">~&gt;</span> <span class="id">G'</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">hcomp</span> <span class="id">:</span> <span class="id">F'</span> <span class="id">\O</span> <span class="id">F</span> <span class="id">~~&gt;</span> <span class="id">G'</span> <span class="id">\O</span> <span class="id">G</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) <span class="id">=&gt;</span> <span class="id">[hom</span> <span class="id">t</span> (<span class="id">G</span> <span class="id">c</span>) <span class="id">\o</span> <span class="id">F'</span> <span class="id">#</span> <span class="id">s</span> <span class="id">c]</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">natural_hcomp</span> <span class="id">:</span> <span class="id">naturality</span> (<span class="id">F'</span> <span class="id">\O</span> <span class="id">F</span>) (<span class="id">G'</span> <span class="id">\O</span> <span class="id">G</span>) <span class="id">hcomp</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof37')">Proof.</span></div>
<div class="proofscript" id="proof37">
<span class="id">move=&gt;</span> <span class="id">c0</span> <span class="id">c1</span> <span class="id">h</span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id">LHS]compA</span> (<span class="id">natural</span> <span class="id">t</span>) <span class="id">-[in</span> <span class="id">LHS]compA</span> <span class="id">-[in</span> <span class="id">RHS]compA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id">\o</span> <span class="id">_</span>).<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id">RHS]FCompE</span> <span class="id">-2!functor_o;</span> <span class="id">congr</span> (<span class="id">F'</span> <span class="id">#</span> <span class="id">_</span>)<span class="id">;</span> <span class="id">apply</span> <span class="id">hom_ext</span> <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">natural</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isNatural.Build</span> <span class="id">C</span> <span class="id">E</span> (<span class="id">F'</span> <span class="id">\O</span> <span class="id">F</span>) (<span class="id">G'</span> <span class="id">\O</span> <span class="id">G</span>)<br/>
&nbsp;&nbsp;<span class="id">hcomp</span> <span class="id">natural_hcomp</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">HComp</span> <span class="id">:</span> <span class="id">F'</span> <span class="id">\O</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G'</span> <span class="id">\O</span> <span class="id">G</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">_</span> <span class="id">~&gt;</span> <span class="id">_</span> <span class="id">of</span> <span class="id">hcomp]</span>.<br/>
<span class="vernacular">End</span> <span class="id">horizontal_composition</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"f&nbsp;\h&nbsp;g"</span> <span class="id">:=</span> (<span class="id">locked</span> (<span class="id">HComp</span> <span class="id">g</span> <span class="id">f</span>)).<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">hcomp_extensionality_lemmas</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">E</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">F'</span> <span class="id">G'</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">E}</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G</span>) (<span class="id">t</span> <span class="id">:</span> <span class="id">F'</span> <span class="id">~&gt;</span> <span class="id">G'</span>).<br/>
<span class="vernacular">Lemma</span> <span class="id">HCompE_def</span> <span class="id">:</span> <span class="id">t</span> <span class="id">\h</span> <span class="id">s</span> <span class="id">=</span> <span class="id">HComp</span> <span class="id">s</span> <span class="id">t</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof38')">Proof.</span></div>
<div class="proofscript" id="proof38">
 <span class="gallina-kwd">by</span> <span class="id">unlock</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">HCompE</span> <span class="id">c</span> <span class="id">:</span> (<span class="id">t</span> <span class="id">\h</span> <span class="id">s</span>) <span class="id">c</span> <span class="id">=</span> <span class="id">t</span> (<span class="id">G</span> <span class="id">c</span>) <span class="id">\o</span> <span class="id">F'</span> <span class="id">#</span> <span class="id">s</span> <span class="id">c</span> <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof39')">Proof.</span></div>
<div class="proofscript" id="proof39">
 <span class="gallina-kwd">by</span> <span class="id">unlock</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">HCompE_alt</span> <span class="id">c</span> <span class="id">:</span> (<span class="id">t</span> <span class="id">\h</span> <span class="id">s</span>) <span class="id">c</span> <span class="id">=</span> <span class="id">G'</span> <span class="id">#</span> (<span class="id">s</span> <span class="id">c</span>) <span class="id">\o</span> <span class="id">t</span> (<span class="id">F</span> <span class="id">c</span>) <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof40')">Proof.</span></div>
<div class="proofscript" id="proof40">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">HCompE</span> <span class="id">natural</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">hcomp_extensionality_lemmas</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">hcomp_id_assoc_lemmas</span>.<br/>
<span class="vernacular">Import</span> <span class="id">comps_notation</span>.<br/>
<span class="vernacular">Variables</span> <span class="id">C</span> <span class="id">D</span> <span class="id">E</span> <span class="id">Z</span> <span class="id">:</span> <span class="id">category</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">F'</span> <span class="id">G'</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">E}</span>) (<span class="id">F''</span> <span class="id">G''</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">E</span> <span class="id">-&gt;</span> <span class="id">Z}</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G</span>) (<span class="id">t</span> <span class="id">:</span> <span class="id">F'</span> <span class="id">~&gt;</span> <span class="id">G'</span>) (<span class="id">u</span> <span class="id">:</span> <span class="id">F''</span> <span class="id">~&gt;</span> <span class="id">G''</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">HCompId</span> <span class="id">c</span> <span class="id">:</span> (<span class="id">t</span> <span class="id">\h</span> <span class="id">NId</span> <span class="id">F</span>) <span class="id">c</span> <span class="id">=</span> <span class="id">t</span> (<span class="id">F</span> <span class="id">c</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof41')">Proof.</span></div>
<div class="proofscript" id="proof41">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">HCompE</span> <span class="id">NIdE</span> <span class="id">functor_id</span> <span class="id">compfid</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">HIdComp</span> <span class="id">c</span> <span class="id">:</span> (<span class="id">NId</span> <span class="id">G'</span> <span class="id">\h</span> <span class="id">s</span>) <span class="id">c</span> <span class="id">=</span> <span class="id">G'</span> <span class="id">#</span> <span class="id">s</span> <span class="id">c</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof42')">Proof.</span></div>
<div class="proofscript" id="proof42">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">HCompE</span> <span class="id">NIdE</span> <span class="id">compidf</span>. Qed.</div>
<br/>
<span class="vernacular">Let</span> <span class="id">HCompA_def</span> <span class="id">:</span> (<span class="id">u</span> <span class="id">\h</span> <span class="id">t</span>) <span class="id">\h</span> <span class="id">s</span> <span class="id">=</span><br/>
&nbsp;&nbsp;<span class="id">[NEq</span> <span class="id">G''</span> <span class="id">\O</span> (<span class="id">G'</span> <span class="id">\O</span> <span class="id">G</span>) <span class="id">,</span> (<span class="id">G''</span> <span class="id">\O</span> <span class="id">G'</span>) <span class="id">\O</span> <span class="id">G]</span><br/>
&nbsp;&nbsp;<span class="id">\v</span> (<span class="id">u</span> <span class="id">\h</span> (<span class="id">t</span> <span class="id">\h</span> <span class="id">s</span>))<br/>
&nbsp;&nbsp;<span class="id">\v</span> <span class="id">[NEq</span> (<span class="id">F''</span> <span class="id">\O</span> <span class="id">F'</span>) <span class="id">\O</span> <span class="id">F</span> <span class="id">,</span> <span class="id">F''</span> <span class="id">\O</span> (<span class="id">F'</span> <span class="id">\O</span> <span class="id">F</span>)<span class="id">]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof43')">Proof.</span></div>
<div class="proofscript" id="proof43">
<span class="id">apply</span> <span class="id">nattrans_ext</span> <span class="id">=&gt;</span> <span class="id">c</span> <span class="id">/=</span>.<br/>
<span class="id">rewrite</span> <span class="id">compidf</span> <span class="id">compfid</span> <span class="id">[in</span> <span class="id">LHS]HCompE</span> <span class="id">[in</span> <span class="id">RHS]HCompE</span>.<br/>
<span class="id">rewrite</span> <span class="id">[in</span> <span class="id">LHS]HCompE</span> <span class="id">hom_compA</span> <span class="id">-functor_o;</span> <span class="id">congr</span> <span class="id">[\o</span> <span class="id">_,</span> <span class="id">_]</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id">#</span> <span class="id">_</span>)<span class="id">;</span> <span class="id">apply</span> <span class="id">hom_ext;</span> <span class="id">rewrite</span> <span class="id">HCompE</span>.<br/>
Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">HCompA</span> <span class="id">c</span> <span class="id">:</span> ((<span class="id">u</span> <span class="id">\h</span> <span class="id">t</span>) <span class="id">\h</span> <span class="id">s</span>) <span class="id">c</span> <span class="id">=</span> (<span class="id">u</span> <span class="id">\h</span> (<span class="id">t</span> <span class="id">\h</span> <span class="id">s</span>)) <span class="id">c</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof44')">Proof.</span></div>
<div class="proofscript" id="proof44">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">HCompA_def</span>. Qed.</div>
<br/>
<span class="vernacular">End</span> <span class="id">hcomp_id_assoc_lemmas</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">hcomp_lemmas</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">E</span> <span class="id">:</span> <span class="id">category</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span> <span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">F'</span> <span class="id">G'</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">E}</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s</span> <span class="id">:</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">G</span>) (<span class="id">t</span> <span class="id">:</span> <span class="id">F'</span> <span class="id">~&gt;</span> <span class="id">G'</span>).<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">HComp_VH</span> <span class="id">:</span> <span class="id">t</span> <span class="id">\h</span> <span class="id">s</span> <span class="id">=</span> (<span class="id">t</span> <span class="id">\h</span> <span class="id">NId</span> <span class="id">G</span>) <span class="id">\v</span> (<span class="id">NId</span> <span class="id">F'</span> <span class="id">\h</span> <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof45')">Proof.</span></div>
<div class="proofscript" id="proof45">
 <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">nattrans_ext=&gt;</span> <span class="id">a;</span> <span class="id">rewrite</span> <span class="id">VCompE</span> <span class="id">HCompE</span> <span class="id">HIdComp</span> <span class="id">HCompId</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">HComp_VH_aux</span> <span class="id">:</span> <span class="id">t</span> <span class="id">\h</span> <span class="id">s</span> <span class="id">=</span> (<span class="id">NId</span> <span class="id">G'</span> <span class="id">\h</span> <span class="id">s</span>) <span class="id">\v</span> (<span class="id">t</span> <span class="id">\h</span> <span class="id">NId</span> <span class="id">F</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof46')">Proof.</span></div>
<div class="proofscript" id="proof46">
<span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">nattrans_ext=&gt;</span> <span class="id">a;</span> <span class="id">rewrite</span> <span class="id">VCompE</span> <span class="id">HCompE</span> <span class="id">HIdComp</span> <span class="id">HCompId</span> <span class="id">-natural</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">NIdFId</span> <span class="id">c</span> <span class="id">:</span> <span class="id">NId</span> (<span class="id">@FId</span> <span class="id">C</span>) <span class="id">c</span> <span class="id">=</span> <span class="id">[hom</span> <span class="id">idfun]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof47')">Proof.</span></div>
<div class="proofscript" id="proof47">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">NIdFComp</span> <span class="id">:</span> <span class="id">NId</span> (<span class="id">F'</span> <span class="id">\O</span> <span class="id">F</span>) <span class="id">=</span> <span class="id">NId</span> <span class="id">F'</span> <span class="id">\h</span> <span class="id">NId</span> <span class="id">F</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof48')">Proof.</span></div>
<div class="proofscript" id="proof48">
 <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">nattrans_ext</span> <span class="id">=&gt;</span> <span class="id">c</span> <span class="id">/=;</span> <span class="id">rewrite</span> <span class="id">HCompE</span> <span class="id">/=</span> <span class="id">compidf</span> <span class="id">functor_id</span>. Qed.</div>
<br/>
<span class="vernacular">Variables</span> (<span class="id">H</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">H'</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">E}</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">s'</span> <span class="id">:</span> <span class="id">G</span> <span class="id">~&gt;</span> <span class="id">H</span>) (<span class="id">t'</span> <span class="id">:</span> <span class="id">G'</span> <span class="id">~&gt;</span> <span class="id">H'</span>).<br/>
<span class="vernacular">Lemma</span> <span class="id">HCompACA</span> <span class="id">:</span> (<span class="id">t'</span> <span class="id">\h</span> <span class="id">s'</span>) <span class="id">\v</span> (<span class="id">t</span> <span class="id">\h</span> <span class="id">s</span>) <span class="id">=</span> (<span class="id">t'</span> <span class="id">\v</span> <span class="id">t</span>) <span class="id">\h</span> (<span class="id">s'</span> <span class="id">\v</span> <span class="id">s</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof49')">Proof.</span></div>
<div class="proofscript" id="proof49">
<span class="id">apply</span> <span class="id">nattrans_ext</span> <span class="id">=&gt;</span> <span class="id">c</span> <span class="id">/=</span>.<br/>
<span class="id">rewrite</span> <span class="id">!HCompE</span> <span class="id">!VCompE</span> <span class="id">-compA</span> <span class="id">-[in</span> <span class="id">RHS]compA;</span> <span class="id">congr</span> (<span class="id">_</span> <span class="id">\o</span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">natural_head</span> <span class="id">-functor_o</span>.<br/>
Qed.</div>
<span class="vernacular">End</span> <span class="id">hcomp_lemmas</span>.<br/>
<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">TriangularLaws</span>.<br/>
<span class="vernacular">Section</span> <span class="id">triangularlaws</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">C}</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">eta</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~&gt;</span> <span class="id">G</span> <span class="id">\O</span> <span class="id">F</span>) (<span class="id">eps</span> <span class="id">:</span> <span class="id">F</span> <span class="id">\O</span> <span class="id">G</span> <span class="id">~&gt;</span> <span class="id">FId</span>).<br/>
<span class="vernacular">Definition</span> <span class="id">left</span> <span class="id">:=</span> <span class="gallina-kwd">forall</span> <span class="id">c,</span> <span class="id">eps</span> (<span class="id">F</span> <span class="id">c</span>) <span class="id">\o</span> <span class="id">F</span> <span class="id">#</span> (<span class="id">eta</span> <span class="id">c</span>) <span class="id">=</span> <span class="id">idfun</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">right</span> <span class="id">:=</span> <span class="gallina-kwd">forall</span> <span class="id">d,</span> <span class="id">G</span> <span class="id">#</span> (<span class="id">eps</span> <span class="id">d</span>) <span class="id">\o</span> <span class="id">eta</span> (<span class="id">G</span> <span class="id">d</span>) <span class="id">=</span> <span class="id">idfun</span>.<br/>
<span class="vernacular">End</span> <span class="id">triangularlaws</span>.<br/>
<span class="vernacular">End</span> <span class="id">TriangularLaws</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">AdjointFunctors</span>.<br/>
<span class="vernacular">Section</span> <span class="id">def</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">C}</span>).<br/>
<span class="vernacular">Record</span> <span class="id">t</span> <span class="id">:=</span> <span class="id">mk</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">eta</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~&gt;</span> <span class="id">G</span> <span class="id">\O</span> <span class="id">F</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">eps</span> <span class="id">:</span> <span class="id">F</span> <span class="id">\O</span> <span class="id">G</span> <span class="id">~&gt;</span> <span class="id">FId</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">triL</span> <span class="id">:</span> <span class="id">TriangularLaws.left</span> <span class="id">eta</span> <span class="id">eps</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">triR</span> <span class="id">:</span> <span class="id">TriangularLaws.right</span> <span class="id">eta</span> <span class="id">eps</span><br/>
<span class="id">}</span>.<br/>
<span class="vernacular">End</span> <span class="id">def</span>.<br/>
<span class="vernacular">Section</span> <span class="id">lemmas</span>.<br/>
<span class="id">Local</span> <span class="vernacular">Notation</span> <span class="id">"F&nbsp;-|&nbsp;G"</span> <span class="id">:=</span> (<span class="id">t</span> <span class="id">F</span> <span class="id">G</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">C}</span>).<br/>
<span class="vernacular">Variable</span> <span class="id">A</span> <span class="id">:</span> <span class="id">F</span> <span class="id">-|</span> <span class="id">G</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">hom_iso</span> <span class="id">c</span> <span class="id">d</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">F</span> <span class="id">c,</span> <span class="id">d}</span> <span class="id">-&gt;</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">G</span> <span class="id">d}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span class="id">h</span> <span class="id">=&gt;</span> <span class="id">[hom</span> (<span class="id">G</span> <span class="id">#</span> <span class="id">h</span>) <span class="id">\o</span> (<span class="id">eta</span> <span class="id">A</span> <span class="id">c</span>)<span class="id">]</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">hom_inv</span> <span class="id">c</span> <span class="id">d</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">G</span> <span class="id">d}</span> <span class="id">-&gt;</span> <span class="id">{hom</span> <span class="id">F</span> <span class="id">c,</span> <span class="id">d}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span class="id">h</span> <span class="id">=&gt;</span> <span class="id">[hom</span> (<span class="id">eps</span> <span class="id">A</span> <span class="id">d</span>) <span class="id">\o</span> (<span class="id">F</span> <span class="id">#</span> <span class="id">h</span>)<span class="id">]</span>.<br/>
<br/>
<span class="vernacular">Import</span> <span class="id">comps_notation</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">hom_isoK</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">d</span> <span class="id">:</span> <span class="id">D</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">F</span> <span class="id">c,</span> <span class="id">d}</span>) <span class="id">:</span> <span class="id">hom_inv</span> (<span class="id">hom_iso</span> <span class="id">f</span>) <span class="id">=</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof50')">Proof.</span></div>
<div class="proofscript" id="proof50">
<span class="id">rewrite</span> <span class="id">/hom_inv</span> <span class="id">/hom_iso;</span> <span class="id">apply</span> <span class="id">hom_ext</span> <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">functor_o</span> <span class="id">-</span>(<span class="id">natural_head</span> (<span class="id">eps</span> <span class="id">_</span>)) <span class="id">triL</span>.<br/>
Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">hom_invK</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">d</span> <span class="id">:</span> <span class="id">D</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">G</span> <span class="id">d}</span>) <span class="id">:</span> <span class="id">hom_iso</span> (<span class="id">hom_inv</span> <span class="id">g</span>) <span class="id">=</span> <span class="id">g</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof51')">Proof.</span></div>
<div class="proofscript" id="proof51">
<span class="id">rewrite</span> <span class="id">/hom_inv</span> <span class="id">/hom_iso;</span> <span class="id">apply</span> <span class="id">hom_ext</span> <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">functor_o</span> <span class="id">hom_compA</span> (<span class="id">natural</span> (<span class="id">eta</span> <span class="id">A</span>)) <span class="id">-hom_compA</span> <span class="id">triR</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">hom_iso_inj</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">d</span> <span class="id">:</span> <span class="id">D</span>) <span class="id">:</span> <span class="id">injective</span> (<span class="id">@hom_iso</span> <span class="id">c</span> <span class="id">d</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof52')">Proof.</span></div>
<div class="proofscript" id="proof52">
 <span class="id">exact:</span> <span class="id">can_inj</span> (<span class="id">@hom_isoK</span> <span class="id">c</span> <span class="id">d</span>). Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">hom_inv_inj</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">d</span> <span class="id">:</span> <span class="id">D</span>) <span class="id">:</span> <span class="id">injective</span> (<span class="id">@hom_inv</span> <span class="id">c</span> <span class="id">d</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof53')">Proof.</span></div>
<div class="proofscript" id="proof53">
 <span class="id">exact:</span> <span class="id">can_inj</span> (<span class="id">@hom_invK</span> <span class="id">c</span> <span class="id">d</span>). Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">eta_hom_iso</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) <span class="id">:</span> <span class="id">eta</span> <span class="id">A</span> <span class="id">c</span> <span class="id">=</span> <span class="id">hom_iso</span> <span class="id">[hom</span> <span class="id">idfun]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof54')">Proof.</span></div>
<div class="proofscript" id="proof54">
 <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">hom_ext;</span> <span class="id">rewrite</span> <span class="id">/hom_iso</span> <span class="id">/=</span> <span class="id">functor_id</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">eps_hom_inv</span> (<span class="id">d</span> <span class="id">:</span> <span class="id">D</span>) <span class="id">:</span> <span class="id">eps</span> <span class="id">A</span> <span class="id">d</span> <span class="id">=</span> <span class="id">hom_inv</span> <span class="id">[hom</span> <span class="id">idfun]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof55')">Proof.</span></div>
<div class="proofscript" id="proof55">
 <span class="gallina-kwd">by</span> <span class="id">apply</span> <span class="id">hom_ext;</span> <span class="id">rewrite</span> <span class="id">/hom_inv</span> <span class="id">/=</span> <span class="id">functor_id</span> <span class="id">compfid</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">ext</span> (<span class="id">B</span> <span class="id">:</span> <span class="id">F</span> <span class="id">-|</span> <span class="id">G</span>) <span class="id">:</span> <span class="id">eta</span> <span class="id">A</span> <span class="id">=</span> <span class="id">eta</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">eps</span> <span class="id">A</span> <span class="id">=</span> <span class="id">eps</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">A</span> <span class="id">=</span> <span class="id">B</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof56')">Proof.</span></div>
<div class="proofscript" id="proof56">
<span class="id">move:</span> <span class="id">A</span> <span class="id">B</span> <span class="id">=&gt;</span> <span class="id">[?</span> <span class="id">?</span> <span class="id">?</span> <span class="id">?]</span> <span class="id">[?</span> <span class="id">?</span> <span class="id">?</span> <span class="id">?]</span> <span class="id">/=</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">subst</span>.<br/>
<span class="id">congr</span> <span class="id">mk;</span> <span class="id">exact/proof_irr</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="vernacular">End</span> <span class="id">lemmas</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">hom_isoK</span> <span class="id">[C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G]</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">hom_invK</span> <span class="id">[C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G]</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">hom_iso_inj</span> <span class="id">[C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G]</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">hom_inv_inj</span> <span class="id">[C</span> <span class="id">D</span> <span class="id">F</span> <span class="id">G]</span>.<br/>
<span class="vernacular">End</span> <span class="id">AdjointFunctors</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"F&nbsp;-|&nbsp;G"</span> <span class="id">:=</span> (<span class="id">AdjointFunctors.t</span> <span class="id">F</span> <span class="id">G</span>).<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">AdjComp</span>.<br/>
<span class="vernacular">Section</span> <span class="id">def</span>.<br/>
<span class="vernacular">Import</span> <span class="id">comps_notation</span>.<br/>
<span class="vernacular">Variables</span> <span class="id">C0</span> <span class="id">C1</span> <span class="id">C2</span> <span class="id">:</span> <span class="id">category</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">F0</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C0</span> <span class="id">-&gt;</span> <span class="id">C1}</span>) (<span class="id">G0</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C1</span> <span class="id">-&gt;</span> <span class="id">C0}</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">F1</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C1</span> <span class="id">-&gt;</span> <span class="id">C2}</span>) (<span class="id">G1</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C2</span> <span class="id">-&gt;</span> <span class="id">C1}</span>).<br/>
<span class="vernacular">Variables</span><br/>
&nbsp;&nbsp;(<span class="id">eta0</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~&gt;</span> <span class="id">G0</span> <span class="id">\O</span> <span class="id">F0</span>) (<span class="id">eta1</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~&gt;</span> <span class="id">G1</span> <span class="id">\O</span> <span class="id">F1</span>)<br/>
&nbsp;&nbsp;(<span class="id">eps0</span> <span class="id">:</span> <span class="id">F0</span> <span class="id">\O</span> <span class="id">G0</span> <span class="id">~&gt;</span> <span class="id">FId</span>) (<span class="id">eps1</span> <span class="id">:</span> <span class="id">F1</span> <span class="id">\O</span> <span class="id">G1</span> <span class="id">~&gt;</span> <span class="id">FId</span>)<br/>
&nbsp;&nbsp;(<span class="id">triL0</span> <span class="id">:</span> <span class="id">TriangularLaws.left</span> <span class="id">eta0</span> <span class="id">eps0</span>)<br/>
&nbsp;&nbsp;(<span class="id">triL1</span> <span class="id">:</span> <span class="id">TriangularLaws.left</span> <span class="id">eta1</span> <span class="id">eps1</span>)<br/>
&nbsp;&nbsp;(<span class="id">triR0</span> <span class="id">:</span> <span class="id">TriangularLaws.right</span> <span class="id">eta0</span> <span class="id">eps0</span>)<br/>
&nbsp;&nbsp;(<span class="id">triR1</span> <span class="id">:</span> <span class="id">TriangularLaws.right</span> <span class="id">eta1</span> <span class="id">eps1</span>).<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">F</span> <span class="id">:=</span> <span class="id">F1</span> <span class="id">\O</span> <span class="id">F0</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">G</span> <span class="id">:=</span> <span class="id">G0</span> <span class="id">\O</span> <span class="id">G1</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">Eta</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~&gt;</span> <span class="id">G</span> <span class="id">\O</span> <span class="id">F</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">[NEq</span> <span class="id">G0</span> <span class="id">\O</span> (<span class="id">G1</span> <span class="id">\O</span> <span class="id">F1</span>) <span class="id">\O</span> <span class="id">F0</span> <span class="id">,</span> <span class="id">G</span> <span class="id">\O</span> <span class="id">F]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\v</span> (<span class="id">NId</span> <span class="id">G0</span> <span class="id">\h</span> <span class="id">eta1</span> <span class="id">\h</span> <span class="id">NId</span> <span class="id">F0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\v</span> <span class="id">[NEq</span> <span class="id">G0</span> <span class="id">\O</span> <span class="id">F0</span> <span class="id">,</span> <span class="id">G0</span> <span class="id">\O</span> <span class="id">FId</span> <span class="id">\O</span> <span class="id">F0]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\v</span> <span class="id">eta0</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">EtaE</span> <span class="id">a</span> <span class="id">:</span> <span class="id">Eta</span> <span class="id">a</span> <span class="id">=</span> <span class="id">G0</span> <span class="id">#</span> (<span class="id">eta1</span> (<span class="id">F0</span> <span class="id">a</span>)) <span class="id">\o</span> (<span class="id">eta0</span> <span class="id">a</span>) <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof57')">Proof.</span></div>
<div class="proofscript" id="proof57">
 <span class="gallina-kwd">by</span> <span class="id">cbn;</span> <span class="id">rewrite</span> <span class="id">HCompId</span> <span class="id">HIdComp</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">EtaE_hom</span> <span class="id">a</span> <span class="id">:</span> <span class="id">Eta</span> <span class="id">a</span> <span class="id">=</span> <span class="id">[hom</span> <span class="id">G0</span> <span class="id">#</span> (<span class="id">eta1</span> (<span class="id">F0</span> <span class="id">a</span>)) <span class="id">\o</span> (<span class="id">eta0</span> <span class="id">a</span>)<span class="id">]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof58')">Proof.</span></div>
<div class="proofscript" id="proof58">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">EtaE</span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span class="id">Eps</span> <span class="id">:</span> <span class="id">F</span> <span class="id">\O</span> <span class="id">G</span> <span class="id">~&gt;</span> <span class="id">FId</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;(<span class="id">eps1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\v</span> <span class="id">[NEq</span> <span class="id">F1</span> <span class="id">\O</span> <span class="id">FId</span> <span class="id">\O</span> <span class="id">G1</span> <span class="id">,</span> <span class="id">F1</span> <span class="id">\O</span> <span class="id">G1]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\v</span> (<span class="id">NId</span> <span class="id">F1</span> <span class="id">\h</span> <span class="id">eps0</span> <span class="id">\h</span> <span class="id">NId</span> <span class="id">G1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\v</span> <span class="id">[NEq</span> <span class="id">F</span> <span class="id">\O</span> <span class="id">G</span> <span class="id">,</span> (<span class="id">F1</span> <span class="id">\O</span> (<span class="id">F0</span> <span class="id">\O</span> <span class="id">G0</span>)) <span class="id">\O</span> <span class="id">G1]</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">EpsE</span> <span class="id">a</span> <span class="id">:</span> <span class="id">Eps</span> <span class="id">a</span> <span class="id">=</span> (<span class="id">eps1</span> <span class="id">_</span>) <span class="id">\o</span> <span class="id">F1</span> <span class="id">#</span> (<span class="id">eps0</span> (<span class="id">G1</span> <span class="id">a</span>)) <span class="id">:&gt;</span> (<span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof59')">Proof.</span></div>
<div class="proofscript" id="proof59">
 <span class="gallina-kwd">by</span> <span class="id">cbn;</span> <span class="id">rewrite</span> <span class="id">HCompId</span> <span class="id">HIdComp</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">EpsE_hom</span> <span class="id">a</span> <span class="id">:</span> <span class="id">Eps</span> <span class="id">a</span> <span class="id">=</span> <span class="id">[hom</span> (<span class="id">eps1</span> <span class="id">_</span>) <span class="id">\o</span> <span class="id">F1</span> <span class="id">#</span> (<span class="id">eps0</span> (<span class="id">G1</span> <span class="id">a</span>))<span class="id">]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof60')">Proof.</span></div>
<div class="proofscript" id="proof60">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">EpsE</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">triL</span> <span class="id">:</span> <span class="id">TriangularLaws.left</span> <span class="id">Eta</span> <span class="id">Eps</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof61')">Proof.</span></div>
<div class="proofscript" id="proof61">
<span class="comment">(*&nbsp;NB(tanaka):&nbsp;This&nbsp;proof&nbsp;does&nbsp;NOT&nbsp;follow&nbsp;the&nbsp;manner&nbsp;of&nbsp;2-category,&nbsp;for&nbsp;now.&nbsp;*)</span><br/>
<span class="id">move=&gt;</span> <span class="id">c;</span> <span class="id">rewrite</span> <span class="id">EpsE</span> <span class="id">EtaE_hom</span> <span class="id">hom_compA</span> (<span class="id">functor_o</span> <span class="id">F</span>) <span class="id">/F</span> <span class="id">-</span>(<span class="id">functor_o_head</span> <span class="id">F1</span>).<br/>
<span class="id">set</span> <span class="id">X</span> <span class="id">:=</span> <span class="id">[hom</span> <span class="id">[\o</span> <span class="id">_,</span> <span class="id">_]]</span>.<br/>
<span class="id">evar</span> (<span class="id">TY</span> <span class="id">:</span> <span class="gallina-kwd">Type</span>).<br/>
<span class="id">evar</span> (<span class="id">Y</span> <span class="id">:</span> <span class="id">TY</span>).<br/>
<span class="id">have-&gt;</span> <span class="id">:</span> <span class="id">F1</span> <span class="id">#</span> <span class="id">X</span> <span class="id">=</span> <span class="id">F1</span> <span class="id">#</span> <span class="id">Y</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">congr</span> (<span class="id">F1</span> <span class="id">#</span> <span class="id">_</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">/X</span> <span class="id">/=</span> <span class="id">-</span>(<span class="id">natural</span> <span class="id">eps0</span>)<span class="id">;</span> <span class="id">exact:</span> <span class="id">erefl</span>.<br/>
<span class="id">rewrite</span> (<span class="id">functor_o_head</span> <span class="id">F1</span>) <span class="id">FIdf</span>.<br/>
<span class="id">rewrite</span> <span class="id">-!hom_compA</span> <span class="id">triL1</span> <span class="id">compidf</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">RHS]</span>(<span class="id">functor_id</span> <span class="id">F1</span>) <span class="id">-</span>(<span class="id">functor_o</span> <span class="id">F1</span>)<span class="id">;</span> <span class="id">congr</span> (<span class="id">F1</span> <span class="id">#</span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">/=</span> <span class="id">triL0</span>.<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">triR</span> <span class="id">:</span> <span class="id">TriangularLaws.right</span> <span class="id">Eta</span> <span class="id">Eps</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof62')">Proof.</span></div>
<div class="proofscript" id="proof62">
<span class="id">move=&gt;</span> <span class="id">c</span>.<br/>
<span class="id">rewrite</span> <span class="id">EpsE_hom</span> <span class="id">EtaE</span> (<span class="id">functor_o_head</span> <span class="id">G</span>) <span class="id">-</span>(<span class="id">functor_o_head</span> <span class="id">G0</span> (<span class="id">eta0</span> <span class="id">_</span>)).<br/>
<span class="comment">(*&nbsp;FRAGILE!<br/>
&nbsp;&nbsp;&nbsp;simpl&nbsp;here&nbsp;breaks&nbsp;the&nbsp;notation&nbsp;and&nbsp;renders&nbsp;the&nbsp;following&nbsp;set&nbsp;X&nbsp;impossible&nbsp;*)</span><br/>
<span class="id">set</span> <span class="id">X:=</span> <span class="id">[hom</span> <span class="id">[\o</span> <span class="id">_,</span> <span class="id">_]]</span>.<br/>
<span class="id">evar</span> (<span class="id">TY</span> <span class="id">:</span> <span class="gallina-kwd">Type</span>).<br/>
<span class="id">evar</span> (<span class="id">Y</span> <span class="id">:</span> <span class="id">TY</span>).<br/>
<span class="id">have-&gt;</span> <span class="id">:</span> <span class="id">G0</span> <span class="id">#</span> <span class="id">X</span> <span class="id">=</span> <span class="id">G0</span> <span class="id">#</span> <span class="id">Y</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span> <span class="id">congr</span> (<span class="id">G0</span> <span class="id">#</span> <span class="id">_</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">/X</span> <span class="id">/=</span> (<span class="id">natural</span> <span class="id">eta1</span>)<span class="id">;</span> <span class="id">exact:</span> <span class="id">erefl</span>.<br/>
<span class="id">rewrite</span> (<span class="id">functor_o</span> <span class="id">G0</span>) <span class="id">hom_compA</span> <span class="id">FIdf</span> <span class="id">triR0</span> <span class="id">compfid</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">RHS]</span>(<span class="id">functor_id</span> <span class="id">G0</span>) <span class="id">-</span>(<span class="id">functor_o</span> <span class="id">G0</span>)<span class="id">;</span> <span class="id">congr</span> (<span class="id">G0</span> <span class="id">#</span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">/=</span> <span class="id">triR1</span>.<br/>
Qed.</div>
<span class="vernacular">End</span> <span class="id">def</span>.<br/>
<span class="vernacular">Module</span> <span class="id">Exports</span>.<br/>
<span class="vernacular">Section</span> <span class="id">adj_comp</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C0</span> <span class="id">C1</span> <span class="id">C2</span> <span class="id">:</span> <span class="id">category</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C0</span> <span class="id">-&gt;</span> <span class="id">C1}</span>) (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C1</span> <span class="id">-&gt;</span> <span class="id">C0}</span>) (<span class="id">A0</span> <span class="id">:</span> <span class="id">F</span> <span class="id">-|</span> <span class="id">G</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">F'</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C1</span> <span class="id">-&gt;</span> <span class="id">C2}</span>) (<span class="id">G'</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C2</span> <span class="id">-&gt;</span> <span class="id">C1}</span>) (<span class="id">A1</span> <span class="id">:</span> <span class="id">F'</span> <span class="id">-|</span> <span class="id">G'</span>).<br/>
<span class="vernacular">Definition</span> <span class="id">adj_comp</span> <span class="id">:=</span> <span class="id">AdjointFunctors.mk</span><br/>
&nbsp;&nbsp;(<span class="id">triL</span> (<span class="id">AdjointFunctors.triL</span> <span class="id">A0</span>) (<span class="id">AdjointFunctors.triL</span> <span class="id">A1</span>))<br/>
&nbsp;&nbsp;(<span class="id">triR</span> (<span class="id">AdjointFunctors.triR</span> <span class="id">A0</span>) (<span class="id">AdjointFunctors.triR</span> <span class="id">A1</span>)).<br/>
<span class="vernacular">End</span> <span class="id">adj_comp</span>.<br/>
<span class="vernacular">End</span> <span class="id">Exports</span>.<br/>
<span class="vernacular">End</span> <span class="id">AdjComp</span>.<br/>
<span class="vernacular">Export</span> <span class="id">AdjComp.Exports</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">JoinLaws</span>.<br/>
<span class="vernacular">Section</span> <span class="id">join_laws</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">M</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span>) <span class="id">.</span><br/>
<span class="vernacular">Variables</span> (<span class="id">ret</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~~&gt;</span> <span class="id">M</span>) (<span class="id">join</span> <span class="id">:</span> <span class="id">M</span> <span class="id">\O</span> <span class="id">M</span> <span class="id">~~&gt;</span> <span class="id">M</span>).<br/>
<span class="vernacular">Definition</span> <span class="id">left_unit</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">a,</span> <span class="id">join</span> <span class="id">a</span> <span class="id">\o</span> <span class="id">ret</span> (<span class="id">M</span> <span class="id">a</span>) <span class="id">=</span> <span class="id">idfun</span> <span class="id">:&gt;</span> (<span class="id">el</span> (<span class="id">M</span> <span class="id">a</span>) <span class="id">-&gt;</span> <span class="id">el</span> (<span class="id">M</span> <span class="id">a</span>)).<br/>
<span class="vernacular">Definition</span> <span class="id">right_unit</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">a,</span> <span class="id">join</span> <span class="id">a</span> <span class="id">\o</span> <span class="id">M</span> <span class="id">#</span> <span class="id">ret</span> <span class="id">a</span> <span class="id">=</span> <span class="id">idfun</span> <span class="id">:&gt;</span> (<span class="id">el</span> (<span class="id">M</span> <span class="id">a</span>) <span class="id">-&gt;</span> <span class="id">el</span> (<span class="id">M</span> <span class="id">a</span>)).<br/>
<span class="vernacular">Definition</span> <span class="id">associativity</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">a,</span> <span class="id">join</span> <span class="id">a</span> <span class="id">\o</span> <span class="id">M</span> <span class="id">#</span> <span class="id">join</span> <span class="id">a</span> <span class="id">=</span> <span class="id">join</span> <span class="id">a</span> <span class="id">\o</span> <span class="id">join</span> (<span class="id">M</span> <span class="id">a</span>) <span class="id">:&gt;</span> (<span class="id">el</span> (<span class="id">M</span> (<span class="id">M</span> (<span class="id">M</span> <span class="id">a</span>))) <span class="id">-&gt;</span> <span class="id">el</span> (<span class="id">M</span> <span class="id">a</span>)).<br/>
<span class="vernacular">End</span> <span class="id">join_laws</span>.<br/>
<span class="vernacular">End</span> <span class="id">JoinLaws</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">BindLaws</span>.<br/>
<span class="vernacular">Section</span> <span class="id">bindlaws</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">M</span> <span class="id">:</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C</span>).<br/>
<span class="vernacular">Variable</span> <span class="id">b</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B,</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">B}</span> <span class="id">-&gt;</span> <span class="id">{hom</span> <span class="id">M</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">B}</span>.<br/>
<span class="id">Local</span> <span class="vernacular">Notation</span> <span class="id">"m&nbsp;&gt;&gt;=&nbsp;f"</span> <span class="id">:=</span> (<span class="id">b</span> <span class="id">f</span> <span class="id">m</span>).<br/>
<span class="vernacular">Fact</span> <span class="id">associative_aux</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">x,</span> <span class="id">M</span> <span class="id">y}</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">y,</span> <span class="id">M</span> <span class="id">z}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span> <span class="id">w</span> <span class="id">=&gt;</span> (<span class="id">f</span> <span class="id">w</span> <span class="id">&gt;&gt;=</span> <span class="id">g</span>)) <span class="id">=</span> (<span class="id">b</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">f</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof63')">Proof.</span></div>
<div class="proofscript" id="proof63">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="vernacular">Definition</span> <span class="id">associative</span> <span class="id">:=</span> <span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">m</span> <span class="id">:</span> <span class="id">el</span> (<span class="id">M</span> <span class="id">A</span>)) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">B}</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">B,</span> <span class="id">M</span> <span class="id">C}</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;(<span class="id">m</span> <span class="id">&gt;&gt;=</span> <span class="id">f</span>) <span class="id">&gt;&gt;=</span> <span class="id">g</span> <span class="id">=</span> <span class="id">m</span> <span class="id">&gt;&gt;=</span> <span class="id">[hom</span> <span class="id">b</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">f]</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">left_neutral</span> (<span class="id">r</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A,</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">A}</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">B}</span>)<span class="id">,</span> <span class="id">[hom</span> (<span class="id">b</span> <span class="id">f</span> <span class="id">\o</span> <span class="id">r</span> <span class="id">A</span>)<span class="id">]</span> <span class="id">=</span> <span class="id">f</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">right_neutral</span> (<span class="id">r</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A,</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">A}</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">A</span> (<span class="id">m</span> <span class="id">:</span> <span class="id">el</span> (<span class="id">M</span> <span class="id">A</span>))<span class="id">,</span> <span class="id">m</span> <span class="id">&gt;&gt;=</span> <span class="id">r</span> <span class="id">_</span> <span class="id">=</span> <span class="id">m</span>.<br/>
<span class="vernacular">End</span> <span class="id">bindlaws</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">misc_laws_on_Type_monad</span>.<br/>
<span class="vernacular">Variable</span> <span class="id">M</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">CT</span> <span class="id">-&gt;</span> <span class="id">CT}</span>.<br/>
<span class="vernacular">Variable</span> <span class="id">b</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B,</span> (<span class="id">A</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span>) <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span>.<br/>
<span class="id">Local</span> <span class="vernacular">Notation</span> <span class="id">"m&nbsp;&gt;&gt;=&nbsp;f"</span> <span class="id">:=</span> (<span class="id">b</span> <span class="id">f</span> <span class="id">m</span>).<br/>
<span class="vernacular">Definition</span> <span class="id">bind_right_distributive</span> (<span class="id">add</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">B,</span> <span class="id">M</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">m</span> <span class="id">:</span> <span class="id">M</span> <span class="id">A</span>) (<span class="id">k1</span> <span class="id">k2</span> <span class="id">:</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> <span class="id">&gt;&gt;=</span> (<span class="gallina-kwd">fun</span> <span class="id">x</span> <span class="id">=&gt;</span> <span class="id">add</span> <span class="id">_</span> (<span class="id">k1</span> <span class="id">x</span>) (<span class="id">k2</span> <span class="id">x</span>)) <span class="id">=</span> <span class="id">add</span> <span class="id">_</span> (<span class="id">m</span> <span class="id">&gt;&gt;=</span> <span class="id">k1</span>) (<span class="id">m</span> <span class="id">&gt;&gt;=</span> <span class="id">k2</span>).<br/>
<span class="vernacular">Definition</span> <span class="id">bind_left_distributive</span> (<span class="id">add</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">B,</span> <span class="id">M</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">m1</span> <span class="id">m2</span> <span class="id">:</span> <span class="id">M</span> <span class="id">A</span>) (<span class="id">k</span> <span class="id">:</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">add</span> <span class="id">_</span> <span class="id">m1</span> <span class="id">m2</span>) <span class="id">&gt;&gt;=</span> <span class="id">k</span> <span class="id">=</span> <span class="id">add</span> <span class="id">_</span> (<span class="id">m1</span> <span class="id">&gt;&gt;=</span> <span class="id">k</span>) (<span class="id">m2</span> <span class="id">&gt;&gt;=</span> <span class="id">k</span>).<br/>
<span class="vernacular">Definition</span> <span class="id">right_zero</span> (<span class="id">f</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">A</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">g</span> <span class="id">:</span> <span class="id">M</span> <span class="id">B</span>)<span class="id">,</span> <span class="id">g</span> <span class="id">&gt;&gt;=</span> (<span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">f</span> <span class="id">A</span>) <span class="id">=</span> <span class="id">f</span> <span class="id">A</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">left_zero</span> (<span class="id">f</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">A</span>) <span class="id">:=</span> <span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B</span> <span class="id">g,</span> <span class="id">f</span> <span class="id">A</span> <span class="id">&gt;&gt;=</span> <span class="id">g</span> <span class="id">=</span> <span class="id">f</span> <span class="id">B</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">left_id</span> (<span class="id">r</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">A</span>) (<span class="id">add</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">B,</span> <span class="id">M</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">A</span> (<span class="id">m</span> <span class="id">:</span> <span class="id">M</span> <span class="id">A</span>)<span class="id">,</span> <span class="id">add</span> <span class="id">_</span> (<span class="id">r</span> <span class="id">_</span>) <span class="id">m</span> <span class="id">=</span> <span class="id">m</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">right_id</span> (<span class="id">r</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">A</span>) (<span class="id">add</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">B,</span> <span class="id">M</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">M</span> <span class="id">B</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> <span class="id">A</span> (<span class="id">m</span> <span class="id">:</span> <span class="id">M</span> <span class="id">A</span>)<span class="id">,</span> <span class="id">add</span> <span class="id">_</span> <span class="id">m</span> (<span class="id">r</span> <span class="id">_</span>) <span class="id">=</span> <span class="id">m</span>.<br/>
<span class="vernacular">End</span> <span class="id">misc_laws_on_Type_monad</span>.<br/>
<span class="vernacular">End</span> <span class="id">BindLaws</span>.<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">bind_lemmas</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">M</span> <span class="id">:</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C</span>).<br/>
<span class="vernacular">Variable</span> <span class="id">b</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B,</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">B}</span> <span class="id">-&gt;</span> <span class="id">{hom</span> <span class="id">M</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">B}</span>.<br/>
<span class="id">Local</span> <span class="vernacular">Notation</span> <span class="id">"m&nbsp;&gt;&gt;=&nbsp;f"</span> <span class="id">:=</span> (<span class="id">b</span> <span class="id">f</span> <span class="id">m</span>).<br/>
<span class="vernacular">Lemma</span> <span class="id">bind_left_neutral_hom_fun</span> (<span class="id">r</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A,</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">A}</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span> <span class="id">BindLaws.left_neutral</span> <span class="id">b</span> <span class="id">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&lt;-&gt;</span> <span class="gallina-kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">M</span> <span class="id">B}</span>)<span class="id">,</span> <span class="id">b</span> <span class="id">f</span> <span class="id">\o</span> <span class="id">r</span> <span class="id">A</span> <span class="id">=</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof64')">Proof.</span></div>
<div class="proofscript" id="proof64">
 <span class="gallina-kwd">by</span> <span class="id">split;</span> <span class="id">move=&gt;</span> <span class="id">H</span> <span class="id">A</span> <span class="id">B</span> <span class="id">f;</span> <span class="id">move:</span> (<span class="id">H</span> <span class="id">A</span> <span class="id">B</span> <span class="id">f</span>)<span class="id">;</span> <span class="id">move/hom_ext</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">bind_lemmas</span>.<br/>
<br/>
<br/>
<span class="id">HB.mixin</span> <span class="vernacular">Record</span> <span class="id">isMonad</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">M</span> <span class="id">:</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C</span>) <span class="id">of</span> <span class="id">@Functor</span> <span class="id">C</span> <span class="id">C</span> <span class="id">M</span> <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">ret</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~&gt;</span> <span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">M]</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">join</span> <span class="id">:</span> <span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">M]</span> <span class="id">\O</span> <span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">M]</span> <span class="id">~&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">M]</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">bind</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>)<span class="id">,</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span> <span class="id">-&gt;</span> <span class="id">{hom</span> <span class="id">M</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">bindE</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span>) (<span class="id">m</span> <span class="id">:</span> <span class="id">el</span> (<span class="id">M</span> <span class="id">a</span>))<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bind</span> <span class="id">a</span> <span class="id">b</span> <span class="id">f</span> <span class="id">m</span> <span class="id">=</span> <span class="id">join</span> <span class="id">b</span> ((<span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">M]</span> <span class="id">#</span> <span class="id">f</span>) <span class="id">m</span>) <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">joinretM</span> <span class="id">:</span> <span class="id">JoinLaws.left_unit</span> <span class="id">ret</span> <span class="id">join</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">joinMret</span> <span class="id">:</span> <span class="id">JoinLaws.right_unit</span> <span class="id">ret</span> <span class="id">join</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">joinA</span> <span class="id">:</span> <span class="id">JoinLaws.associativity</span> <span class="id">join</span><br/>
<span class="id">}</span>.<br/>
<span class="id">#[short</span>(<span class="id">type=monad</span>)<span class="id">]</span><br/>
<span class="id">HB.structure</span> <span class="vernacular">Definition</span> <span class="id">Monad</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">{M</span> <span class="id">of</span> <span class="id">isMonad</span> <span class="id">C</span> <span class="id">M</span> <span class="id">&amp;</span> <span class="id">isFunctor</span> <span class="id">C</span> <span class="id">C</span> <span class="id">M}</span>.<br/>
<span class="vernacular">Arguments</span> <span class="id">bind</span> <span class="id">{C</span> <span class="id">M</span> <span class="id">a</span> <span class="id">b}</span> <span class="id">:</span> <span class="id">rename,</span> <span class="id">simpl</span> <span class="id">never</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">"m&nbsp;&gt;&gt;=&nbsp;f"</span> <span class="id">:=</span> (<span class="id">bind</span> <span class="id">f</span> <span class="id">m</span>).<br/>
<br/>
<span class="vernacular">Section</span> <span class="id">monad_interface</span>.<br/>
<span class="vernacular">Variable</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">M</span> <span class="id">:</span> <span class="id">monad</span> <span class="id">C</span>).<br/>
<span class="vernacular">Import</span> <span class="id">comps_notation</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">joinretM_head</span> <span class="id">a</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">M</span> <span class="id">a}</span>) <span class="id">:</span> <span class="id">[\o</span> <span class="id">join</span> <span class="id">_,</span> <span class="id">ret</span> <span class="id">_,</span> <span class="id">f]</span> <span class="id">=</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof65')">Proof.</span></div>
<div class="proofscript" id="proof65">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">compA</span> <span class="id">joinretM</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">joinMret_head</span> <span class="id">a</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">M</span> <span class="id">a}</span>) <span class="id">:</span> <span class="id">[\o</span> <span class="id">join</span> <span class="id">_,</span> <span class="id">M</span> <span class="id">#</span> <span class="id">ret</span> <span class="id">_,</span> <span class="id">f]</span> <span class="id">=</span> <span class="id">f</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof66')">Proof.</span></div>
<div class="proofscript" id="proof66">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">compA</span> <span class="id">joinMret</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">joinA_head</span> <span class="id">a</span> (<span class="id">c</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,</span> <span class="id">M</span> (<span class="id">M</span> (<span class="id">M</span> <span class="id">a</span>))<span class="id">}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">[\o</span> <span class="id">join</span> <span class="id">_,</span> <span class="id">M</span> <span class="id">#</span> <span class="id">join</span> <span class="id">_,</span> <span class="id">f]</span> <span class="id">=</span> <span class="id">[\o</span> <span class="id">join</span> <span class="id">_,</span> <span class="id">join</span> <span class="id">_,</span> <span class="id">f]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof67')">Proof.</span></div>
<div class="proofscript" id="proof67">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">compA</span> <span class="id">joinA</span>. Qed.</div>
<span class="vernacular">End</span> <span class="id">monad_interface</span>.<br/>
<br/>
<span class="id">HB.factory</span> <span class="vernacular">Record</span> <span class="id">Monad_of_ret_join</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">M</span> <span class="id">:</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">of</span> <span class="id">@Functor</span> <span class="id">C</span> <span class="id">C</span> <span class="id">M</span> <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">ret</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~&gt;</span> <span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">M]</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">join</span> <span class="id">:</span> <span class="id">M</span> <span class="id">\O</span> <span class="id">M</span> <span class="id">~&gt;</span> <span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">M]</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">joinretM</span> <span class="id">:</span> <span class="id">JoinLaws.left_unit</span> <span class="id">ret</span> <span class="id">join</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">joinMret</span> <span class="id">:</span> <span class="id">JoinLaws.right_unit</span> <span class="id">ret</span> <span class="id">join</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">joinA</span> <span class="id">:</span> <span class="id">JoinLaws.associativity</span> <span class="id">join</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB.builders</span> <span class="vernacular">Context</span> <span class="id">C</span> <span class="id">M</span> <span class="id">of</span> <span class="id">Monad_of_ret_join</span> <span class="id">C</span> <span class="id">M</span>.<br/>
<span class="vernacular">Let</span> <span class="id">F</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">{functor</span> <span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_}</span> <span class="id">of</span> <span class="id">M]</span>.<br/>
<span class="vernacular">Let</span> <span class="id">bind</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span>) <span class="id">:</span> <span class="id">{hom</span> <span class="id">M</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span> <span class="id">:=</span> <span class="id">[hom</span> <span class="id">join</span> <span class="id">_</span> <span class="id">\o</span> (<span class="id">F</span> <span class="id">#</span> <span class="id">f</span>)<span class="id">]</span>.<br/>
<span class="vernacular">Let</span> <span class="id">bindE</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span>) (<span class="id">m</span> <span class="id">:</span> <span class="id">el</span> (<span class="id">M</span> <span class="id">a</span>)) <span class="id">:</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bind</span> <span class="id">f</span> <span class="id">m</span> <span class="id">=</span> <span class="id">join</span> <span class="id">b</span> ((<span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">M]</span> <span class="id">#</span> <span class="id">f</span>) <span class="id">m</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof68')">Proof.</span></div>
<div class="proofscript" id="proof68">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isMonad.Build</span> <span class="id">C</span> <span class="id">M</span> <span class="id">bindE</span> <span class="id">joinretM</span> <span class="id">joinMret</span> <span class="id">joinA</span>.<br/>
<span class="id">HB.end</span>.<br/>
<br/>
<span class="id">HB.factory</span> <span class="vernacular">Record</span> <span class="id">Monad_of_ret_bind</span> (<span class="id">C</span> <span class="id">:</span> <span class="id">category</span>) (<span class="id">acto</span> <span class="id">:</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C</span>) <span class="id">:=</span> <span class="id">{</span><br/>
&nbsp;&nbsp;<span class="id">ret'</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">a,</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">acto</span> <span class="id">a}</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">bind</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>)<span class="id">,</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">acto</span> <span class="id">b}</span> <span class="id">-&gt;</span> <span class="id">{hom</span> <span class="id">acto</span> <span class="id">a,</span> <span class="id">acto</span> <span class="id">b}</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">bindretf</span> <span class="id">:</span> <span class="id">BindLaws.left_neutral</span> <span class="id">bind</span> <span class="id">ret'</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">bindmret</span> <span class="id">:</span> <span class="id">BindLaws.right_neutral</span> <span class="id">bind</span> <span class="id">ret'</span> <span class="id">;</span><br/>
&nbsp;&nbsp;<span class="id">bindA</span> <span class="id">:</span> <span class="id">BindLaws.associative</span> <span class="id">bind</span> <span class="id">;</span><br/>
<span class="id">}</span>.<br/>
<span class="id">HB.builders</span> <span class="vernacular">Context</span> <span class="id">C</span> <span class="id">M</span> <span class="id">of</span> <span class="id">Monad_of_ret_bind</span> <span class="id">C</span> <span class="id">M</span>.<br/>
<span class="vernacular">Let</span> <span class="id">fmap</span> <span class="id">a</span> <span class="id">b</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:=</span> <span class="id">bind</span> <span class="id">[hom</span> <span class="id">ret'</span> <span class="id">b</span> <span class="id">\o</span> <span class="id">f]</span>.<br/>
<span class="vernacular">Let</span> <span class="id">bindretf_fun</span> <span class="id">:</span> (<span class="gallina-kwd">forall</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;<span class="id">bind</span> <span class="id">f</span> <span class="id">\o</span> <span class="id">ret'</span> <span class="id">a</span> <span class="id">=</span> <span class="id">f</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof69')">Proof.</span></div>
<div class="proofscript" id="proof69">
 <span class="gallina-kwd">by</span> <span class="id">apply/bind_left_neutral_hom_fun/bindretf</span>. Qed.</div>
<span class="vernacular">Let</span> <span class="id">fmap_id</span> <span class="id">:</span> <span class="id">FunctorLaws.id</span> <span class="id">fmap</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof70')">Proof.</span></div>
<div class="proofscript" id="proof70">
<span class="id">move=&gt;</span> <span class="id">A;</span> <span class="id">apply/hom_ext/funext=&gt;m</span>. <span class="id">rewrite</span> <span class="id">/fmap</span>.<br/>
<span class="id">rewrite/idfun/=</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">RHS]</span>(<span class="id">bindmret</span> <span class="id">m</span>).<br/>
<span class="id">congr</span> (<span class="gallina-kwd">fun</span> <span class="id">f</span> <span class="id">=&gt;</span> <span class="id">bind</span> <span class="id">f</span> <span class="id">m</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span>.<br/>
Qed.</div>
<span class="vernacular">Let</span> <span class="id">fmap_o</span> <span class="id">:</span> <span class="id">FunctorLaws.comp</span> <span class="id">fmap</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof71')">Proof.</span></div>
<div class="proofscript" id="proof71">
<span class="id">move=&gt;</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> <span class="id">g</span> <span class="id">h;</span> <span class="id">apply/hom_ext/funext=&gt;m;</span> <span class="id">rewrite</span> <span class="id">/fmap/=</span>.<br/>
<span class="id">rewrite</span> <span class="id">bindA/=</span>.<br/>
<span class="id">congr</span> (<span class="gallina-kwd">fun</span> <span class="id">f</span> <span class="id">=&gt;</span> <span class="id">bind</span> <span class="id">f</span> <span class="id">m</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id">hom_ext/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">RHS]hom_compA</span> <span class="id">bindretf_fun</span>.<br/>
Qed.</div>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isFunctor.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">fmap_id</span> <span class="id">fmap_o</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">F</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">{functor</span> <span class="id">_</span> <span class="id">-&gt;</span> <span class="id">_}</span> <span class="id">of</span> <span class="id">M]</span>.<br/>
<span class="vernacular">Let</span> <span class="id">ret'_naturality</span> <span class="id">:</span> <span class="id">naturality</span> <span class="id">FId</span> <span class="id">F</span> <span class="id">ret'</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof72')">Proof.</span></div>
<div class="proofscript" id="proof72">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">A</span> <span class="id">B</span> <span class="id">h;</span> <span class="id">rewrite</span> <span class="id">FIdf</span> <span class="id">bindretf_fun</span>. Qed.</div>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isNatural.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">FId</span> <span class="id">F</span><br/>
&nbsp;&nbsp;(<span class="id">ret'</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~~&gt;</span> <span class="id">M</span>) <span class="id">ret'_naturality</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">ret</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">FId</span> <span class="id">~&gt;</span> <span class="id">F</span> <span class="id">of</span> <span class="id">ret']</span>.<br/>
<span class="vernacular">Let</span> <span class="id">join'</span> <span class="id">:</span> <span class="id">F</span> <span class="id">\O</span> <span class="id">F</span> <span class="id">~~&gt;</span> <span class="id">F</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span class="id">_</span> <span class="id">=&gt;</span> <span class="id">bind</span> <span class="id">[hom</span> <span class="id">idfun]</span>.<br/>
<span class="vernacular">Let</span> <span class="id">fmap_bind</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,b}</span>) <span class="id">m</span> (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">c,F</span> <span class="id">a}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;(<span class="id">fmap</span> <span class="id">f</span>) (<span class="id">bind</span> <span class="id">g</span> <span class="id">m</span>) <span class="id">=</span> <span class="id">bind</span> <span class="id">[hom</span> <span class="id">fmap</span> <span class="id">f</span> <span class="id">\o</span> <span class="id">g]</span> <span class="id">m</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof73')">Proof.</span></div>
<div class="proofscript" id="proof73">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/fmap</span> <span class="id">bindA</span>. Qed.</div>
<span class="vernacular">Let</span> <span class="id">join'_naturality</span> <span class="id">:</span> <span class="id">naturality</span> (<span class="id">F</span> <span class="id">\O</span> <span class="id">F</span>) <span class="id">F</span> <span class="id">join'</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof74')">Proof.</span></div>
<div class="proofscript" id="proof74">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">A</span> <span class="id">B</span> <span class="id">h</span>.<br/>
<span class="id">rewrite</span> <span class="id">/join</span> <span class="id">/=</span> <span class="id">funeqE</span> <span class="id">=&gt;</span> <span class="id">m</span> <span class="id">/=</span>.<br/>
<span class="id">rewrite</span> <span class="id">fmap_bind</span> <span class="id">bindA</span> <span class="id">/=</span>.<br/>
<span class="id">congr</span> (<span class="gallina-kwd">fun</span> <span class="id">f</span> <span class="id">=&gt;</span> <span class="id">bind</span> <span class="id">f</span> <span class="id">m</span>).<br/>
<span class="id">rewrite</span> <span class="id">hom_ext/=</span>.<br/>
<span class="id">rewrite</span> <span class="id">-[in</span> <span class="id">RHS]hom_compA</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">bindretf_fun</span>.<br/>
Qed.</div>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isNatural.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">join'_naturality</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">join</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">F</span> <span class="id">\O</span> <span class="id">F</span> <span class="id">~&gt;</span> <span class="id">F</span> <span class="id">of</span> <span class="id">join']</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span class="id">bind_fmap</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) (<span class="id">m</span> <span class="id">:</span> <span class="id">el</span> (<span class="id">F</span> <span class="id">a</span>)) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">F</span> <span class="id">c}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">bind</span> <span class="id">g</span> (<span class="id">fmap</span> <span class="id">f</span> <span class="id">m</span>) <span class="id">=</span> <span class="id">bind</span> <span class="id">[hom</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">f]</span> <span class="id">m</span> <span class="id">.</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof75')">Proof.</span></div>
<div class="proofscript" id="proof75">
<span class="id">rewrite</span> <span class="id">bindA</span> <span class="id">/=;</span> <span class="id">congr</span> (<span class="gallina-kwd">fun</span> <span class="id">f</span> <span class="id">=&gt;</span> <span class="id">bind</span> <span class="id">f</span> <span class="id">m</span>)<span class="id">;</span> <span class="id">apply</span> <span class="id">hom_ext</span> <span class="id">=&gt;</span> <span class="id">/=</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">-hom_compA</span> <span class="id">bindretf_fun</span>.<br/>
Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">bindE</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">F</span> <span class="id">b}</span>) (<span class="id">m</span> <span class="id">:</span> <span class="id">el</span> (<span class="id">F</span> <span class="id">a</span>)) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">bind</span> <span class="id">f</span> <span class="id">m</span> <span class="id">=</span> <span class="id">join</span> <span class="id">b</span> ((<span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">F]</span> <span class="id">#</span> <span class="id">f</span>) <span class="id">m</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof76')">Proof.</span></div>
<div class="proofscript" id="proof76">
<span class="id">rewrite</span> <span class="id">/join</span> <span class="id">/=</span>.<br/>
<span class="id">rewrite</span> <span class="id">/=bind_fmap/idfun/=</span>.<br/>
<span class="id">congr</span> (<span class="gallina-kwd">fun</span> <span class="id">f</span> <span class="id">=&gt;</span> <span class="id">bind</span> <span class="id">f</span> <span class="id">m</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span>.<br/>
Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">joinretM</span> <span class="id">:</span> <span class="id">JoinLaws.left_unit</span> <span class="id">ret</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof77')">Proof.</span></div>
<div class="proofscript" id="proof77">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/join</span> <span class="id">=&gt;</span> <span class="id">A;</span> <span class="id">rewrite</span> <span class="id">bindretf_fun</span>. Qed.</div>
<span class="vernacular">Let</span> <span class="id">bind_fmap_fun</span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,b}</span>) (<span class="id">g</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">b,</span> <span class="id">F</span> <span class="id">c}</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">bind</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">fmap</span> <span class="id">f</span> <span class="id">=</span> <span class="id">bind</span> <span class="id">[hom</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">f]</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof78')">Proof.</span></div>
<div class="proofscript" id="proof78">
 <span class="id">rewrite</span> <span class="id">funeqE</span> <span class="id">=&gt;</span> <span class="id">?;</span> <span class="id">exact:</span> <span class="id">bind_fmap</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">joinMret</span> <span class="id">:</span> <span class="id">JoinLaws.right_unit</span> <span class="id">ret</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof79')">Proof.</span></div>
<div class="proofscript" id="proof79">
<span class="id">rewrite</span> <span class="id">/join</span> <span class="id">=&gt;</span> <span class="id">A;</span> <span class="id">rewrite</span> <span class="id">funeqE</span> <span class="id">=&gt;</span> <span class="id">ma</span>.<br/>
<span class="id">rewrite</span> <span class="id">bind_fmap_fun/=</span> <span class="id">-[in</span> <span class="id">RHS]</span>(<span class="id">bindmret</span> <span class="id">ma</span>).<br/>
<span class="id">congr</span> (<span class="gallina-kwd">fun</span> <span class="id">f</span> <span class="id">=&gt;</span> <span class="id">bind</span> <span class="id">f</span> <span class="id">ma</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span>.<br/>
Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">joinA</span> <span class="id">:</span> <span class="id">JoinLaws.associativity</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof80')">Proof.</span></div>
<div class="proofscript" id="proof80">
<span class="id">move</span> <span class="id">=&gt;</span> <span class="id">A;</span> <span class="id">rewrite</span> <span class="id">funeqE</span> <span class="id">=&gt;</span> <span class="id">mmma</span>.<br/>
<span class="id">rewrite</span> <span class="id">/join</span>.<br/>
<span class="id">rewrite</span> <span class="id">bind_fmap_fun/=</span> <span class="id">bindA/=</span>.<br/>
<span class="id">congr</span> (<span class="gallina-kwd">fun</span> <span class="id">f</span> <span class="id">=&gt;</span> <span class="id">bind</span> <span class="id">f</span> <span class="id">mmma</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span>.<br/>
Qed.</div>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isMonad.Build</span> <span class="id">C</span> <span class="id">F</span> <span class="id">bindE</span> <span class="id">joinretM</span> <span class="id">joinMret</span> <span class="id">joinA</span>.<br/>
<span class="id">HB.end</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">_Monad_of_adjoint_functors</span>.<br/>
<span class="vernacular">Section</span> <span class="id">def</span>.<br/>
<span class="vernacular">Import</span> <span class="id">comps_notation</span>.<br/>
<span class="vernacular">Variables</span> <span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">C}</span>).<br/>
<span class="vernacular">Variable</span> <span class="id">A</span> <span class="id">:</span> <span class="id">F</span> <span class="id">-|</span> <span class="id">G</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">eps</span> <span class="id">:=</span> <span class="id">AdjointFunctors.eps</span> <span class="id">A</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">eta</span> <span class="id">:=</span> <span class="id">AdjointFunctors.eta</span> <span class="id">A</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">M</span> <span class="id">:=</span> <span class="id">G</span> <span class="id">\O</span> <span class="id">F</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">join</span> <span class="id">:</span> <span class="id">M</span> <span class="id">\O</span> <span class="id">M</span> <span class="id">~~&gt;</span> <span class="id">M</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span class="id">a</span> <span class="id">=&gt;</span> <span class="id">G</span> <span class="id">#</span> (<span class="id">eps</span> (<span class="id">F</span> <span class="id">a</span>)).<br/>
<span class="vernacular">Definition</span> <span class="id">ret</span> <span class="id">:</span> <span class="id">FId</span> <span class="id">~~&gt;</span> <span class="id">M</span> <span class="id">:=</span> <span class="gallina-kwd">fun</span> <span class="id">a</span> <span class="id">=&gt;</span> <span class="id">eta</span> <span class="id">a</span>.<br/>
<span class="vernacular">Let</span> <span class="id">triL</span> <span class="id">:=</span> <span class="id">AdjointFunctors.triL</span> <span class="id">A</span>.<br/>
<span class="vernacular">Let</span> <span class="id">triR</span> <span class="id">:=</span> <span class="id">AdjointFunctors.triR</span> <span class="id">A</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">naturality_ret</span> <span class="id">:</span> <span class="id">naturality</span> <span class="id">FId</span> <span class="id">M</span> <span class="id">ret</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof81')">Proof.</span></div>
<div class="proofscript" id="proof81">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">*;</span> <span class="id">rewrite</span> (<span class="id">natural</span> <span class="id">eta</span>). Qed.</div>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isNatural.Build</span> <span class="id">C</span> <span class="id">C</span> <span class="id">FId</span> <span class="id">M</span> <span class="id">ret</span> <span class="id">naturality_ret</span>.<br/>
<span class="vernacular">Lemma</span> <span class="id">naturality_join</span> <span class="id">:</span> <span class="id">naturality</span> (<span class="id">M</span> <span class="id">\O</span> <span class="id">M</span>) <span class="id">M</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof82')">Proof.</span></div>
<div class="proofscript" id="proof82">
<span class="id">rewrite</span> <span class="id">/join</span> <span class="id">=&gt;</span> <span class="id">a</span> <span class="id">b</span> <span class="id">h</span>.<br/>
<span class="id">rewrite</span> <span class="id">/M</span> <span class="id">!FCompE</span> <span class="id">-2!</span>(<span class="id">functor_o</span> <span class="id">G</span>)<span class="id">;</span> <span class="id">congr</span> (<span class="id">G</span> <span class="id">#</span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">/=</span> (<span class="id">natural</span> <span class="id">eps</span>).<br/>
Qed.</div>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">isNatural.Build</span> <span class="id">C</span> <span class="id">C</span> (<span class="id">M</span> <span class="id">\O</span> <span class="id">M</span>) <span class="id">M</span> <span class="id">join</span> <span class="id">naturality_join</span>.<br/>
<span class="vernacular">Let</span> <span class="id">joinE</span> <span class="id">:</span> <span class="id">join</span> <span class="id">=</span> <span class="gallina-kwd">fun</span> <span class="id">a</span> <span class="id">=&gt;</span> <span class="id">G</span> <span class="id">#</span> (<span class="id">@eps</span> (<span class="id">F</span> <span class="id">a</span>)).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof83')">Proof.</span></div>
<div class="proofscript" id="proof83">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="vernacular">Let</span> <span class="id">join_associativity'</span> <span class="id">a</span> <span class="id">:</span> <span class="id">join</span> <span class="id">a</span> <span class="id">\o</span> <span class="id">join</span> (<span class="id">M</span> <span class="id">a</span>) <span class="id">=</span> <span class="id">join</span> <span class="id">a</span> <span class="id">\o</span> (<span class="id">M</span> <span class="id">#</span> <span class="id">join</span> <span class="id">a</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof84')">Proof.</span></div>
<div class="proofscript" id="proof84">
<span class="id">rewrite</span> <span class="id">joinE</span> <span class="id">-2!</span>(<span class="id">functor_o</span> <span class="id">G</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">congr</span> (<span class="id">G</span> <span class="id">#</span> <span class="id">_</span>)<span class="id">;</span> <span class="id">rewrite</span> <span class="id">hom_ext</span> <span class="id">/=</span> (<span class="id">natural</span> <span class="id">eps</span>).<br/>
Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">join_associativity</span> <span class="id">:</span> <span class="id">JoinLaws.associativity</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof85')">Proof.</span></div>
<div class="proofscript" id="proof85">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">a;</span> <span class="id">rewrite</span> <span class="id">join_associativity'</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">join_left_unit</span> <span class="id">:</span> <span class="id">JoinLaws.left_unit</span> <span class="id">ret</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof86')">Proof.</span></div>
<div class="proofscript" id="proof86">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">a;</span> <span class="id">rewrite</span> <span class="id">joinE</span> <span class="id">triR</span>. Qed.</div>
<span class="vernacular">Lemma</span> <span class="id">join_right_unit</span> <span class="id">:</span> <span class="id">JoinLaws.right_unit</span> <span class="id">ret</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof87')">Proof.</span></div>
<div class="proofscript" id="proof87">
<span class="id">move=&gt;</span> <span class="id">a;</span> <span class="id">rewrite</span> <span class="id">joinE</span>. <span class="id">rewrite</span> <span class="id">/M</span> <span class="id">FCompE</span>.<br/>
<span class="id">rewrite</span> <span class="id">/=</span> <span class="id">-functor_o</span> <span class="id">-[in</span> <span class="id">RHS]functor_id</span>.<br/>
<span class="id">congr</span> (<span class="id">G</span> <span class="id">#</span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">hom_ext/=</span> <span class="id">triL</span>.<br/>
Qed.</div>
<span class="vernacular">Let</span> <span class="id">bind</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span>) <span class="id">:</span> <span class="id">{hom</span> <span class="id">M</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">[hom</span> <span class="id">join</span> <span class="id">_</span> <span class="id">\o</span> (<span class="id">M</span> <span class="id">#</span> <span class="id">f</span>)<span class="id">]</span>.<br/>
<span class="vernacular">Let</span> <span class="id">bindE</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">C</span>) (<span class="id">f</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">M</span> <span class="id">b}</span>) (<span class="id">m</span> <span class="id">:</span> <span class="id">el</span> (<span class="id">M</span> <span class="id">a</span>)) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">bind</span> <span class="id">f</span> <span class="id">m</span> <span class="id">=</span> <span class="id">join</span> <span class="id">b</span> ((<span class="id">[the</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">C}</span> <span class="id">of</span> <span class="id">M]</span> <span class="id">#</span> <span class="id">f</span>) <span class="id">m</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof88')">Proof.</span></div>
<div class="proofscript" id="proof88">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">monad_of_adjoint_mixin</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">isMonad.Build</span> <span class="id">C</span> <span class="id">M</span> <span class="id">bindE</span> <span class="id">join_left_unit</span> <span class="id">join_right_unit</span> <span class="id">join_associativity</span>.<br/>
<span class="vernacular">End</span> <span class="id">def</span>.<br/>
<span class="vernacular">Definition</span> <span class="id">build</span> (<span class="id">C</span> <span class="id">D</span> <span class="id">:</span> <span class="id">category</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">C</span> <span class="id">-&gt;</span> <span class="id">D}</span>) (<span class="id">G</span> <span class="id">:</span> <span class="id">{functor</span> <span class="id">D</span> <span class="id">-&gt;</span> <span class="id">C}</span>) (<span class="id">A</span> <span class="id">:</span> <span class="id">F</span> <span class="id">-|</span> <span class="id">G</span>) <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="id">Monad.Pack</span> (<span class="id">Monad.Class</span> (<span class="id">monad_of_adjoint_mixin</span> <span class="id">A</span>)).<br/>
<span class="vernacular">End</span> <span class="id">_Monad_of_adjoint_functors</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">Monad_of_adjoint_functors</span> <span class="id">:=</span> <span class="id">_Monad_of_adjoint_functors</span>.<span class="id">build</span>.<br/>
<br/>
<span class="vernacular">Require</span> <span class="vernacular">Import</span> <span class="id">hierarchy</span>.<br/>
<br/>
<span class="vernacular">Module</span> <span class="id">Monad_of_category_monad</span>.<br/>
<span class="vernacular">Section</span> <span class="id">def</span>.<br/>
<span class="vernacular">Variable</span> <span class="id">M</span> <span class="id">:</span> <span class="id">category.Monad.Exports.monad</span> <span class="id">CT</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">acto</span> <span class="id">:</span> <span class="gallina-kwd">Type</span> <span class="id">-&gt;</span> <span class="gallina-kwd">Type</span> <span class="id">:=</span> <span class="id">M</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">actm</span> (<span class="id">A</span> <span class="id">B</span> <span class="id">:</span> <span class="gallina-kwd">Type</span>) (<span class="id">h</span> <span class="id">:</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">B</span>) (<span class="id">x</span> <span class="id">:</span> <span class="id">acto</span> <span class="id">A</span>) <span class="id">:</span> <span class="id">acto</span> <span class="id">B</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;(<span class="id">M</span> <span class="id">#</span> <span class="id">[the</span> <span class="id">{hom</span> <span class="id">A,</span> <span class="id">B}</span> <span class="id">of</span> <span class="id">h]</span>) <span class="id">x</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">actm_id</span> <span class="id">A</span> <span class="id">:</span> <span class="id">actm</span> <span class="id">id</span> <span class="id">=</span> <span class="id">@id</span> (<span class="id">acto</span> <span class="id">A</span>).<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof89')">Proof.</span></div>
<div class="proofscript" id="proof89">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">/actm</span> <span class="id">category.functor_id</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">actm_comp</span> <span class="id">A</span> <span class="id">B</span> <span class="id">C</span> (<span class="id">g</span> <span class="id">:</span> <span class="id">B</span> <span class="id">-&gt;</span> <span class="id">C</span>) (<span class="id">h</span> <span class="id">:</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">B</span>) <span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">actm</span> (<span class="id">g</span> <span class="id">\o</span> <span class="id">h</span>) <span class="id">=</span> <span class="id">actm</span> <span class="id">g</span> <span class="id">\o</span> <span class="id">actm</span> <span class="id">h</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof90')">Proof.</span></div>
<div class="proofscript" id="proof90">
 <span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">{1}/actm</span> <span class="id">category.functor_o</span>. Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">hierarchy.isFunctor.Build</span> <span class="id">acto</span> <span class="id">actm_id</span> <span class="id">actm_comp</span>.<br/>
<br/>
<span class="vernacular">Let</span> <span class="id">F</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">functor</span> <span class="id">of</span> <span class="id">acto]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">actmE</span> (<span class="id">a</span> <span class="id">b</span> <span class="id">:</span> <span class="id">CT</span>) (<span class="id">h</span> <span class="id">:</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span>) <span class="id">:</span> (<span class="id">F</span> <span class="id">#</span> <span class="id">h</span>)<span class="id">%monae</span> <span class="id">=</span> (<span class="id">M</span> <span class="id">#</span> <span class="id">h</span>)<span class="id">%category</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof91')">Proof.</span></div>
<div class="proofscript" id="proof91">
 <span class="gallina-kwd">by</span> <span class="id">congr</span> (<span class="id">category.actm</span> <span class="id">M</span>)<span class="id">;</span> <span class="id">apply</span> <span class="id">hom_ext</span>. Qed.</div>
<br/>
<span class="vernacular">Definition</span> <span class="id">ret_</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A,</span> <span class="id">idfun</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">F</span> <span class="id">A</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span class="id">A</span> (<span class="id">a</span> <span class="id">:</span> <span class="id">A</span>) <span class="id">=&gt;</span> <span class="id">@category</span>.<span class="id">ret</span> <span class="id">_</span> <span class="id">M</span> <span class="id">A</span> <span class="id">a</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">join_</span> <span class="id">:</span> <span class="gallina-kwd">forall</span> <span class="id">A,</span> <span class="id">[the</span> <span class="id">functor</span> <span class="id">of</span> <span class="id">F</span> <span class="id">\o</span> <span class="id">F]</span> <span class="id">A</span> <span class="id">-&gt;</span> <span class="id">F</span> <span class="id">A</span> <span class="id">:=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">fun</span> <span class="id">A</span> <span class="id">=&gt;</span> <span class="id">@category</span>.<span class="id">join</span> <span class="id">_</span> <span class="id">M</span> <span class="id">A</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">naturality_ret</span> <span class="id">:</span> <span class="id">hierarchy.naturality</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ret_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof92')">Proof.</span></div>
<div class="proofscript" id="proof92">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">?</span> <span class="id">?</span> <span class="id">?;</span> <span class="id">rewrite</span> (<span class="id">category.natural</span> (<span class="id">@category</span>.<span class="id">ret</span> <span class="id">_</span> <span class="id">M</span>)). Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">hierarchy.isNatural.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">ret_</span> <span class="id">naturality_ret</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">ret</span> <span class="id">:</span> (<span class="id">FId</span> <span class="id">~&gt;</span> <span class="id">F</span>)<span class="id">%monae</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">nattrans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id">ret_]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">naturality_join</span> <span class="id">:</span> <span class="id">hierarchy.naturality</span> <span class="id">[the</span> <span class="id">functor</span> <span class="id">of</span> <span class="id">F</span> <span class="id">\o</span> <span class="id">F]</span> <span class="id">F</span> <span class="id">join_</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof93')">Proof.</span></div>
<div class="proofscript" id="proof93">
<span class="id">move=&gt;</span> <span class="id">a</span> <span class="id">b</span> <span class="id">h;</span> <span class="id">rewrite</span> (<span class="id">_</span> <span class="id">:</span> <span class="id">h</span> <span class="id">=</span> <span class="id">[the</span> <span class="id">{hom</span> <span class="id">a,</span> <span class="id">b}</span> <span class="id">of</span> <span class="id">h]</span>)<span class="id">//</span>.<br/>
<span class="id">rewrite</span> <span class="id">/join_</span> <span class="id">actmE</span> (<span class="id">category.natural</span> <span class="id">category.join</span> <span class="id">a</span>).<br/>
<span class="id">congr</span> (<span class="id">_</span> <span class="id">\o</span> <span class="id">_</span>).<br/>
<span class="gallina-kwd">by</span> <span class="id">rewrite</span> <span class="id">category.FCompE</span> <span class="id">-2!actmE</span>.<br/>
Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">hierarchy.isNatural.Build</span> <span class="id">_</span> <span class="id">_</span> <span class="id">join_</span> <span class="id">naturality_join</span>.<br/>
<br/>
<span class="vernacular">Definition</span> <span class="id">join</span> <span class="id">:=</span> <span class="id">[the</span> <span class="id">nattrans</span> <span class="id">_</span> <span class="id">_</span> <span class="id">of</span> <span class="id">join_]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span> <span class="id">retE</span> <span class="id">a</span> <span class="id">:</span> <span class="id">ret</span> <span class="id">a</span> <span class="id">=</span> <span class="id">category.ret</span> <span class="id">a</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof94')">Proof.</span></div>
<div class="proofscript" id="proof94">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">joinE</span> <span class="id">a</span> <span class="id">:</span> <span class="id">join</span> <span class="id">a</span> <span class="id">=</span> <span class="id">category.join</span> <span class="id">a</span><br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof95')">Proof.</span></div>
<div class="proofscript" id="proof95">
 <span class="gallina-kwd">by</span> <span class="id">[]</span>. Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">joinretM</span> <span class="id">:</span> <span class="id">hierarchy.JoinLaws.left_unit</span> <span class="id">ret</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof96')">Proof.</span></div>
<div class="proofscript" id="proof96">
<span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">a;</span> <span class="id">apply</span> <span class="id">funext=&gt;</span> <span class="id">x;</span> <span class="id">rewrite</span> <span class="id">joinE</span> <span class="id">retE</span> (<span class="id">category.joinretM</span> <span class="id">a</span>).<br/>
Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">joinMret</span> <span class="id">:</span> <span class="id">hierarchy.JoinLaws.right_unit</span> <span class="id">ret</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof97')">Proof.</span></div>
<div class="proofscript" id="proof97">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">a;</span> <span class="id">rewrite</span> <span class="id">joinE</span> <span class="id">retE</span> <span class="id">actmE</span> (<span class="id">@category</span>.<span class="id">joinMret</span> <span class="id">_</span> <span class="id">M</span>). Qed.</div>
<br/>
<span class="vernacular">Lemma</span> <span class="id">joinA</span> <span class="id">:</span> <span class="id">hierarchy.JoinLaws.associativity</span> <span class="id">join</span>.<br/>
<div><span class="toggleproof" onclick="toggleDisplay('proof98')">Proof.</span></div>
<div class="proofscript" id="proof98">
 <span class="gallina-kwd">by</span> <span class="id">move=&gt;</span> <span class="id">a;</span> <span class="id">rewrite</span> <span class="id">joinE</span> <span class="id">actmE</span> (<span class="id">category.joinA</span> <span class="id">a</span>). Qed.</div>
<br/>
<span class="id">HB.instance</span> <span class="vernacular">Definition</span> <span class="id">_</span> <span class="id">:=</span> <span class="id">@hierarchy</span>.<span class="id">isMonad_ret_join.Build</span> <span class="id">acto</span> <span class="id">ret</span> <span class="id">join</span><br/>
&nbsp;&nbsp;<span class="id">joinretM</span> <span class="id">joinMret</span> <span class="id">joinA</span>.<br/>
<span class="vernacular">End</span> <span class="id">def</span>.<br/>
<span class="vernacular">End</span> <span class="id">Monad_of_category_monad</span>.<br/>
<span class="id">HB.export</span> <span class="id">Monad_of_category_monad</span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
</body>
</html>
